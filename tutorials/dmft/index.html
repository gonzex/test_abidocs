
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="http://www.abinit.org/tutorials/dmft/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="shortcut icon" href="../../images/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.10.1">
    
    
      
        <title>DMFT - abinit</title>
      
    
    
    
      <script src="../../assets/javascripts/modernizr-e826f8942a.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}",
                  kq: "{\\kk + \\qq}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link rel="stylesheet" href="../../assets/stylesheets/application-a20f419c8e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-23f75ab9c7.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">

      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="http://www.abinit.org" title="abinit" class="md-logo md-header-nav__button">
            <img src="../../images/logo-abinit-2015.svg" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
            
            DMFT
          
        </span>
      </div>
        
      <!-- Guide Tour with introjs -->
      <div class="md-flex__cell md-flex__cell--shrink">
          <a href="#" class="btn btn-xs btn-default" title="Guided Tour" onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>

      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      

      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.5.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
            <li><a href="#">8.2.0</a></li>
            
            <li><a href="#">8.1.0</a></li>
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user-guide/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../welcome/" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/wavefunctions/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <div class="md-nav__button md-logo">
      
        
          <img src="../../images/logo-abinit-2015.svg">
        
      
    </div>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/help_what_ABINIT_does/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/new_user/" title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/connections/" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../welcome/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        DMFT
      </label>
    
    <a href="./" title="DMFT" class="md-nav__link md-nav__link--active">
      DMFT
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-dftdmft-calculation-for-srvo3" title="A DFT+DMFT calculation for SrVO3." class="md-nav__link">
    A DFT+DMFT calculation for SrVO3.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-dftdmft-method-summary-and-key-parameters" title="1 The DFT+DMFT method: summary and key parameters" class="md-nav__link">
    1 The DFT+DMFT method: summary and key parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-electronic-structure-of-srvo3-in-lda" title="2 Electronic Structure of SrVO3 in LDA" class="md-nav__link">
    2 Electronic Structure of SrVO3 in LDA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-electronic-structure-of-srvo3-dftdmft-calculation" title="3 Electronic Structure of SrVO3: DFT+DMFT calculation" class="md-nav__link">
    3 Electronic Structure of SrVO3: DFT+DMFT calculation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-the-input-file-for-dmft-calculation-correlated-orbitals-screened" title="3.1. The input file for DMFT calculation: correlated orbitals, screened" class="md-nav__link">
    3.1. The input file for DMFT calculation: correlated orbitals, screened
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-the-dftdmft-calculation-the-log-file" title="3.2. The DFT+DMFT calculation: the log file" class="md-nav__link">
    3.2. The DFT+DMFT calculation: the log file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-the-self-energy" title="3.3. The self energy" class="md-nav__link">
    3.3. The self energy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-the-greens-function-for-correlated-orbitals" title="3.4. The Green's function for correlated orbitals" class="md-nav__link">
    3.4. The Green's function for correlated orbitals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-the-local-spectral-function" title="3.5. The local spectral function" class="md-nav__link">
    3.5. The local spectral function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-electronic-structure-of-srvo3-choice-of-correlated-orbitals" title="4 Electronic Structure of SrVO3: Choice of correlated orbitals" class="md-nav__link">
    4 Electronic Structure of SrVO3: Choice of correlated orbitals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-electronic-structure-of-srvo3-the-internal-energy" title="5 Electronic Structure of SrVO3: The internal energy" class="md-nav__link">
    5 Electronic Structure of SrVO3: The internal energy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-electronic-structure-of-srvo3-in-dftdmft-equilibrium-volume" title="6 Electronic Structure of SrVO3 in DFT+DMFT: Equilibrium volume" class="md-nav__link">
    6 Electronic Structure of SrVO3 in DFT+DMFT: Equilibrium volume
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-electronic-structure-of-srvo3-conclusion" title="7 Electronic Structure of SrVO3: Conclusion" class="md-nav__link">
    7 Electronic Structure of SrVO3: Conclusion
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a-dftdmft-calculation-for-srvo3" title="A DFT+DMFT calculation for SrVO3." class="md-nav__link">
    A DFT+DMFT calculation for SrVO3.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-dftdmft-method-summary-and-key-parameters" title="1 The DFT+DMFT method: summary and key parameters" class="md-nav__link">
    1 The DFT+DMFT method: summary and key parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-electronic-structure-of-srvo3-in-lda" title="2 Electronic Structure of SrVO3 in LDA" class="md-nav__link">
    2 Electronic Structure of SrVO3 in LDA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-electronic-structure-of-srvo3-dftdmft-calculation" title="3 Electronic Structure of SrVO3: DFT+DMFT calculation" class="md-nav__link">
    3 Electronic Structure of SrVO3: DFT+DMFT calculation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-the-input-file-for-dmft-calculation-correlated-orbitals-screened" title="3.1. The input file for DMFT calculation: correlated orbitals, screened" class="md-nav__link">
    3.1. The input file for DMFT calculation: correlated orbitals, screened
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-the-dftdmft-calculation-the-log-file" title="3.2. The DFT+DMFT calculation: the log file" class="md-nav__link">
    3.2. The DFT+DMFT calculation: the log file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-the-self-energy" title="3.3. The self energy" class="md-nav__link">
    3.3. The self energy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-the-greens-function-for-correlated-orbitals" title="3.4. The Green's function for correlated orbitals" class="md-nav__link">
    3.4. The Green's function for correlated orbitals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-the-local-spectral-function" title="3.5. The local spectral function" class="md-nav__link">
    3.5. The local spectral function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-electronic-structure-of-srvo3-choice-of-correlated-orbitals" title="4 Electronic Structure of SrVO3: Choice of correlated orbitals" class="md-nav__link">
    4 Electronic Structure of SrVO3: Choice of correlated orbitals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-electronic-structure-of-srvo3-the-internal-energy" title="5 Electronic Structure of SrVO3: The internal energy" class="md-nav__link">
    5 Electronic Structure of SrVO3: The internal energy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-electronic-structure-of-srvo3-in-dftdmft-equilibrium-volume" title="6 Electronic Structure of SrVO3 in DFT+DMFT: Equilibrium volume" class="md-nav__link">
    6 Electronic Structure of SrVO3 in DFT+DMFT: Equilibrium volume
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-electronic-structure-of-srvo3-conclusion" title="7 Electronic Structure of SrVO3: Conclusion" class="md-nav__link">
    7 Electronic Structure of SrVO3: Conclusion
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                
                <h1 id="lesson-on-dftdmft">Lesson on DFT+DMFT<a class="headerlink" href="#lesson-on-dftdmft" title="Permanent link">&para;</a></h1>
<h2 id="a-dftdmft-calculation-for-srvo3">A DFT+DMFT calculation for SrVO<sub>3</sub>.<a class="headerlink" href="#a-dftdmft-calculation-for-srvo3" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to perform a DFT+DMFT calculation using
Abinit.</p>
<p>You will not learn here what is DFT+DMFT. But you will learn how to do a
DFT+DMFT calculation and what are the main input variables controlling this
type of calculation.</p>
<p>It might be useful that you already know how to do PAW calculations using
ABINIT but it is not mandatory (you can follow the two lessons on PAW in
ABINIT, <a class="wikilink lesson-wikilink" href="../paw1">PAW1</a> and <a class="wikilink lesson-wikilink" href="../paw2">PAW2</a>). Also the
<a class="wikilink lesson-wikilink" href="../dftu">DFT+U lesson</a> in ABINIT might be useful to know some basic
variables common to DFT+U and DFT+DMFT.</p>
<p>This lesson should take one hour to complete (especially if you have access to
several processors).</p>
<h2 id="1-the-dftdmft-method-summary-and-key-parameters">1 The DFT+DMFT method: summary and key parameters<a class="headerlink" href="#1-the-dftdmft-method-summary-and-key-parameters" title="Permanent link">&para;</a></h2>
<p>The DFT+DMFT method aims at improving the description of strongly correlated
systems. Generally, these highly correlated materials contain rare-earth
metals or transition metals, which have partially filled <em>d</em> or <em>f</em> bands and
thus localized electrons. For further information on this method, please refer
to <a class="wikilink citation-wikilink" data-content="Dynamical mean-field theory of strongly correlated fermion systems and the limit of infinite dimensions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#georges1996">[Georges1996]</a> and <a class="wikilink citation-wikilink" data-content="Electronic structure calculations with dynamical mean-field theory" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#kotliar2006">[Kotliar2006]</a>. For an introduction to Many Body
Physics (Green&rsquo;s function, Self-energy, imaginary time, and Matsubara
frequencies), see e.g. <a class="wikilink citation-wikilink" data-content="Introduction to Many-Body Physics" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#coleman2015">[Coleman2015]</a> and <a class="wikilink citation-wikilink" data-content="Probl\`eme \`a N-corps" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#tremblay2017">[Tremblay2017]</a>.</p>
<p>Several parameters (both physical and technical) needs to be discussed for a
DFT+DMFT calculation.</p>
<ul>
<li>The definition of correlated orbitals. In the ABINIT DMFT implementation, it is done with the help of Projected Wannier orbitals (see <a class="wikilink citation-wikilink" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008">[Amadon2008]</a>). The first part of the tutorial explains the importance of this choice. Wannier functions are unitarily related to a selected set of Kohn Sham (KS) wavefunctions, specified in ABINIT by band index <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a>, and <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a>. Thus, as empty bands are necessary to build Wannier functions, it is required in DMFT calculations that the KS Hamiltonian is correctly diagonalized: use high values for <a class="wikilink codevar-wikilink" href="../../variables/dev#nnsclo">nnsclo</a>, and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nline">nline</a> for DMFT calculations and preceding DFT calculations. Roughly speaking, the larger dmftbandf-dmftbandi is, the more localized is the radial part of the orbital. Note that this definition is different from the definition of correlated orbitals in the DFT+U implementation in ABINIT (see <a class="wikilink citation-wikilink" data-content="$\gamma$ and $\beta$ cerium: {LDA}+{U} calculations of ground-state parameters" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008a">[Amadon2008a]</a>). The relation between the two expressions is briefly discussed in <a class="wikilink citation-wikilink" data-content="A self-consistent {DFT}+{DMFT} scheme in the projector augmented wave method: applications to cerium, {C}e$_2${O}$_3$ and {P}u$_2${O}$_3$ with the {H}ubbard {I} solver and comparison to {DFT}+{U}" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2012">[Amadon2012]</a>. </li>
<li>The definition of the Coulomb and exchange interaction U and J are done as in DFT+U through the variables <a class="wikilink codevar-wikilink" href="../../variables/paw#upawu">upawu</a> and <a class="wikilink codevar-wikilink" href="../../variables/paw#jpawu">jpawu</a>. They could be computed with the cRPA method, also available in ABINIT. The value of U and J should in principle depend on the definition of correlated orbitals. In this tutorial, U and J will be seen as parameters, as in the DFT+U approach. As in DFT+U, two double counting methods are available (see the <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_dc">dmft_dc</a> input variable). Note that in version 7.10.5 (but not in later versions) <a class="wikilink codevar-wikilink" href="../../variables/paw#jpawu">jpawu</a>=0 is required if the density matrix in the correlated subspace is not diagonal. </li>
<li>The choice of the double counting correction. The current default choice in ABINIT is (<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_dc">dmft_dc</a>=1) which corresponds to the full localized limit. </li>
<li>The method of resolution of the Anderson model. In ABINIT, it can be the Hubbard I method (<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_solv">dmft_solv</a>=2) the Continuous time Quantum Monte Carlo (CTQMC) method (<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_solv">dmft_solv</a>=5) or the static mean field method (<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_solv">dmft_solv</a>=1) equivalent to usual DFT+U. </li>
<li>The solution of the Anderson Hamiltonian and the DMFT solution are strongly dependent over temperature. So the temperature <a class="wikilink codevar-wikilink" href="../../variables/gstate#tsmear">tsmear</a> is a very important physical parameter of the calculation. </li>
<li>The practical solution of the DFT+DMFT scheme is usually presented as a double loop over first the local Green&rsquo;s function, and second the electronic local density. (cf Fig. 1 in <a class="wikilink citation-wikilink" data-content="A self-consistent {DFT}+{DMFT} scheme in the projector augmented wave method: applications to cerium, {C}e$_2${O}$_3$ and {P}u$_2${O}$_3$ with the {H}ubbard {I} solver and comparison to {DFT}+{U}" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2012">[Amadon2012]</a>). The number of iterations of both loops are respectively given in ABINIT by keywords <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_iter">dmft_iter</a> and <a class="wikilink codevar-wikilink" href="../../variables/basic#nstep">nstep</a>. Other useful variables are <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_rslf">dmft_rslf</a>=1 and <a class="wikilink codevar-wikilink" href="../../variables/files#prtden">prtden</a>=-1 (to be able to restart the calculation from the density file). Lastly, one linear and one logarithmic grid are used for Matsubara Frequencies indicated by <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_nwli">dmft_nwli</a> and <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_nwlo">dmft_nwlo</a> (Typical values are 100000 and 100, but convergence should be studied). A large number of informations are given in the log file using <a class="wikilink codevar-wikilink" href="../../variables/paw#pawprtvol">pawprtvol</a>=3. </li>
</ul>
<h2 id="2-electronic-structure-of-srvo3-in-lda">2 Electronic Structure of SrVO3 in LDA<a class="headerlink" href="#2-electronic-structure-of-srvo3-in-lda" title="Permanent link">&para;</a></h2>
<p>You might create a subdirectory of the ~abinit/tests/tutoparal directory, and
use it for the tutorial. In what follows, the names of files will be mentioned
as if you were in this subdirectory</p>
<p>Copy the files ../Input/tdmft_1.in and ../Input/tdmft_x.files in your Work
directory and run ABINIT (as usual, the actual &ldquo;abinit&rdquo; command is something
like ../../../../src/98_main/abinit):</p>
<div class="codehilite"><pre><span></span>abinit &lt; tdmft_x.files &gt; log_1
</pre></div>


<p>This run should take some time. It is recommended that you use at least 10
processors (and 32 should be fast). It calculates the LDA ground state of
SrVO3 and compute the band structure in a second step. The variable
<a class="wikilink codevar-wikilink" href="../../variables/paw#pawfatbnd">pawfatbnd</a> allows to create files with &ldquo;fatbands&rdquo; (see description of the
variable in the list of variables): the width of the line along each k-point
path and for each band is proportional to the contribution of a given atomic
orbital on this particular Kohn Sham Wavefunction. A low cutoff and a small
number of k-points are used in order to speed up the calculation. During this
time you can take a look at the input file. There are two datasets. The first
one is a ground state calculations with <a class="wikilink codevar-wikilink" href="../../variables/dev#nnsclo">nnsclo</a>=3 and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nline">nline</a>=3 in order
to have well diagonalized eigenfunctions even for empty states. In practice,
you have however to check that the residue of wavefunctions is small at the
end of the calculation. In this calculation, we find 1.E-06, which is large
(1.E-10 would be better, so nnsclo and nline should be increased, but it would
take more time). When the calculation is finished, you can plot the fatbands
for Vanadium and l=2. Several possibilities are available for that purpose. We
will work with the simple XMGRACE package (you need to install it, if not
already avaialble on your machine).</p>
<div class="codehilite"><pre><span></span>xmgrace tdmft_1o_DS2_FATBANDS_at0001_V_is1_l0002
</pre></div>


<p>The band structure is given in eV.<br />
<img alt="FatbandV" src="../../documents/lesson_dmft/fatbandV.jpg" />  </p>
<p>and the fatbands for Oxygen and l=1 with</p>
<div class="codehilite"><pre><span></span>xmgrace tdmft_1o_DS2_FATBANDS_at0003_O_is1_l0001.
</pre></div>


<p><img alt="FatbandV" src="../../documents/lesson_dmft/fatbandO.jpg" /><br />
In these plots, you recover the band structure of SrVO3 (see for comparison
the band structure of Fig.3 of <a class="wikilink citation-wikilink" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008">[Amadon2008]</a>). , and the main character of
the bands. Bands 21 to 25 are mainly <em>d</em> and bands 12 to 20 are mainly oxygen
<em>p</em>. However, we clearly see an important hybridization. The Fermi level (at 0
eV) is in the middle of bands 21-23.</p>
<p>One can easily check thats bands 21-23 are mainly <em>d-t2g</em> and bands 24-25 are
mainly <em>eg</em>: just use pawfatbnd=2 in tdmft_1.in and relaunch the calculations.
Then the file tdmft_1o_DS2_FATBANDS_at0001_V_is1_l2_m-2,
tdmft_1o_DS2_FATBANDS_at0001_V_is1_l2_m-1 and
tdmft_1o_DS2_FATBANDS_at0001_V_is1_l2_m1 give you respectively the xy,yz and
xz fatbands (ie <em>d-t2g</em>) and tdmft_1o_DS2_FATBANDS_at0001_V_is1_l2_m+0 and
tdmft_1o_DS2_FATBANDS_at0001_V_is1_l2_m+2 give the z2 and z2-y2 fatbands (ie
<em>eg</em>).</p>
<p>So in conclusion of this study, the Kohn Sham bands which are mainly <em>t2g</em> are
the bands 21,22 and 23.</p>
<p>Of course, it could have been anticipated from classical crystal field theory:
the vanadium is in the center of an octahedron of oxygen atoms, so <em>d</em>
orbitals are splitted in <em>t2g</em> and <em>eg</em>. As <em>t2g</em> orbitals are not directed
toward oxygen atoms, <em>t2g</em>-like bands are lower in energy and filled with one
electron, whereas <em>eg</em>-like bands are higher and empty.</p>
<p>In the next section, we will thus use the <em>t2g</em>-like bands to built Wannier
functions and do the DFT+DMFT calculation.</p>
<h2 id="3-electronic-structure-of-srvo3-dftdmft-calculation">3 Electronic Structure of SrVO3: DFT+DMFT calculation<a class="headerlink" href="#3-electronic-structure-of-srvo3-dftdmft-calculation" title="Permanent link">&para;</a></h2>
<h4 id="31-the-input-file-for-dmft-calculation-correlated-orbitals-screened">3.1. The input file for DMFT calculation: correlated orbitals, screened<a class="headerlink" href="#31-the-input-file-for-dmft-calculation-correlated-orbitals-screened" title="Permanent link">&para;</a></h4>
<p>Coulomb interaction and frequency mesh</p>
<p>In ABINIT, correlated orbitals are defined using the projected local orbitals
Wannier functions as outlined above. The definition requires to define a given
energy window from which projected Wannier functions are constructed. We would
like in this tutorial, to apply the DMFT method on <em>d</em> orbitals and for
simplicity on a subset of d orbitals, namely <em>t2g</em> orbitals (<em>eg</em> orbitals
play a minor role because they are empty). But we need to define <em>t2g</em>
orbitals. For this, we will use Wannier functions.</p>
<p>As we have seen in the orbitally resolved fatbands, the Kohn Sham wave
function contains a important weight of <em>t2g</em> atomic orbitals mainly in <em>t2g</em>-
like bands but also in oxygen bands.</p>
<p>So, we can use only the <em>t2g</em>-like bands to define Wannier functions or also
both the <em>t2g</em>-like and <em>O-p</em>-like bands.</p>
<p>The first case corresponds to the input file tdmft_2.in. In this case
<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a>=21 and <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a>=23. As we only put the electron interaction
on <em>t2g</em> orbitals, we have to use first lpawu=2, but also the keyword
<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_t2g">dmft_t2g</a>=1 in order to restrict the application of interaction on <em>t2g</em>
orbitals.</p>
<p>Notice also that before launching a DMFT calculation, the LDA should be
perfectly converged, including the empty states (check nline and nnsclo in the
input file). The input file tdmft_2.in thus contains two datasets: the first
one is a well converged LDA calculation, and the second is the DFT+DMFT
calculation.</p>
<p>Notice the other dmft variables used in the input file and check their meaning
in the input variable glossary. In particular, we are using dmft_solv=5 for
the dmft dataset in order to use the density-density continuous time quantum
monte carlo (CTQMC) solver. (See <a class="wikilink citation-wikilink" data-content="Continuous-time Monte Carlo methods for quantum impurity models" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gull2011">[Gull2011]</a>, as well as the ABINIT 2016
paper <a class="wikilink citation-wikilink" data-content="Recent developments in the {ABINIT} software package" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#gonze2016">[Gonze2016]</a> for details about the CTQMC implementation in ABINIT.)<br />
Note that the number of imaginary frequencies <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_nwlo">dmft_nwlo</a> has to be set to
at least twice the value of <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftqmc_l">dmftqmc_l</a> (the discretization in imaginary
time). Here, we choose a temperature of 1200 K. For lower temperature, the
number of Matsubara frequencies should be higher.</p>
<p>Here we use a fast calculation, with a small value of the parameters,
especially <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmft_nwlo">dmft_nwlo</a>, <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftqmc_l">dmftqmc_l</a> and <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftqmc_n">dmftqmc_n</a>.</p>
<p>Let&rsquo;s now discuss the value of the effective Coulomb interaction U (<a class="wikilink codevar-wikilink" href="../../variables/paw#upawu">upawu</a>)
and J (<a class="wikilink codevar-wikilink" href="../../variables/paw#jpawu">jpawu</a>). The values of U and J used in ABINIT in DMFT use the same
convention as in DFT+U calculations in ABINIT (cf <a class="wikilink citation-wikilink" data-content="$\gamma$ and $\beta$ cerium: {LDA}+{U} calculations of ground-state parameters" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008a">[Amadon2008a]</a>). However,
calculations in Ref. <a class="wikilink citation-wikilink" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008">[Amadon2008]</a> use for U and J the usual convention for _
t2g _ systems as found in <a class="wikilink citation-wikilink" data-content="Dynamical mean-field theory using Wannier functions: A flexible route to electronic structure calculations of strongly correlated materials" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#lechermann2006">[Lechermann2006]</a>, Eq. 26 (see also the appendix in
<a class="wikilink citation-wikilink" data-content="Interplay of Mott transition and ferromagnetism in the orbitally degenerate Hubbard model" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#fresard1997">[Fresard1997]</a>). It corresponds to the Slater integral F4=0 and we can show
that U_abinit=U-4/3 J and J_abinit=7/6 J . So in order to use U=4 eV and
J=0.65 eV with these latter conventions (as in <a class="wikilink citation-wikilink" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008">[Amadon2008]</a>), we have to use
in ABINIT: <a class="wikilink codevar-wikilink" href="../../variables/paw#upawu">upawu</a>=3.13333 eV; <a class="wikilink codevar-wikilink" href="../../variables/paw#jpawu">jpawu</a>=0.75833 eV and <a class="wikilink codevar-wikilink" href="../../variables/paw#f4of2_sla">f4of2_sla</a>=0.</p>
<p>Now, you can launch the calculation:</p>
<p>Copy the files ../Input/tdmft_2.in and modify tdmft_x.files in your Work
directory and run ABINIT:</p>
<div class="codehilite"><pre><span></span>mpirun -n 32 ../../../tmp/src/98_main/abinit &lt; tdmft_x.files &gt; log_2
</pre></div>


<h4 id="32-the-dftdmft-calculation-the-log-file">3.2. The DFT+DMFT calculation: the log file<a class="headerlink" href="#32-the-dftdmft-calculation-the-log-file" title="Permanent link">&para;</a></h4>
<p>We are now going to browse quickly the log file (log_2) for this calculation.</p>
<p>Starting from</p>
<div class="codehilite"><pre><span></span>     =====  Start of DMFT calculation
</pre></div>


<p>we have first the definition of logarithmic grid for frequency, then, after:</p>
<div class="codehilite"><pre><span></span>  == Prepare data for DMFT calculation
</pre></div>


<p>The projection of Kohn Sham wavefunctions and (truncated) atomic orbitals are
computed (Eq.(2.1) in <a class="wikilink citation-wikilink" data-content="A self-consistent {DFT}+{DMFT} scheme in the projector augmented wave method: applications to cerium, {C}e$_2${O}$_3$ and {P}u$_2${O}$_3$ with the {H}ubbard {I} solver and comparison to {DFT}+{U}" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2012">[Amadon2012]</a>) and unnormalized orbitals are built
(Eq.(2.2) in <a class="wikilink citation-wikilink" data-content="A self-consistent {DFT}+{DMFT} scheme in the projector augmented wave method: applications to cerium, {C}e$_2${O}$_3$ and {P}u$_2${O}$_3$ with the {H}ubbard {I} solver and comparison to {DFT}+{U}" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2012">[Amadon2012]</a>) The occupation matrix in this orbital basis is</p>
<div class="codehilite"><pre><span></span>  ------ Symetrised Occupation



        0.11142  -0.00000  -0.00000
       -0.00000   0.11142  -0.00000
       -0.00000  -0.00000   0.11142
</pre></div>


<p>and the Normalization of this orbital basis is</p>
<div class="codehilite"><pre><span></span>  ------ Symetrised Norm



        0.65790   0.00000   0.00000
        0.00000   0.65790   0.00000
        0.00000   0.00000   0.65790
</pre></div>


<p>Now, let&rsquo;s compare these numbers to other quantities. If the preceding LDA
calculation is converged, dmatpuopt=1 is used, and <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a>=1 and
<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandf">dmftbandf</a>=nband, then the above Symetrised Occupation should be exactly
equal to the occupation matrix given in the usual DFT+U occupation matrix
written in the log file (with dmatpuopt=1) (see discussion in <a class="wikilink citation-wikilink" data-content="A self-consistent {DFT}+{DMFT} scheme in the projector augmented wave method: applications to cerium, {C}e$_2${O}$_3$ and {P}u$_2${O}$_3$ with the {H}ubbard {I} solver and comparison to {DFT}+{U}" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2012">[Amadon2012]</a>).
In our case, we are not in this case because <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a>=21 so this
condition is not fulfilled. Concerning the norm if these orbitals, two factors
play a role:</p>
<ul>
<li>Firstly, the number of Kohn Sham function used should be infinite (cf Eq. B.4 of <a class="wikilink citation-wikilink" data-content="A self-consistent {DFT}+{DMFT} scheme in the projector augmented wave method: applications to cerium, {C}e$_2${O}$_3$ and {P}u$_2${O}$_3$ with the {H}ubbard {I} solver and comparison to {DFT}+{U}" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2012">[Amadon2012]</a>), which is not the case here, because we take into account only bands 21-23. We emphasize that it is not a limitation of our approach, but just a physical choice concerning Wannier functions. This physical choice induces that these intermediate wave functions have a very low norm. </li>
<li>
<p>Secondly, the atomic orbitals used to do the projection are cut at the PAW radius. As a consequence, even if we would use a complete set of KS wavefunctions and thus the closure relation, the norm could not be one. In our case, it could be at most 0.86852, which is the norm of the truncated atomic function of <em>d</em> orbitals of Vanadium used in this calculation. This number can be found in the log file by searching for ph0phiint (grep &ldquo;ph0phiint(icount)= 1&rdquo; log_2). (See also the discussion in Section B.3 of <a class="wikilink citation-wikilink" data-content="A self-consistent {DFT}+{DMFT} scheme in the projector augmented wave method: applications to cerium, {C}e$_2${O}$_3$ and {P}u$_2${O}$_3$ with the {H}ubbard {I} solver and comparison to {DFT}+{U}" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2012">[Amadon2012]</a>). 
Next the LDA Green&rsquo;s function is computed.</p>
<p>=====  LDA Green Function Calculation</p>
</li>
</ul>
<p>Then the Green&rsquo;s function is integrated to compute the occupation matrix.
Interestingly, the density matrix here must be equal to the density matrix
computed with the unnormalized correlated orbitals. If this is not the case,
it means that the frequency grid is not sufficiently large. In our case, we
find:</p>
<div class="codehilite"><pre><span></span>        0.11143   0.00000   0.00000
        0.00000   0.11143   0.00000
        0.00000   0.00000   0.11143
</pre></div>


<p>So the error is very small (1.10E-5). As an exercise, you can decrease the
number of frequencies and see that the error becomes larger.</p>
<p>Then the true orthonormal Wannier functions are built and the Green&rsquo;s function
is computed in this basis just after:</p>
<div class="codehilite"><pre><span></span> =====  LDA Green Function Calculation with renormalized psichi
</pre></div>


<p>The occupation matrix is now:</p>
<div class="codehilite"><pre><span></span>        0.16937   0.00000  -0.00000
        0.00000   0.16937   0.00000
       -0.00000   0.00000   0.16937
</pre></div>


<p>We see that because of the orthonormalization of the orbitals necessary to
built Wannier functions, the occupation matrix logically increases.</p>
<p>Then, after:</p>
<div class="codehilite"><pre><span></span> =====  Define Interaction and self-energy
</pre></div>


<p>The Interaction kernel is computed from U and J, and the self energy is read
from the disk file (if it exists). Then, the Green&rsquo;s function is computed with
the self energy and the Fermi level is computed. Then the DMFT Loop starts.</p>
<div class="codehilite"><pre><span></span> =====  DMFT Loop starts here
</pre></div>


<p>The log contains a lot of details about the calculation (especially if
<a class="wikilink codevar-wikilink" href="../../variables/paw#pawprtvol">pawprtvol</a>=3). In order to have a more synthetic overview of the
calculation (this is especially useful to detect possible divergence of the
calculation), the following command extracts the evolution of the number of
electrons (LDA, LDA with Wannier functions, and DMFT number of electrons) as a
function of iterations (be careful, all numbers of electron are computed
differently as explained in the log file):</p>
<div class="codehilite"><pre><span></span>grep -e Nb -e ITER log_2
</pre></div>


<p>Besides, during each DMFT calculation, there are one or more CTQMC
calculations:</p>
<div class="codehilite"><pre><span></span>Starting QMC  (Thermalization)
</pre></div>


<p>For the sake of efficiency, the DMFT Loop is in this calculation done only
once before doing again the DFT Loop (cf Fig. 1 of <a class="wikilink citation-wikilink" data-content="A self-consistent {DFT}+{DMFT} scheme in the projector augmented wave method: applications to cerium, {C}e$_2${O}$_3$ and {P}u$_2${O}$_3$ with the {H}ubbard {I} solver and comparison to {DFT}+{U}" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2012">[Amadon2012]</a>). At the end
of the calculation, the occupation matrix is written and is:</p>
<div class="codehilite"><pre><span></span>          -- polarization spin component  1
        0.16843   0.00000  -0.00000
       -0.00000   0.16843  -0.00000
       -0.00000   0.00000   0.16843
</pre></div>


<p>We can see that the total number of electron is very close to one and it does
not change much as a function of iterations. As an output of the calculation,
you can find the self energy in file tdmft_2o_DS2Self-omega_iatom0001_isppol1
and the Green&rsquo;s function is file Gtau.dat.</p>
<h4 id="33-the-self-energy">3.3. The self energy<a class="headerlink" href="#33-the-self-energy" title="Permanent link">&para;</a></h4>
<p>You can use the self-energy to compute the quasiparticle renormalization
weight. We first extract the first six Matsubara frequencies:</p>
<div class="codehilite"><pre><span></span>head -n 8 tdmft_2o_DS2Self-omega_iatom0001_isppol1 &gt; self.dat
</pre></div>


<p>Then we plot the imaginary part of the self-energy (in imaginary frequency):</p>
<div class="codehilite"><pre><span></span>xmgrace -block self.dat -bxy 1:3
</pre></div>


<p>Then using xmgrace, you click on <em>Data</em>, then on _ Transformations _ and then
on _ Regression _ and you can do a 4<sup>th</sup> order fit as:<br />
<img alt="self" src="../../documents/lesson_dmft/self.jpg" /><br />
The slope at zero frequency obtained is 0.82. From this number, the
quasiparticle renormalisation weight can be obtained using Z=1/(1+0.82)=0.55.</p>
<h4 id="34-the-greens-function-for-correlated-orbitals">3.4. The Green&rsquo;s function for correlated orbitals<a class="headerlink" href="#34-the-greens-function-for-correlated-orbitals" title="Permanent link">&para;</a></h4>
<p>The impurity (or local) Green&rsquo;s function for correlated orbitals is written in
the file Gtau.dat. It is plotted as a function of the imaginary time in the
interval [0,β] where β is the inverse temperature (in Hartree). You can plot
this Green&rsquo;s function for the six <em>t2g</em> orbitals using e.g xmgrace</p>
<div class="codehilite"><pre><span></span>xmgrace -nxy Gtau.dat
</pre></div>


<p><img alt="Gtau" src="../../documents/lesson_dmft/Gtau.jpg" /><br />
As the six _ t2g _ orbitals are degenerated, the six Green&rsquo;s function must be
similar, within the stochastic noise. Moreover, this imaginary time Green&rsquo;s
function must be negative and the value of G(β) for the orbital i is equal to
the opposite of the number of electrons in the orbital i (-ni). Optionnally,
you can check how the Green&rsquo;s function can be a rough way to check for the
importance of stochastic noise. For example, change for simplicity the number
of steps for the DMFT calculation to 1:</p>
<div class="codehilite"><pre><span></span>nstep2 1
</pre></div>


<p>and then use a much smaller number of steps for the Monte Carlo Solver such as</p>
<div class="codehilite"><pre><span></span>dmftqmc_n 1.d3
</pre></div>


<p>save the previous Gtau.dat file:</p>
<div class="codehilite"><pre><span></span>cp Gtau.dat Gtau.dat_save
</pre></div>


<p>Then relaunch the calculation. After it is completed, compare the new Green&rsquo;s
function and the old one with the previous value of <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftqmc_n">dmftqmc_n</a>. Using
xmgrace,</p>
<div class="codehilite"><pre><span></span>xmgrace -nxy Gtau.dat_save -nxy Gtau.dat
</pre></div>


<p>one obtains:<br />
<img alt="Gtau2" src="../../documents/lesson_dmft/Gtau2.jpg" /><br />
One naturally sees that the stochastic noise is much larger in this case. This
stochastic noise can induces that the variation of physical quantities (number
of electrons, electronic density, energy) as a function of the number of
iteration is noisy. Once you have finished this comparison, copy the saved
Green&rsquo;s function into Gtau.dat in order to continue the tutorial with a
precise Green&rsquo;s function in Gtau.dat:</p>
<div class="codehilite"><pre><span></span>cp Gtau.dat_save Gtau.dat
</pre></div>


<h4 id="35-the-local-spectral-function">3.5. The local spectral function<a class="headerlink" href="#35-the-local-spectral-function" title="Permanent link">&para;</a></h4>
<p>You can now use the imaginary time Green&rsquo;s function (contained in file
Gtau.dat) to compute the spectral function in real frequency. Such analytical
continuation can be done on quantum Monte Carlo data using the Maximum Entropy
method.</p>
<p>A maximum entropy code has been published recently by D. Bergeron. It can be
downloaded
<a href="https://www.physique.usherbrooke.ca/MaxEnt/index.php/Main_Page">here</a>. Please
cite the related paper <a class="wikilink citation-wikilink" data-content="Algorithms for optimized maximum entropy and diagnostic tools for analytic continuation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bergeron2016">[Bergeron2016]</a> if you use this code in a publication.</p>
<p>The code has a lot of options, and definitely, the method should be understood
and the user guide should be read before any real use. It is not the goal of
this DFT+DMFT tutorial to introduce to the Maximum Entropy Method (see
<a class="wikilink citation-wikilink" data-content="Algorithms for optimized maximum entropy and diagnostic tools for analytic continuation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#bergeron2016">[Bergeron2016]</a> and references therein). We give here a very quick way to
obtain a spectral function. First, you have to install this code and the
armadillo library by following the
<a href="https://www.physique.usherbrooke.ca/MaxEnt/index.php/Download">guidelines</a>,
and then launch it on the current directory in order to generate the default
input file OmegaMaxEnt_input_params.dat.</p>
<div class="codehilite"><pre><span></span>OmegaMaxEnt
</pre></div>


<p>Then edit the file OmegaMaxEnt_input_params.dat, and modify the first seven
lines with:</p>
<div class="codehilite"><pre><span></span>data file: Gtau.dat

OPTIONAL PREPROCESSING TIME PARAMETERS

DATA PARAMETERS
bosonic data (yes/[no]): no
imaginary time data (yes/[no]): yes
</pre></div>


<p>Then relaunch the code</p>
<div class="codehilite"><pre><span></span>OmegaMaxEnt
</pre></div>


<p>and plot the spectral function:</p>
<div class="codehilite"><pre><span></span>xmgrace OmegaMaxEnt_final_result/optimal_spectral_function_*.dat
</pre></div>


<p>Change the unit from Hartree to eV, and then, you have the spectral function:<br />
<img alt="spectralfunction" src="../../documents/lesson_dmft/spectralfunction.jpg" /><br />
Even if the calculation is not well converged, you recognize in the spectral
functions the quasiparticle peak as well as Hubbard bands at -2 eV and +2.5 eV
as in Fig.4 of <a class="wikilink citation-wikilink" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008">[Amadon2008]</a>.</p>
<h2 id="4-electronic-structure-of-srvo3-choice-of-correlated-orbitals">4 Electronic Structure of SrVO3: Choice of correlated orbitals<a class="headerlink" href="#4-electronic-structure-of-srvo3-choice-of-correlated-orbitals" title="Permanent link">&para;</a></h2>
<p>Previously, only the <em>t2g</em>-like bands were used in the definition of Wannier
functions. If there were no hybridization between <em>t2g</em> orbitals and oxygen
<em>p</em> orbitals, the Wannier functions would be pure atomic orbitals and they
would not change if the energy window was increased. But there is an important
hybridization, as a consequence, we will now built Wannier functions with a
large window, by including oxygen <em>p</em>-like bands in the definition of Wannier
functions. Create a new input file:</p>
<div class="codehilite"><pre><span></span>cp tdmft_2.in tdmft_3.in
</pre></div>


<p>and use <a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftbandi">dmftbandi</a>= 12 in tdmft_3.in. Now the code will built Wannier
functions with a larger window, including <em>O-p</em>-like bands, and thus much more
localized. Launch the calculation after having updated tdmft_x.files (if the
calculation is too long, you can decide to restart the second dataset directly
from a converged LDA calculation instead of redoing the LDA calculation for
each new DMFT calculation).</p>
<div class="codehilite"><pre><span></span>abinit &lt; tdmft_x.files &gt; log_3
</pre></div>


<p>In this case, both the occupation and the norm are larger because more states
are taken into account: you have the occupation matrix which is</p>
<div class="codehilite"><pre><span></span>  ------ Symetrised Occupation



        0.23573  -0.00000  -0.00000
       -0.00000   0.23573  -0.00000
       -0.00000  -0.00000   0.23573
</pre></div>


<p>and the norm is:</p>
<div class="codehilite"><pre><span></span>  ------ Symetrised Norm



        0.78223   0.00000  -0.00000
        0.00000   0.78223  -0.00000
       -0.00000  -0.00000   0.78223
</pre></div>


<p>Let us now compare the total number of electron and the norm with the two
energy window:</p>
<div class="codehilite"><pre><span></span> Energy window:                              _t2g_-like bands         _t2g_-like+_O-p_-like bands
 dmftbandi/dmftbandf:                           21/23                      12/23
 Norm:                                           0.66                       0.78
 LDA Number of electrons (before ⊥):            0.66(=0.11*6)              1.42(=0.235*6)
 LDA Number of electrons (after  ⊥):            1.02                       1.81
</pre></div>


<p>For the large window, as we use more Kohn Sham states, both the occupation and
the norm are larger, mainly because of the important weight of <em>d</em> orbitals in
the oxygen bands (because of the hybridization). Concerning the norm, remind
that in any case, it cannot be larger that 0.86. So as the Norm is 0.78, it
means that by selecting bands 12-23 in the calculation, we took into account
0.78/0.86*100=90\% of the weight of the truncated atomic orbital among Kohn
Sham bands. Moreover, after orthonormalization, you can check that the
difference between LDA numbers of electrons is still large (1.02 versus 1.81),
even if the orthonormalization effect is larger on the small windows case.
Note that in this particular case, with diagonal matrix, the number of
electrons before and after orthonormalization are simply linked by
n_before/Norm=n_after, i.e. 1.81≈1.42/0.78 and 1.02≈0.66/0.66</p>
<p>At the end of the DFT+DMFT calculation, the occupation matrix is written and
is</p>
<div class="codehilite"><pre><span></span>          -- polarization spin component  1
        0.29450   0.00000   0.00000
        0.00000   0.29450   0.00000
        0.00000   0.00000   0.29450
</pre></div>


<p>Similarly to the previous calculation, the spectral function can be plotted
using the Maximum Entropy code: we find a spectral function with an
hybridation peak at -5 eV, as described in Fig.5 of <a class="wikilink citation-wikilink" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008">[Amadon2008]</a>.<br />
<img alt="spectralfunction" src="../../documents/lesson_dmft/spectralfunction2.jpg" /><br />
Resolving the lower Hubbard bands would require a more converged calculation.</p>
<p>As above, one can compute the renormalization weight and it gives 0.68. It
shows that with the same value of U and J, interactions have a weaker effect
for the large window Wannier functions. Indeed, the value of the screened
interaction U should be larger because the Wannier functions are more
localized (see discussion in <a class="wikilink citation-wikilink" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#amadon2008">[Amadon2008]</a>).</p>
<h2 id="5-electronic-structure-of-srvo3-the-internal-energy">5 Electronic Structure of SrVO3: The internal energy<a class="headerlink" href="#5-electronic-structure-of-srvo3-the-internal-energy" title="Permanent link">&para;</a></h2>
<p>The internal energy can be obtained with</p>
<div class="codehilite"><pre><span></span>grep -e ITER -e Internal log_3
</pre></div>


<p>and select the second occurrence for each iteration (the double counting
expression) which should be accurate with iscf=17 (at convergence both
expressions are equals also in DFT+DMFT). So after gathering the data:</p>
<div class="codehilite"><pre><span></span>  1      -1.51483736718814E+02
  2      -1.51480860837124E+02
  3      -1.51479980721122E+02
  4      -1.51479456233951E+02
  5      -1.51479511038784E+02
  6      -1.51479570943715E+02
  7      -1.51479487485907E+02
  8      -1.51479539558451E+02
  9      -1.51479457525225E+02
 10      -1.51479582334490E+02
</pre></div>


<p>You can plot the evolution of the internal energy as a function of the
iteration.<br />
<img alt="internal" src="../../documents/lesson_dmft/internal.jpg" /><br />
You notice that the internal energy (in a DFT+DMFT calculations) does not
converge as a function of iterations, because there is a finite statistical
noise. So, as a function of iterations, first, the internal energy starts to
converge, because the modification of the energy induced by the self-
consistency cycle is larger than the statistical noise, but then the internal
energy fluctuates around a mean value. So if the statistical noise is larger
than the tolerance, the calculation will never converge. So if a given
precision on the total energy is expected, a practical solution is to increase
the number of Quantum Monte Carlo steps (<a class="wikilink codevar-wikilink" href="../../variables/dmft#dmftqmc_n">dmftqmc_n</a>) in order to lower the
statistical noise. Also another solution is to do an average over the last
values of the internal energy. Note that in version 7.10.5, only the Internal
energy has a physical meaning in DFT+DMFT and not Etotal or ETOT.</p>
<h2 id="6-electronic-structure-of-srvo3-in-dftdmft-equilibrium-volume">6 Electronic Structure of SrVO3 in DFT+DMFT: Equilibrium volume<a class="headerlink" href="#6-electronic-structure-of-srvo3-in-dftdmft-equilibrium-volume" title="Permanent link">&para;</a></h2>
<p>We focus now on the total energy. Create a new input file, tdmft_4.in:</p>
<div class="codehilite"><pre><span></span>cp tdmft_3.in tdmft_4.in
</pre></div>


<p>And use acell=7.1605 instead of 7.2605. Relaunch the calculation and note the
Internal energy (grep Internal tdmft_4.out).</p>
<p>Redo another calculation with acell=7.00. Then extract the LDA Internal energy
and the DMFT Internal energy (grep Internal tdmft_5.out).</p>
<div class="codehilite"><pre><span></span>acell   Internal energy LDA    Internal energy DMFT
7.0000   -151.51517               -151.4797
7.1605   -151.52399               -151.4877
7.2605   -151.51515               -151.4795
</pre></div>


<p>and then plot DMFT and LDA energies as a function of acell. You will notice
that the equilibrium volume is very weakly modified by the strong correlations
is this case.</p>
<h2 id="7-electronic-structure-of-srvo3-conclusion">7 Electronic Structure of SrVO3: Conclusion<a class="headerlink" href="#7-electronic-structure-of-srvo3-conclusion" title="Permanent link">&para;</a></h2>
<p>To sum up, the important physical parameters for DFT+DMFT are the definition
of correlated orbitals, the choice of U and J (and double counting). The
important technical parameters are the frequency and time grids as well as the
number of steps for Monte Carlo, the DMFT loop and the DFT loop.</p>
<p>We showed in this tutorial how to compute spectral functions, quasiparticle
renormalization weights and total internal energy.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/wavefunctions/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../welcome/" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../user-guide/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user-guide/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../welcome/" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/wavefunctions/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../nlo/" title="Nlo" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Nlo
              </span>
            </div>
          </a>
        
        
          <a href="../eph/" title="Eph" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Eph
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.5.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 The Abinit Group (BAmadon)
          </div>
        

        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application-f3ab9e5ff8.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
    
  </body>
</html>