<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="The Abinit group">
        <link rel="canonical" href="http://www.abinit.org/tutorials/base1/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Base1 - abinit</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/extra.css" rel="stylesheet">
        <link href="../../css/codehilite.css" rel="stylesheet">
    
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
    <!-- <script src="../../js/somelib.js"></script> -->

    <!--
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="/resources/demos/style.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    -->

    <!--
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script> $( function() {$( "#abinit-tabs" ).tabs();} ); </script>
    -->

    <!--
    -->
        <!-- MathJax support -->
        <script type="text/javascript" async
          src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
        </script>

        <!--
        Configure MathJax to produce automatic equation numbers
        http://docs.mathjax.org/en/latest/tex.html
        -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
              TeX: {
                  equationNumbers: { autoNumber: "all" },
                  extensions: ["AMSmath.js"],
                  Macros: {
                      rr: "{\\bf r}",
                      GG: "{\\bf G}",
                      kk: "{\\bf k}",
                      qq: "{\\bf q}"
                  }
              }
          });
        </script>

        <!-- See http://docs.mathjax.org/en/latest/start.html 
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
            jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true
            },
            "HTML-CSS": { availableFonts: ["TeX"] }
          });
        </script>
        -->

 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">abinit</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Quick Start <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../..">Introduction</a>
</li>
                            
<li >
    <a href="../../installation/">Installation</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Topics</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../topics/crystal/">Crystalline Structure</a>
</li>
            
<li >
    <a href="../../topics/kpoints/">K-points</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../user-guide/help_what_ABINIT_does/">Overview</a>
</li>
                            
<li >
    <a href="../../user-guide/help_abinit/">Abinit</a>
</li>
                            
<li >
    <a href="../../user-guide/help_mrgddb/">Mrgddb</a>
</li>
                            
<li >
    <a href="../../user-guide/help_optic/">Optic</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Input Variables <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Abinit</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../input_variables/varlist_abinit/">All Variables</a>
</li>
            
<li >
    <a href="../../input_variables/varbas/">Basic</a>
</li>
            
<li >
    <a href="../../input_variables/varbse/">Bethe-Salpeter</a>
</li>
            
<li >
    <a href="../../input_variables/vardev/">Developers</a>
</li>
            
<li >
    <a href="../../input_variables/vardmft/">DMFT</a>
</li>
            
<li >
    <a href="../../input_variables/vareph/">Electron-Phonon</a>
</li>
            
<li >
    <a href="../../input_variables/varff/">Varff</a>
</li>
            
<li >
    <a href="../../input_variables/varfil/">File-handling</a>
</li>
            
<li >
    <a href="../../input_variables/vargeo/">Geometry</a>
</li>
            
<li >
    <a href="../../input_variables/vargs/">Ground-State</a>
</li>
            
<li >
    <a href="../../input_variables/vargw/">GW</a>
</li>
            
<li >
    <a href="../../input_variables/varint/">Internal</a>
</li>
            
<li >
    <a href="../../input_variables/varpar/">Parallelism</a>
</li>
            
<li >
    <a href="../../input_variables/varpaw/">PAW</a>
</li>
            
<li >
    <a href="../../input_variables/varrf/">RF</a>
</li>
            
<li >
    <a href="../../input_variables/varrlx/">Relaxation</a>
</li>
            
<li >
    <a href="../../input_variables/varvdw/">VdW</a>
</li>
            
<li >
    <a href="../../input_variables/varw90/">Wannier90</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../welcome/">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Base Tutorials</a>
    <ul class="dropdown-menu">
            
<li class="active">
    <a href="./">Base1</a>
</li>
            
<li >
    <a href="../base2/">Base2</a>
</li>
            
<li >
    <a href="../base3/">Base3</a>
</li>
            
<li >
    <a href="../base4/">Base4</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">DFPT</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../rf1/">RF1</a>
</li>
            
<li >
    <a href="../rf2/">RF2</a>
</li>
            
<li >
    <a href="../elastic/">Elastic</a>
</li>
            
<li >
    <a href="../eph/">EPH</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../dmft/">DMFT</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Many-Body</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../gw1/">GW1</a>
</li>
            
<li >
    <a href="../gw2/">GW2</a>
</li>
            
<li >
    <a href="../bse/">Bethe-Salpeter</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Parallelism</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../basepar/">Base</a>
</li>
            
<li >
    <a href="../paral_mbt/">Many-Body</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Theory <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../theory/theory_mbt/">MBPT</a>
</li>
                            
<li >
    <a href="../../theory/additional_material/">Additional Material</a>
</li>
                            
<li >
    <a href="../../bibliography/">Bibliography</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../about/release-notes/">Release Notes</a>
</li>
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>
                            
<li >
    <a href="../../about/license/">License</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../welcome/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../base2/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/abinit/abinit/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#11-the-first-step-the-most-important-and-the-most-difficult">1.1. The first step (the most important, and the most difficult !):</a></li>
        <li class="main "><a href="#12-computation-of-the-interatomic-distance-method-1">1.2. Computation of the interatomic distance (method 1).</a></li>
        <li class="main "><a href="#13-computation-of-the-interatomic-distance-method-2">1.3 Computation of the interatomic distance (method 2).</a></li>
        <li class="main "><a href="#14-computation-of-the-charge-density">1.4. Computation of the charge density.</a></li>
        <li class="main "><a href="#15-computation-of-the-atomisation-energy">1.5. Computation of the atomisation energy.</a></li>
        <li class="main "><a href="#answers-to-the-questions">Answers to the questions</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>This lesson aims at showing how to get the following physical properties:</p>
<ul>
<li>the (pseudo)total energy </li>
<li>the bond length </li>
<li>the charge density </li>
<li>the atomisation energy </li>
</ul>
<p>You will learn about the two input files, the basic input variables, the
existence of defaults, the actions of the parser, and the use of the multi-dataset feature. 
You will also learn about the two output files as well as the density file.</p>
<p>This first lesson covers the sections 1, 3, 4 and 6 of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>.</p>
<p>The very first step is a detailed tour of the input and output files: you are
like a tourist, and you discover a town in a coach. You will have a bit more
freedom after that first step &hellip;<br />
It is supposed that you have some good knowledge of UNIX/Linux.</p>
<p>This lesson should take about 2 hours.</p>
<div class="toc">
<ul>
<li><a href="#11-the-first-step-the-most-important-and-the-most-difficult">1.1. The first step (the most important, and the most difficult !):</a></li>
<li><a href="#12-computation-of-the-interatomic-distance-method-1">1.2. Computation of the interatomic distance (method 1).</a></li>
<li><a href="#13-computation-of-the-interatomic-distance-method-2">1.3 Computation of the interatomic distance (method 2).</a></li>
<li><a href="#14-computation-of-the-charge-density">1.4. Computation of the charge density.</a></li>
<li><a href="#15-computation-of-the-atomisation-energy">1.5. Computation of the atomisation energy.</a></li>
<li><a href="#answers-to-the-questions">Answers to the questions</a></li>
</ul>
</div>
<hr />
<h3 id="11-the-first-step-the-most-important-and-the-most-difficult">1.1. The first step (the most important, and the most difficult !):<a class="headerlink" href="#11-the-first-step-the-most-important-and-the-most-difficult" title="Permanent link">&para;</a></h3>
<p>Computing the (pseudo) total energy, and some associated quantities.</p>
<p>Note that the present tutorial will use four different windows: one to
visualize the text of the tutorial (the present window), a second to run the
code, a third to visualize sections of the <a class="wikilink" href="../../help_abinit/">help_abinit</a> (that will open
automatically), and a fourth one for the description of input variables (that
will also open automatically). Try to manage adequately these four windows &hellip;</p>
<p><strong>1.1.a</strong> In addition to the present window, open the second window. 
Go to the Tutorial directory (that we refer as ~abinit/tests/tutorial/Input). </p>
<div class="codehilite"><pre><span></span>    $ <span class="nb">cd</span> ~abinit/tests/tutorial/Input
</pre></div>


<p>In that directory, you will find the necessary input files to run the examples
related to this tutorial. Take a few seconds to read the names of the files
already present in <code>~abinit/tests/tutorial/Input</code>. 
Compare with the lessons mentioned in the index of the <a href="../lesson_welcome.html"><strong>Tutorial home page</strong></a>.
You will find other input files, specific for the Density Functional
Perturbation Theory (&ldquo;Response functions&rdquo;) capabilities of ABINIT in the
directory <code>~abinit/tests/tutorespfn/Input</code>.  </p>
<p><strong>1.1.b </strong>You also need a working directory. So, you should create a subdirectory of this directory, 
whose name might be &ldquo;Work&rdquo; (so ~abinit/tests/tutorial/Input/Work). Change the working directory of windows 2 to &ldquo;Work&rdquo;: </p>
<div class="codehilite"><pre><span></span>    $ mkdir Work
    $ <span class="nb">cd</span> Work
</pre></div>


<p>You will do most of the actions of this tutorial in this working directory.
Copy the file tbase1_x.files in &ldquo;Work&rdquo;:</p>
<div class="codehilite"><pre><span></span>    $ cp ../tbase1_x.files .
</pre></div>


<p><strong>1.1.c</strong> Edit the tbase1_x.files. It is not very long (only 6 lines). It gives the information needed for the code to build other file names &hellip; You will discover more about this file in the <a href="../../../users/generated_files/help_abinit.html#intro1">section 1.1</a> of the abinit_help file. Please, read it now (it will take one minute or so). </p>
<p><strong>1.1.d</strong> Modify the first and second lines of tbase1_x.files file, so that they read:  </p>
<div class="codehilite"><pre><span></span>tbase1_1.in  
tbase1_1.out
</pre></div>


<p>Later, you will again modify these lines, to treat more cases. Make sure that
the last line, gives the correct location of the pseudopotential. Close the
tbase1_x.files file. Then, copy the file [[tests/tutorial/Input/tbase1_1.in]]
in &ldquo;Work&rdquo;:  </p>
<div class="codehilite"><pre><span></span>    $ cp ../tbase1_1.in .
</pre></div>


<p>Also later, we will look at this file, and learn about its content. For now,
you will try to run the code. Its name is <code>abinit</code>. The place where it can be
found varies, according to the installation procedure. We will denote the
directory where you have installed the package <code>~abinit</code>. Supposing that you
dumped the binaries from the Web site, then <code>abinit</code> is to be found in the
package, with location <code>~abinit/opt</code>. If you dumped the sources from the Web
site, and issued <code>./configure</code> in the ~abinit directory, then it is located in
<code>~abinit/src/98_main</code>. In what follows, we will suppose that you can call it by
simply typing <code>abinit</code>, even if the actual command must be something like
<code>../../../../opt/abinit</code> or <code>../../../../src/98_main/abinit</code>. (Suggestion: create
an alias with <code>ln -s</code>, or copy the abinit executable, or declare the path with
the shell command <code>export PATH=~abinit/src/98_main:$PATH</code>).</p>
<p>So, in the Work directory, type:  </p>
<div class="codehilite"><pre><span></span>    $ abinit &lt; tbase1_x.files &gt;<span class="p">&amp;</span> log
</pre></div>


<p>Wait a few seconds &hellip; it&rsquo;s done ! You can look at the content of the Work directory.</p>
<div class="codehilite"><pre><span></span>    $ ls
</pre></div>


<p>You should get something like</p>
<div class="codehilite"><pre><span></span>    abinit  log  tbase1_1.in  tbase1_1.out  tbase1_x.files  tbase1_xo_DDB  tbase1_xo_DEN  
    tbase1_xo_EIG.nc  tbase1_xo_GSR.nc  tbase1_xo_OUT.nc  tbase1_xo_WFK
</pre></div>


<p>(if you declared the path, you will not find <code>abinit</code> in the list) Different
output files have been created, including a <code>log</code> file and the output file
<code>tbase1_1.out</code>. To check that everything is correct, you can make a diff of
<code>tbase1_1.out</code> with a reference file [[tests/tutorial/Refs/tbase1_1.out]]
contained in the <code>~abinit/tests/tutorial/Refs</code> directory:</p>
<div class="codehilite"><pre><span></span>    $ diff tbase1_1.out ../../Refs/tbase1_1.out <span class="p">|</span> less
</pre></div>


<p>(Perhaps you will need to ignore the blanks, with the command <code>diff -b</code>
instead of <code>diff</code>)</p>
<p>That reference file uses slightly different file names. You should get some
difference, but rather inoffensive ones, like differences in the name of input
files or timing differences, e.g.:</p>
<div class="codehilite"><pre><span></span>    2,3c2,3
    &lt; .Version 8.0.8 of ABINIT
    &lt; .(MPI version, prepared for a x86_64_linux_gnu5.4 computer)
    ---
    &gt; .Version 8.0.7  of ABINIT
    &gt; .(MPI version, prepared for a x86_64_linux_gnu5.3 computer)
    17c17
    &lt; .Starting date : Fri 27 May 2016.
    ---
    &gt; .Starting date : Thu 26 May 2016.
    27c27
    &lt; - input  file    -&gt; tbase1_1.in
    ---
    &gt; - input  file    -&gt; ../tbase1_1.in
    29,30c29,30
    &lt; - root for input  files -&gt; tbase1_xi
    &lt; - root for output files -&gt; tbase1_xo
    ---
    &gt; - root for input  files -&gt; tbase1_1i
    &gt; - root for output files -&gt; tbase1_1o
    92,93c92,93
    &lt; - pspini: atom type   1  psp file is ../../../Psps_for_tests/01h.pspgth
    &lt; - pspatm: opening atomic psp file    ../../../Psps_for_tests/01h.pspgth
    ---
    &gt; - pspini: atom type   1  psp file is /home/gonze/ABINIT/ABINITv8.0.7/trunk/8.0.7-private/tests/Psps_for_tests/01h.pspgth
    &gt; - pspatm: opening atomic psp file    /home/gonze/ABINIT/ABINITv8.0.7/trunk/8.0.7-private/tests/Psps_for_tests/01h.pspgth
    166c166
    &lt;  prteigrs : about to open file tbase1_xo_EIG
    ---
    &gt;  prteigrs : about to open file tbase1_1o_EIG
    214c214
    &lt; - Total cpu        time (s,m,h):          4.7        0.08      0.001
    ---
    &gt; - Total cpu        time (s,m,h):          4.6        0.08      0.001
    221,229c221,228
</pre></div>


<p>(&hellip; and what comes after that is related only to timing &hellip;).</p>
<p>If you do not run on a PC under Linux with GNU Fortran compiler, e.g. the
Intel compiler, you might also have small numerical differences, on the order
of 1.0d-10 at most. You might also have other differences in the paths of
files. Finally, it might also be that the default FFT algorithm differs from
the one of the reference machine, in which case the line mentioning fftalg
will differ (ifftalg will not be 312). If you get something else, you should
ask for help!</p>
<p>In this part of the output file, note the dash &ldquo;-&rdquo; that is inserted in the
first column. This is not important for the user: it is used to post-process
the output file using some automatic tool. As a rule, you should ignore
symbols placed in the first column of the ABINIT output file.</p>
<p>Supposing everything went well, we will now detail the different steps that
took place: how to run the code, what is in the &ldquo;tbase1_1.in&rdquo; input file, and,
later, what is in the &ldquo;tbase1_1.out&rdquo; and &ldquo;log&rdquo; output files.</p>
<p><strong>1.1.e</strong> Running the code is described in the <a href="../../../users/generated_files/help_abinit.html#exec">section 1.2</a> of the abinit_help file. Please, read it now (it will take 30 seconds or less).</p>
<p><strong>1.1.f</strong> It is now time to edit the tbase1_1.in file. You can have a first glance at it. It is not very long: about 50 lines, mostly comments. Do not try to understand everything immediately. After having gone through it, you should read general explanation about its content, and the format of such input files in the <a href="../../../users/generated_files/help_abinit.html#intro3">section 3.1</a> of the abinit_help file. </p>
<p><strong>1.1.g</strong> You might now examine in more details some input variables. An alphabetically ordered <a href="../../../input_variables/generated_files/allvariables.html">index of all variables</a> is provided, and their description is found in different files (non-exhaustive list): </p>
<ul>
<li>Basic variables, <a href="../../../input_variables/generated_files/varbas.html">VARBAS</a></li>
<li>Files handling variables, <a href="../../../input_variables/generated_files/varfil.html">VARFIL</a></li>
<li>Ground-state calculation variables, <a href="../../../input_variables/generated_files/vargs.html">VARGS</a></li>
<li>GW variables, <a href="../../../input_variables/generated_files/vargw.html">VARGW</a></li>
<li>Parallelisation variables, <a href="../../../input_variables/generated_files/varpar.html">VARPAR</a></li>
<li>Response Function variables, <a href="../../../input_variables/generated_files/varrf.html">VARRF</a></li>
</ul>
<p>However, the number of such variables is rather large! Note that a dozen of
input variables were needed to run the first test case. This is possible
because there are defaults values for the other input variables. When it
exists, the default value is mentioned at the fourth line of the section
related to each input variable, in the corresponding input variables file.
Some input variables are also preprocessed, in order to derive convenient
values for other input variables. Defaults are not existing or were avoided
for the few input variables that you find in tbase1_1.in . These are
particularly important input variables. So, take a few minutes to have a look
at the input variables of tbase1_1.in:</p>
<ul>
<li><a class="wikilink" href="../../input_variables/varbas/#acell">acell</a></li>
<li><a class="wikilink" href="../../input_variables/varbas/#ntypat">ntypat</a></li>
<li><a class="wikilink" href="../../input_variables/varbas/#znucl">znucl</a></li>
<li><a class="wikilink" href="../../input_variables/varbas/#natom">natom</a></li>
<li><a class="wikilink" href="../../input_variables/varbas/#typat">typat</a></li>
<li><a class="wikilink" href="../../input_variables/varbas/#xcart">xcart</a></li>
<li><a class="wikilink" href="../../input_variables/varbas/#ecut">ecut</a></li>
<li><a class="wikilink" href="../../input_variables/varbas/#nkpt">nkpt</a></li>
<li><a class="wikilink" href="../../input_variables/varbas/#nstep">nstep</a></li>
<li><a class="wikilink" href="../../input_variables/varbas/#toldfe">toldfe</a></li>
<li><a class="wikilink" href="../../input_variables/vargs/#diemac">diemac</a></li>
</ul>
<p>Have also a look at <a class="wikilink" href="../../input_variables/varbas/#kpt">kpt</a> and <a class="wikilink" href="../../input_variables/varbas/#iscf">iscf</a>.</p>
<p>It is now time to have a look at the two output files of the run.</p>
<p><strong>1.1.h</strong> First, open the &ldquo;log&rdquo; file. You can begin to read it. It is nasty. Jump to its end. You will find there the number of WARNINGS and COMMENTS that were issued by the code during execution. You might try to find them in the file (localize the keywords &ldquo;WARNING&rdquo; or &ldquo;COMMENT&rdquo; in this file). Some of them are for the experienced user. For the present time, we will ignore them. You can find more information about messages in the log file in the <a href="../../../users/generated_files/help_abinit.html#logfile">section 6.1</a> of the abinit_help file.</p>
<p><strong>1.1.i</strong> Then, open the [[tests/tutorial/Refs/tbase1_1.out]] file. You find some general information about the output file in <a href="../../../users/generated_files/help_abinit.html#outputfile"> section 6.2</a> of the abinit_help file. You should also: </p>
<ul>
<li>examine the header of &ldquo;tbase1_1.out&rdquo; </li>
<li>examine the report on memory needs (do not read each value of parameters) </li>
<li>examine the echo of preprocessed input data, </li>
</ul>
<p>until you reach the message:  </p>
<div class="codehilite"><pre><span></span><span class="n">chkinp</span><span class="o">:</span> <span class="n">Checking</span> <span class="n">input</span> <span class="n">parameters</span> <span class="k">for</span> <span class="n">consistency</span><span class="o">.</span>
</pre></div>


<p>If the code does not stop there, the input parameters are consistent. At this
stage, many default values have been provided, and the preprocessing is
finished.</p>
<p>It is worth to come back to the echo of preprocessed input data. You should
first examine the &ldquo;tbase1_1.in&rdquo; file in more details, and read the meaning of
each of its variables in the corresponding input variables file, if it has not
yet been done. Then, you should examine some variables that were NOT defined
in the input file, but that appear in the echo written in &ldquo;tbase1_1.out&rdquo;:  </p>
<p>- <a class="wikilink" href="../../input_variables/varbas/#nband">nband</a>: its value is 2.<br />
It is the number of electronic states that will be treated by the code. It has
been computed by counting the number of valence electrons in the unit cell
(summing the valence electrons brought by each pseudopotential) then occupying
the lowest states (look at the <a class="wikilink" href="../../input_variables/vargs/#occ">occ</a> variable), and adding some states (at
least one, maybe more, depending on the size of the system).  </p>
<p>- <a class="wikilink" href="../../input_variables/vargs/#ngfft">ngfft</a>: its value is 30 30 30 .<br />
It is the number of points of the three-dimensional FFT grid. It has been
derived from <a class="wikilink" href="../../input_variables/varbas/#ecut">ecut</a> and the dimension of the cell (<a class="wikilink" href="../../input_variables/varbas/#acell">acell</a>).  </p>
<p>The maximal number of plane waves &ldquo;<strong>mpw</strong>&rdquo; is mentioned in the memory
evaluation section: it is <strong>752</strong>.<br />
Well, this is not completely right, as the code took advantage of the time-
reversal symmetry, valid for the k-point (0 0 0), to decrease the number of
planewave by about a factor of two.<br />
The full set of plane waves is <strong>1503</strong> (see later in the &ldquo;tbase1_1.out&rdquo;
file).<br />
The code indicates the time-reversal symmetry by a value of <a class="wikilink" href="../../input_variables/vardev/#istwfk">istwfk</a>=2 ,
instead of the usual <a class="wikilink" href="../../input_variables/vardev/#istwfk">istwfk</a>=1 default.  </p>
<p>- <a class="wikilink" href="../../input_variables/varbas/#nsym">nsym</a>: its value is 16.<br />
It is the number of symmetries of the system. The 3x3 matrices <a class="wikilink" href="../../input_variables/varbas/#symrel">symrel</a>
define the symmetries operation. In this case, none of the symmetries is
accompanied by a translation, that would appear in the variable <a class="wikilink" href="../../input_variables/varbas/#tnons">tnons</a>. The
code did an automatic analysis of symmetries.<br />
They could alternatively be set by hand, or using the symmetry builder (to be
described later).  </p>
<p>- <a class="wikilink" href="../../input_variables/varbas/#xangst">xangst</a> and <a class="wikilink" href="../../input_variables/varbas/#xred">xred</a> are alternative ways to <a class="wikilink" href="../../input_variables/varbas/#xcart">xcart</a> to specify the
positions of atoms within the primitive cell.</p>
<p>Now, you can start reading the description of the remaining of the
tbase1_1.out file, in the <a href="../../../users/generated_files/help_abinit.html#6.3"> section 6.3
</a> of the abinit_help file.
Look at the tbase1_1.out file at the same time.</p>
<p><strong> 1.1.j  </strong> You have read completely an output file! </p>
<p>Could you answer the following questions?</p>
<ul>
<li>Q1. How many SCF cycles were needed to have the <a class="wikilink" href="../../input_variables/varbas/#toldfe">toldfe</a> criterion satisfied? </li>
<li>Q2. Is the energy likely more converged than <a class="wikilink" href="../../input_variables/varbas/#toldfe">toldfe</a>? </li>
<li>Q3. What is the value of the force on each atom, in Ha/Bohr? </li>
<li>Q4. What is the difference of eigenenergies between the two electronic states? </li>
<li>Q5. Can you insert &lsquo;<a class="wikilink" href="../../input_variables/varfil/#prtvol">prtvol</a> 2&rsquo; in the input file, run again abinit, and find where is located the maximum of the electronic density, and how much is it, in electrons/Bohr^3 ? </li>
</ul>
<p>(answers are given at the end of the present file)</p>
<hr />
<h3 id="12-computation-of-the-interatomic-distance-method-1"><strong>1.2. Computation of the interatomic distance (method 1). </strong><a class="headerlink" href="#12-computation-of-the-interatomic-distance-method-1" title="Permanent link">&para;</a></h3>
<p><strong>1.2.a</strong> <em>Starting from now, everytime a new input variable is mentioned, you should read the corresponding descriptive section in the ABINIT help.</em></p>
<p>We will now complete the description of the meaning of each term: there are
still a few indications that you should be aware of, even if you will not use
them in the tutorial. These might appear in the description of some input
variables &hellip; For this, you should read the <a href="../../../users/generated_files/help_abinit.html#parameters"> section
3.2</a> of the
abinit_help file.</p>
<p><strong>1.2.b</strong> There are three methodologies to compute the optimal distance between the two Hydrogen atoms: </p>
<ul>
<li>one could compute the <strong>TOTAL ENERGY</strong> for different values of the interatomic distance, make a fit through the different points, and determine the minimum of the fitting function; </li>
<li>one could compute the <strong>FORCES</strong> for different values of the interatomic distance, make a fit through the different values, and determine the zero of the fitting function; </li>
<li>one could use an automatic algorithm for minimizing the energy (or finding the zero of forces). 
We will begin with the computation of energy and forces for different values
of the interatomic distance. This exercise will allow you to learn how to use
multiple datasets.</li>
</ul>
<p>The interatomic distance in the tbase1_1.in file was 1.4 Bohr. Suppose you
decide to examine the interatomic distances from 1.0 Bohr to 2.0 Bohr, by
steps of 0.05 Bohr. That is, 21 calculations.<br />
If you are a UNIX guru, it will be easy for you to write a script that will
drive these 21 calculations, changing automatically the variable <a class="wikilink" href="../../input_variables/varbas/#xcart">xcart</a> in
the input file, and then gather all the data, in a convenient form to be
plotted.<br />
Well, are you a UNIX guru? If not, there is an easier path, all within ABINIT!</p>
<p>This is the multi-dataset mode. Detailed explanations about it can be found in
sections <a href="../../../users/generated_files/help_abinit.html#multidataset">3.3</a>,
<a href="../../../users/generated_files/help_abinit.html#series">3.4</a>,
<a href="../../../users/generated_files/help_abinit.html#loop">3.5</a> and
<a href="../../../users/generated_files/help_abinit.html#3.6">3.6</a>, of the abinit_help
file.</p>
<p><strong>1.2.c</strong> Now, can you write an input file that will do the computation described above (interatomic distances from 1.0 Bohr to 2.0 Bohr, by steps of 0.05 Bohr)? You might start from tbase1_1.in. Try to define a series, and to use the <a class="wikilink" href="../../input_variables/varfil/#getwfk">getwfk</a> input variable (the latter will make the computation much faster). </p>
<p>You should likely have a look at the section that describes the <a class="wikilink" href="../../input_variables/varfil/#irdwfk">irdwfk</a> and
<a class="wikilink" href="../../input_variables/varfil/#getwfk">getwfk</a> input variables: in particular, look at the meaning of <em><strong>getwfk
-1</strong></em></p>
<p>Also, define explicitly the number of states (or supercell &ldquo;bands&rdquo;) to be one,
using the input variable <a class="wikilink" href="../../input_variables/varbas/#nband">nband</a>. The input file
[[tests/tutorial/Input/tbase1_2.in]] is an example of file that will do the
job, while [[tests/tutorial/Refs/tbase1_2.out]] is an example of output file.
If you decide to use the ~abinit/tests/tutorial/Input/tbase1_2.in file, do not
forget to change the file names in the &ldquo;tbase1_x.files&rdquo; file &hellip;</p>
<p>So, you run the code with your input file (this might take fifteen seconds or
so on a PC at 3 GHz), examine the output file quickly (there are many
repetition of sections, for the different datasets), and get the output
energies gathered in the final echo of variables:</p>
<div class="codehilite"><pre><span></span>        etotal1  -1.0368223891E+00
        etotal2  -1.0538645433E+00
        etotal3  -1.0674504851E+00
        etotal4  -1.0781904896E+00
        etotal5  -1.0865814785E+00
        etotal6  -1.0930286804E+00
        etotal7  -1.0978628207E+00
        etotal8  -1.1013539124E+00
        etotal9  -1.1037224213E+00
        etotal10 -1.1051483730E+00
        etotal11 -1.1057788247E+00
        etotal12 -1.1057340254E+00
        etotal13 -1.1051125108E+00
        etotal14 -1.1039953253E+00
        etotal15 -1.1024495225E+00
        etotal16 -1.1005310615E+00
        etotal17 -1.0982871941E+00
        etotal18 -1.0957584182E+00
        etotal19 -1.0929800578E+00
        etotal20 -1.0899835224E+00
        etotal21 -1.0867972868E+00
</pre></div>


<p>You might try to plot these data. </p>
<p><img alt="" src="../base1_assets/Plot1.jpg" /> </p>
<p>The minimum of energy in the above list is clearly between dataset 11 and 12, that is:</p>
<div class="codehilite"><pre><span></span>         xcart11 -7.5000000000E-01  0.0000000000E+00  0.0000000000E+00
                  7.5000000000E-01  0.0000000000E+00  0.0000000000E+00
         xcart12 -7.7500000000E-01  0.0000000000E+00  0.0000000000E+00
                  7.7500000000E-01  0.0000000000E+00  0.0000000000E+00
</pre></div>


<p>corresponding to a distance of H atoms between 1.5 Bohr and 1.55 Bohr. The
forces vanish also between 1.5 Bohr and 1.55 Bohr:</p>
<div class="codehilite"><pre><span></span>     fcart11 -5.4945071285E-03  0.0000000000E+00  0.0000000000E+00
              5.4945071285E-03  0.0000000000E+00  0.0000000000E+00
     fcart12  6.9603067838E-03  0.0000000000E+00  0.0000000000E+00
             -6.9603067838E-03  0.0000000000E+00  0.0000000000E+00
</pre></div>


<p>From these two values, using a linear interpolation, one get the optimal value
of 1.522 Bohr .<br />
Note that <em>the number of SCF cycles drops from 6 to 5 when the wavefunctions
are read from the previous dataset.</em></p>
<hr />
<h3 id="13-computation-of-the-interatomic-distance-method-2"><strong>1.3 Computation of the interatomic distance (method 2). </strong><a class="headerlink" href="#13-computation-of-the-interatomic-distance-method-2" title="Permanent link">&para;</a></h3>
<p><strong>1.3.a</strong> The other methodology is based on an automatic computation of the minimum. <br />
There are different algorithms to do that. See the input variable <a class="wikilink" href="../../input_variables/varrlx/#ionmov">ionmov</a>,
with values 2 and 7. In the present case, with only one degree of freedom to
be optimized, the best choice is <a class="wikilink" href="../../input_variables/varrlx/#ionmov">ionmov</a> 2 .</p>
<p>You have also to define the maximal number of timesteps for this optimization.
Set the input variable <a class="wikilink" href="../../input_variables/varrlx/#ntime">ntime</a> to 10, it will be largely enough. For the
stopping criterion <a class="wikilink" href="../../input_variables/varrlx/#tolmxf">tolmxf</a>, use the reasonable value of 5.0d-4 Ha/Bohr.
This defines the force threshold to consider that the geometry is converged.
The code will stop if the residual forces are below that value before reaching
<a class="wikilink" href="../../input_variables/varrlx/#ntime">ntime</a>.</p>
<p>It is also worth to change the stopping criterion for the SCF cycle, in order
to be sure that the forces generated for each trial interatomic distance are
sufficiently converged. Indeed, the value used for <a class="wikilink" href="../../input_variables/varbas/#toldfe">toldfe</a>, namely 1.0d-6,
might be sufficient for total energy calculations, but definitely not for the
accurate computation of other properties. So, change <a class="wikilink" href="../../input_variables/varbas/#toldfe">toldfe</a> in <a class="wikilink" href="../../input_variables/varbas/#toldff">toldff</a>,
and set the latter input variable to ten times smaller than <a class="wikilink" href="../../input_variables/varrlx/#tolmxf">tolmxf</a>. The
input file [[tests/tutorial/Input/tbase1_3.in]] is an example of file that
will do the job, while [[tests/tutorial/Refs/tbase1_3.out]] is an example of
output file. If you decide to use these files, do not forget to change the
file names in the &ldquo;tbase1_x.files&rdquo; file &hellip; So, you run the code with your
input file (a few seconds), examine quietly this file (which is much smaller
than the tbase1_2.out file), and get some significant output data gathered in
the final echo of variables:</p>
<div class="codehilite"><pre><span></span>    etotal   -1.1058360644E+00
     fcart    1.8270533893E-04  0.0000000000E+00  0.0000000000E+00
             -1.8270533893E-04  0.0000000000E+00  0.0000000000E+00
      ...
     xcart   -7.6091015760E-01  0.0000000000E+00  0.0000000000E+00
              7.6091015760E-01  0.0000000000E+00  0.0000000000E+00
</pre></div>


<p>According to these data (see <a class="wikilink" href="../../input_variables/varbas/#xcart">xcart</a>), the optimal interatomic distance is
about 1.522 Bohr, in good agreement with the estimation of tbase1_2.out . If
you have time (this is to be done at home), you might try to change the
stopping criteria, and redo the calculation, to see the level of convergence
of the interatomic distance.</p>
<p>Note that the final value of fcart in your run might differ slightly from the
one shown above (less than one percent change). Such a fluctuation is quite
often observed for a value converging to zero (remember, we ask the code to
determine the equilibrium geometry, that is, forces should be zero) when the
same computation is done on different platforms.</p>
<hr />
<h3 id="14-computation-of-the-charge-density"><strong>1.4. Computation of the charge density.</strong><a class="headerlink" href="#14-computation-of-the-charge-density" title="Permanent link">&para;</a></h3>
<p>The charge density has already been computed, for all geometries, in the
above-mentioned runs. Here, we will print this quantity.</p>
<p><strong>1.4.a</strong> We start from the optimized interatomic distance 1.522 Bohr, and make a run at fixed geometry. The input variable <a class="wikilink" href="../../input_variables/varfil/#prtden">prtden</a> must be set to 1. To understand correctly the content of the <a class="wikilink" href="../../input_variables/varfil/#prtden">prtden</a> description, it is worth to read a much more detailed description of the &ldquo;files&rdquo; file, in <a href="../../../users/generated_files/help_abinit.html#4">section 4 </a> of the abinit_help file. </p>
<p><strong>1.4.b</strong> The input file [[tests/tutorial/Input/tbase1_4.in]] is an example of input file for a run that will print a density. If you decide to use this file, do not forget to change the file names in tbase1_x.files. The run will take a few seconds. </p>
<p>The density will be output in the <strong>tbase1_xo_DEN</strong> file. Try to edit it &hellip;
No luck ! This file is unformatted, not written using the ASCII code. Even if
you cannot read it, its description is provided in the abinit_help. It
contains first a header, then the density numbers. The description of the
header is presented in <a href="../../../users/generated_files/help_abinit.html#header">section
6.4</a> of the abinit_help
file, while the body of the _DEN file is presented in <a href="../../../users/generated_files/help_abinit.html#densoutputfile">section
6.5</a>. It is the
appropriate time to read also the description of the potential files and
wavefunctions files, as these files contain the same header as the density
file, see sections
<a href="../../../users/generated_files/help_abinit.html#localpotfile">6.6</a> and
<a href="../../../users/generated_files/help_abinit.html#wavefctfile">6.7</a></p>
<p><strong>1.4.c</strong> Such a density file can be read by ABINIT, to restart a calculation (see the input variable <a class="wikilink" href="../../input_variables/varbas/#iscf">iscf</a>, when its value is -2), but more usually, by an utility called &ldquo;cut3d&rdquo;. This utility is available in the ABINIT package. You might try to use it now, to generate two-dimensional cuts in the density, and visualize the charge density contours. <br />
Read the corresponding <a href="../../../users/generated_files/help_cut3d.html">Cut3D help
file</a>. Then, try to run cut3d to
analyse <strong>tbase1_xo_DEN</strong>. You should first try to translate the unformatted
density data to indexed formatted data, by using option 6 in the adequate
menu. Save the indexed formatted data to file <strong>tbase1_xo_DEN_indexed</strong>. Then,
edit this file, to have an idea of the content of the _DEN files.<br />
For further treatment, you might choose to select another option than 6. In
particular, if you have access to MATLAB, choose option 5. With minor
modifications (set ngx=ngy=ngz to 30) you will be able to use the file dim.m
present in ~abinit/doc/tutorial/documents/lesson_base1 to visualize the
3-Dimensional isosurfaces. Another option might be to use the XCrysDen
software, for which you need to use option 9.</p>
<hr />
<h3 id="15-computation-of-the-atomisation-energy"><strong>1.5. Computation of the atomisation energy.</strong><a class="headerlink" href="#15-computation-of-the-atomisation-energy" title="Permanent link">&para;</a></h3>
<p><strong>1.5.a</strong> The atomisation energy is the energy needed to separate a molecule in its constituent atoms, each being neutral. <br />
In the present case, one must compute first the total energy of an isolated
hydrogen atom. The atomisation energy will be the difference between the total
energy of H2 and twice the total energy of H.<br />
There are some subtleties in the calculation of an isolated atom.</p>
<ul>
<li>in many cases, the ground state of an isolated atom is spin-polarized, see the variables <a class="wikilink" href="../../input_variables/varbas/#nsppol">nsppol</a> and <a class="wikilink" href="../../input_variables/vargs/#spinat">spinat</a> ; </li>
<li>the highest occupied level might be degenerate with the lowest unoccupied level of the same spin, in which case the techniques usually appropriate for metals are to be used (see <a href="../lesson_base4.html">lesson_base4</a>) </li>
<li>also often, the symmetry of the ground-state charge density will NOT be spherical, so that the automatic determination of symmetries by the code, based on the atomic coordinates, should be disabled, see the input variable <a class="wikilink" href="../../input_variables/varbas/#nsym">nsym</a>, to be set to 1 in this case. </li>
</ul>
<p>For Hydrogen, we are lucky that the ground state is spherical (1s orbital),
and that the highest occupied level and lowest unoccupied level, although
degenerate, have a different spin. We will define by hand the occupation of
each spin, see the input variables <a class="wikilink" href="../../input_variables/varbas/#occopt">occopt</a> (to be set to 2), and <a class="wikilink" href="../../input_variables/vargs/#occ">occ</a> .<br />
Finally, in order to make numerical errors cancel, it is important to compute
the above-mentioned difference in the same box, for the same cut-off, and even
for a location in the box that is similar to the molecule case (although the
latter might not be so important).</p>
<p>The input file [[tests/tutorial/Input/tbase1_5.in]] is an example of file that
will do the job, while [[tests/tutorial/Refs/tbase1_5.out]] is an example of
output file. If you decide to use the tbase1_5.in file, do not forget to
change the file names in the tbase1_x.files file. The run lasts a few seconds.</p>
<p>You should read the output file, and note the tiny differences related with
the spin-polarisation:</p>
<ul>
<li>the electronic eigenvalues are now given for both spin up and spin down cases: </li>
</ul>
<div class="codehilite"><pre><span></span>         Eigenvalues (hartree) for nkpt=   1  k points, SPIN UP:
     kpt#   1, nband=  1, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced coord)
      -0.26414
     Eigenvalues (hartree) for nkpt=   1  k points, SPIN DOWN:
     kpt#   1, nband=  1, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced coord)
      -0.11112
</pre></div>


<ul>
<li>If you run again, while having inserted in the input file &lsquo;<a class="wikilink" href="../../input_variables/varfil/#prtvol">prtvol</a> 2&rsquo;, because <a class="wikilink" href="../../input_variables/varbas/#occopt">occopt</a>, the charge density and spin polarisation at each point of the FFT grid is also analyzed: </li>
</ul>
<div class="codehilite"><pre><span></span>         Total charge density [el/Bohr^3]
          Maximum=    1.4053E-01  at reduced coord.    0.0000    0.0000    0.0000
     Next maximum=    1.2019E-01  at reduced coord.    0.0000    0.0000    0.9667
          Minimum=    3.4544E-06  at reduced coord.    0.4667    0.4333    0.4333
     Next minimum=    3.4544E-06  at reduced coord.    0.5333    0.4333    0.4333
     Spin up density      [el/Bohr^3]
          Maximum=    1.4053E-01  at reduced coord.    0.0000    0.0000    0.0000
     Next maximum=    1.2019E-01  at reduced coord.    0.0000    0.0000    0.9667
          Minimum=    3.4544E-06  at reduced coord.    0.4667    0.4333    0.4333
     Next minimum=    3.4544E-06  at reduced coord.    0.5333    0.4333    0.4333
     Spin down density    [el/Bohr^3]
          Maximum=    0.0000E+00  at reduced coord.    0.9667    0.9667    0.9667
     Next maximum=    0.0000E+00  at reduced coord.    0.9333    0.9667    0.9667
          Minimum=    0.0000E+00  at reduced coord.    0.0000    0.0000    0.0000
     Next minimum=    0.0000E+00  at reduced coord.    0.0333    0.0000    0.0000
     Magnetization (spin up - spin down) [el/Bohr^3]
          Maximum=    1.4053E-01  at reduced coord.    0.0000    0.0000    0.0000
     Next maximum=    1.2019E-01  at reduced coord.    0.0000    0.0000    0.9667
          Minimum=    3.4544E-06  at reduced coord.    0.4667    0.4333    0.4333
     Next minimum=    3.4544E-06  at reduced coord.    0.5333    0.4333    0.4333
     Relative magnetization (=zeta, between -1 and 1)
          Maximum=    1.0000E+00  at reduced coord.    0.9667    0.9667    0.9667
     Next maximum=    1.0000E+00  at reduced coord.    0.9333    0.9667    0.9667
          Minimum=    1.0000E+00  at reduced coord.    0.0000    0.0000    0.0000
     Next minimum=    1.0000E+00  at reduced coord.    0.0333    0.0000    0.0000
</pre></div>


<p>The <strong>zeta</strong> variable is the ratio between the spin-density difference and the
charge density. It varies between +1 and -1. In the present case of Hydrogen,
there is no spin down density, so the zeta variable is +1.<br />
(Comment: in this part of the output file, note the comma &ldquo;,&rdquo; that is inserted
in the first column. This is not important for the user: it is used to post-
process the output file using some automatic tool. As a rule, you should
ignore symbols placed in the first column of the ABINIT output file.)</p>
<p>The total energy is</p>
<div class="codehilite"><pre><span></span>    etotal   -4.7010531489E-01
</pre></div>


<p>while the total energy of the H2 molecule is (see test 13):</p>
<div class="codehilite"><pre><span></span>    etotal   -1.1058360644E+00
</pre></div>


<p>The atomisation energy is thus 0.1656 Ha (The difference between the total
energy of the H2 molecule and twice the energy of an isolated Hydrogen atom).</p>
<p>At this stage, we can compare our results:</p>
<ul>
<li>bond length: 1.522 Bohr </li>
<li>atomisation energy at that bond length: 0.1656 Ha = 4.506 eV </li>
</ul>
<p>with the experimental data as well as theoretical data using a much more
accurate technique (see Kolos and Roothaan, Rev. Mod. Phys. 32, 219 (1960),
especially p.225)</p>
<ul>
<li>bond length: 1.401 Bohr </li>
<li>atomisation energy: 4.747 eV </li>
</ul>
<p>The bond length is awful (nearly 10% off), and the atomisation energy is a bit too low, 5 % off.</p>
<p>What is wrong??<br />
Well, are you sure that the input parameters that we did not discuss are correct? 
These are:</p>
<ul>
<li><a class="wikilink" href="../../input_variables/varbas/#ecut">ecut</a> (the plane-wave kinetic energy cut-off) </li>
<li><a class="wikilink" href="../../input_variables/varbas/#acell">acell</a> (the supercell size) </li>
<li><a class="wikilink" href="../../input_variables/varbas/#ixc">ixc</a> (not even mentioned until now, this input variable specifies what kind of 
    exchange-correlation functional is to be used &hellip;) </li>
<li>the pseudopotential </li>
</ul>
<p>We used 10 Ha as cut-off energy, a 10x10x10 Bohr^3 supercell, the local-
density approximation (as well as the local-spin-density approximation) in the
Teter parametrization, and a pseudopotential from the Goedecker-Hutter-Teter
table (Phys. Rev. B 54, 1703 (1996)).</p>
<p>We will see in the <a href="../lesson_base2.html">next lesson</a> how to address the choice
of these parameters (except the pseudopotential).</p>
<hr />
<h3 id="answers-to-the-questions">Answers to the questions<a class="headerlink" href="#answers-to-the-questions" title="Permanent link">&para;</a></h3>
<ul>
<li>Q1. How many SCF cycles were needed to have the <a class="wikilink" href="../../input_variables/varbas/#toldfe">toldfe</a> criterion satisfied? </li>
<li>Q2. Is the energy likely more converged than <a class="wikilink" href="../../input_variables/varbas/#toldfe">toldfe</a>? </li>
<li>Q3. What is the value of the force on each atom, in Ha/Bohr? </li>
<li>Q4. What is the difference of eigenenergies between the two electronic states? </li>
<li>Q5. Where is located the maximum of the electronic density, and how much is it, in electrons/Bohr^3 ? </li>
</ul>
<p>NOTE: <em>there might be numerical differences, from platform to platform, in the
quoted results !</em></p>
<p><strong>Q1.</strong> 6 SCF cycles were needed: </p>
<div class="codehilite"><pre><span></span>         iter   Etot(hartree)      deltaE(h)  residm     vres2
     ETOT  1  -1.1013391225242    -1.101E+00 4.220E-04 8.396E+00
     ETOT  2  -1.1036939626391    -2.355E-03 7.374E-09 2.840E-01
     ETOT  3  -1.1037170965209    -2.313E-05 7.389E-08 1.549E-02
     ETOT  4  -1.1037223548790    -5.258E-06 4.146E-07 2.715E-04
     ETOT  5  -1.1037224212232    -6.634E-08 4.091E-09 5.700E-06
     ETOT  6  -1.1037224213136    -9.037E-11 5.808E-12 3.076E-07

     At SCF step    6, etot is converged :
      for the second time, diff in etot=  9.038E-11 &lt; toldfe=  1.000E-06
</pre></div>


<p>Note that the number of steps that were allowed, <a class="wikilink" href="../../input_variables/varbas/#nstep">nstep</a>=10, is larger than
the number of steps effectively needed to reach the stopping criterion. As a
rule, you should always check that the number of steps that you allowed was
sufficient to reach the target tolerance. You might now play a bit with nstep,
as e.g. set it to 5, to see how ABINIT reacts.</p>
<p>Side note: in most of the tutorial examples, <a class="wikilink" href="../../input_variables/varbas/#nstep">nstep</a> will be enough to reach
the target tolerance, defined by one of the &ldquo;tolXXX&rdquo; input variables. However,
this is not always the case (e.g. the test case 1 of the <a href="../lesson_rf1.html">lesson response-
function 1</a>), because of some portability problems, that
could only be solved by stopping the SCF cycles before the required tolerance.</p>
<p><strong>Q2.</strong> The information is contained in the same piece of the output file. Yes, the energy is more converged than <a class="wikilink" href="../../input_variables/varbas/#toldfe">toldfe</a>, since the stopping criterion asked for the difference between successive evaluations of the energy to be smaller than <a class="wikilink" href="../../input_variables/varbas/#toldfe">toldfe</a> twice in a row, while the evolution of the energy is nice, and always decreasing by smaller and smaller amounts. </p>
<p><strong>Q3.</strong> These values are: </p>
<div class="codehilite"><pre><span></span>     cartesian forces (hartree/bohr) at end:
        1     -0.03740558871217     0.00000000000000     0.00000000000000
        2      0.03740558871217     0.00000000000000     0.00000000000000
     frms,max,avg= 2.1596127E-02 3.7405589E-02   0.000E+00  0.000E+00  0.000E+00 h/b
</pre></div>


<p>On the first atom (located at -0.7 0 0 in cartesian coordinates, in Bohr), the
force vector is pointing in the minus x direction, and in the plus x direction
for the second atom located at +0.7 0 0 .<br />
The H2 molecule would like to expand &hellip;</p>
<p><strong>Q4.</strong> The eigenvalues (in Hartree) are mentioned at the lines </p>
<div class="codehilite"><pre><span></span>     Eigenvalues (hartree) for nkpt=   1  k points:
     kpt#   1, nband=  2, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced coord)
      -0.36525  -0.01379
</pre></div>


<p>As mentioned in the
<a href="../../../users/generated_files/help_abinit.html#averagepot">abinit_help</a> file,
the absolute value of eigenenergies is not meaningful. Only differences of
eigenenergies, as well as differences with the potential.<br />
The difference is 0.35147 Hartree, that is 9.564 eV .<br />
Moreover, remember that Kohn-Sham eigenenergies are formally NOT connected to
experimental excitation energies !<br />
(Well, more is to be said later about this &hellip;).</p>
<p><strong>Q5.</strong> The maximum electronic density in electron per Bohr cube is reached at the mid-point between the two H atoms : </p>
<div class="codehilite"><pre><span></span>     Total charge density [el/Bohr^3]
    ,     Maximum=    2.6907E-01  at reduced coord.    0.0000    0.0000    0.0000
</pre></div></div>
        </div>

        <footer class="col-md-12">
<hr>

    <center>Abinit version 8.5.4</center>


<center>Copyright &copy; 2017 The Abinit Group (XG, RC)</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>
        <script>var base_url = '../..';</script>
        <!--
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        -->
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
        <script src="../../extra_javascript/abidocs.js"></script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <!--<div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    -->

    </body>
</html>
