
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="http://www.abinit.org/tutorials/ucalc_crpa/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="shortcut icon" href="../../images/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.8.1">
    
    
      
        <title>Ucalc crpa - abinit</title>
      
    
    
    
      <script src="../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- MathJax support -->
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}",
                  kq: "{\\kk + \\qq}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    


    
      <link rel="stylesheet" href="../../assets/stylesheets/application-bfecc7305d.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-02c2a4388f.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="http://www.abinit.org" title="abinit" class="md-logo md-header-nav__button">
            <img src="../../images/abinit_logo.png" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
                <span class="md-header-nav__parent">
                  DFT_PLUS_U
                </span>
              
            
            Ucalc crpa
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../input_variables/" title="Input Variables" class="md-tabs__link">
          Input Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../welcome/" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/mbt/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../images/abinit_logo.png">
      </i>
    
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/help_what_ABINIT_does/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/new_user/" title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Input Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Input Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../input_variables/connections/" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../welcome/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4" checked>
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Ucalc crpa
      </label>
    
    <a href="./" title="Ucalc crpa" class="md-nav__link md-nav__link--active">
      Ucalc crpa
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-the-constrained-rpa-to-compute-the-u-and-j-in-the-case-of-srvo3" title="Using the constrained RPA to compute the U and J in the case of SrVO3." class="md-nav__link">
    Using the constrained RPA to compute the U and J in the case of SrVO3.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-crpa-method-to-compute-effective-interaction-summary-and-key-parameters" title="1 The cRPA method to compute effective interaction: summary and key parameters" class="md-nav__link">
    1 The cRPA method to compute effective interaction: summary and key parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-electronic-structure-of-srvo3-in-lda" title="2 Electronic Structure of SrVO3 in LDA" class="md-nav__link">
    2 Electronic Structure of SrVO3 in LDA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-definition-of-screening-and-orbitals-in-crpa-models-input-file-and-log-file" title="3 Definition of screening and orbitals in cRPA: models, input file and log file" class="md-nav__link">
    3 Definition of screening and orbitals in cRPA: models, input file and log file
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-the-constrained-polarization-calculation" title="3.1. The constrained polarization calculation." class="md-nav__link">
    3.1. The constrained polarization calculation.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-the-input-file-for-crpa-calculation-correlated-orbitals-wannier" title="3.2. The input file for cRPA calculation: correlated orbitals, Wannier" class="md-nav__link">
    3.2. The input file for cRPA calculation: correlated orbitals, Wannier
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-the-first-dataset-a-converged-lda-calculation" title="3.2.1. The first DATASET: A converged LDA calculation" class="md-nav__link">
    3.2.1. The first DATASET: A converged LDA calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-the-second-dataset-a-converged-lda-calculation-and-definition-of" title="3.2.2. The second DATASET: A converged LDA calculation and definition of" class="md-nav__link">
    3.2.2. The second DATASET: A converged LDA calculation and definition of
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/additional_material/" title="Additional Material" class="md-nav__link">
      Additional Material
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-the-constrained-rpa-to-compute-the-u-and-j-in-the-case-of-srvo3" title="Using the constrained RPA to compute the U and J in the case of SrVO3." class="md-nav__link">
    Using the constrained RPA to compute the U and J in the case of SrVO3.
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-crpa-method-to-compute-effective-interaction-summary-and-key-parameters" title="1 The cRPA method to compute effective interaction: summary and key parameters" class="md-nav__link">
    1 The cRPA method to compute effective interaction: summary and key parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-electronic-structure-of-srvo3-in-lda" title="2 Electronic Structure of SrVO3 in LDA" class="md-nav__link">
    2 Electronic Structure of SrVO3 in LDA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-definition-of-screening-and-orbitals-in-crpa-models-input-file-and-log-file" title="3 Definition of screening and orbitals in cRPA: models, input file and log file" class="md-nav__link">
    3 Definition of screening and orbitals in cRPA: models, input file and log file
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-the-constrained-polarization-calculation" title="3.1. The constrained polarization calculation." class="md-nav__link">
    3.1. The constrained polarization calculation.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-the-input-file-for-crpa-calculation-correlated-orbitals-wannier" title="3.2. The input file for cRPA calculation: correlated orbitals, Wannier" class="md-nav__link">
    3.2. The input file for cRPA calculation: correlated orbitals, Wannier
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-the-first-dataset-a-converged-lda-calculation" title="3.2.1. The first DATASET: A converged LDA calculation" class="md-nav__link">
    3.2.1. The first DATASET: A converged LDA calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-the-second-dataset-a-converged-lda-calculation-and-definition-of" title="3.2.2. The second DATASET: A converged LDA calculation and definition of" class="md-nav__link">
    3.2.2. The second DATASET: A converged LDA calculation and definition of
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <!-- Return to Top -->

<p><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a></p>
<hr />
<h1 id="calculation-of-u-and-j-using-crpa">Calculation of U and J using cRPA<a class="headerlink" href="#calculation-of-u-and-j-using-crpa" title="Permanent link">&para;</a></h1>
<h2 id="using-the-constrained-rpa-to-compute-the-u-and-j-in-the-case-of-srvo3">Using the constrained RPA to compute the U and J in the case of SrVO<sub>3</sub>.<a class="headerlink" href="#using-the-constrained-rpa-to-compute-the-u-and-j-in-the-case-of-srvo3" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to perform a calculation of <em>U</em> and <em>J</em> in
Abinit using cRPA. This method is well adapted in particular to determine <em>U</em>
and <em>J</em> as they can be used in DFT+DMFT. The implementation is described in
<a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>.</p>
<p>It might be useful that you already know how to do PAW calculations using
ABINIT but it is not mandatory (you can follow the two lessons on PAW in
ABINIT (<a href="../lesson_paw1.html">PAW1</a>, <a href="../lesson_paw2.html">PAW2</a>)). The DFT+U
tutorial in ABINIT (<a href="../lesson_dftu.html">DFT+U</a>) might be useful to know some
basic variables about correlated orbitals.</p>
<p>The first GW tutorial in ABINIT (<a href="../lesson_gw1.html">GW</a>) is useful to learn how
to compute the screening, and how to converge the relevant parameters (energy
cutoffs and number of bands for the polarizability).</p>
<p>This lesson should take two hours to complete (you should have access to more
than 8 processors).</p>
<h2 id="1-the-crpa-method-to-compute-effective-interaction-summary-and-key-parameters">1 The cRPA method to compute effective interaction: summary and key parameters<a class="headerlink" href="#1-the-crpa-method-to-compute-effective-interaction-summary-and-key-parameters" title="Permanent link">&para;</a></h2>
<p>The cRPA method aims at computing the effective interactions among correlated
electrons. Generally, these highly correlated materials contain rare-earth
metals or transition metals, which have partially filled <em>d</em> or <em>f</em> bands and
thus localized electrons. cRPA relies on the fact that screening processes can
be decomposed in two steps: Firstly, the bare Coulomb interaction is screened
by non correlated electrons to produce the effective interaction <em>Wr</em>.
Secondly, correlated electrons screened this interaction to produce the fully
screening interaction <em>W</em>. <a class="wikilink citation-link" data-content="Frequency-dependent local interactions and low-energy effective models from electronic structure calculations" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#aryasetiawan2004">[Aryasetiawan2004]</a>). However, the second
screening process is taken into account when one uses a method which describes
accurately the interaction among correlated electrons (such as Quantum Monte
Carlo within the DFT+DMFT method). So, to avoid a double counting of screening
by correlated electrons, the DFT+DMFT methods needs as an input the effective
interaction <em>Wr</em>. The goal of this tutorial is to present the implementation
of this method using Projected Local Orbitals Wannier orbitals in ABINIT (The
implementation of cRPA in ABINIT is described in <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a> and projected
local orbitals Wannier functions are presented in <a class="wikilink citation-link" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2008">[Amadon2008]</a>). The
discussion about the localization of Wannier orbitals has some similarities
with the beginning on the DMFT tutorial (see <a href="../lesson_dmft.html#1">here</a> and
<a href="../lesson_dmft.html#2">there</a>)</p>
<p>Several parameters (both physical and technical) are important for the cRPA
calculation:</p>
<ul>
<li>** The definition of correlated orbitals.** The first part of the tutorial is similar to the DMFT tutorial and explains the electronic structure of SrVO3 and will be used to understand the definition of Wannier orbitals with various extensions. Wannier functions are unitarily related to a selected set of Kohn Sham (KS) wavefunctions, specified in ABINIT by band index <a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandi">dmftbandi</a>, and <a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandf">dmftbandf</a>. Thus, as empty bands are necessary to build Wannier functions, it is required in DMFT or cRPA calculations that the KS Hamiltonian is correctly diagonalized: use high values for <a class="wikilink codevar-link" href="../../input_variables/dev#nnsclo">nnsclo</a>, and <a class="wikilink codevar-link" href="../../input_variables/gstate#nline">nline</a> for cRPA and DMFT calculations and preceding DFT calculations. Another solution used in the present tutorial is to use a specific non self-consistent calculation to diagonalize the hamiltonian, as in GW calculations. Concerning the localization or correlated orbitals, generally, the larger dmftbandf-dmftbandi is, the more localized is the radial part of the Wannier orbital. Finally, note that Wannier orbitals are used in DMFT and cRPA implementations but this is not the most usual choice of correlated orbitals in the DFT+U implementation in particular in ABINIT (see <a class="wikilink citation-link" data-content="$\gamma$ and $\beta$ cerium: {LDA}+{U} calculations of ground-state parameters" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2008a">[Amadon2008a]</a>). The relation between the two expressions is briefly discussed in <a class="wikilink citation-link" data-content="Proton transport in barium stannate: classical, semi-classical and quantum regimes" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#geneste2016">[Geneste2016]</a>. </li>
<li>** The constrained polarization calculation.** As we will discuss in section  2, there are different ways to define the constrained polarizability, by suppressing in the polarization, some electronic transitions: As discussed in section I of <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>, one can either suppress electronic transition inside a given subset of Kohn-Sham bands. In this case, one can use <a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa">ucrpa</a>=1, and choose the first and last bands defining the subset of bands by using variable <a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa_bands">ucrpa_bands</a>. One can also use an energy windows instead of a number of bands by using <a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa_window">ucrpa_window</a>. Another solution is to use a weighting scheme which lowers the contribution of a given transition, as a function of the weight of correlated orbitals on the bands involved in the transition (see Eq. (5) and (7) in <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>). In this case, on still use the variable <a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa_bands">ucrpa_bands</a>. The variable will in this case be used to define Projected Local Orbitals Wannier functions that will then be used to define the weighting function in the polarizability. (see Eq. (5) and (7) in <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>). </li>
<li>** Convergence parameters ** are the same as for a polarizability calculation for the screening calculation (<a class="wikilink codevar-link" href="../../input_variables/gw#ecuteps">ecuteps</a>, <a class="wikilink codevar-link" href="../../input_variables/gw#ecutwfn">ecutwfn</a>, <a class="wikilink codevar-link" href="../../input_variables/basic#nband">nband</a>) and the same as for the exchange part of GW for the effective interaction, ie <a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a>, <a class="wikilink codevar-link" href="../../input_variables/gw#ecutwfn">ecutwfn</a>. It is recommended, as discussed in appendix A of <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>, to use <a class="wikilink codevar-link" href="../../input_variables/paw#pawoptosc">pawoptosc</a>=1. If the calculation is carried out with several atoms, use <a class="wikilink codevar-link" href="../../input_variables/basic#nsym">nsym</a>=1, the calculation is not symmetrized over atoms in this case. </li>
</ul>
<h2 id="2-electronic-structure-of-srvo3-in-lda">2 Electronic Structure of SrVO3 in LDA<a class="headerlink" href="#2-electronic-structure-of-srvo3-in-lda" title="Permanent link">&para;</a></h2>
<p>You might create a subdirectory of the ~abinit/tests/tutoparal directory, and
use it for the tutorial. In what follows, the names of files will be mentioned
as if you were in this subdirectory</p>
<p>Copy the files ../Input/tucrpa_1.in and ../Input/tucrpa_1.files in your Work
directory, and run ABINIT: (as usual, the actual &ldquo;abinit&rdquo; command is something
like ../../../../src/98_main/abinit):</p>
<div class="codehilite"><pre><span></span>abinit &lt; tucrpa_1.files &gt; log_1
</pre></div>


<p>This run should take some time. It is recommended that you use at least 10
processors (and 32 should be fast). It calculates the LDA ground state of
SrVO3 and compute the band structure in a second step. The variable
<a class="wikilink codevar-link" href="../../input_variables/paw#pawfatbnd">pawfatbnd</a> allows to create files with &ldquo;fatbands&rdquo; (see description of the
variable in the list of variables): the width of the line along each k-point
path and for each band is proportional to the contribution of a given atomic
orbital on this particular Kohn Sham Wavefunction. A low cutoff and a small
number of k-points are used in order to speed up the calculation. During this
time you can take a look at the input file. There are two datasets. The first
one is a ground state calculations with <a class="wikilink codevar-link" href="../../input_variables/dev#nnsclo">nnsclo</a>=3 and <a class="wikilink codevar-link" href="../../input_variables/gstate#nline">nline</a>=3 in order
to have well diagonalized eigenfunctions even for empty states. In practice,
you have however to check that the residue of wavefunctions is small at the
end of the calculation. In this calculation, we find 1.E-06, which is large
(1.E-10 would be better, so <a class="wikilink codevar-link" href="../../input_variables/gstate#nline">nline</a> and <a class="wikilink codevar-link" href="../../input_variables/dev#nnsclo">nnsclo</a> should be increased, but
it would take more time). When the calculation is finished, you can plot the
fatbands for Vanadium and l=2 with</p>
<div class="codehilite"><pre><span></span>xmgrace tucrpa_O_DS2_FATBANDS_at0001_V_is1_l0002
</pre></div>


<p>The band structure is given in eV.</p>
<p><img alt="FatbandV" src="../../documents/lesson_ucalc_crpa/fatbandsV.jpeg" /></p>
<p>and the fatbands for one oxygen atom and l=1 with</p>
<div class="codehilite"><pre><span></span>xmgrace tucrpa_O_DS2_FATBANDS_at0003_O_is1_l0001.
</pre></div>


<p><img alt="FatbandV" src="../../documents/lesson_ucalc_crpa/fatbandsO.jpeg" /></p>
<p>In these plots, you recover the band structure of SrVO3 (see for comparison
the band structure of Fig.3 of <a class="wikilink citation-link" data-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2008">[Amadon2008]</a>), and the main character of the
bands. Bands 21 to 25 are mainly <em>d</em> and bands 12 to 20 are mainly oxygen <em>p</em>.
However, we clearly see an important hybridization. The Fermi level (at 0 eV)
is in the middle of bands 21-23.</p>
<p>One can easily check thats bands 21-23 are mainly <em>d-t2g</em> and bands 24-25 are
mainly <em>eg</em>: just use pawfatbnd=2 in tucrpa_1.in and relaunch the
calculations. Then the file tucrpa_O_DS2_FATBANDS_at0001_V_is1_l2_m-2,
tucrpa_O_DS2_FATBANDS_at0001_V_is1_l2_m-1 and
tucrpa_O_DS2_FATBANDS_at0001_V_is1_l2_m1 give you respectively the xy,yz and
xz fatbands (ie <em>d-t2g</em>) and tucrpa_O_DS2_FATBANDS_at0001_V_is1_l2_m+0 and
tucrpa_O_DS2_FATBANDS_at0001_V_is1_l2_m+2 give the z2 and z2-y2 fatbands (ie
<em>eg</em>).</p>
<p>So in conclusion of this study, the Kohn Sham bands which are mainly <em>t2g</em> are
the bands 21, 22 and 23.</p>
<p>Of course, it could have been anticipated from classical crystal field theory:
the vanadium is in the center of an octahedron of oxygen atoms, so <em>d</em>
orbitals are splitted in <em>t2g</em> and <em>eg</em>. As <em>t2g</em> orbitals are not directed
toward oxygen atoms, <em>t2g</em>-like bands are lower in energy and filled with one
electron, whereas <em>eg</em>-like bands are higher and empty.</p>
<p>In the next section, we will thus use the <em>d</em>-like bands to built Wannier
functions and compute effective interactions for these orbitals.</p>
<h2 id="3-definition-of-screening-and-orbitals-in-crpa-models-input-file-and-log-file">3 Definition of screening and orbitals in cRPA: models, input file and log file<a class="headerlink" href="#3-definition-of-screening-and-orbitals-in-crpa-models-input-file-and-log-file" title="Permanent link">&para;</a></h2>
<h4 id="31-the-constrained-polarization-calculation">3.1. The constrained polarization calculation.<a class="headerlink" href="#31-the-constrained-polarization-calculation" title="Permanent link">&para;</a></h4>
<p>As discussed briefly in Appendix A of <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a> as well as in section III
B of <a class="wikilink citation-link" data-content="Hubbard {U} and Hund exchange {J} in transition metal oxides: Screening versus localization trends from constrained random phase approximation" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#vaugier2012">[Vaugier2012]</a> and Section II B of <a class="wikilink citation-link" data-content="First-principles calculations of dynamical screened interactions for the transition metal oxides {MO} ({M}={M}n, {F}e, {C}o, {N}i)" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#sakuma2013">[Sakuma2013]</a>, one can use different
schemes for the cRPA calculations. Let us discuss these different models
namely the (<em>d-d</em>), (<em>dp-dp</em>), (<em>d-dp</em>(a)), and (<em>d-dp</em>(b)) models. In the
notation (A-B), A and B refers respectively to some bands of A-like and B-like
character. Moreover, A refers to the definition of screening and B refers to
the definition of correlated orbitals. To clarify this definition, we give
below some examples:</p>
<ul>
<li>(<em>t2g</em>-<em>t2g</em>) model (or <em>t2g</em> model): The correlated orbitals are defined with only <em>t2g</em>-like bands (bands 21, 22 and 23). The screening inside these bands is not taken into account to built the constrained polarizability. Note that if this case (and in the (<em>d-d</em>) and (<em>dp-dp</em>) models), using ucrpa=1 or 2 give the same results, provided one uses ucrpa_bands equal to (<a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandi">dmftbandi</a> <a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandf">dmftbandf</a> ). </li>
<li>(<em>d-d</em>) model (or d model) : The correlated orbitals are defined with only <em>d</em>-like bands (bands 21 to 25). The screening inside these bands is not taken into account. </li>
<li>(<em>dp-dp</em>) model (or dp model): The correlated orbitals are defined with only <em>d</em>-like and Op-like bands (bands 12 to 23). The screening inside these bands is not taken into account. </li>
<li>(<em>d-dp</em>(a)) model: In this scheme the Wannier orbitals are constructed as in the (<em>dp-dp</em>) model. However, in this scheme, one only supresses the screening inside <em>d</em>-like bands (<a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa">ucrpa</a>=1). It is coherent with the fact that the DMFT will only be applied to the d orbitals: so the screening for Op-like bands need to be taken into account. </li>
<li>(<em>d-dp</em>(b)) model: It is the same model as the (<em>d-dp</em>(a)), nevertheless, in this case, only the weighting scheme is used (<a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa">ucrpa</a>=2 in ABINIT). 
Which way of computing interactions is the most relevant depends on the way
the interactions will be used. Some aspects of it are discussed in Ref.
<a class="wikilink citation-link" data-content="Hubbard {U} and Hund exchange {J} in transition metal oxides: Screening versus localization trends from constrained random phase approximation" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#vaugier2012">[Vaugier2012]</a>. Also, for Mott insulators, and if self-consistency over
interactions is carried out, the choice of models is discussed in
<a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>.</li>
</ul>
<h4 id="32-the-input-file-for-crpa-calculation-correlated-orbitals-wannier">3.2. The input file for cRPA calculation: correlated orbitals, Wannier<a class="headerlink" href="#32-the-input-file-for-crpa-calculation-correlated-orbitals-wannier" title="Permanent link">&para;</a></h4>
<p>functions</p>
<p>In this section, we will present the input variables and discuss how to
extract useful information in the log file in the case of the <em>d-d</em> model. The
input file for a typical cRPA calculation (tucrpa_1.in) contains four datasets
(as usual GW calculations, see the <a href="../lesson_gw1.html#1a">GW tutorial</a>): the
first one is a well converged LDA calculation, the second is non self-
consistent calculation to compute accurately full and empty states, the third
computes the constrained non interacting polarizability, and the fourth
computes effective interaction parameters <em>U</em> and <em>J</em>. We discuss these four
datasets in the next four subsections.</p>
<p>Copy the files ../Input/tucrpa_2.in and ../Input/tucrpa_2.files in your Work
directory. The input file tucrpa_2.in contains standard data to perform a LDA
calculation on SrVO3. We focus in the next subsections on some peculiar input
variables related to the fact that we perform a cRPA calculation. Before
reading the following section, launch the abinit calculation:</p>
<div class="codehilite"><pre><span></span>abinit &lt; tucrpa_2.files &gt; log_2
</pre></div>


<h5 id="321-the-first-dataset-a-converged-lda-calculation">3.2.1. The first DATASET: A converged LDA calculation<a class="headerlink" href="#321-the-first-dataset-a-converged-lda-calculation" title="Permanent link">&para;</a></h5>
<p>The first dataset is a simple calculation of the density using LDA using 50
bands. We do not use symmetry in this calculation, so <a class="wikilink codevar-link" href="../../input_variables/basic#nsym">nsym</a>=1. If symmetry
is used (<a class="wikilink codevar-link" href="../../input_variables/basic#nsym">nsym</a>=0), then the calculation of <em>U</em> and <em>J</em> will be valid, but
the full interaction matrix described in section 3.2.4 will not be correct.</p>
<h5 id="322-the-second-dataset-a-converged-lda-calculation-and-definition-of">3.2.2. The second DATASET: A converged LDA calculation and definition of<a class="headerlink" href="#322-the-second-dataset-a-converged-lda-calculation-and-definition-of" title="Permanent link">&para;</a></h5>
<p>Wannier functions</p>
<p>Before presenting the input variables for this dataset, we discuss two
important physical parameters relevant to this dataset.</p>
<ul>
<li>Diagonalization of Kohn-Sham Hamiltonian : As in the case of DFT+DMFT or GW calculation, a cRPA calculation requires that the LDA is perfectly converged and the Kohn Sham eigenstates are precisely determined , including the empty states. Indeed these empty states are necessary both to build Wannier functions and to compute the polarizability. For this reason we choose a very low value of <a class="wikilink codevar-link" href="../../input_variables/basic#tolwfr">tolwfr</a> in the input file tucrpa_1.in. </li>
<li>
<p>Wannier functions : Once the calculation is converged, we compute Wannier functions, as in a DFT+DMFT calculation. To do this, we only precise that we are using the DFT+DMFT implementation (usedmft=0), but only with the Wannier keywords (<a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandi">dmftbandi</a> and <a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandf">dmftbandf</a>). We emphasize that with respect to the discussion on models on section 3.1, <a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandi">dmftbandi</a> and <a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandf">dmftbandf</a> are used to define the so called A bands. We will see in dataset 2 how B bands are defined. In our case, as we are in the <em>d-d</em> model, we choose only the <em>d</em>-like bands as a starting point and <a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandi">dmftbandi</a> and <a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandf">dmftbandf</a> are thus equal to the first and last <em>d</em>-like bands, namely 21 and 25. </p>
<p>iscf2          -2    # Perform a non self-consistent calculation            <br />
nbandkss2      -1    # Number of bands in KSS file (-1 means the maximum possible) 
kssform         3    # Format of the Wavefunction file (should be 3) 
nbdbuf2         4    # The last four bands will not be perfectly diagonalized 
tolwfr2   1.0d-18    # The criterion to stop diagonalization </p>
<h1 id="compute-wannier-functions">== Compute Wannier functions<a class="headerlink" href="#compute-wannier-functions" title="Permanent link">&para;</a></h1>
<p>usedmft2        1    # Mandatory to enable the calculation of Wannier functions as in DMFT. 
dmftbandi2     21    # Precise the definition of Wannier functions (also used for DMFT calculations) 
dmftbandf2     25    # Precise the definition of Wannier functions (also used for DMFT calculations) </p>
</li>
</ul>
<h5 id="322-the-third-dataset-compute-the-constrained-polarizability-and">3.2.2. The third DATASET: Compute the constrained polarizability and<a class="headerlink" href="#322-the-third-dataset-compute-the-constrained-polarizability-and" title="Permanent link">&para;</a></h5>
<p>dielectric function</p>
<p>The third DATASET drives the computation of the constrained polarizability and
the dielectric function. Again, we reproduce below the input variables
peculiar to this dataset.</p>
<p>We add some comments here on three most important topics</p>
<ul>
<li>Definition of constrained polarizability: As in the discussion on models on section 3.1, the constrained polarizability is defined thanks to B-like bands. The keywords related to this definition is <a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa_bands">ucrpa_bands</a>. According to the value of ucrpa, <a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa_bands">ucrpa_bands</a> defined the bands for which the transitions are neglected, or (if ucrpa=2), it defined Wannier functions that are used in the weighting scheme (see Eq. (5) and (7) of section II of <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>). Alternatively and only if ucrpa=1, an energy windows can be defined (with variable <a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa_window">ucrpa_window</a>) to exclude the transition. In our case, as we are in the <em>d-d</em> model, we neglect transitions inside the <em>d</em>-like bands, so we choose <a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa_bands">ucrpa_bands</a>= 21 25. </li>
<li>Convergence of the polarizability : <a class="wikilink codevar-link" href="../../input_variables/basic#nband">nband</a> and <a class="wikilink codevar-link" href="../../input_variables/gw#ecuteps">ecuteps</a> are the two main variables that should be converged. Note that one must study the role of these variables directly on the effective interaction parameters to determine their relevant values. </li>
<li>
<p>Frequency mesh  of the polarizability: Can be useful if one wants to plot the frequency dependence of the effective interactions (as in e.g. <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>). </p>
<p>optdriver3     3     # Keyword to launch the calculation of screening 
 gwcalctyp3     2     # The screening will be used later with gwcalctyp 2 in the next dataset 
 getwfk3       -1     # Obtain WFK file from previous dataset
 ecuteps3     5.0     # Cut-off energy of the planewave set to represent the dielectric matrix.
                              #It is important to converge effective interactions as a function of this parameter.</p>
<h1 id="-frequencies-for-dielectric-matrix">&ndash; Frequencies for dielectric matrix<a class="headerlink" href="#-frequencies-for-dielectric-matrix" title="Permanent link">&para;</a></h1>
<p>nfreqre3       1     # Number of  real frequencies 
 freqremax3    10 eV  # Maximal value of frequencies 
 freqremin3     0 eV  # Minimal value of frequencies 
 nfreqim3       0     # Number of  imaginary frequencies </p>
<h1 id="-ucrpa-screening">&ndash; Ucrpa: screening<a class="headerlink" href="#-ucrpa-screening" title="Permanent link">&para;</a></h1>
<p>ucrpa_bands3  21 25  # Define the bands corresponding to the <em>d</em> contribution </p>
<h1 id="-parallelism">&ndash; Parallelism<a class="headerlink" href="#-parallelism" title="Permanent link">&para;</a></h1>
<p>gwpara3        1</p>
</li>
</ul>
<h5 id="323-the-fourth-dataset-compute-the-effective-interactions">3.2.3. The fourth DATASET: Compute the effective interactions<a class="headerlink" href="#323-the-fourth-dataset-compute-the-effective-interactions" title="Permanent link">&para;</a></h5>
<p>The fourth DATASET drives the computation of the effective interactions. It is
similar computationally to the computation of exchange in <em>GW</em> calculations.
Again, we reproduce below the input variables peculiar to this dataset.</p>
<p>We add some comments on convergence properties</p>
<ul>
<li>Convergence as the number of plane waves:  Eq. (A1) and (A2) in Appendix A of <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a> show the summation over plane waves which is performed. The cutoff on plane wave which is used in this summation is <a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a> because of the similarity of Eq. A2 with the Fock exchange (see <a href="../../../theory/generated_files/theorydoc_mbt.html#evaluation_gw_sigma">GW notes</a>) when one computes the bare interaction. <a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a> is thus the main convergence parameter for this dataset. Note that as discussed in Appendix A of <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>, high values of <a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a> can be necessary because oscillator matrix elements in PAW contains the Fourier transform of (a product of) atomic orbitals. </li>
<li>
<p>The frequency mesh  must be the same as in the DATASET 2. </p>
<p>optdriver4  4      # Self-Energy calculation
 gwcalctyp4  2      # activate HF or ucrpa
 getwfk4     1      # Obtain WFK file from dataset 1
 getscr4     2      # Obtain SCR file from previous dataset
 ecutsigx4  30.0    # Dimension of the G sum in Sigma_x.</p>
<h1 id="-frequencies-for-effective-interactions">&ndash; Frequencies for effective interactions<a class="headerlink" href="#-frequencies-for-effective-interactions" title="Permanent link">&para;</a></h1>
<p>nfreqsp4    1
 freqspmax4 10 eV
 freqspmin4  0 eV
 nkptgw4     0      # number of k-point where to calculate the GW correction: all BZ
 mqgrid4   300      # Reduced but fine at least for SrVO3
 mqgriddg4 300      # Reduced but fine at least for SrVO3</p>
<h1 id="-parallelism_1">&ndash; Parallelism<a class="headerlink" href="#-parallelism_1" title="Permanent link">&para;</a></h1>
<p>gwpara4 2          # do not change if nsppol=2</p>
</li>
</ul>
<h5 id="324-the-crpa-calculation-the-log-file-for-the-d-d-model">3.2.4 The cRPA calculation: the log file (for the <em>d-d</em> model)<a class="headerlink" href="#324-the-crpa-calculation-the-log-file-for-the-d-d-model" title="Permanent link">&para;</a></h5>
<p>We are now going to browse quickly the log file for this calculation.</p>
<ul>
<li>Bare interaction of atomic orbitals. </li>
</ul>
<p>First, at the beginning of the log file, you will find the calculation of the
bare interaction for the atomic wavefunction corresponding the angular
momentum specified by <a class="wikilink codevar-link" href="../../input_variables/paw#lpawu">lpawu</a>, in the input file (here <a class="wikilink codevar-link" href="../../input_variables/paw#lpawu">lpawu</a> =2). It is
a simple fast direct integration. Note that this information is complete only
if you use XML PAW atomic data (as the one available on the JTH table
available on the ABINIT website).</p>
<div class="codehilite"><pre><span></span>     =======================================================================
  == Calculation of diagonal bare Coulomb interaction on ATOMIC orbitals
     (it is assumed that the wavefunction for the first reference
             energy in PAW atomic data is an atomic eigenvalue)

 Max value of the radius in atomic data file   =    201.3994
 Max value of the mesh   in atomic data file   =    910
 PAW radius is                                 =      2.2000
 PAW value of the mesh for integration is      =    587
 Integral of atomic wavefunction until rpaw    =      0.8418

 For an atomic wfn truncated at rmax =    201.3994
     The norm of the wfn is                    =      1.0000
     The bare interaction (no renormalization) =     17.7996 eV
     The bare interaction (for a renorm. wfn ) =     17.7996 eV

 For an atomic wfn truncated at rmax =      2.2000
     The norm of the wfn is                    =      0.8418
     The bare interaction (no renormalization) =     16.0038 eV
     The bare interaction (for a renorm. wfn ) =     22.5848 eV
 =======================================================================
</pre></div>


<p>Various quantities are computed, the one which is interesting to see here, is
the bare interaction computed for a wavefunction truncated at a very large
radius (here 201.3994 au ), ie virtually infinite. We find that this bare
interaction is 17.8 eV. We will compare below this value to the bare
interaction computed on Wannier orbitals.</p>
<ul>
<li>
<p>Bare Coulomb direct interaction of Wannier orbitals. In the third dataset, the code writes the Coulomb interaction matrix as: </p>
<div class="codehilite"><pre><span></span>  U&#39;=U(m1,m2,m1,m2) for the bare interaction
</pre></div>


<ul>
<li>
<p>1      2      3      4      5
   1 16.041 14.898 14.885 14.898 15.715
   2 14.898 16.041 15.508 14.898 15.092
   3 14.885 15.508 16.567 15.508 15.114
   4 14.898 14.898 15.508 16.041 15.092
   5 15.715 15.092 15.114 15.092 16.567</p>
</li>
<li>
<p>First we see that diagonal interactions are larger than off-diagonal terms, which is logical, because electron interaction is larger if electrons are located in the same orbital. </p>
</li>
<li>We recover in these interaction matrix the degeneracy of <em>d</em> orbitals in the cubic symmetry (we remind, as listed in <a class="wikilink codevar-link" href="../../input_variables/paw#dmatpawu">dmatpawu</a>, that the order of orbitals in ABINIT are xy, yz, z2, xy, x2-y2). </li>
<li>We note also that the interaction for <em>t2g</em> and <em>eg</em> orbitals are not the same. This effect is compared in e.g. Appendix C.1 of <a class="wikilink citation-link" data-content="Hubbard {U} and Hund exchange {J} in transition metal oxides: Screening versus localization trends from constrained random phase approximation" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#vaugier2012">[Vaugier2012]</a> to the usual Slater parametrization of interaction matrices. </li>
<li>Diagonal bare interactions are smaller to the bare interaction on atomic orbitals (17.8 eV, as discussed above). It shows that the Wannier functions (obtained within the <em>d-d</em> model) are less localized than atomic orbitals. It is logical because these Wannier functions contain indeed a weight on O-<em>p</em> orbitals. </li>
<li>
<p>From this interaction matrix, one can compute the average of all elements (the famous <em>U</em>), as well as the average of diagonal elements, which is sometimes used as another definition of <em>U</em> (see Eq. (8) and (9) of <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a>. The two quantities are written in the log file: </p>
<p>Hubbard bare interaction U=1/(2l+1)**2 \sum U(m1,m2,m1,m2)=   15.3789    0.0000</p>
</li>
</ul>
<p>(Hubbard bare interaction U=1/(2l+1) \sum U(m1,m1,m1,m1)=   16.2514    0.0000)</p>
</li>
</ul>
<p>[To speed up the calculation and if one needs only these average values of <em>U</em>
and <em>J</em>, one can use <a class="wikilink codevar-link" href="../../input_variables/basic#nsym">nsym</a>=0 in the input file, but in this case, the
interaction matrix does not anymore reproduce the correct symmetry. For
several correlated atoms, the implementation is under test and it is mandatory
to use <a class="wikilink codevar-link" href="../../input_variables/basic#nsym">nsym</a>=1.]</p>
<ul>
<li>
<p>Bare exchange interaction. The exchange interaction matrix is also written as well as the average of off-diagonal elements, which is <em>J</em>. </p>
<div class="codehilite"><pre><span></span>  Hund coupling J=U(m1,m1,m2,m2) for the bare interaction
</pre></div>


<ul>
<li>1      2      3      4      5
   1 16.041  0.482  0.555  0.478  0.249
   2  0.482 16.041  0.329  0.478  0.478
   3  0.555  0.329 16.567  0.400  0.555
   4  0.478  0.478  0.400 16.041  0.482
   5  0.249  0.478  0.555  0.482 16.567</li>
</ul>
<p>bare interaction value of J=1/((2l+1)(2l)) \sum_{m1/=m2} U(m1,m2,m2,m1)=    0.4486    0.0000</p>
</li>
<li>
<p>Then, the cRPA effective interactions are given for all frequency. The first frequency is zero and the cRPA interactions are: </p>
<div class="codehilite"><pre><span></span>  U&#39;=U(m1,m2,m1,m2) for the cRPA interaction
</pre></div>


<ul>
<li>1      2      3      4      5
   1  3.434  2.432  2.338  2.432  2.966
   2  2.432  3.434  2.809  2.432  2.495
   3  2.338  2.809  3.641  2.809  2.430
   4  2.432  2.432  2.809  3.434  2.495
   5  2.966  2.495  2.430  2.495  3.641</li>
</ul>
<p>Hubbard cRPA interaction for w =  1, U=1/(2l+1)**2 \sum U(m1,m2,m1,m2)=    2.7546   -0.0000</p>
<p>(Hubbard cRPA interaction for w =   1, U=1/(2l+1) \sum U(m1,m1,m1,m1)=    3.5167   -0.0000)</p>
<p>Hund coupling J=U(m1,m1,m2,m2) for the cRPA interaction
 -      1      2      3      4      5
   1  3.434  0.440  0.508  0.435  0.247
   2  0.440  3.434  0.315  0.436  0.442
   3  0.508  0.315  3.641  0.378  0.444
   4  0.435  0.436  0.378  3.434  0.446
   5  0.247  0.442  0.444  0.446  3.641</p>
<p>cRPA interaction value of J=1/((2l+1)(2l)) \sum_{m1/=m2} U(m1,m2,m2,m1)=    0.4092    0.0000</p>
</li>
<li>
<p>At the end of the calculation, the value of <em>U</em> and <em>J</em> as a function of frequency are gathered. </p>
<div class="codehilite"><pre><span></span>   -------------------------------------------------------------
        Average U and J as a function of frequency
</pre></div>


<hr />
<div class="codehilite"><pre><span></span>     omega           U(omega)            J(omega)
    0.000      2.7546   -0.0000      0.4092    0.0000
</pre></div>


<hr />
</li>
</ul>
<h2 id="4-convergence-studies">4 Convergence studies<a class="headerlink" href="#4-convergence-studies" title="Permanent link">&para;</a></h2>
<p>We give here the results of some convergence studies, than can be made by the
readers. Some are computationally expensive. It is recommanded to use at least
32 processors. Input files are provided in tucrpa_3.in and tucrpa_3.files for
the first case.</p>
<h4 id="41-ecuteps">4.1 ecuteps<a class="headerlink" href="#41-ecuteps" title="Permanent link">&para;</a></h4>
<p>The number of plane waves used in the calculation of the cRPA polarizability
is determined by <a class="wikilink codevar-link" href="../../input_variables/gw#ecuteps">ecuteps</a> (see <a href="../../../theory/generated_files/theorydoc_mbt.html#RPA_Fourier_space">Notes on RPA
calculations</a>).
The convergence can be studied simply by increasing the values of <a class="wikilink codevar-link" href="../../input_variables/gw#ecuteps">ecuteps</a>
and gives:</p>
<div class="codehilite"><pre><span></span>   ecuteps (Ha)   U (eV)     J (eV)
      3            3.22       0.43
      5            3.01       0.42
      7            2.99       0.40
      9            2.99       0.40
</pre></div>


<p>So, for <a class="wikilink codevar-link" href="../../input_variables/basic#nband">nband</a>=30, <a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a>=30 and a 4x4x4 k-point grid, the effective
interactions are converged with a precision of 0.02 eV for <a class="wikilink codevar-link" href="../../input_variables/gw#ecuteps">ecuteps</a>=5.</p>
<h4 id="42-nband">4.2 nband<a class="headerlink" href="#42-nband" title="Permanent link">&para;</a></h4>
<p>The RPA polarizability depends also of the number of Kohn-Sham bands as also
discussed in the <a href="../../../theory/generated_files/theorydoc_mbt.html#RPA_Fourier_space">Notes on RPA
calculations</a>.</p>
<div class="codehilite"><pre><span></span>   nband          U (eV)     J (eV)
    30             3.01       0.42
    50             2.75       0.41
    70             2.71       0.41
    90             2.70       0.40
</pre></div>


<p>So, for <a class="wikilink codevar-link" href="../../input_variables/gw#ecuteps">ecuteps</a>=5, <a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a>=30 and a 4x4x4 k-point grid, the effective
interactions are converged with a precision of 0.05 eV for <a class="wikilink codevar-link" href="../../input_variables/basic#nband">nband</a>=50.</p>
<h4 id="43-ecutsigx">4.3 ecutsigx<a class="headerlink" href="#43-ecutsigx" title="Permanent link">&para;</a></h4>
<p><a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a> is the input variable determining the number of plane waves used
in the calculation of the exchange part of the self-energy. The same variable
is used here to determine the number of plane waves used in the calculation of
the effective interaction. The study of the convergence gives:</p>
<div class="codehilite"><pre><span></span>     ecutsigx (Ha)            U_bare (eV)    J_bare (eV)      U (eV)       J (eV)
         30                    15.38          0.45            3.22         0.43
         50                    15.38          0.46            3.22         0.44
         70                    15.38          0.47            3.22         0.45
</pre></div>


<p>For <a class="wikilink codevar-link" href="../../input_variables/gw#ecuteps">ecuteps</a>=3, <a class="wikilink codevar-link" href="../../input_variables/basic#nband">nband</a>=30 and a 4 4 4 k-point grid, effective
interactions are converged with a precision of 0.02 eV for <a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a>=30 Ha.</p>
<h4 id="44-k-point">4.4 k-point<a class="headerlink" href="#44-k-point" title="Permanent link">&para;</a></h4>
<p>The dependence of effective interactions with the k-point grid is also
important to check.</p>
<div class="codehilite"><pre><span></span>   kpoint grid     U_bare (eV)    J_bare (eV)     U (eV)       J (eV)
      4 4 4          15.38          0.45           3.22         0.43
      5 5 5          15.38          0.44           3.14         0.43
      6 6 6          15.36          0.44           3.19         0.43
      7 7 7          15.35          0.44           3.19         0.43
</pre></div>


<p>For <a class="wikilink codevar-link" href="../../input_variables/gw#ecuteps">ecuteps</a>=3, <a class="wikilink codevar-link" href="../../input_variables/basic#nband">nband</a>=30 and <a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a>=30, effective interactions
are converged to 0.01 eV for a k-point grid of 6 6 6. The converged parameters
are thus <a class="wikilink codevar-link" href="../../input_variables/gw#ecuteps">ecuteps</a>=5,<a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a>=30,ngkpt=6 6 6, <a class="wikilink codevar-link" href="../../input_variables/basic#nband">nband</a>=50 with an
expected precision of 0.1 eV. We will use instead
<a class="wikilink codevar-link" href="../../input_variables/gw#ecuteps">ecuteps</a>=5,<a class="wikilink codevar-link" href="../../input_variables/gw#ecutsigx">ecutsigx</a>=30,ngkpt=4 4 4, <a class="wikilink codevar-link" href="../../input_variables/basic#nband">nband</a>=50 to lower the
computational cost. In this case, we find values of <em>U</em> and <em>J</em> of 2.75 eV and
0.41 eV and <em>U</em> is probably underestimated by 0.1 eV.</p>
<h2 id="5-effective-interactions-for-different-models">5 Effective interactions for different models<a class="headerlink" href="#5-effective-interactions-for-different-models" title="Permanent link">&para;</a></h2>
<p>In this section, we compute, using the converged values of parameters, the
value of effective interactions for the models discussed in section and 3.1.
The table below gives for each model, the values of <a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandi">dmftbandi</a>,
<a class="wikilink codevar-link" href="../../input_variables/dmft#dmftbandf">dmftbandf</a> and <a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa_bands">ucrpa_bands</a> that must be used, and it sums up the value
of bare and effective interactions.</p>
<div class="codehilite"><pre><span></span>      model      ucrpa dmftbandi/dmftbandf ucrpa_bands |  Ubare    Ubare diag   Jbare |   U      Udiag     J 
 _     d - d     _   1        21/25            21 25     |  15.4      16.3      0.45  |  2.8     3.5     0.41
 _    t2g-t2g    _   1        21/25            21 25     |  15.3      16.0      0.48  |  2.8     3.4     0.44
 _     dp-dp     _   1        12/25            12 25     |  19.4      20.6      0.67  | 10.1    11.2     0.64
 _     d -dp (a) _   1        12/25            21 25     |  19.4      20.6      0.67  |  3.4     4.4     0.62
 _     d -dp (b) _   2        12/25            12 25     |  19.4      20.6      0.67  |  1.6     2.6     0.60
</pre></div>


<p>Even if our calculation is not perfectly converged with respect to k-points,
the results obtained for the <em>d-d</em>, <em>dp-dp</em>, and <em>d-dp (a)</em> models are in
agreement (within 0.1 or 0.2 eV) with results obtained in Table V of
<a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a> and references cited in this table.</p>
<p>To obtain the results with only the <em>t2g</em> orbitals, one must use a specific
input file, which is tucrpa_4.in, which uses specific keywords, peculiar to
this case (compare it with tucrpa_2.in). We now briefly comment the physics of
the results.</p>
<ul>
<li>Bare interactions. When the number of bands used is larger, the Wannier orbitals extension is smaller. Thus, the interaction obtained with Wannier functions obtained from <em>dp</em> bands are larger than interactions obtained with Wannier functions obtained with <em>d</em> bands and also larger than interaction obtained on atomic orbitals. </li>
<li>For the same Wannier functions (_dp-dp, d-dp <em>(a), _d-dp</em> (b)), one can see the role of the screening on cRPA interactions: <ul>
<li>When one supresses all transitions inside the <em>d</em>-like and <em>p</em>-like bands (<em>dp-dp</em> model), <em>U</em> is large. </li>
<li>When only the transitions inside the <em>d</em>-like bands are suppressed, <em>U</em> is smaller (<em>d-dp</em> (a) model) in comparison to the <em>dp-dp</em> model, because the screening is more efficient. </li>
<li>Lastly, when one uses the weighting scheme to compute the polarizability,_ U_ is very small. Indeed, in this case, one can show that there are some residual transitions near the Fermi level (due to the hybridization between <em>d</em> orbitals and O_p_ orbitals) which are very efficient to screen the interaction (A similar effect is discussed in <a class="wikilink citation-link" data-content="Screened Coulomb interaction calculations: c{RPA} implementation and applications to dynamical screening and self-consistency in uranium dioxide and cerium" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#amadon2014">[Amadon2014]</a> for UO2 or <a class="wikilink citation-link" data-content="First-principles calculations of dynamical screened interactions for the transition metal oxides {MO} ({M}={M}n, {F}e, {C}o, {N}i)" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#sakuma2013">[Sakuma2013]</a> for transition metal oxydes).<br />
Finally, fully screened interactions (not discussed here) could also be
computed for each definition correlated orbitals by using the default values
of <a class="wikilink codevar-link" href="../../input_variables/gw#ucrpa_bands">ucrpa_bands</a> .</li>
</ul>
</li>
</ul>
<h2 id="6-frequency-dependent-interactions">6 Frequency dependent interactions<a class="headerlink" href="#6-frequency-dependent-interactions" title="Permanent link">&para;</a></h2>
<p>In this section, we are going to compute frequency dependent effective
interactions. Just change the following input variables in order to compute
effective interaction between 0 and 30 eV. We use <a class="wikilink codevar-link" href="../../input_variables/basic#nsym">nsym</a>=0 in order to
decrease the computational cost.</p>
<div class="codehilite"><pre><span></span> # -- Frequencies for effective interactions
 nsym        0
 nfreqsp3   60
 freqspmax3 30 eV
 freqspmin3  0 eV
 nfreqsp4   60
 freqspmax4 30 eV
 freqspmin4  0 eV
</pre></div>


<p>An example of input file can be found in tucrpa_5.in. Note that we have
decreased some parameters to speed-up the calculations. Importantly, however,
we have increased the number of Kohn Sham bands, because calculation of
screening at high frequency involves high energy transitions which requires
high energy states (as well as semicore states). If the calculation is too
time consuming, you can reduce the number of frequencies. The following figure
has been plotted with 300 frequencies, but using 30 or 60 frequencies is
sufficient to see the main tendencies. Extract the value of <em>U</em> for the 60
frequencies using:</p>
<div class="codehilite"><pre><span></span>grep &quot;U(omega)&quot; -A 60 tucrpa_5.out &gt; Ufreq.dat
</pre></div>


<p>Remove the first line, and plot the data:</p>
<p><img alt="dynamical" src="../../documents/lesson_ucalc_crpa/dynamical.jpeg" /></p>
<p>We recover in the picture the main results found in the Fig. 3 of
<a class="wikilink citation-link" data-content="Calculations of Hubbard U from first-principles" data-placement="right" data-toggle="popover" data-trigger="hover" href="../../theory/bibliography#aryasetiawan2006">[Aryasetiawan2006]</a> . Indeed, the frequency dependent effective interactions
exhibits a plasmon excitation.</p>
<h2 id="7-conclusion">7 Conclusion<a class="headerlink" href="#7-conclusion" title="Permanent link">&para;</a></h2>
<p>This simple tutorial showed how to compute effective interactions for SrVO3.
It emphasized the importance of the definition of correlated orbitals and the
definition of constrained polarizability.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../input_variables/" title="Input Variables" class="md-tabs__link">
          Input Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../welcome/" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/mbt/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../udet/" title="Udet" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Udet
              </span>
            </div>
          </a>
        
        
          <a href="../rf1/" title="RF1" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                RF1
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.5.4</center>
        

        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 The Abinit Group (BAmadon)
          </div>
        

        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-6940329b9f.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
    
  </body>
</html>