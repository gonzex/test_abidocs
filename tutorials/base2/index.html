<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="The Abinit group">
        <link rel="canonical" href="http://www.abinit.org/tutorials/base2/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Base2 - abinit</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/codehilite.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">
    
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">abinit</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../..">Introduction</a>
</li>
                            
<li >
    <a href="../../installation/">Installation</a>
</li>
                            
<li >
    <a href="../../user-guide/help_what_ABINIT_does/">Overview</a>
</li>
                            
<li >
    <a href="../../user-guide/help_abinit/">Abinit</a>
</li>
                            
<li >
    <a href="../../user-guide/help_mrgddb/">Mrgddb</a>
</li>
                            
<li >
    <a href="../../user-guide/help_optic/">Optic</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topics <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../topics/">Complete List</a>
</li>
                            
<li >
    <a href="../../topics/Artificial/">Artificial</a>
</li>
                            
<li >
    <a href="../../topics/AtomManipulator/">AtomManipulator</a>
</li>
                            
<li >
    <a href="../../topics/AtomTypes/">AtomTypes</a>
</li>
                            
<li >
    <a href="../../topics/Bader/">Bader</a>
</li>
                            
<li >
    <a href="../../topics/BandOcc/">BandOcc</a>
</li>
                            
<li >
    <a href="../../topics/Berry/">Berry</a>
</li>
                            
<li >
    <a href="../../topics/BSE/">BSE</a>
</li>
                            
<li >
    <a href="../../topics/ConstrainedPol/">ConstrainedPol</a>
</li>
                            
<li >
    <a href="../../topics/Control/">Control</a>
</li>
                            
<li >
    <a href="../../topics/Coulomb/">Coulomb</a>
</li>
                            
<li >
    <a href="../../topics/CRPA/">CRPA</a>
</li>
                            
<li >
    <a href="../../topics/crystal/">Crystal</a>
</li>
                            
<li >
    <a href="../../topics/Dev/">Dev</a>
</li>
                            
<li >
    <a href="../../topics/DFPT/">DFPT</a>
</li>
                            
<li >
    <a href="../../topics/DFT+U/">DFT+U</a>
</li>
                            
<li >
    <a href="../../topics/DMFT/">DMFT</a>
</li>
                            
<li >
    <a href="../../topics/EffMass/">EffMass</a>
</li>
                            
<li >
    <a href="../../topics/EFG/">EFG</a>
</li>
                            
<li >
    <a href="../../topics/Elastic/">Elastic</a>
</li>
                            
<li >
    <a href="../../topics/ElecBandStructure/">ElecBandStructure</a>
</li>
                            
<li >
    <a href="../../topics/ElecDOS/">ElecDOS</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonInt/">ElPhonInt</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonTransport/">ElPhonTransport</a>
</li>
                            
<li >
    <a href="../../topics/ForcesStresses/">ForcesStresses</a>
</li>
                            
<li >
    <a href="../../topics/FrequencyMeshMBPT/">FrequencyMeshMBPT</a>
</li>
                            
<li >
    <a href="../../topics/GeoConstraints/">GeoConstraints</a>
</li>
                            
<li >
    <a href="../../topics/GeoOpt/">GeoOpt</a>
</li>
                            
<li >
    <a href="../../topics/GW/">GW</a>
</li>
                            
<li >
    <a href="../../topics/GWls/">GWls</a>
</li>
                            
<li >
    <a href="../../topics/Hybrids/">Hybrids</a>
</li>
                            
<li >
    <a href="../../topics/">Home</a>
</li>
                            
<li >
    <a href="../../topics/k-points/">K points</a>
</li>
                            
<li >
    <a href="../../topics/LOTF/">LOTF</a>
</li>
                            
<li >
    <a href="../../topics/MagField/">MagField</a>
</li>
                            
<li >
    <a href="../../topics/MagMom/">MagMom</a>
</li>
                            
<li >
    <a href="../../topics/MolecularDynamics/">MolecularDynamics</a>
</li>
                            
<li >
    <a href="../../topics/multidtset/">Multidtset</a>
</li>
                            
<li >
    <a href="../../topics/nonlinear/">Nonlinear</a>
</li>
                            
<li >
    <a href="../../topics/Optic/">Optic</a>
</li>
                            
<li >
    <a href="../../topics/Output/">Output</a>
</li>
                            
<li >
    <a href="../../topics/parallelism/">Parallelism</a>
</li>
                            
<li >
    <a href="../../topics/PAW/">PAW</a>
</li>
                            
<li >
    <a href="../../topics/PhononBands/">PhononBands</a>
</li>
                            
<li >
    <a href="../../topics/Phonons/">Phonons</a>
</li>
                            
<li >
    <a href="../../topics/PhononWidth/">PhononWidth</a>
</li>
                            
<li >
    <a href="../../topics/PIMD/">PIMD</a>
</li>
                            
<li >
    <a href="../../topics/Planewaves/">Planewaves</a>
</li>
                            
<li >
    <a href="../../topics/positron/">Positron</a>
</li>
                            
<li >
    <a href="../../topics/printing/">Printing</a>
</li>
                            
<li >
    <a href="../../topics/PseudosPAW/">PseudosPAW</a>
</li>
                            
<li >
    <a href="../../topics/q-points/">Q points</a>
</li>
                            
<li >
    <a href="../../topics/RandStopPow/">RandStopPow</a>
</li>
                            
<li >
    <a href="../../topics/Recursion/">Recursion</a>
</li>
                            
<li >
    <a href="../../topics/RPACorrEn/">RPACorrEn</a>
</li>
                            
<li >
    <a href="../../topics/SCFAlgorithms/">SCFAlgorithms</a>
</li>
                            
<li >
    <a href="../../topics/SCFControl/">SCFControl</a>
</li>
                            
<li >
    <a href="../../topics/SelfEnergy/">SelfEnergy</a>
</li>
                            
<li >
    <a href="../../topics/SmartSymm/">SmartSymm</a>
</li>
                            
<li >
    <a href="../../topics/spinpolarisation/">Spinpolarisation</a>
</li>
                            
<li >
    <a href="../../topics/STM/">STM</a>
</li>
                            
<li >
    <a href="../../topics/Susceptibility/">Susceptibility</a>
</li>
                            
<li >
    <a href="../../topics/TDDFT/">TDDFT</a>
</li>
                            
<li >
    <a href="../../topics/TDepES/">TDepES</a>
</li>
                            
<li >
    <a href="../../topics/Temperature/">Temperature</a>
</li>
                            
<li >
    <a href="../../topics/TransPath/">TransPath</a>
</li>
                            
<li >
    <a href="../../topics/TuningSpeed/">TuningSpeed</a>
</li>
                            
<li >
    <a href="../../topics/UnitCell/">UnitCell</a>
</li>
                            
<li >
    <a href="../../topics/vdw/">Vdw</a>
</li>
                            
<li >
    <a href="../../topics/Wannier/">Wannier</a>
</li>
                            
<li >
    <a href="../../topics/Wavelets/">Wavelets</a>
</li>
                            
<li >
    <a href="../../topics/xc/">Xc</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Input Variables <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Abinit</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../input_variables/varlist_abinit/">All Variables</a>
</li>
            
<li >
    <a href="../../input_variables/basic/">Basic</a>
</li>
            
<li >
    <a href="../../input_variables/bse/">Bethe-Salpeter</a>
</li>
            
<li >
    <a href="../../input_variables/dev/">Developers</a>
</li>
            
<li >
    <a href="../../input_variables/dmft/">DMFT</a>
</li>
            
<li >
    <a href="../../input_variables/eph/">Electron-Phonon</a>
</li>
            
<li >
    <a href="../../input_variables/ffield/">Varff</a>
</li>
            
<li >
    <a href="../../input_variables/files/">File-handling</a>
</li>
            
<li >
    <a href="../../input_variables/geo/">Geometry</a>
</li>
            
<li >
    <a href="../../input_variables/gstate/">Ground-State</a>
</li>
            
<li >
    <a href="../../input_variables/gw/">GW</a>
</li>
            
<li >
    <a href="../../input_variables/internal/">Internal</a>
</li>
            
<li >
    <a href="../../input_variables/paral/">Parallelism</a>
</li>
            
<li >
    <a href="../../input_variables/paw/">PAW</a>
</li>
            
<li >
    <a href="../../input_variables/dfpt/">DFPT</a>
</li>
            
<li >
    <a href="../../input_variables/rlx/">Relaxation</a>
</li>
            
<li >
    <a href="../../input_variables/vdw/">VdW</a>
</li>
            
<li >
    <a href="../../input_variables/w90/">Wannier90</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../input_variables/anaddb/">Anaddb</a>
</li>
                            
<li >
    <a href="../../input_variables/optic/">Optic</a>
</li>
                            
<li >
    <a href="../../input_variables/aim/">Aim</a>
</li>
                            
<li >
    <a href="../../input_variables/varset_stats/">Statistics</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Lessons <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../welcome/">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Base Tutorials</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../base1/">Base1</a>
</li>
            
<li class="active">
    <a href="./">Base2</a>
</li>
            
<li >
    <a href="../base3/">Base3</a>
</li>
            
<li >
    <a href="../base4/">Base4</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">DFPT</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../rf1/">RF1</a>
</li>
            
<li >
    <a href="../rf2/">RF2</a>
</li>
            
<li >
    <a href="../elastic/">Elastic</a>
</li>
            
<li >
    <a href="../eph/">EPH</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../dmft/">DMFT</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Many-Body</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../gw1/">GW1</a>
</li>
            
<li >
    <a href="../gw2/">GW2</a>
</li>
            
<li >
    <a href="../bse/">Bethe-Salpeter</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Parallelism</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../basepar/">Base</a>
</li>
            
<li >
    <a href="../paral_mbt/">Many-Body</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Theory <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../theory/theory_mbt/">MBPT</a>
</li>
                            
<li >
    <a href="../../theory/additional_material/">Additional Material</a>
</li>
                            
<li >
    <a href="../../bibliography/">Bibliography</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../developers/README/">How to write docs</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../about/release-notes/">Release Notes</a>
</li>
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>
                            
<li >
    <a href="../../about/license/">License</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../base1/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../base3/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/abinit/abinit/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#20-summary-of-the-previous-lesson">2.0. Summary of the previous lesson.</a></li>
        <li class="main "><a href="#21-and-22-the-convergence-in-ecut">2.1 and 2.2 The convergence in ecut</a></li>
        <li class="main "><a href="#24-the-final-calculation-in-local-spin-density-approximation">2.4 The final calculation in Local (Spin) Density Approximation.</a></li>
        <li class="main "><a href="#25-the-use-of-the-generalized-gradient-approximation">2.5 The use of the Generalized Gradient Approximation.</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<!-- Return to Top -->

<p><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a>
This lesson aims at showing how to get converged values for the following
physical properties:</p>
<ul>
<li>the bond length </li>
<li>the atomisation energy 
You will learn about the numerical quality of the calculations, then make
convergence studies with respect to the number of planewaves and the size of
the supercell, and finally consider the effect of the XC functional. The
problems related to the use of different pseudopotential are not examined.</li>
</ul>
<p>You will also finish to read the abinit_help file.</p>
<p>This lesson should take about 1 hour.</p>
<ul>
<li>2.0 Summary of the previous lesson</li>
<li>2.1 The convergence in <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a></li>
<li>2.2 The convergence in <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a></li>
<li>2.3 The convergence in <a class="wikilink" href="../../input_variables/basic/#acell">acell</a></li>
<li>2.4 The final calculation in Local (Spin) Density Approximation.</li>
<li>2.5 The use of the Generalized Gradient Approximation.</li>
</ul>
<hr />
<h4 id="_1"><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<h3 id="20-summary-of-the-previous-lesson"><strong>2.0. Summary of the previous lesson.</strong><a class="headerlink" href="#20-summary-of-the-previous-lesson" title="Permanent link">&para;</a></h3>
<p>We studied the H2 molecule in a big box. We used 10 Ha as cut-off energy, a
10x10x10 Bohr^3 supercell, the local-density approximation (as well as the
local-spin-density approximation) in the Teter parametrization (<a class="wikilink" href="../../input_variables/basic/#ixc">ixc</a>=1, the
default), and a pseudopotential from the Goedecker-Hutter-Teter table.</p>
<p>At this stage, we compared our results:</p>
<ul>
<li>bond length: 1.522 Bohr</li>
<li>atomisation energy at that bond length: 0.1656 Ha = 4.506 eV</li>
</ul>
<p>with the experimental data (as well as theoretical data using a much more
accurate technique than DFT)</p>
<ul>
<li>bond length: 1.401 Bohr</li>
<li>atomisation energy: 4.747 eV</li>
</ul>
<p>The bond length is awful (nearly 10% off), and the atomisation energy is a bit
too low, 5 % off.</p>
<h3 id="_2"><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<hr />
<h3 id="21-and-22-the-convergence-in-ecut"><strong>2.1 and 2.2 The convergence in ecut</strong><a class="headerlink" href="#21-and-22-the-convergence-in-ecut" title="Permanent link">&para;</a></h3>
<p><strong>2.1.a</strong><strong> Computing the bond length and corresponding atomisation energy in one run.</strong></p>
<p>_Before beginning, you might consider to work in a different subdirectory as
for lesson_base1. Why not "Work2"? _  </p>
<p>Because we will compute many times the bond length and atomisation energy, it
is worth to make a single input file that will do all the associated
operations. You should try to use 2 datasets (try to combine
~abinit/tests/tutorial/Input/tbase1_3.in with
~abinit/tests/tutorial/Input/tbase1_5.in!). Do not try to have the same
position of the H atom as one of the H2 atoms in the optimized geometry.</p>
<p>The input file ~abinit/tests/tutorial/Input/tbase2_1.in is an example of file
that will do the job, while ~abinit/tests/tutorial/Refs/tbase2_1.out is an
example of output file. You might use
~abinit/tests/tutorial/Input/tbase2_x.files as "files" file (do not forget to
modify it, like in lesson 1), although it does not differ from
~abinit/tests/tutorial/Input/tbase1_x.files. The run should take less than one
minute.</p>
<p>You should obtain the values:</p>
<pre><code>    etotal1  -1.1058360644E+00
    etotal2  -4.7010531489E-01
</code></pre>
<p>and</p>
<pre><code>    xcart1  -7.6091015760E-01  0.0000000000E+00  0.0000000000E+00
             7.6091015760E-01  0.0000000000E+00  0.0000000000E+00
</code></pre>
<p>These are similar to those determined in <a href="../lesson_base1.html">lesson 1</a>,
although they have been obtained in one run. You can also check that the
residual forces are lower than <code>5.0d-4</code>. Convergence issues are discussed in
<a href="../../../users/generated_files/help_abinit.html#7">section 7</a> of the abinit_help
file.<br />
You should read it. By the way, you have read many parts of the abinit_help
file! You are missing the sections
<a href="../../../users/generated_files/help_abinit.html#2">2</a>,
<a href="../../../users/generated_files/help_abinit.html#5">5</a>,
<a href="../../../users/generated_files/help_abinit.html#8">8</a>. You are also missing the
description of many input variables. We suggest that you finish reading
entirely the abinit_help file now, while the knowledge of the input variables
will come in the long run.</p>
<p><strong>2.1.b</strong> Many convergence parameters have already been identified. We will focus only on <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> and <a class="wikilink" href="../../input_variables/basic/#acell">acell</a>. This is because </p>
<ul>
<li>the convergence of the SCF cycle and geometry determination are well under control thanks to <a class="wikilink" href="../../input_variables/basic/#toldfe">toldfe</a>, <a class="wikilink" href="../../input_variables/basic/#toldff">toldff</a> and <a class="wikilink" href="../../input_variables/rlx/#tolmxf">tolmxf</a> (this might not be the case for other physical properties)</li>
<li>there is no k point convergence study to be done for an isolated system in a big box: no additional information is gained by adding a k-point beyond one</li>
<li>the boxcut value is automatically chosen larger than 2 by ABINIT, see the determination of the input variable <a class="wikilink" href="../../input_variables/gstate/#ngfft">ngfft</a> by preprocessing</li>
<li>we are using <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>=2 for the determination of the geometry.</li>
</ul>
<p>For the check of convergence with respect to <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a>, you have the choice
between doing different runs of the tbase2_1.in file with different values of
<a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a>, or doing a double loop of datasets, as proposed in
~abinit/tests/tutorial/Input/tbase2_2.in . The values of <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> have been
chosen between 10Ha and 35Ha, by step of 5 Ha. If you want to make a double
loop, you might benefit of reading again the <a href="../../../users/generated_files/help_abinit.html#loop">double-loop
section</a> of the abinit_help
file.</p>
<p><strong>2.2.a</strong> You have likely seen a big increase of the CPU time needed to do the calculation. You should also look at the increase of the memory needed to do the calculation (go back to the beginning of the output file). The output data are as follows: </p>
<pre><code>    etotal11 -1.1058360644E+00
    etotal12 -4.7010531489E-01
    etotal21 -1.1218716100E+00
    etotal22 -4.7529731401E-01
    etotal31 -1.1291943792E+00
    etotal32 -4.7773586424E-01
    etotal41 -1.1326879404E+00
    etotal42 -4.7899908214E-01
    etotal51 -1.1346739190E+00
    etotal52 -4.7972721653E-01
    etotal61 -1.1359660026E+00
    etotal62 -4.8022016459E-01

     xcart11 -7.6091015760E-01  0.0000000000E+00  0.0000000000E+00
              7.6091015760E-01  0.0000000000E+00  0.0000000000E+00
     xcart12  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
     xcart21 -7.5104912643E-01  0.0000000000E+00  0.0000000000E+00
              7.5104912643E-01  0.0000000000E+00  0.0000000000E+00
     xcart22  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
     xcart31 -7.3977108831E-01  0.0000000000E+00  0.0000000000E+00
              7.3977108831E-01  0.0000000000E+00  0.0000000000E+00
     xcart32  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
     xcart41 -7.3304273322E-01  0.0000000000E+00  0.0000000000E+00
              7.3304273322E-01  0.0000000000E+00  0.0000000000E+00
     xcart42  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
     xcart51 -7.3001570260E-01  0.0000000000E+00  0.0000000000E+00
              7.3001570260E-01  0.0000000000E+00  0.0000000000E+00
     xcart52  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
     xcart61 -7.2955902118E-01  0.0000000000E+00  0.0000000000E+00
              7.2955902118E-01  0.0000000000E+00  0.0000000000E+00
     xcart62  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
</code></pre>
<p>The corresponding atomisation energies and interatomic distances are:</p>
<pre><code>ecut    atomisation   interatomic distance
(Ha)    energy (Ha)      (Bohr)

10       .1656          1.522
15       .1713          1.502
20       .1737          1.480
25       .1747          1.466
30       .1753          1.460
35       .1756          1.459
</code></pre>
<p>In order to obtain 0.2% relative accuracy on the bond length or atomisation
energy, one should use a kinetic cut-off energy of 30 Ha. We will keep in mind
this value for the final run.</p>
<p>Well, 30 Ha is a large kinetic energy cut-off! The pseudopotential that we are
using for Hydrogen is rather "hard" ...</p>
<hr />
<h3 id="_3"><a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p><strong>2.3 The convergence in acell</strong></p>
<p>The same technique as for <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> should be now used for the convergence in
<a class="wikilink" href="../../input_variables/basic/#acell">acell</a>. We will explore <a class="wikilink" href="../../input_variables/basic/#acell">acell</a> starting from <code>8 8 8</code> to <code>18 18 18</code>, by
step of <code>2 2 2</code>. We keep <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> 10 for this study. Indeed, it is a rather
general rule that there is little cross-influence between the convergence of
<a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> and the convergence of <a class="wikilink" href="../../input_variables/basic/#acell">acell</a>. The file
~abinit/tests/tutorial/Input/tbase2_3.in can be used as an example. The output
data (~abinit/tests/tutorial/Refs/tbase2_3.out) are as follows:</p>
<pre><code>    etotal11   -1.1188124709E+00
    etotal12   -4.8074164402E-01
    etotal21   -1.1058360838E+00
    etotal22   -4.7010531489E-01
    etotal31   -1.1039109527E+00
    etotal32   -4.6767804802E-01
    etotal41   -1.1039012868E+00
    etotal42   -4.6743724199E-01
    etotal51   -1.1041439411E+00
    etotal52   -4.6735895176E-01
    etotal61   -1.1042058281E+00
    etotal62   -4.6736729718E-01

     xcart11   -7.8330751426E-01  0.0000000000E+00  0.0000000000E+00
                7.8330751426E-01  0.0000000000E+00  0.0000000000E+00
     xcart12    0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
     xcart21   -7.6024281092E-01  0.0000000000E+00  0.0000000000E+00
                7.6024281092E-01  0.0000000000E+00  0.0000000000E+00
     xcart22    0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
     xcart31   -7.5428234893E-01  0.0000000000E+00  0.0000000000E+00
                7.5428234893E-01  0.0000000000E+00  0.0000000000E+00
     xcart32    0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
     xcart41   -7.5446921004E-01  0.0000000000E+00  0.0000000000E+00
                7.5446921004E-01  0.0000000000E+00  0.0000000000E+00
     xcart42    0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
     xcart51   -7.5384974520E-01  0.0000000000E+00  0.0000000000E+00
                7.5384974520E-01  0.0000000000E+00  0.0000000000E+00
     xcart52    0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
     xcart61   -7.5373336127E-01  0.0000000000E+00  0.0000000000E+00
                7.5373336127E-01  0.0000000000E+00  0.0000000000E+00
     xcart62    0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
</code></pre>
<p>The corresponding atomisation energies and interatomic distances are:</p>
<p>acell<br />
(Bohr)</p>
<p>|</p>
<p>atomisation<br />
energy (Ha)</p>
<p>|</p>
<p>interatomic distance<br />
(Bohr)  </p>
<p>---|---|---  </p>
<p>8</p>
<p>|</p>
<p>.1574</p>
<p>|</p>
<p>1.568  </p>
<p>10</p>
<p>|</p>
<p>.1656</p>
<p>|</p>
<p>1.522  </p>
<p>12</p>
<p>|</p>
<p>.1686</p>
<p>|</p>
<p>1.509  </p>
<p>14</p>
<p>|</p>
<p>.1691</p>
<p>|</p>
<p>1.510  </p>
<p>16</p>
<p>|</p>
<p>.1694</p>
<p>|</p>
<p>1.508  </p>
<p>18</p>
<p>|</p>
<p>.1695</p>
<p>|</p>
<p>1.508  </p>
<p>In order to reach 0.2% convergence on the interatomic distance, one needs <code>acell 12 12 12</code>. The atomisation energy needs <code>acell 14 14 14</code> to be converged
at that level. At <code>12 12 12</code>, the difference is <code>.0009 Ha=0.024eV</code>, which is
sufficiently small for practical purposes. We will use <code>acell 12 12 12</code> for
the final run.</p>
<p>For most solids the size of the unit cell will be smaller than that. We are
treating a lot of vacuum in this supercell! So, the H2 study, with this
pseudopotential, turns out to be not really easy. Of course, the number of
states to be treated is minimal! This allows to have reasonable CPU time
still.</p>
<hr />
<h3 id="24-the-final-calculation-in-local-spin-density-approximation"><strong>2.4 The final calculation in Local (Spin) Density Approximation.</strong><a class="headerlink" href="#24-the-final-calculation-in-local-spin-density-approximation" title="Permanent link">&para;</a></h3>
<p>We now use the correct values of both <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> and <a class="wikilink" href="../../input_variables/basic/#acell">acell</a>. Well, you should
modify the tbase2_3.in file to make a calculation with <code>acell 12 12 12</code> and
<code>ecut 30</code>. You can still use the double loop feature with <code>[[udtset]] 1 2</code>
(which reduces to a single loop), to minimize the modifications to the file.
The file ~abinit/tests/tutorial/Input/tbase2_4.in can be taken as an example
of input file, and ~abinit/tests/tutorial/Refs/tbase2_4.out as an example of
output file.</p>
<p>Since we are doing the calculation at a single (<a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a>, <a class="wikilink" href="../../input_variables/basic/#acell">acell</a>) pair, the
total CPU time is not as much as for the previous determinations of optimal
values through series calculations. However, the memory needs have still
increased a bit.</p>
<p>The output data are:</p>
<pre><code>    etotal11 -1.1329369190E+00
    etotal12 -4.7765320721E-01

     xcart11 -7.2594741339E-01  0.0000000000E+00  0.0000000000E+00
              7.2594741339E-01  0.0000000000E+00  0.0000000000E+00
     xcart12  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
</code></pre>
<ul>
<li>The corresponding atomisation energy is <code>0.1776 Ha = 4.833 eV</code></li>
<li>The interatomic distance is 1.452 Bohr. </li>
<li>These are our final data for the local (spin) density approximation. 
We have used <code>[[ixc]]=1</code> . Other expressions for the local (spin) density
approximation <code>[[ixc]]=2, 3 .. 7</code> are possible. The values 1, 2, 3 and 7
should give about the same results, since they all start from the XC energy of
the homogeneous electron gas, as determined by Quantum Monte Carlo
calculations.<br />
Other possibilities <code>[[ixc]]=4, 5, 6</code> are older local density functionals,
that could not rely on these data.</li>
</ul>
<hr />
<h3 id="25-the-use-of-the-generalized-gradient-approximation"><strong>2.5 The use of the Generalized Gradient Approximation.</strong><a class="headerlink" href="#25-the-use-of-the-generalized-gradient-approximation" title="Permanent link">&para;</a></h3>
<p>We will use the Perdew-Burke-Ernzerhof functional, proposed in Phys. Rev.
Lett. 77, 3865 (1996).</p>
<p>In principle, for GGA, one should use another pseudopotential than for LDA.
However, for the special case of Hydrogen, and in general pseudopotentials
with a very small core (including only the 1s orbital), pseudopotentials
issued from the LDA and from the GGA are very similar.</p>
<p>So, we will not change our pseudopotential. This will save us lot of time, as
we should not redo an <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> convergence test (ecut is often characteristic
of the pseudopotentials that are used in a calculation).</p>
<p>Independently of the pseudopotential, an <a class="wikilink" href="../../input_variables/basic/#acell">acell</a> convergence test should not
be done again, since the vacuum is treated similarly in LDA or GGA.</p>
<p>So, our final values within GGA will be easily obtained, by setting <a class="wikilink" href="../../input_variables/basic/#ixc">ixc</a> to
11 in the input file tbase2_4.in. See ~abinit/tests/tutorial/Input/tbase2_5.in
for an example.</p>
<pre><code>    etotal11 -1.1621428376E+00
    etotal12 -4.9869631917E-01

     xcart11 -7.1190611804E-01  0.0000000000E+00  0.0000000000E+00
              7.1190611804E-01  0.0000000000E+00  0.0000000000E+00
     xcart12  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
</code></pre>
<ul>
<li>The corresponding atomisation energy is <code>0.1648 Ha = 4.483 eV</code></li>
<li>The interatomic distance is <code>1.424 Bohr</code>. </li>
<li>
<p>These are our final data for the generalized gradient approximation. 
Once more, here are the experimental data:</p>
</li>
<li>
<p>bond length: 1.401 Bohr </p>
</li>
<li>atomisation energy: 4.747 eV 
In GGA, we are within 2% of the experimental bond length, but 5% of the
experimental atomisation energy. In LDA, we were within 4% of the experimental
bond length, and within 2% of the experimental atomisation energy.</li>
</ul>
<p><em>Do not forget that the typical accuracy of LDA and GGA varies with the class
of materials studied...</em></p></div>
        </div>

        <footer class="col-md-12">
<hr>

    <center>Abinit version 8.5.4</center>


    <center>Copyright &copy; 2017 The Abinit Group</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>
        <script>var base_url = '../..';</script>
        <!--
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        -->
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
        <script src="../../extra_javascript/abidocs.js"></script>

    <!--<script>var base_url = '../..';</script>
<script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>

<h1 id="search">Search Results</h1>

<form action="search.html">
  <input name="q" id="mkdocs-search-query" type="text" >
</form>

<div id="mkdocs-search-results">
  Sorry, page not found.
</div>
    -->

    </body>
</html>
