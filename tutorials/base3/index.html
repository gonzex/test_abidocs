<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="The Abinit group">
        <link rel="canonical" href="http://www.abinit.org/tutorials/base3/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Base3 - abinit</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/codehilite.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">
    
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">abinit</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../..">Introduction</a>
</li>
                            
<li >
    <a href="../../installation/">Installation</a>
</li>
                            
<li >
    <a href="../../user-guide/help_what_ABINIT_does/">Overview</a>
</li>
                            
<li >
    <a href="../../user-guide/help_abinit/">Abinit</a>
</li>
                            
<li >
    <a href="../../user-guide/help_mrgddb/">Mrgddb</a>
</li>
                            
<li >
    <a href="../../user-guide/help_optic/">Optic</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topics <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../topics/">Complete List</a>
</li>
                            
<li >
    <a href="../../topics/Artificial/">Artificial</a>
</li>
                            
<li >
    <a href="../../topics/AtomManipulator/">AtomManipulator</a>
</li>
                            
<li >
    <a href="../../topics/AtomTypes/">AtomTypes</a>
</li>
                            
<li >
    <a href="../../topics/Bader/">Bader</a>
</li>
                            
<li >
    <a href="../../topics/BandOcc/">BandOcc</a>
</li>
                            
<li >
    <a href="../../topics/Berry/">Berry</a>
</li>
                            
<li >
    <a href="../../topics/BSE/">BSE</a>
</li>
                            
<li >
    <a href="../../topics/ConstrainedPol/">ConstrainedPol</a>
</li>
                            
<li >
    <a href="../../topics/Control/">Control</a>
</li>
                            
<li >
    <a href="../../topics/Coulomb/">Coulomb</a>
</li>
                            
<li >
    <a href="../../topics/CRPA/">CRPA</a>
</li>
                            
<li >
    <a href="../../topics/crystal/">Crystal</a>
</li>
                            
<li >
    <a href="../../topics/Dev/">Dev</a>
</li>
                            
<li >
    <a href="../../topics/DFPT/">DFPT</a>
</li>
                            
<li >
    <a href="../../topics/DFT+U/">DFT+U</a>
</li>
                            
<li >
    <a href="../../topics/DMFT/">DMFT</a>
</li>
                            
<li >
    <a href="../../topics/EffMass/">EffMass</a>
</li>
                            
<li >
    <a href="../../topics/EFG/">EFG</a>
</li>
                            
<li >
    <a href="../../topics/Elastic/">Elastic</a>
</li>
                            
<li >
    <a href="../../topics/ElecBandStructure/">ElecBandStructure</a>
</li>
                            
<li >
    <a href="../../topics/ElecDOS/">ElecDOS</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonInt/">ElPhonInt</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonTransport/">ElPhonTransport</a>
</li>
                            
<li >
    <a href="../../topics/ForcesStresses/">ForcesStresses</a>
</li>
                            
<li >
    <a href="../../topics/FrequencyMeshMBPT/">FrequencyMeshMBPT</a>
</li>
                            
<li >
    <a href="../../topics/GeoConstraints/">GeoConstraints</a>
</li>
                            
<li >
    <a href="../../topics/GeoOpt/">GeoOpt</a>
</li>
                            
<li >
    <a href="../../topics/GW/">GW</a>
</li>
                            
<li >
    <a href="../../topics/GWls/">GWls</a>
</li>
                            
<li >
    <a href="../../topics/Hybrids/">Hybrids</a>
</li>
                            
<li >
    <a href="../../topics/">Home</a>
</li>
                            
<li >
    <a href="../../topics/k-points/">K points</a>
</li>
                            
<li >
    <a href="../../topics/LOTF/">LOTF</a>
</li>
                            
<li >
    <a href="../../topics/MagField/">MagField</a>
</li>
                            
<li >
    <a href="../../topics/MagMom/">MagMom</a>
</li>
                            
<li >
    <a href="../../topics/MolecularDynamics/">MolecularDynamics</a>
</li>
                            
<li >
    <a href="../../topics/multidtset/">Multidtset</a>
</li>
                            
<li >
    <a href="../../topics/nonlinear/">Nonlinear</a>
</li>
                            
<li >
    <a href="../../topics/Optic/">Optic</a>
</li>
                            
<li >
    <a href="../../topics/Output/">Output</a>
</li>
                            
<li >
    <a href="../../topics/parallelism/">Parallelism</a>
</li>
                            
<li >
    <a href="../../topics/PAW/">PAW</a>
</li>
                            
<li >
    <a href="../../topics/PhononBands/">PhononBands</a>
</li>
                            
<li >
    <a href="../../topics/Phonons/">Phonons</a>
</li>
                            
<li >
    <a href="../../topics/PhononWidth/">PhononWidth</a>
</li>
                            
<li >
    <a href="../../topics/PIMD/">PIMD</a>
</li>
                            
<li >
    <a href="../../topics/Planewaves/">Planewaves</a>
</li>
                            
<li >
    <a href="../../topics/positron/">Positron</a>
</li>
                            
<li >
    <a href="../../topics/printing/">Printing</a>
</li>
                            
<li >
    <a href="../../topics/PseudosPAW/">PseudosPAW</a>
</li>
                            
<li >
    <a href="../../topics/q-points/">Q points</a>
</li>
                            
<li >
    <a href="../../topics/RandStopPow/">RandStopPow</a>
</li>
                            
<li >
    <a href="../../topics/Recursion/">Recursion</a>
</li>
                            
<li >
    <a href="../../topics/RPACorrEn/">RPACorrEn</a>
</li>
                            
<li >
    <a href="../../topics/SCFAlgorithms/">SCFAlgorithms</a>
</li>
                            
<li >
    <a href="../../topics/SCFControl/">SCFControl</a>
</li>
                            
<li >
    <a href="../../topics/SelfEnergy/">SelfEnergy</a>
</li>
                            
<li >
    <a href="../../topics/SmartSymm/">SmartSymm</a>
</li>
                            
<li >
    <a href="../../topics/spinpolarisation/">Spinpolarisation</a>
</li>
                            
<li >
    <a href="../../topics/STM/">STM</a>
</li>
                            
<li >
    <a href="../../topics/Susceptibility/">Susceptibility</a>
</li>
                            
<li >
    <a href="../../topics/TDDFT/">TDDFT</a>
</li>
                            
<li >
    <a href="../../topics/TDepES/">TDepES</a>
</li>
                            
<li >
    <a href="../../topics/Temperature/">Temperature</a>
</li>
                            
<li >
    <a href="../../topics/TransPath/">TransPath</a>
</li>
                            
<li >
    <a href="../../topics/TuningSpeed/">TuningSpeed</a>
</li>
                            
<li >
    <a href="../../topics/UnitCell/">UnitCell</a>
</li>
                            
<li >
    <a href="../../topics/vdw/">Vdw</a>
</li>
                            
<li >
    <a href="../../topics/Wannier/">Wannier</a>
</li>
                            
<li >
    <a href="../../topics/Wavelets/">Wavelets</a>
</li>
                            
<li >
    <a href="../../topics/xc/">Xc</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Input Variables <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Abinit</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../input_variables/varlist_abinit/">All Variables</a>
</li>
            
<li >
    <a href="../../input_variables/basic/">Basic</a>
</li>
            
<li >
    <a href="../../input_variables/bse/">Bethe-Salpeter</a>
</li>
            
<li >
    <a href="../../input_variables/dev/">Developers</a>
</li>
            
<li >
    <a href="../../input_variables/dmft/">DMFT</a>
</li>
            
<li >
    <a href="../../input_variables/eph/">Electron-Phonon</a>
</li>
            
<li >
    <a href="../../input_variables/ffield/">Varff</a>
</li>
            
<li >
    <a href="../../input_variables/files/">File-handling</a>
</li>
            
<li >
    <a href="../../input_variables/geo/">Geometry</a>
</li>
            
<li >
    <a href="../../input_variables/gstate/">Ground-State</a>
</li>
            
<li >
    <a href="../../input_variables/gw/">GW</a>
</li>
            
<li >
    <a href="../../input_variables/internal/">Internal</a>
</li>
            
<li >
    <a href="../../input_variables/paral/">Parallelism</a>
</li>
            
<li >
    <a href="../../input_variables/paw/">PAW</a>
</li>
            
<li >
    <a href="../../input_variables/dfpt/">DFPT</a>
</li>
            
<li >
    <a href="../../input_variables/rlx/">Relaxation</a>
</li>
            
<li >
    <a href="../../input_variables/vdw/">VdW</a>
</li>
            
<li >
    <a href="../../input_variables/w90/">Wannier90</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../input_variables/anaddb/">Anaddb</a>
</li>
                            
<li >
    <a href="../../input_variables/optic/">Optic</a>
</li>
                            
<li >
    <a href="../../input_variables/aim/">Aim</a>
</li>
                            
<li >
    <a href="../../input_variables/varset_stats/">Statistics</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Lessons <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../welcome/">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Base Tutorials</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../base1/">Base1</a>
</li>
            
<li >
    <a href="../base2/">Base2</a>
</li>
            
<li class="active">
    <a href="./">Base3</a>
</li>
            
<li >
    <a href="../base4/">Base4</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">DFPT</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../rf1/">RF1</a>
</li>
            
<li >
    <a href="../rf2/">RF2</a>
</li>
            
<li >
    <a href="../elastic/">Elastic</a>
</li>
            
<li >
    <a href="../eph/">EPH</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../dmft/">DMFT</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Many-Body</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../gw1/">GW1</a>
</li>
            
<li >
    <a href="../gw2/">GW2</a>
</li>
            
<li >
    <a href="../bse/">Bethe-Salpeter</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Parallelism</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../basepar/">Base</a>
</li>
            
<li >
    <a href="../paral_mbt/">Many-Body</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Theory <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../theory/theory_mbt/">MBPT</a>
</li>
                            
<li >
    <a href="../../theory/additional_material/">Additional Material</a>
</li>
                            
<li >
    <a href="../../bibliography/">Bibliography</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../developers/README/">How to write docs</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../about/release-notes/">Release Notes</a>
</li>
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>
                            
<li >
    <a href="../../about/license/">License</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../base2/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../base4/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/abinit/abinit/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#31-computing-the-total-energy-of-silicon-at-fixed-number-of-k-points">** 3.1. Computing the total energy of silicon at fixed number of k points.</a></li>
        <li class="main "><a href="#32-starting-the-convergence-study-with-respect-to-k-points">3.2. Starting the convergence study with respect to k points</a></li>
        <li class="main "><a href="#33-actually-performing-the-convergence-study-with-respect-to-k-points">** 3.3. Actually performing the convergence study with respect to k points</a></li>
        <li class="main "><a href="#34-determination-of-the-lattice-parameters">3.4. Determination of the lattice parameters.</a></li>
        <li class="main "><a href="#35-computing-the-band-structure">3.5. Computing the band structure</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<!-- Return to Top -->

<p><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a>
This lesson aims at showing you how to get the following physical properties,
for an insulator:</p>
<ul>
<li>the total energy </li>
<li>the lattice parameter </li>
<li>the band structure (actually, the Kohn-Sham band structure) 
You will learn about the use of k-points, as well as the smearing of the
plane-wave kinetic energy cut-off.</li>
</ul>
<p>This lesson should take about 1 hour.</p>
<ul>
<li>3.1 Computing the total energy of silicon at fixed number of k points.</li>
<li>3.2 Starting the convergence study with respect to k points</li>
<li>3.3 Actually performing the convergence study with respect to k points</li>
<li>3.4 Determination of the lattice parameters</li>
<li>3.5 Computing the band structure</li>
</ul>
<hr />
<h3 id="31-computing-the-total-energy-of-silicon-at-fixed-number-of-k-points">** 3.1. Computing the total energy of silicon at fixed number of k points.<a class="headerlink" href="#31-computing-the-total-energy-of-silicon-at-fixed-number-of-k-points" title="Permanent link">&para;</a></h3>
<p>**</p>
<p><em>Before beginning, you might consider to work in a different subdirectory as
for lesson_base1 or lesson_base2 . Why not "Work3" ?</em></p>
<p>The file ~abinit/tests/tutorial/Input/tbase3_x.files lists the file names and
root names. You can copy it in the Work3 directory and change it as you did
for the tbase1_x.files and tbase2_x.files files. You can also copy the file
~abinit/tests/tutorial/Input/tbase3_1.in in Work3. This is your input file.
You should edit it, read it carefully, have a look at the following "new"
input variables, and their explanation :</p>
<ul>
<li><a class="wikilink" href="../../input_variables/basic/#rprim">rprim</a> </li>
<li><a class="wikilink" href="../../input_variables/basic/#xred">xred</a> (used instead of xcart) </li>
<li><a class="wikilink" href="../../input_variables/basic/#kptopt">kptopt</a>, <a class="wikilink" href="../../input_variables/basic/#ngkpt">ngkpt</a>, <a class="wikilink" href="../../input_variables/basic/#nshiftk">nshiftk</a>, <a class="wikilink" href="../../input_variables/basic/#shiftk">shiftk</a>, <a class="wikilink" href="../../input_variables/gstate/#kptrlatt">kptrlatt</a>, (not easy ... take your time !) </li>
<li><a class="wikilink" href="../../input_variables/gstate/#diemac">diemac</a> (compared to isolated molecules, another value is used, while <a class="wikilink" href="../../input_variables/gstate/#diemix">diemix</a> has been suppressed). </li>
</ul>
<p>Note also the following: you will work at fixed <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> (=8Ha). It is
implicit that in "real life", you should do a convergence test with respect to
<a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> ...<br />
Here, a suitable <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> is given to you. It will allow to obtain 0.2%
relative accuracy on lattice parameters.</p>
<p>When you have read the input file, you can run the code, as usual (it will run
for a few seconds).<br />
Then, read the output file, and note the total energy.</p>
<pre><code>   etotal   -8.8662238960E+00
</code></pre>
<hr />
<h3 id="32-starting-the-convergence-study-with-respect-to-k-points"><strong> 3.2. Starting the convergence study with respect to k points </strong><a class="headerlink" href="#32-starting-the-convergence-study-with-respect-to-k-points" title="Permanent link">&para;</a></h3>
<p>There is of course a convergence study associated with the sampling of the
Brillouin zone. You should examine different grids, of increasing resolution.
You might try the following series of grids:</p>
<pre><code>ngkpt1  2 2 2
ngkpt2  4 4 4
ngkpt3  6 6 6
ngkpt4  8 8 8
</code></pre>
<p>However, the associated number of k points in the irreducible Brillouin zone
grows very fast. It is</p>
<pre><code>nkpt1  2
nkpt2 10
nkpt3 28
nkpt4 60
</code></pre>
<p>ABINIT computes automatically this number of k points, from the definition of
the grid and the symmetries.<br />
You might nevertheless define an input nkpt value in the input file, in which
case ABINIT will compare its computed value (from the grid) with this input
value. We take this opportunity to examine the behaviour of ABINIT when a
problem is detected. Let's suppose that with <code>ngkpt1 4 4 4</code> , one mentions
<code>nkpt1 2</code> . The input file ~abinit/tests/tutorial/Input/tbase3_2.in is an
example. Do not forget to change tbase3_x.files, if you are using that file
name . The message that you get a few dozen of lines before the end of the log
file is :</p>
<pre><code>--- !BUG
message: |
    The argument nkpt=     2, does not match
      the number of k points generated by kptopt, kptrlatt, shiftk,
      and the eventual symmetries, that is, nkpt=    10.
      However, note that it might be due to the user,
      if nkpt is explicitely defined in the input file.
      In this case, please check your input file.
src_file: getkgrid.F90
src_line: 415
...

  Action : contact ABINIT group.
</code></pre>
<p>This is a typical ABINIT error message. It states what is the problem that
causes the stop of ABINIT, then suggests that it might be due to an error in
the input file, namely, an erroneous value of nkpt. The expected value,
<a class="wikilink" href="../../input_variables/basic/#nkpt">nkpt</a> 10. is mentioned before the notice that the input file might be
erroneous. Then, the file at which the problem occured is mentioned, as well
as the number of the line in that file.</p>
<p>As the computation of <a class="wikilink" href="../../input_variables/basic/#nkpt">nkpt</a> for specific grids of k points is not an easy
task, while the even more important selection of specific economical grids
(the best ratio between the accuracy of the integration in the Brillouin zone
and the number of k-points) is more difficult, some help to the user is
provided by ABINIT. ABINIT is able to examine automatically different k point
grids, and to propose the best grids for integration. This is described in the
abinit_help file, see the input variable <a class="wikilink" href="../../input_variables/files/#prtkpt">prtkpt</a>, and the associated
characterisation of the integral accuracy, described in <a class="wikilink" href="../../input_variables/gstate/#kptrlen">kptrlen</a>. The
generation of lists of k-point sets is done in different test cases, in the
directory ~abinit/tests/v2 . You can directly have a look at the output files
in ~abinit/tests/v2/Refs , the output files for the tests 61 to 73.</p>
<p>When one begins the study of a new material, it is strongly advised to examine
first the list of k points grids, and select (at least) three efficient ones,
for the k point convergence study. Do not forget that the CPU time will be
linearly proportional to the number of k points to be treated: using 10 k
points will take five more time than using 2 k points. Even for a similar
accuracy of the Brillouin zone integration (about the same value of
<a class="wikilink" href="../../input_variables/gstate/#kptrlen">kptrlen</a>), it might be easy to generate a grid that will fold to 10 k
points in the irreducible Brillouin zone, as well as one that will fold to 2 k
points in the irreducible Brillouin zone. The latter is clearly to be
preferred !</p>
<hr />
<h3 id="33-actually-performing-the-convergence-study-with-respect-to-k-points">** 3.3. Actually performing the convergence study with respect to k points<a class="headerlink" href="#33-actually-performing-the-convergence-study-with-respect-to-k-points" title="Permanent link">&para;</a></h3>
<p>**</p>
<p>In order to understand k-point grids, you should read the Monkhorst and Pack
paper, Phys. Rev. B 13, 5188 (1976) ... Well, maybe not immediately ... In the
meantime, you can try the above-mentioned convergence study.</p>
<p>The input file ~abinit/tests/tutorial/Input/tbase3_3.in is an example, while
~abinit/tests/tutorial/Refs/tbase3_3.out is a reference output file. In this
output file, you should have a look at the echo of input variables. As you
know, these are preprocessed, and, in particular, <a class="wikilink" href="../../input_variables/basic/#ngkpt">ngkpt</a> and <a class="wikilink" href="../../input_variables/basic/#shiftk">shiftk</a> are
used to generate the list of k points (<a class="wikilink" href="../../input_variables/basic/#kpt">kpt</a>) and their weights (<a class="wikilink" href="../../input_variables/basic/#wtk">wtk</a>).
You should read the information about <a class="wikilink" href="../../input_variables/basic/#kpt">kpt</a> and <a class="wikilink" href="../../input_variables/basic/#wtk">wtk</a>.</p>
<p>From the output file, here is the evolution of total energy per unit cell:</p>
<pre><code>    etotal1  -8.8662238960E+00
    etotal2  -8.8724909739E+00
    etotal3  -8.8726017432E+00
    etotal4  -8.8726056405E+00
</code></pre>
<p>The difference between dataset 3 and dataset 4 is rather small. Even the
dataset 2 gives an accuracy of about 0.0001 Ha<br />
So, our converged value for the total energy, at fixed <a class="wikilink" href="../../input_variables/basic/#acell">acell</a>, fixed
<a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a>, is -8.8726 Ha .</p>
<hr />
<h3 id="34-determination-of-the-lattice-parameters"><strong> 3.4. Determination of the lattice parameters. </strong><a class="headerlink" href="#34-determination-of-the-lattice-parameters" title="Permanent link">&para;</a></h3>
<p>The input variable <a class="wikilink" href="../../input_variables/rlx/#optcell">optcell</a> governs the automatic optimisation of cell
shape and volume.<br />
For the automatic optimisation of cell volume, use:</p>
<pre><code>optcell 1
ionmov 2
ntime 10
dilatmx 1.05
ecutsm 0.5
</code></pre>
<p>You should read the indications about <a class="wikilink" href="../../input_variables/rlx/#dilatmx">dilatmx</a> and <a class="wikilink" href="../../input_variables/rlx/#ecutsm">ecutsm</a>.<br />
Do not test all the k point grids, only those with nkpt 2 and 10.</p>
<p>The input file ~abinit/tests/tutorial/Input/tbase3_4.in is an example, while
~abinit/tests/tutorial/Refs/tbase3_4.out is a reference output file.  </p>
<p>You should obtain the following evolution of the lattice parameters:</p>
<pre><code>     acell1   1.0233363682E+01  1.0233363682E+01  1.0233363682E+01 Bohr
     acell2   1.0216447241E+01  1.0216447241E+01  1.0216447241E+01 Bohr
</code></pre>
<p>with the following very small residual stresses:</p>
<pre><code>    strten1   1.8591719160E-07  1.8591719160E-07  1.8591719160E-07
              0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
    strten2  -2.8279720007E-08 -2.8279720007E-08 -2.8279720007E-08
              0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
</code></pre>
<p>The stress tensor is given in Hartree/Bohr^3, and the order of the components
is</p>
<pre><code>                        11  22  33
                        23  13  12
</code></pre>
<p>There is only a 0.13% relative difference between <a class="wikilink" href="../../input_variables/basic/#acell">acell</a>1 and <a class="wikilink" href="../../input_variables/basic/#acell">acell</a>2 .<br />
So, our converged LDA value for Silicon, with the 14si.pspnc pseudopotential
(see the tbase3_x.files file) is 10.216 Bohr (actually 10.21644...), that is
5.406 Angstrom. The experimental value is <code>5.431 Angstrom at 25 degree
Celsius</code>, see R.W.G. Wyckoff, Crystal structures Ed. Wiley and sons, New-York
(1963).</p>
<hr />
<h3 id="35-computing-the-band-structure"><strong>3.5. Computing the band structure</strong><a class="headerlink" href="#35-computing-the-band-structure" title="Permanent link">&para;</a></h3>
<p>We fix the parameters <a class="wikilink" href="../../input_variables/basic/#acell">acell</a> to the theoretical value of 3*10.216, and we
fix also the grid of k points (the 4x4x4 FCC grid, equivalent to a 8x8x8
Monkhorst-pack grid)<br />
We will ask for 8 bands (4 valence and 4 conduction).</p>
<p>A band structure can be computed by solving the Kohn-Sham equation for many
different k points, along different lines of the Brillouin zone.<br />
The potential that enters the Kohn-Sham must be derived from a previous self-
consistent calculation, and will not vary during the scan of different k-point
lines.<br />
Suppose that you want to make a L-Gamma-X-(U-)Gamma circuit, with 10, 12 and
17 divisions for each line (each segment has a different length in reciprocal
space, and these divisions give approximately the same distance between points
along a line).<br />
The circuit will be obtained easily by the following choice of segment end
points:</p>
<pre><code>L     (1/2 0 0)
Gamma (0 0 0)
X     (0 1/2 1/2)
Gamma (1 1 1)
</code></pre>
<p>_Note:</p>
<ol>
<li>the last Gamma point is in another cell of the reciprocal space than the first one, this choice allows to construct the X-U-Gamma line easily ;</li>
<li>the k-points are specified using reduced coordinates - in agreement with the input setting of the primitive 2-atom unit cell - in standard textbooks, you will often find the L, Gamma or X point given in coordinates of the conventional 8-atom cell: the above-mentioned circuit is then (1/2 1/2 1/2)-(0 0 0)-(1 0 0)-(1 1 1), but such (conventional) coordinates cannot be used with the 2-atom (non-conventional) cell.</li>
</ol>
<p>_</p>
<p>So, you should set up in your input file, for the first dataset, a usual SCF
calculation in which you output the density (<a class="wikilink" href="../../input_variables/files/#prtden">prtden</a> 1), and, for the
second dataset:</p>
<ul>
<li>fix <a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a> to -2, to make a non-self-consistent calculation ; </li>
<li>define <a class="wikilink" href="../../input_variables/files/#getden">getden</a> -1, to take the output density of dataset 1 ; </li>
<li>set <a class="wikilink" href="../../input_variables/basic/#nband">nband</a> to 8 ; </li>
<li>set <a class="wikilink" href="../../input_variables/basic/#kptopt">kptopt</a> to -3, to define three segments in the brillouin Zone ; </li>
<li>set <a class="wikilink" href="../../input_variables/gstate/#ndivk">ndivk</a> to 10 12 17 (this means a circuit defined by 4 points, with 10 divisions of the first segment, 12 divisions of the second, 17 divisions of the third) </li>
<li>
<p>set <a class="wikilink" href="../../input_variables/gstate/#kptbounds">kptbounds</a> to </p>
<pre><code>                0.5  0.0  0.0 # L point
            0.0  0.0  0.0 # Gamma point
            0.0  0.5  0.5 # X point
            1.0  1.0  1.0 # Gamma point in another cell.
</code></pre>
</li>
<li>
<p>set <a class="wikilink" href="../../input_variables/gstate/#enunit">enunit</a> to 1, in order to have eigenenergies in eV </p>
</li>
<li>the only tolerance criterion admitted for non-self-consistent calculations is <a class="wikilink" href="../../input_variables/basic/#tolwfr">tolwfr</a>. You should set it to 1.0d-10 (or so), and suppress <a class="wikilink" href="../../input_variables/basic/#toldfe">toldfe</a>. </li>
</ul>
<p>The input file ~abinit/tests/tutorial/Input/tbase3_5.in is an example, while
~abinit/tests/tutorial/Refs/tbase3_5.out is a reference output file.</p>
<p>You should find the band structure starting at (second dataset):</p>
<pre><code> Eigenvalues (   eV  ) for nkpt=  40  k points:
 kpt#   1, nband=  8, wtk=  1.00000, kpt=  0.5000  0.0000  0.0000 (reduced coord)
  -3.78815  -1.15872   4.69668   4.69668   7.38795   9.23867   9.23867  13.45707
 kpt#   2, nband=  8, wtk=  1.00000, kpt=  0.4500  0.0000  0.0000 (reduced coord)
  -3.92759  -0.95774   4.71292   4.71292   7.40692   9.25561   9.25561  13.48927
 kpt#   3, nband=  8, wtk=  1.00000, kpt=  0.4000  0.0000  0.0000 (reduced coord)
  -4.25432  -0.44393   4.76726   4.76726   7.46846   9.31193   9.31193  13.57737
 kpt#   4, nband=  8, wtk=  1.00000, kpt=  0.3500  0.0000  0.0000 (reduced coord)
  -4.64019   0.24941   4.85732   4.85732   7.56855   9.38323   9.38323  13.64601
 ....
</code></pre>
<p>One needs a graphical tool to represent all these data ... (For the MAPR 2451
lecture: try with MATLAB). In a separate file (_EIG), you will find the list
of k-points and eigenenergies (the input variable <a class="wikilink" href="../../input_variables/files/#prteig">prteig</a> is set by default
to 1).</p>
<p>Even without a graphical tool we will have a quick look at the values at L,
Gamma, X and Gamma again:</p>
<pre><code> kpt#   1, nband=  8, wtk=  1.00000, kpt=  0.5000  0.0000  0.0000 (reduced coord)
  -3.78815  -1.15872   4.69668   4.69668   7.38795   9.23867   9.23867  13.45707

 kpt#  11, nband=  8, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced coord)
  -6.17005   5.91814   5.91814   5.91814   8.44836   8.44836   8.44836   9.17755

 kpt#  23, nband=  8, wtk=  1.00000, kpt=  0.0000  0.5000  0.5000 (reduced coord)
  -1.96393  -1.96393   3.00569   3.00569   6.51173   6.51173  15.95524  15.95524

 kpt#  40, nband=  8, wtk=  1.00000, kpt=  1.0000  1.0000  1.0000 (reduced coord)
  -6.17005   5.91814   5.91814   5.91814   8.44836   8.44836   8.44836   9.17755
</code></pre>
<p>The last gamma is exactly equivalent to the first gamma. It can be checked
that the top of the valence band is obtained at Gamma (=5.91814 eV). The width
of the valence band is 12.09 eV, the lowest unoccupied state at X is 0.594 eV
higher than the top of the valence band, at Gamma. The Si is described as an
indirect band gap material (this is correct), with a band-gap of about 0.594
eV (this is quantitatively quite wrong: the experimental value 1.17 eV is at
25 degree Celsius). The minimum of the conduction band is even slightly
displaced with respect to X, see kpt # 21 . This underestimation of the band
gap is well-known (the famous DFT band-gap problem). In order to obtain
correct band gaps, you need to go beyond the Kohn-Sham Density Functional
Theory: use the GW approximation. This is described in <a href="../lesson_gw1.html">the first lesson on
the GW approximation</a>.</p>
<p>For experimental data and band structure representation, see<br />
M.L. Cohen and J.R. Chelikowski<br />
Electronic structure and optical properties of semiconductors<br />
Springer-Verlag New-York (1988).</p>
<p>There is a subtlety that is worth to comment about. In non-self-consistent
calculations, like those performed in the present band structure calculation,
with <a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a>=-2, not all bands are converged within the tolerance <a class="wikilink" href="../../input_variables/basic/#tolwfr">tolwfr</a>.
Indeed, the two upper bands (by default) have not been taken into account to
apply this convergence criterion: they constitute a "buffer". The number of
such "buffer" bands is governed by the input variable <a class="wikilink" href="../../input_variables/gstate/#nbdbuf">nbdbuf</a>.</p>
<p>It can happen that the highest (or two highest) band(s), if not separated by a
gap from non-treated bands, can exhibit a very slow convergence rate. This
buffer allows to achieve convergence of "important", non-buffer bands. In the
present case, 6 bands have been converged with a residual better than
<a class="wikilink" href="../../input_variables/basic/#tolwfr">tolwfr</a>, while the two upper bands are less converged (still sufficiently
for graphical representation of the band structure). In order to achieve the
same convergence for all 8 bands, it is advised to use <a class="wikilink" href="../../input_variables/basic/#nband">nband</a>=10 (that is,
8 + 2).</p></div>
        </div>

        <footer class="col-md-12">
<hr>

    <center>Abinit version 8.5.4</center>


    <center>Copyright &copy; 2017 The Abinit Group</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>
        <script>var base_url = '../..';</script>
        <!--
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        -->
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
        <script src="../../extra_javascript/abidocs.js"></script>

    <!--<script>var base_url = '../..';</script>
<script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>

<h1 id="search">Search Results</h1>

<form action="search.html">
  <input name="q" id="mkdocs-search-query" type="text" >
</form>

<div id="mkdocs-search-results">
  Sorry, page not found.
</div>
    -->

    </body>
</html>
