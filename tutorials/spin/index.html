
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="http://www.abinit.org/tutorials/spin/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="shortcut icon" href="../../images/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.8.1">
    
    
      
        <title>Spin - abinit</title>
      
    
    

    
      <script src="../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}",
                  kq: "{\\kk + \\qq}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Load Ubuntu fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    <!-- 
    https://github.com/daneden/animate.css
    <link rel="stylesheet"
     href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    -->

    <!-- 
    https://github.com/IanLunn/Hover
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hover.css/2.1.1/css/hover-min.css" />
    -->



    
      <link rel="stylesheet" href="../../assets/stylesheets/application-bfecc7305d.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-02c2a4388f.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">

      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="http://www.abinit.org" title="abinit" class="md-logo md-header-nav__button">
            <img src="../../images/abinit_logo.png" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Lessons
                </span>
              
                <span class="md-header-nav__parent">
                  Base Tutorials
                </span>
              
            
            Spin
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      

      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.5.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
            <li><a href="#">8.2.0</a></li>
            
            <li><a href="#">8.1.0</a></li>
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../welcome/" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/wavefunctions/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../images/abinit_logo.png">
      </i>
    
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/help_what_ABINIT_does/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/new_user/" title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/" title="Topic List" class="md-nav__link">
      Topic List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../variables/connections/" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../welcome/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked>
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Spin
      </label>
    
    <a href="./" title="Spin" class="md-nav__link md-nav__link--active">
      Spin
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#properties-related-to-spin-spin-polarized-calculations-ferro-ferri-magnetic-materials-and-spin-orbit-coupling" title="Properties related to spin (spin polarized calculations, ferro- ferri- magnetic materials, and spin-orbit coupling)." class="md-nav__link">
    Properties related to spin (spin polarized calculations, ferro- ferri- magnetic materials, and spin-orbit coupling).
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-a-ferromagnetic-material-bcc-fe" title="1 A ferromagnetic material: bcc Fe" class="md-nav__link">
    1 A ferromagnetic material: bcc Fe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-an-antiferromagnetic-example-fcc-fe" title="2 An antiferromagnetic example: fcc Fe" class="md-nav__link">
    2 An antiferromagnetic example: fcc Fe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-another-look-at-fcc-fe" title="3 Another look at fcc Fe" class="md-nav__link">
    3 Another look at fcc Fe
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#properties-related-to-spin-spin-polarized-calculations-ferro-ferri-magnetic-materials-and-spin-orbit-coupling" title="Properties related to spin (spin polarized calculations, ferro- ferri- magnetic materials, and spin-orbit coupling)." class="md-nav__link">
    Properties related to spin (spin polarized calculations, ferro- ferri- magnetic materials, and spin-orbit coupling).
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-a-ferromagnetic-material-bcc-fe" title="1 A ferromagnetic material: bcc Fe" class="md-nav__link">
    1 A ferromagnetic material: bcc Fe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-an-antiferromagnetic-example-fcc-fe" title="2 An antiferromagnetic example: fcc Fe" class="md-nav__link">
    2 An antiferromagnetic example: fcc Fe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-another-look-at-fcc-fe" title="3 Another look at fcc Fe" class="md-nav__link">
    3 Another look at fcc Fe
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                
                <h1 id="lesson-about-the-spin">Lesson about the spin<a class="headerlink" href="#lesson-about-the-spin" title="Permanent link">&para;</a></h1>
<h2 id="properties-related-to-spin-spin-polarized-calculations-ferro-ferri-magnetic-materials-and-spin-orbit-coupling">Properties related to spin (spin polarized calculations, ferro- ferri- magnetic materials, and spin-orbit coupling).<a class="headerlink" href="#properties-related-to-spin-spin-polarized-calculations-ferro-ferri-magnetic-materials-and-spin-orbit-coupling" title="Permanent link">&para;</a></h2>
<p>This lesson aims at showing how to get the following physical properties:</p>
<ul>
<li>
<p>the total magnetization of a ferromagnetic material  </p>
</li>
<li>
<p>the magnetization of an antiferromagnetic material  </p>
</li>
<li>
<p>analyse the total density of states per spin direction    </p>
</li>
<li>
<p>analyse the density of states per atom and per spin direction  </p>
</li>
<li>
<p>look at the effect of spin-orbit coupling for a non magnetic system  </p>
</li>
<li>
<p>non-collinear magnetism (not yet)</p>
</li>
<li>spin-orbit coupling and magnetocristalline anisotropy (not yet)</li>
</ul>
<p>You will learn to use of  features of ABINIT which deal with spin.  </p>
<p>This lesson should take about 1.5 hour.</p>
<h2 id="1-a-ferromagnetic-material-bcc-fe">1 A ferromagnetic material: <em>bcc</em> Fe<a class="headerlink" href="#1-a-ferromagnetic-material-bcc-fe" title="Permanent link">&para;</a></h2>
<p>_Before beginning, you might consider to work in a different subdirectory as
for the other lessons. Why not &ldquo;Work_spin&rdquo; (so
~abinit/tests/tutorial/Input/Work_spin) ? _  </p>
<p>The file ~abinit/tests/tutorial/Input/tspin_x.files lists the file names and
root names. You can copy it in the Work_spin directory (and change it, when
needed, as usual).<br />
You can also copy the file ~abinit/tests/tutorial/Input/tspin_1.in in
Work_spin. This is your input file. You can run the calculation, then you
should edit the input file, and read it carefully.<br />
Because we are going to perform magnetic calculations, there a two new types
of variables:  </p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/basic#nsppol">nsppol</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a></li>
</ul>
<p>Please, read their description in the help file.<br />
You will work at fixed <a class="wikilink codevar-wikilink" href="../../variables/basic#ecut">ecut</a> (=18Ha) and k-point grid, defined by <a class="wikilink codevar-wikilink" href="../../variables/basic#ngkpt">ngkpt</a>
(the 4x4x4 Monkhorst-Pack grid). It is implicit that in &ldquo;real life&rdquo;, you
should do a convergence test with respect to both convergence parameters.<br />
This takes about 12 seconds on a modern PC (one needs a sufficiently large
cut-off to exhibit magnetic effects).<br />
We will compare the output with and without magnetization. (Hence, there are
two datasets in the run)<br />
We now look at the output file.<br />
In the magnetic case, the electronic density is split in two parts, the &ldquo;Spin-
up&rdquo; and the &ldquo;Spin-down&rdquo; parts to which correspond different Kohn-Sham
potentials and different sets of eigenvalues whose occupation are given by the
Fermi-Dirac function (without the ubiquitous factor 2)  </p>
<p>For the first k-point, we get for instance:<br />
(no magnetization)<br />
       occ     2.00000   1.99989   1.99989   1.22915   1.22915   0.28676   0.00000   0.00000<br />
(magnetic case)<br />
       occ   1.00000   0.99999   0.99999   0.98396   0.98396   0.69467   0.00000   0.00000 (spin-up)<br />
             1.00000   0.99730   0.99730   0.00898   0.00898   0.00224   0.00000   0.00000 (spin-down)  </p>
<p>We note that the occupation are very different for up and down spins, which
means that the eigenvalues are shifted which is in turn due to a shift of the
exchange-correlation potential, and therefore of the effective potential. You
can indeed have a look at the output file to compare spin-up and down
eigenvalues:  </p>
<p>-0.48411  -0.38615  -0.38615  -0.30587  -0.30587  -0.27293   0.33747   0.33747 (up, kpt#1)<br />
-0.46638  -0.32383  -0.32383  -0.21767  -0.21767  -0.20371   0.36261   0.36261 (dn, kpt#1)  </p>
<p>The magnetization density (in unit of mu_B - Bohr&rsquo;s magneton) is the
difference between the up and down densities. The magnetization density,
divided by the total density is noted &ldquo;zeta&rdquo;. This quantity &ldquo;zeta&rdquo; can vary
between -1 and 1. It is everywhere zero in the non-magnetic case. In the
magnetic case, we can read for instance its minimal and maximal values in the
output file:  </p>
<p>Min spin pol zeta= -4.8326E-02 at reduced coord.  0.7222  0.5000  0.2222<br />
     next min= -4.8326E-02 at reduced coord.  0.5000  0.7222  0.2222<br />
Max spin pol zeta=  5.7306E-01 at reduced coord.  0.0000  0.8889  0.8889<br />
     next max=  5.7306E-01 at reduced coord.  0.8889  0.0000  0.8889  </p>
<p>The total magnetization, its integral on the unit cell, is now in the magnetic
case:  </p>
<p>Magnetization (Bohr magneton)=  1.96743463E+00<br />
 Total spin up =  4.98371731E+00   Total spin down =  3.01628269E+00  </p>
<p>We observe that the total density (up+down) yields 8.000 as expected.  </p>
<p>The magnetization density is not the only changed quantity. The energy is
changed too, and we get:  </p>
<div class="codehilite"><pre><span></span>etotal1  -2.4661707268E+01  (no magnetization)  
etotal2  -2.4670792868E+01  (with magnetization)
</pre></div>


<p>The energy of the magnetized system is the lowest and therefore energetically
favoured, as expected since bcc iron is a ferromagnet.<br />
Finally, one notes also that the stress tensor is affected by the
magnetization. This would also be true for  the forces for a less symmetric
material.  </p>
<p>It is interesting to consider in more details the distribution of eigenvalues
for each direction of magnetization, which is best done by looking at the
respective densities of state.<br />
To this end we have set <a class="wikilink codevar-wikilink" href="../../variables/files#prtdos">prtdos</a>= 1 in the input file, in order to obtain
the density of states corresponding to spin-up and spin-down electrons (as
soon as <a class="wikilink codevar-wikilink" href="../../variables/basic#nsppol">nsppol</a>=2).<br />
The values of the DOS are in the files tspin_1o_DS1_DOS and tspin_1o_DS2_DOS
for the magnetic and non magnetic case respectively. We can extract the values
for use in a plotting software.<br />
Traditionally, in order to enhance visibility, one affects with a negative
sign the DOS of  minority  electrons. If we compare the <a href="../../documents/lesson_spin/bccfe_mag_dos2.jpg">DOS of the
magnetized</a> system and the <a href="../../documents/lesson_spin/bccfe_nonmag_dos2.jpg">non
magnetized</a> system, we observe
that the up and down DOS have been  &ldquo;shifted&rdquo; with respect each other.<br />
The integrated density of states yields the number of electrons for each spin
direction and we see the magnetization which arises from the fact that there
are more up than down electrons at the Fermi level.  </p>
<p>That the magnetization points upwards is fortuitous, and we can get it
pointing downwards by changing the sign of the initial <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a>.<br />
Indeed, in the absence of spin-orbit coupling, there is no relation between
the direction of magnetization and the cristal axes.<br />
If we start with a <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a> of 0, the magnetization remains 0. <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a>
gives indeed a way to initially break the spin symmetry.  </p>
<h2 id="2-an-antiferromagnetic-example-fcc-fe">2 An antiferromagnetic example: <em>fcc</em> Fe<a class="headerlink" href="#2-an-antiferromagnetic-example-fcc-fe" title="Permanent link">&para;</a></h2>
<p>Well sort of....  </p>
<p>Actually, fcc Fe, displays many complicated structures, in particular spin
spirals. A spiral is characterized by a direction along an axis, an angle of
the magnetization with respect to this axis and a step after which a rotation
is complete.<br />
A very simple particular case is when the angle is 90, the axis is
&lt;100&gt; and the step is the unit cell side, spin directions are
alternating in every two planes perpendicular to the &lt;100&gt; axis (&ldquo;spiral
stairway&rdquo;)<br />
For instance, if the atom at [x,y,0] possesses an &ldquo;up&rdquo; magnetization, the atom
at [x,y,&frac12;] would possess a down magnetization etc&hellip;<br />
To describe such a structure, we merely need two atoms, [0,0,0] and
[&frac12;,0,&frac12;] and a unit cell comprising those two atoms.<br />
Also, each atom will be given opposite magnetization with the help of the
variable <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a>.  </p>
<p>You can copy the file ~abinit/tests/tutorial/Input/tspin_2.in in Work_spin.
This is your input file. Modify accordingly the tspin_x.files file. You can
run the calculation, then you should edit the tspin_2.in file, and briefly
look at the two changes with respect to the file tspin_1.in: the change of
unit cell basis vectors <a class="wikilink codevar-wikilink" href="../../variables/basic#rprim">rprim</a>, the new <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a>.  </p>
<p>Note also we use now <a class="wikilink codevar-wikilink" href="../../variables/basic#nsppol">nsppol</a>=1 and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nspden">nspden</a>=2: this combination of values
is only valid when performing an antiferromagnetic calculation (nspden=2 means
that we have 2 independent components for the charge density while nsppol=1
means that we have 1 independent component for the wave-functions).<br />
In that case, ABINIT uses the so-called Shubnikov symmetries, to perform
calculations twice faster than with <a class="wikilink codevar-wikilink" href="../../variables/basic#nsppol">nsppol</a>=2 and <a class="wikilink codevar-wikilink" href="../../variables/gstate#nspden">nspden</a>=2. The
symmetry of the crystal is not the full fcc symmetry anymore since the
symmetry must now preserve the magnetization of each atom.  ABINIT is
nevertheless able to detect such symmetry belonging to the Shubnikov groups
and correctly detects that the cell is primitive, which would not be the case
if we had the same value of <a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a> on each atom.  </p>
<p>If we now run again the calculation, this total computation time is
approximately 30 seconds on a recent CPU.<br />
If we look at the eigenvalues and occupations, they are again affected by a
factor 2, which results from the symmetry considerations alluded to above, and
not from the &ldquo;usual&rdquo; spin degeneracy : the potential for spin-up is equal to
the potential for spin-down, shifted by the antiferromagnetic translation
vector. Eigenenergies are identical for spin-up and spin-down, but
wavefunctions are shifted one with respect to the other.  </p>
<p>kpt#   1, nband= 16, wtk=  0.05556, kpt=  0.0833  0.0833  0.1250 (reduced
coord)<br />
  -0.60539  -0.47491  -0.42613  -0.39022  -0.35974  -0.34377  -0.28895  -0.28828<br />
  -0.25314  -0.24042  -0.22943  -0.14218   0.20264   0.26203   0.26641   0.62158<br />
      occupation numbers for kpt#   1<br />
   2.00000   2.00000   2.00000   1.99997   1.99945   1.99728   1.50632
1.48106<br />
   0.15660   0.04652   0.01574   0.00000   0.00000   0.00000   0.00000
0.00000  </p>
<p>How do we know we have a magnetic order?<br />
The  density of state used for bcc Fe will not be useful since the net
magnetization is zero and we have as many up and down electrons.<br />
Though, the magnetization is reflected in the existence of an up and down
electronic density whose sum is the total density and whose difference yields
the net magnetization density at each point in real space.  </p>
<p>In particular, the integral of the magnetization around each atom will give an
indication of the magnetic moment carried by this particular atom. A first
estimation is printed out by ABINIT. You can read:<br />
 Integrated total density in atomic spheres:<br />
 -------------------------------------------<br />
 Atom  Sphere radius  Integrated_up_density  Integrated_dn_density
Total(up+dn)   Diff(up-dn)<br />
    1        2.00000             3.32789225             2.99093607    6.31882832    0.33695617<br />
    2        2.00000             2.98670724             3.32364305    6.31035029   -0.33693581<br />
 Note: Diff(up-dn) can be considered as a rough approximation of a local
magnetic moment.  </p>
<p>and obtain a rough estimation of the magnetic moment of each atom (strongly
dependent on the radius used to project the charge density):  </p>
<p>magnetization of atom 1= 0.33696<br />
magnetization of atom 2=-0.33693  </p>
<p>But here we want more precise results&hellip;<br />
To perform the integration, we will use the utility cut3d which yields an
interpolation of the magnetization at any point in space. cut3d is one of the
executables of the ABINIT package and should be installed together with
abinit.<br />
As of now cut3d is interactive, we will use it through a very primitive script
(written in Python) to perform a rough estimate of the magnetization on each
atom.<br />
You can have a look at the
~abinit/doc/tutorial/documents/lesson_spin/magnetization.py program, and note
(or believe) that it does perform an integration of magnetization on a cube of
side acell/2 around each atom; if applicable, you might consider to adjust the
value of &ldquo;CUT3D&rdquo; string in the Python script.  </p>
<p>Copy it in your Work_spin directory. If you run the program, by typing &ldquo;python
magnetization.py&rdquo; , you will see the result:  </p>
<p>magnetization of atom 1= 0.38212<br />
magnetization of atom 2=-0.38203  </p>
<p>which shows that the magnetization of each atom are actually opposite.<br />
With the next input file tspin_3.in, we will consider this same problem, but
in a different way, and note, for future record that the total energy is:
Etotal=-4.92489592898935E+01  </p>
<h2 id="3-another-look-at-fcc-fe">3 Another look at <em>fcc</em> Fe<a class="headerlink" href="#3-another-look-at-fcc-fe" title="Permanent link">&para;</a></h2>
<p>Instead of treating fcc Fe directly as an antiferromagnetic material, we will
not make any hypotheses on its magnetic structure, and run the calculation
like the one for fcc Fe, anticipating only that the two spin directions are
going to be different.<br />
We will not even assume that the initial spins are of the same magnitude.  </p>
<p>You can copy the file ~abinit/tests/tutorial/Input/tspin_3.in in Work_spin.
This is your input file. You can modify the file tspin_x.files and immediately
start running the calculation. Then, you should edit it. Note the values of
<a class="wikilink codevar-wikilink" href="../../variables/gstate#spinat">spinat</a>. In this job, we wish again to characterize the magnetic structure.<br />
We are not going to use zeta as in the preceding calculation, but we will here
use another feature of abinit: atom and angular momentum projected densities
of state.<br />
These are densities of state weighted by the projection of the wave functions
on angular momentum channels (that is spherical harmonics) centered on each
atom of the system.<br />
Note that theses DOS are computed with the tetrahedron method, which is rather
time consuming and produces less smooth DOS than the smearing method. The time
is strongly dependent on the number of kpoints and we use here only a reduced
set.<br />
(This will take about 1.5 minutes on a modern computer)  </p>
<p>To specify this calculation we need new variables, in addition to <a class="wikilink codevar-wikilink" href="../../variables/files#prtdos">prtdos</a>
set now to 3 :  </p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#natsph">natsph</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#iatsph">iatsph</a></li>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#ratsph">ratsph</a></li>
</ul>
<p>This will specify the atoms around which the calculation will be performed,
and the radius of the sphere.<br />
We specifically select a new dataset for each atom, a non self-consistent
calculation being run to generate the projected density of states.<br />
First, we note that the value of the energy is: Etotal=-4.92489557316370E+01,
which shows that we have attained presumably the same state as above.  </p>
<p>The density of states will be in the files tspin_3o_DS2_DOS_AT0001 for the
first atom, and tspin_3o_DS3_DOS_AT0002 for the second atom.<br />
We can extract the density of d states, which carries most of the magnetic
moment and whose integral up to the Fermi level will yield an estimate of the
magnetization on each atom. We note the Fermi level (recalled in the file
tspin_3o_DS1_DOS):  </p>
<p>Fermi energy :      -0.28270392  </p>
<p>If we have a look at the integrated site projected density of states, we can
compute the total moment on each atom. To this end, one can open the file
tspin_3o_DS3_DOS_AT0002, which contains information pertaining to atom 2. This
file is self-documented, and describes on each line, for spin up and spin
down:  </p>
<h1 id="energyha-l0-l1-l2-l3-l4-integral-l0-l1-l2">energy(Ha)  l=0   l=1   l=2   l=3   l=4    (integral=&gt;)  l=0   l=1   l=2<a class="headerlink" href="#energyha-l0-l1-l2-l3-l4-integral-l0-l1-l2" title="Permanent link">&para;</a></h1>
<p>l=3   l=4  </p>
<p>If we look for the lines containing  an energy of &ldquo;-0.28250&rdquo;,  we find  </p>
<p>up   -0.28250   0.8026   2.6082  23.3966   0.7727   0.1687       0.30    0.34
3.42    0.04    0.01<br />
dn   -0.28250   0.3381   1.8716  24.0456   0.3104   0.1116       0.30    0.33
2.74    0.04    0.01  </p>
<p>There are apparently changes in the densities of states for all the channels,
but besides the d-channels, these are indeed fluctuations. This is confirmed
by looking at the integrated density of states which is different only for the
d-channel. The difference between up and down is 0.68, in rough agreement
(regarding our very rude methods of integration) with the previous
calculation. Using a calculation with the same number of k points for the
projected DOS, we can <a href="../../documents/lesson_spin/energy_diff_fccfe.jpg">plot</a>
the up-down integrated dos difference for the d-channel. Note that there is
some scatter in this graph, due to the finite number of digits (2 decimal
places) of the integrated dos given in the file tspin_3o_DS3_DOS_AT0002.  </p>
<p>If we now look at the up and down DOS for each atom, we can see that the
corner atom and the face atom possess opposite magnetizations, which roughly
cancel each other. The density of states computed with the tetrahedron method
is not as smooth as by the smearing method, and a running average allows for a
better view.  </p>
<h2 id="4-ferrimagnetic-not-yet">4 Ferrimagnetic (not yet)<a class="headerlink" href="#4-ferrimagnetic-not-yet" title="Permanent link">&para;</a></h2>
<p>Some materials can display a particular form of ferromagnetism, which also can
be viewed as non compensated antiferromagnetism, called ferrimagnetism.<br />
Some atoms possess up spin and other possess down spin, but the total spin
magnetization is non zero.<br />
This happens generally for system with different type of atoms, and sometimes
in rather complicated structures such as the magnetite.  </p>
<h2 id="5-the-spin-orbit-coupling">5 The spin-orbit coupling<a class="headerlink" href="#5-the-spin-orbit-coupling" title="Permanent link">&para;</a></h2>
<p>For heavy atoms a relativistic description of the electronic structure becomes
necessary, and this can be accomplished through the relativistic LDA
approximation.</p>
<h3 id="51-norm-conserving-pseudo-potentials">5.1 Norm-conserving pseudo-potentials<a class="headerlink" href="#51-norm-conserving-pseudo-potentials" title="Permanent link">&para;</a></h3>
<h3 id="for-atoms-the-dirac-equation-is-solved-and-the-22l1-l-channel">For atoms, the Dirac equation is solved and the 2(2l+1) l-channel<a class="headerlink" href="#for-atoms-the-dirac-equation-is-solved-and-the-22l1-l-channel" title="Permanent link">&para;</a></h3>
<p>degeneracy is lifted according to the eigenvalues of the L+S operator (l+&frac12;
and l-&frac12; of degeneracy 2l+2 and 2l). After pseudization, the  associated wave
functions can be recovered by adding to usual pseudo-potential projectors a
spin-orbit term of the generic form v(r).|l,s&gt;L.S&lt;l,s|. Not all
potentials include this additional term, but it turns out that it is the case
for all the HGH type pseudopotentials.</p>
<h3 id="in-a-plane-wave-calculation-the-wavefunctions-will-be-two-components">In a plane wave calculation, the wavefunctions will be two components<a class="headerlink" href="#in-a-plane-wave-calculation-the-wavefunctions-will-be-two-components" title="Permanent link">&para;</a></h3>
<p>spinors, that is will have a spin-up and a spin-down component but these
components will be coupled. This mean the size of the Hamiltonian matrix is
quadrupled.</p>
<h3 id="we-will-consider-here-a-heavier-atom-than-iron-tantalum">We will consider here a heavier atom than Iron: Tantalum.<a class="headerlink" href="#we-will-consider-here-a-heavier-atom-than-iron-tantalum" title="Permanent link">&para;</a></h3>
<p>You will have to change the &ldquo;files&rdquo; file accordingly, as we here have used the
potential: 73ta.hghsc. It is a HGH pseudopotential, with semicore states.
Replace the last line of the tspin_x.files by</p>
<h3 id="_1"><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="cp">../../../Psps_for_tests/73ta.hghsc</span>
</pre></div>


<p>You can copy the file ~abinit/tests/tutorial/Input/tspin_5.in in Work_spin.
Change accordingly the file names in tspin_x.files, then run the calculation.
It takes about 20 secs on a recent computer.<br />
The input file contains one new variable:  </p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/gstate#nspinor">nspinor</a></li>
</ul>
<p>Have a look at it. You should also look at <a class="wikilink codevar-wikilink" href="../../variables/gstate#so_psp">so_psp</a>; it is not used here,
meaning that the SO information is directly read from the pseudopotential
file.  </p>
<p>In this run, we check that we recover the splitting of the atomic level by
performing a calculation in a big box. Two calculations are launched with and
without spin-orbit.  </p>
<p>We can easily follow the symmetry of the different levels of the non spin
orbit calculation:<br />
  kpt#   1, nband= 26, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced
coord)<br />
-2.44760  <br />
-1.46437  -1.46437  -1.46437  <br />
-0.17045  <br />
-0.10852  -0.10852  -0.10852  -0.10740  -0.10740  </p>
<p>That is, the symmetry: s, p, s, d  </p>
<p>After application of the spin-orbit coupling, we now have to consider twice as
many levels:<br />
 kpt#   1, nband= 26, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced
coord)<br />
-2.43258  -2.43258  <br />
-1.67294  -1.67294  -1.35468  -1.35468  -1.35468  -1.35468 <br />
-0.16788  -0.16788  <br />
-0.11629  -0.11629  -0.11629  -0.11629  -0.09221  -0.09221 -0.09120  -0.09120  -0.09120  -0.09120   </p>
<p>The levels are not perfectly degenerate, due to the finite size of the
simulation box. We can nevetheless compute the splitting of the levels, and we
obtain, for e.g. the p-channel: 1.67294-1.35468=0.31826 Ha  </p>
<p>If we now consider the <a href="https://www.nist.gov/pml/atomic-reference-
data-electronic-structure-calculations-tantalum">NIST table</a> of atomic data, we obtain :  </p>
<p>5p splitting, table: 1.681344-1.359740=0.321604 Ha<br />
5d splitting, table:   .153395-.131684=0.021711 Ha  </p>
<p>We obtain a reasonable agreement.<br />
A more converged (and more expensive calculation) would yield:  </p>
<p>5p splitting, abinit: 1.64582-1.32141=0.32441 Ha<br />
5d splitting, abinit:   .09084-.11180=0.02096 Ha  </p>
<h3 id="52-projector-augmented-wave">5.2 Projector Augmented-Wave<a class="headerlink" href="#52-projector-augmented-wave" title="Permanent link">&para;</a></h3>
<p>Within the Projector Augmented-Wave method, the usual (pseudo-)Hamiltonian can
be expressed as:  </p>
<p>H  =  Kin + V_eff +  D_ij  |~pi &gt; &lt;~pj  |</p>
<p>If the two following conditions are satisfied:  </p>
<p>(1) the local PAW basis is complete enough ;<br />
(2) the electronic density is mainly contained in the PAW augmentation
regions,  </p>
<p>it can be showed that a very good approximation of the PAW Hamiltonian &ndash;
including spin-orbit coupling &ndash; is:  </p>
<p>H  ~  Kin + V_eff +  (D_ij+D^SO_ij)  |~pi &gt; &lt;~pj  |</p>
<p>where D^SO_ij is the projection of the (L.S) operator into the PAW
augmentation regions.<br />
As an immediate consequence , we thus have the possibility to use the standard
~pi   PAW projectors; in other words, it is possible to use the standard PAW
datasets (pseudopotentials) to perform calculations including spin-orbit
coupling.<br />
But, of course, it is still necessary to express the wave-functions as two
components spinors (spin-up and a spin-down components).<br />
Let&rsquo;s have a look at the following keyword:  </p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../../variables/paw#pawspnorb">pawspnorb</a></li>
</ul>
<p>It automatically activates the spin-orbit coupling within PAW (forcing
<a class="wikilink codevar-wikilink" href="../../variables/gstate#nspinor">nspinor</a>=2).  </p>
<p>Now the practice:<br />
We consider here Bismuth.<br />
You will have to change the &ldquo;files&rdquo; file accordingly, as we here have used the
potential: 83bi.paw. It is a PAW dataset with 5d, 6s and 6p electrons in
valence.<br />
Replace the last line of the tspin_x.files by</p>
<h3 id="_2"><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="cp">../../../Psps_for_tests/83bi.paw</span>
</pre></div>


<p>You can copy the file ~abinit/tests/tutorial/Input/tspin_6.in in Work_spin
(one Bismuth atom in a large cell). Change accordingly the file names in
tspin_x.files, then run the calculation. It takes about 10 secs on a recent
computer. Two datasets are executed: the first one without spin-orbit
coupling, the second one using  <a class="wikilink codevar-wikilink" href="../../variables/paw#pawspnorb">pawspnorb</a>=1.  </p>
<p>The results (eigenvalues) are:<br />
 Eigenvalues (hartree) for nkpt=   1  k points:<br />
 kpt#   1, nband= 24, wtk=  1.00000, kpt=  0.0000  0.0000  0.0000 (reduced
coord)<br />
 5d   -0.93353  -0.93353  -0.93353  -0.93353  -0.82304  -0.82304  -0.82304
-0.82304 -0.82291  -0.82291<br />
 6s   -0.42972  -0.42972<br />
 6p   -0.11089  -0.11089  -0.03810  -0.03810  -0.03810  -0.03810  </p>
<p>Again, the levels are not perfectly degenerate, due to the finite size of the
simulation box.<br />
We can compute the splitting of the levels, and we obtain:  </p>
<p>5d-channel: 0.93353-0.82304=0.11048 Ha<br />
6p-channel: 0.11089-0.03810=0.07289 Ha  </p>
<p>If we now consider the <a href="https://www.nist.gov/pml/atomic-reference-
data-electronic-structure-calculations-bismuth">NIST table</a> of atomic data, we obtain :  </p>
<p>5d-channel: 1.063136-0.952668=0.11047 Ha<br />
6p-channel: 0.228107-0.156444=0.07166 Ha  </p>
<p>A perfect agreement even with a small simulation cell and very small values of
plane-wave cut-offs&hellip;  </p>
<h2 id="6-rotation-of-the-magnetization-and-spin-orbit">6 Rotation of the magnetization and spin-orbit<a class="headerlink" href="#6-rotation-of-the-magnetization-and-spin-orbit" title="Permanent link">&para;</a></h2>
<p>The most spectacular manifestation of the spin-orbit coupling is the energy
associated with a rotation of the magntisation with respect with the cristal
axis. It is at the origin of the magneto cristalline anisotropy of paramount
technological importance.  </p>
<hr />
<p>This ABINIT tutorial is now finished&hellip;<br />
GZ would like to thank B. Siberchicot for useful comments.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title=About><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title=Developers><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/wavefunctions/" data-toggle="tooltip" data-placement="left" 
                  title=Theory><i class="fa fa-book"></i></a></li>
        
          <li><a href="../welcome/" data-toggle="tooltip" data-placement="left" 
                  title=Lessons><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../../variables/" data-toggle="tooltip" data-placement="left" 
                  title=Variables><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../topics/" data-toggle="tooltip" data-placement="left" 
                  title=Topics><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title=User Guide><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../topics/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../variables/" title="Variables" class="md-tabs__link">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../welcome/" title="Lessons" class="md-tabs__link md-tabs__link--active">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/wavefunctions/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../base4/" title="Base4" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Base4
              </span>
            </div>
          </a>
        
        
          <a href="../paw1/" title="PAW1" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                PAW1
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.5.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 The Abinit Group (GZ, MT)
          </div>
        

        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application-6940329b9f.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
    
  </body>
</html>