<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="The Abinit group">
        <link rel="canonical" href="http://www.abinit.org/tutorials/eph/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>EPH - abinit</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/codehilite.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">
    
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">abinit</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../..">Introduction</a>
</li>
                            
<li >
    <a href="../../installation/">Installation</a>
</li>
                            
<li >
    <a href="../../user-guide/help_what_ABINIT_does/">Overview</a>
</li>
                            
<li >
    <a href="../../user-guide/help_abinit/">Abinit</a>
</li>
                            
<li >
    <a href="../../user-guide/help_mrgddb/">Mrgddb</a>
</li>
                            
<li >
    <a href="../../user-guide/help_optic/">Optic</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topics <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../topics/">Complete List</a>
</li>
                            
<li >
    <a href="../../topics/Artificial/">Artificial</a>
</li>
                            
<li >
    <a href="../../topics/AtomManipulator/">AtomManipulator</a>
</li>
                            
<li >
    <a href="../../topics/AtomTypes/">AtomTypes</a>
</li>
                            
<li >
    <a href="../../topics/Bader/">Bader</a>
</li>
                            
<li >
    <a href="../../topics/BandOcc/">BandOcc</a>
</li>
                            
<li >
    <a href="../../topics/Berry/">Berry</a>
</li>
                            
<li >
    <a href="../../topics/BSE/">BSE</a>
</li>
                            
<li >
    <a href="../../topics/ConstrainedPol/">ConstrainedPol</a>
</li>
                            
<li >
    <a href="../../topics/Control/">Control</a>
</li>
                            
<li >
    <a href="../../topics/Coulomb/">Coulomb</a>
</li>
                            
<li >
    <a href="../../topics/CRPA/">CRPA</a>
</li>
                            
<li >
    <a href="../../topics/crystal/">Crystal</a>
</li>
                            
<li >
    <a href="../../topics/Dev/">Dev</a>
</li>
                            
<li >
    <a href="../../topics/DFPT/">DFPT</a>
</li>
                            
<li >
    <a href="../../topics/DFT+U/">DFT+U</a>
</li>
                            
<li >
    <a href="../../topics/DMFT/">DMFT</a>
</li>
                            
<li >
    <a href="../../topics/EffMass/">EffMass</a>
</li>
                            
<li >
    <a href="../../topics/EFG/">EFG</a>
</li>
                            
<li >
    <a href="../../topics/Elastic/">Elastic</a>
</li>
                            
<li >
    <a href="../../topics/ElecBandStructure/">ElecBandStructure</a>
</li>
                            
<li >
    <a href="../../topics/ElecDOS/">ElecDOS</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonInt/">ElPhonInt</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonTransport/">ElPhonTransport</a>
</li>
                            
<li >
    <a href="../../topics/ForcesStresses/">ForcesStresses</a>
</li>
                            
<li >
    <a href="../../topics/FrequencyMeshMBPT/">FrequencyMeshMBPT</a>
</li>
                            
<li >
    <a href="../../topics/GeoConstraints/">GeoConstraints</a>
</li>
                            
<li >
    <a href="../../topics/GeoOpt/">GeoOpt</a>
</li>
                            
<li >
    <a href="../../topics/GW/">GW</a>
</li>
                            
<li >
    <a href="../../topics/GWls/">GWls</a>
</li>
                            
<li >
    <a href="../../topics/Hybrids/">Hybrids</a>
</li>
                            
<li >
    <a href="../../topics/">Home</a>
</li>
                            
<li >
    <a href="../../topics/k-points/">K points</a>
</li>
                            
<li >
    <a href="../../topics/LOTF/">LOTF</a>
</li>
                            
<li >
    <a href="../../topics/MagField/">MagField</a>
</li>
                            
<li >
    <a href="../../topics/MagMom/">MagMom</a>
</li>
                            
<li >
    <a href="../../topics/MolecularDynamics/">MolecularDynamics</a>
</li>
                            
<li >
    <a href="../../topics/multidtset/">Multidtset</a>
</li>
                            
<li >
    <a href="../../topics/nonlinear/">Nonlinear</a>
</li>
                            
<li >
    <a href="../../topics/Optic/">Optic</a>
</li>
                            
<li >
    <a href="../../topics/Output/">Output</a>
</li>
                            
<li >
    <a href="../../topics/parallelism/">Parallelism</a>
</li>
                            
<li >
    <a href="../../topics/PAW/">PAW</a>
</li>
                            
<li >
    <a href="../../topics/PhononBands/">PhononBands</a>
</li>
                            
<li >
    <a href="../../topics/Phonons/">Phonons</a>
</li>
                            
<li >
    <a href="../../topics/PhononWidth/">PhononWidth</a>
</li>
                            
<li >
    <a href="../../topics/PIMD/">PIMD</a>
</li>
                            
<li >
    <a href="../../topics/Planewaves/">Planewaves</a>
</li>
                            
<li >
    <a href="../../topics/positron/">Positron</a>
</li>
                            
<li >
    <a href="../../topics/printing/">Printing</a>
</li>
                            
<li >
    <a href="../../topics/PseudosPAW/">PseudosPAW</a>
</li>
                            
<li >
    <a href="../../topics/q-points/">Q points</a>
</li>
                            
<li >
    <a href="../../topics/RandStopPow/">RandStopPow</a>
</li>
                            
<li >
    <a href="../../topics/Recursion/">Recursion</a>
</li>
                            
<li >
    <a href="../../topics/RPACorrEn/">RPACorrEn</a>
</li>
                            
<li >
    <a href="../../topics/SCFAlgorithms/">SCFAlgorithms</a>
</li>
                            
<li >
    <a href="../../topics/SCFControl/">SCFControl</a>
</li>
                            
<li >
    <a href="../../topics/SelfEnergy/">SelfEnergy</a>
</li>
                            
<li >
    <a href="../../topics/SmartSymm/">SmartSymm</a>
</li>
                            
<li >
    <a href="../../topics/spinpolarisation/">Spinpolarisation</a>
</li>
                            
<li >
    <a href="../../topics/STM/">STM</a>
</li>
                            
<li >
    <a href="../../topics/Susceptibility/">Susceptibility</a>
</li>
                            
<li >
    <a href="../../topics/TDDFT/">TDDFT</a>
</li>
                            
<li >
    <a href="../../topics/TDepES/">TDepES</a>
</li>
                            
<li >
    <a href="../../topics/Temperature/">Temperature</a>
</li>
                            
<li >
    <a href="../../topics/TransPath/">TransPath</a>
</li>
                            
<li >
    <a href="../../topics/TuningSpeed/">TuningSpeed</a>
</li>
                            
<li >
    <a href="../../topics/UnitCell/">UnitCell</a>
</li>
                            
<li >
    <a href="../../topics/vdw/">Vdw</a>
</li>
                            
<li >
    <a href="../../topics/Wannier/">Wannier</a>
</li>
                            
<li >
    <a href="../../topics/Wavelets/">Wavelets</a>
</li>
                            
<li >
    <a href="../../topics/xc/">Xc</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Input Variables <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Abinit</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../input_variables/varlist_abinit/">All Variables</a>
</li>
            
<li >
    <a href="../../input_variables/basic/">Basic</a>
</li>
            
<li >
    <a href="../../input_variables/bse/">Bethe-Salpeter</a>
</li>
            
<li >
    <a href="../../input_variables/dev/">Developers</a>
</li>
            
<li >
    <a href="../../input_variables/dmft/">DMFT</a>
</li>
            
<li >
    <a href="../../input_variables/eph/">Electron-Phonon</a>
</li>
            
<li >
    <a href="../../input_variables/ffield/">Varff</a>
</li>
            
<li >
    <a href="../../input_variables/files/">File-handling</a>
</li>
            
<li >
    <a href="../../input_variables/geo/">Geometry</a>
</li>
            
<li >
    <a href="../../input_variables/gstate/">Ground-State</a>
</li>
            
<li >
    <a href="../../input_variables/gw/">GW</a>
</li>
            
<li >
    <a href="../../input_variables/internal/">Internal</a>
</li>
            
<li >
    <a href="../../input_variables/paral/">Parallelism</a>
</li>
            
<li >
    <a href="../../input_variables/paw/">PAW</a>
</li>
            
<li >
    <a href="../../input_variables/dfpt/">DFPT</a>
</li>
            
<li >
    <a href="../../input_variables/rlx/">Relaxation</a>
</li>
            
<li >
    <a href="../../input_variables/vdw/">VdW</a>
</li>
            
<li >
    <a href="../../input_variables/w90/">Wannier90</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../input_variables/anaddb/">Anaddb</a>
</li>
                            
<li >
    <a href="../../input_variables/optic/">Optic</a>
</li>
                            
<li >
    <a href="../../input_variables/aim/">Aim</a>
</li>
                            
<li >
    <a href="../../input_variables/varset_stats/">Statistics</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Lessons <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../welcome/">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Base Tutorials</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../base1/">Base1</a>
</li>
            
<li >
    <a href="../base2/">Base2</a>
</li>
            
<li >
    <a href="../base3/">Base3</a>
</li>
            
<li >
    <a href="../base4/">Base4</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">DFPT</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../rf1/">RF1</a>
</li>
            
<li >
    <a href="../rf2/">RF2</a>
</li>
            
<li >
    <a href="../elastic/">Elastic</a>
</li>
            
<li class="active">
    <a href="./">EPH</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../dmft/">DMFT</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Many-Body</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../gw1/">GW1</a>
</li>
            
<li >
    <a href="../gw2/">GW2</a>
</li>
            
<li >
    <a href="../bse/">Bethe-Salpeter</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Parallelism</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../basepar/">Base</a>
</li>
            
<li >
    <a href="../paral_mbt/">Many-Body</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Theory <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../theory/theory_mbt/">MBPT</a>
</li>
                            
<li >
    <a href="../../theory/additional_material/">Additional Material</a>
</li>
                            
<li >
    <a href="../../bibliography/">Bibliography</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../developers/README/">How to write docs</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../about/release-notes/">Release Notes</a>
</li>
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>
                            
<li >
    <a href="../../about/license/">License</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../elastic/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../dmft/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/abinit/abinit/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#146-calculation-of-the-ground-state-and-phonon-structure-of-fcc-al">1. Calculation of the ground state and phonon structure of fcc Al.</a></li>
        <li class="main "><a href="#dataset-structure-and-flow">Dataset Structure and Flow</a></li>
        <li class="main "><a href="#convergence">Convergence</a></li>
        <li class="main "><a href="#execution">Execution</a></li>
        <li class="main "><a href="#246-merging-of-the-2dte-_ddb-files-using-mrgddb">2. Merging of the 2DTE _DDB files using MRGDDB.</a></li>
        <li class="main "><a href="#346-extraction-and-merging-of-the-electron-phonon-matrix-elements-using">**3. Extraction and merging of the electron-phonon matrix elements using</a></li>
        <li class="main "><a href="#446-basic-anaddb-calculation-of-electron-phonon-quantities">4. Basic ANADDB calculation of electron-phonon quantities.</a></li>
        <li class="main "><a href="#546-convergence-tests-of-the-integration-techniques">5. Convergence tests of the integration techniques.</a></li>
        <li class="main "><a href="#646-transport-quantities-within-boltzmann-theory">6. Transport quantities within Boltzmann theory.</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<!-- Return to Top -->

<p><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a>
This lesson demonstrates how to obtain the following physical properties, for
a metal :</p>
<ul>
<li>the phonon linewidths (inverse lifetimes) due to the electron-phonon interaction</li>
<li>the Eliashberg spectral function</li>
<li>the electron-phonon coupling strength</li>
<li>the McMillan critical temperature</li>
<li>the resistivity and electronic part of the thermal conductivity</li>
</ul>
<p>Here you will learn to use the electron-phonon coupling part of the anaddb
utility. This implies a preliminary calculation of the electron-phonon matrix
elements and phonon frequencies and eigenvectors, from a standard ABINIT
phonon calculation, which will be reviewed succinctly.</p>
<p>This lesson should take about 1 hour.</p>
<ul>
<li>1 Calculation of the ground state and phonon structure of fcc Al.</li>
<li>2 Merging of the 2DTE DDB files using MRGDDB.</li>
<li>3 Merging of the electron-phonon matrix elements using MRGGKK.</li>
<li>4 Basic ANADDB calculation of electron-phonon quantities.</li>
<li>5 Convergence tests of the integration techniques.</li>
<li>6 Transport quantities within Boltzmann theory.</li>
</ul>
<hr />
<h3 id="146-calculation-of-the-ground-state-and-phonon-structure-of-fcc-al"><strong>1. Calculation of the ground state and phonon structure of fcc Al.</strong><a class="headerlink" href="#146-calculation-of-the-ground-state-and-phonon-structure-of-fcc-al" title="Permanent link">&para;</a></h3>
<h3 id="_1"><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>_Before beginning, you might consider making a different subdirectory to work
in. Why not create "Work_eph" in ~abinit/tests/tutorespfn/Input ? _  </p>
<p>It is presumed that the user has already followed the Tutorials
<a href="../lesson_rf1.html">RF1</a> and <a href="../lesson_rf2.html">RF2</a>, and understands the
calculation of ground state and response function (phonon) properties with
ABINIT.</p>
<p>The file ~abinit/tests/tutorespfn/Input/teph_1.files lists the file names and
root names for the first run (GS+perturbations). You can copy it to the
working directory. You can also copy the file
~abinit/tests/tutorespfn/Input/teph_1.in to your working directory. This is
your input file.</p>
<ul>
<li>_cp ../teph_1.files . _</li>
<li>_cp ../teph_1.in . _</li>
</ul>
<p>You can immediately start this run - the input files will be examined later
...</p>
<pre><code>../../abinit &lt; teph_1.files &gt; tmp-log &amp;
</code></pre>
<h3 id="dataset-structure-and-flow">Dataset Structure and Flow<a class="headerlink" href="#dataset-structure-and-flow" title="Permanent link">&para;</a></h3>
<p>The teph_1.in file contains a number of datasets (DS). These will perform the
ground state (DS 1), then the phonon perturbations (DS 2-4), for a cell of FCC
aluminium. The DDK perturbation (DS 5) is also calculated, and will be used to
obtain the Fermi velocities for the transport calculations in Section 6.</p>
<p>Once these are done, abinit calculates the wave functions on the full grid of
k-points (using <a href="../../../input_variables/generated_files/varbas.html#kptopt">kptopt
3</a>) in DS 6: these
will be used to calculate the electron-phonon matrix elements. In a full
calculation the density of k-points should be increased significantly here and
for the following datasets. For DS 1-5 only the normal convergence of the
phonon frequencies should be ensured. In DS 7-10 only the matrix elements are
calculated, for the electron-phonon coupling and for the DDK
(position/momentum matrix elements), on the dense and complete grid of
k-points from DS 6. Note that the separation of the matrix element calculation
is new from version 7.6.</p>
<p>The important variable for electron-phonon coupling calculations is <a class="wikilink" href="../../input_variables/files/#prtgkk">prtgkk</a>
This prints out files suffixed GKK, which contain the electron-phonon matrix
elements. The matrix elements only depend on the self-consistent perturbed
density (files suffixed 1DENx), which we get from DS 2-4 (linked by variable
<a class="wikilink" href="../../input_variables/files/#get1den">get1den</a>). These can therefore be calculated on arbitrarily dense k-point
meshes. Even better, only a single step is needed, since no self-consistency
is required. To enforce the calculation of all the matrix elements on all
k-points, symmetries are disabled when <a class="wikilink" href="../../input_variables/files/#prtgkk">prtgkk</a> is set to 1, so be sure not
to use it during the normal self-consistent phonon runs DS 2-4. Again this is
very different from versions before 7.6.</p>
<h3 id="convergence">Convergence<a class="headerlink" href="#convergence" title="Permanent link">&para;</a></h3>
<p>The calculation is done using minimal values of a number of parameters, in
order to make it tractable in a time appropriate for a tutorial. The results
will be completely unconverged, but by the end of the lesson you should know
how to run a full electron phonon calculation, and be able to improve the
convergence on your own.</p>
<p>Edit the file teph_1.in. We now examine several variables. The kinetic energy
cutoff <a class="wikilink" href="../../input_variables/basic/#ecut">ecut</a> is a bit low, and the number of k-points (determined by
<a href="../../../input_variables/generated_files/varbas.html#ngkpt">ngkpt</a>) is much too
low. Electron-phonon calculations require a very precise determination of the
Fermi surface of the metal. This implies a very dense k-point mesh, and the
convergence of the grid must be checked. In our case, for Al, we will use a
(non-shifted) 4x4x4 k-point grid, but a converged calculation needs more than
16x16x16 points. This will be re-considered in section 5. The q-point grid
will be 2x2x2. It must be a sub-grid of the full k-point grid, and must
contain the Γ point.</p>
<p>The value of <a class="wikilink" href="../../input_variables/basic/#acell">acell</a> is fixed to a rounded value from experiment. It, too,
should be converged to get physical results (see <a href="../lesson_base3.html"> Tutorial
3</a>).</p>
<p>Note that the value of 1.0E-14 for <a class="wikilink" href="../../input_variables/basic/#tolwfr">tolwfr</a> is tight, and should be even
lower (down to 1.0E-20 or even 1.0E-22). This is because the wavefunctions
will be used later explicitly in the matrix elements for ANADDB, as opposed to
only energy values or densities, which are averages of the wavefunctions and
eigenenergies over k-points and bands. Electron-phonon quantities are delicate
sums of a few of these small matrix elements (those near the Fermi surface),
so each matrix element must be accurate. You can however set <a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a> to 0 in
the phonon calculations, and avoid saving huge perturbed wavefunction files to
disk (you only need to keep the ground state wave functions, with prtwf1 1).</p>
<h3 id="execution">Execution<a class="headerlink" href="#execution" title="Permanent link">&para;</a></h3>
<p>Run the first input (a few seconds on a recent PC), and you should obtain a
value of</p>
<pre><code> etotal -2.0828579336121 Ha
</code></pre>
<p>for the energy at the end of DATASET 1. The following datasets calculate the
second order energy variations under atomic displacement in the three reduced
directions of the fcc unit cell. This is done for three different phonons,
Gamma, (1/2,0,0), and X=(1/2,1/2,0), which generate the 2x2x2 q-point grid
(take care with the reduced coordinates of the reciprocal space points! They
are not along cartesian directions, but along the reciprocal space lattice
vectors.). The whole calculation follows the same lines as <a href="../lesson_rf1.html"> Tutorial
RF1</a>. As an example, DATASET 3 calculates the perturbed
wavefunctions at k+q, for k in the ground state k-point mesh, and q=(1/2,0,0).
Then, DATASET 3 calculates</p>
<pre><code> 2DTE 0.80951882353353
</code></pre>
<p>for the second-order energy variation for movement of the (unique) atom along
the first reduced direction for q=(1/2,0,0). The main differences with <a href="../lesson_rf1.html">
Tutorial RF1</a> are that Given we are dealing with a metal, no
perturbation wrt electric fields is considered ; However, if you want to do
transport calculations, you need the ddk calculation anyway, to get the
electron band velocities. This is added in dataset 5. In the standard case,
ABINIT uses symmetry operations and non-stationary expressions to calculate a
minimal number of 2DTE for different mixed second derivatives of the total
energy. In our case we use the first derivatives, and they must all be
calculated explicitly.</p>
<p>You are now the proud owner of 9 first-order matrix element files (suffixed
_GKKx), corresponding to the three directional perturbations of the atom at
each of the three q-points. The _GKK files contain the matrix elements of the
electron-phonon interaction, which we will extract and use in the following.
Besides the _GKK files there are the _DDB files for each perturbation which
contain the 2DTE for the different phonons wavevectors q.</p>
<hr />
<h3 id="246-merging-of-the-2dte-_ddb-files-using-mrgddb"><strong>2. Merging of the 2DTE _DDB files using MRGDDB.</strong><a class="headerlink" href="#246-merging-of-the-2dte-_ddb-files-using-mrgddb" title="Permanent link">&para;</a></h3>
<h3 id="_2"><a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>You can copy the following content to a file teph_2.in within your working
directory:</p>
<pre><code>teph_2.ddb.out
Total ddb for Al FCC system
3
teph_1o_DS2_DDB
teph_1o_DS3_DDB
teph_1o_DS4_DDB
</code></pre>
<p>This is your input file for the
<a href="../../../users/generated_files/help_mrgddb.html">MRGDDB</a> utility, which will
take the different _DDB files and merge them into a single one which ANADDB
will use to determine the phonon frequencies and eigenvectors. teph_2.in
contains the name of the final file, a comment line, then the number of _DDB
files to be merged and their names.</p>
<p><a href="../../../users/generated_files/help_mrgddb.html">MRGDDB</a> is run with the command</p>
<pre><code> mrgddb &lt; teph_2.in
</code></pre>
<p>It runs in a few seconds.</p>
<hr />
<h3 id="346-extraction-and-merging-of-the-electron-phonon-matrix-elements-using">**3. Extraction and merging of the electron-phonon matrix elements using<a class="headerlink" href="#346-extraction-and-merging-of-the-electron-phonon-matrix-elements-using" title="Permanent link">&para;</a></h3>
<p>MRGGKK.**</p>
<h3 id="_3"><a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>A merge similar to that in the last section must be carried out for the
electron-phonon matrix elements. This is done using the MRGGKK utility, and
its input file is ~abinit/tests/tutorespfn/Input/teph_3.in, shown below</p>
<pre><code>teph_3o_GKK.bin   # Name of output file
0                    # binary (0) or ascii (1) output
teph_1o_DS1_WFK   # GS wavefunction file
0  9 9               # number of 1WF files, of GKK files, and of perturbations in the GKK files
teph_1o_DS2_GKK1  # names of the 1WF then the (eventual) GKK files
teph_1o_DS2_GKK2
...
</code></pre>
<p>The matrix element sections of all the _GKK files will be extracted and
concatenated into one (binary) file, here named teph_3o_GKK.bin. The following
lines in teph_3.in give the output format (0 for binary or 1 for ascii), then
the name of the ground state wavefunction file. The fourth line contains 3
integers, which give the number of _1WF files (which can also be used to
salvage the GKK), the number of _GKK files, and the number of perturbations in
the _GKK files. Thus, MRGGKK functions very much like
<a href="../../../users/generated_files/help_mrgddb.html">MRGDDB</a>, and can merge _GKK
files which already contain several perturbations (q-points or atomic
displacements). Finally, the names of the different _1WF and _GKK files are
listed.</p>
<p>MRGGKK will run on this example in a few seconds. In more general cases, the
runtime will depend on the size of the system, and for a large number of bands
or k-points can extend up to 20 minutes or more.</p>
<hr />
<h3 id="446-basic-anaddb-calculation-of-electron-phonon-quantities"><strong>4. Basic ANADDB calculation of electron-phonon quantities.</strong><a class="headerlink" href="#446-basic-anaddb-calculation-of-electron-phonon-quantities" title="Permanent link">&para;</a></h3>
<h3 id="_4"><a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>The general theory of electron-phonon coupling and Eliashberg
superconductivity is reviewed in <em>Theory of Superconducting Tc, P.B. Allen and
B. Mitrovic in Sol. State Phys. <strong>37</strong> (1982) ed. Ehrenreich, Seitz, and
Turnbull</em>. The first implementations similar to that in ABINIT are those in
<em>S.Y. Savrasov and D.Y. Savrasov, Phys. Rev. B <strong>54</strong> 16487 (1996)</em> and <em>A.Y.
Liu and A.A. Quong, Phys. Rev. B <strong>53</strong> R7575-R7579 (1996)</em>.</p>
<p>File ~abinit/tests/tutorespfn/Input/teph_4.in contains the input needed by
ANADDB to carry out the calculation of the electron-phonon quantities. ANADDB
takes a files file, just like ABINIT, which tells it where to find the input,
ddb, and gkk files, and what to name the output, thermodynamical output, and
electron phonon output files. ~abinit/tests/tutorespfn/Input/teph_4.files is
your files file for ANADDB. You can edit it now.</p>
<p>The new variables are at the head of the file:</p>
<pre><code># turn on calculation of the electron-phonon quantities
elphflag 1

# Path in reciprocal space along which the phonon linewidths
#  and band structure will be calculated
nqpath 7
qpath
 0.0 0.0 0.0
 1/2 1/2 0.0
 1   1   1
 1/2 1/2 1/2
 1/2 1/2 0.0
 1/2 3/4 1/4
 1/2 1/2 1/2

# Coulomb pseudopotential parameter
mustar 0.136
</code></pre>
<p><a href="../../../users/generated_files/help_anaddb.html#elphflag"> elphflag</a> is a flag
to turn on the calculation of the electron-phonon quantities. The first
quantities which will be calculated are the phonon linewidths along a path in
reciprocal space (exactly like the band structure in <a href="../lesson_base3.html#35">Lesson
3.5</a>). The path is specified by the variable
<a href="../../../users/generated_files/help_anaddb.html#qpath">qpath</a> giving the apexes
of the path in reciprocal space, which are usually special points of high
symmetry. The number of points is given by
<a href="../../../users/generated_files/help_anaddb.html#nqpath">nqpath</a>. Note that qpath
can be used in normal phonon band structure calculations as well, provided
that <a href="../../../users/generated_files/help_anaddb.html#qpath">q1phl</a> is omitted
from the input file (the latter overrides qpath). The phonon linewidths are
printed to a file suffixed _LWD.</p>
<p>The phonon linewidths are proportional to the electron phonon coupling, and
still depend on the phonon wavevector q. The other electron-phonon
calculations which are presently implemented in ANADDB, in particular for
superconductivity, determine isotropic quantities, which are averaged over the
Fermi surface and summed over q-points. Integrating the coupling over
reciprocal space, but keeping the resolution in the phonon mode's energy, one
calculates the Eliashberg spectral function α²F. The α²F function is similar
to the density of states of the phonons, but is weighted according to the
coupling of the phonons to the electrons. It is output to a file with suffix
<em>A2F, which is ready to be represented using any graphical software (Xmgr,
matlab, OpenDX...). The first inverse moment of α²F gives the global coupling
strength, or mass renormalization factor, λ. From λ, using the McMillan
formula (_Phys. Rev. <strong>167</strong> 331-344 (1968)</em>) as modified by Allen and Dynes
(<em>Phys. Rev. B <strong>12</strong> 905 (1975)</em>), ANADDB calculates the critical temperature
for superconductivity. The formula contains an adjustable parameter μ* which
approximates the effect of Coulomb interactions, and is given by the input
variable <a href="../../../users/generated_files/help_anaddb.html#mustar">mustar</a>. For Al
with the k-point grid given and a value of μ=0.136 the ANADDB output file
shows the following values</p>
<pre><code> mka2f: lambda &lt;omega^2&gt; =     8.891284E-07
 mka2f: lambda &lt;omega^3&gt; =     7.757272E-10
 mka2f: lambda &lt;omega^4&gt; =     8.715049E-13
 mka2f: lambda &lt;omega^5&gt; =     1.108658E-15
 mka2f: isotropic lambda =     8.337444E+00
 mka2f: omegalog  =     1.769558E-04 (Ha)     5.587816E+01 (Kelvin)
 mka2f: input mustar =     1.360000E-01
-mka2f: MacMillan Tc =     4.038730E-05 (Ha)     1.275329E+01 (Kelvin)
</code></pre>
<p>As expected, this is a fairly bad estimation of the experimental value of 1.2
K. The coupling strength is severely overestimated (experiment gives 0.44),
and the logarithmic average frequency is too low, but not nearly enough to
compensate λ. Aluminum is a good case in which things can be improved, easily
because its Fermi surface is isotropic and the coupling is weak.</p>
<hr />
<h3 id="546-convergence-tests-of-the-integration-techniques"><strong>5. Convergence tests of the integration techniques.</strong><a class="headerlink" href="#546-convergence-tests-of-the-integration-techniques" title="Permanent link">&para;</a></h3>
<h3 id="_5"><a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>In section 4, we used the default method for integration on the Fermi surface,
which employs a smearing of the DOS and attributes Gaussian weights to each
k-point as a function of its distance from the Fermi surface. Another
efficient method of integration in k-space is the tetrahedron method, which is
also implemented in ANADDB, and can be used by setting
<a href="../../../users/generated_files/help_anaddb.html#telphint">telphint</a> = 0. In this
case the k-point grid must be specified explicitly in the input, repeating the
variable <a href="../../../users/generated_files/help_anaddb.html#kptrlatt">kptrlatt</a>
from the ABINIT output, so that ANADDB can re-construct the different
tetrahedra which fill the reciprocal unit cell. In the Gaussian case, the
width of the smearing can be controlled using the input variable
<a href="../../../users/generated_files/help_anaddb.html#elphsmear">elphsmear</a>.</p>
<p>To test our calculations, they should be re-done with a denser k-point grid
and a denser q-point grid, until the results (α²F or λ) are converged. The
value of <a href="../../../users/generated_files/help_anaddb.html#elphsmear">elphsmear</a>
should also be checked, to make sure that it does not affect results.
Normally, the limit for a very small
<a href="../../../users/generated_files/help_anaddb.html#elphsmear">elphsmear</a> and a very
dense k-point grid is the same as the value obtained with the tetrahedron
method (which usually converges with a sparser k-point grid).</p>
<p>Edit input file ~abinit/tests/tutorespfn/Input/teph_5.in and you will see the
main difference with teph_4.in is the choice of the tetrahedron integration
method. If you are patient, save the output _LWD and _A2F files and run the
full lesson again with a denser k-point grid (say, 6x6x6) and you will be able
to observe the differences in convergence.</p>
<hr />
<h3 id="646-transport-quantities-within-boltzmann-theory"><strong>6. Transport quantities within Boltzmann theory.</strong><a class="headerlink" href="#646-transport-quantities-within-boltzmann-theory" title="Permanent link">&para;</a></h3>
<h3 id="_6"><a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>The electron-phonon interaction is also responsible for the resistivity of
normal metals and related phenomena. Even in a perfect crystal, interaction
with phonons will limit electron life times (and vice versa). This can be
calculated fairly simply using the Boltzmann theory of transport with first
order scattering by phonons (see, e.g., "Electrons and Phonons" by Ziman).</p>
<p>The additional ingredient needed to calculate transport quantities (electrical
resistivity, heat conductivity limited by electron-phonon coupling) is the
Fermi velocity, i.e. the group velocity of a wavepacket of electrons placed at
the Fermi surface. This is the "true" velocity the charge will move at, once
you have displaced the Fermi sphere a little bit in k space (see, e.g.
Ashcroft and Mermin as well). The velocity can be related simply to a
commutator of the position, which is also used for dielectric response, using
a DDK calculation (see <a href="../lesson_rf1.html#5">the Gamma point phonon
tutorial</a>). The phonon calculation at Gamma need not
include the electric field (this is a metal after all, so the effect on the
phonons should be negligible), but we need an additional dataset to calculate
the 3 DDK files along the 3 primitive directions of the unit cell. To be more
precise, just as for the el-ph matrix elements, we do not need the perturbed
wavefunctions, only the perturbed eigenvalues. Calculating the DDK derivatives
with <a class="wikilink" href="../../input_variables/files/#prtgkk">prtgkk</a> set to 1 will output files named _GKKxx (xx=3<em>natom+1 to
3</em>natom+3) containing the matrix elements of the ddk perturbation (these are
basically the first part of the normal DDK files for E field perturbation,
without the wave function coefficients).</p>
<p>The anaddb "files" file must specify where the ddk files are, so anaddb can
calculate the Fermi velocities. It actually reads:</p>
<pre><code>teph_6.in
teph_6.out
teph_2.ddb.out
moldyn
teph_3o_GKK.bin
teph.ep
teph_6.ddk
</code></pre>
<p>where the last line is the name of a small file listing the 3 DDK files to be
used:</p>
<pre><code>teph_1_DS5_GKK4
teph_1_DS5_GKK5
teph_1_DS5_GKK6
</code></pre>
<p>The abinit input file teph_1.in already obtained the DDK files from the
additional dataset, DS5, with the following lines of teph_1.in:</p>
<pre><code>tolwfr5 1.0d-14
qpt5 0 0 0
rfphon5 0
rfelfd5 2
</code></pre>
<p>Copy the additional .ddk file from the tests/tutorespfn/Inputs directory, and
run anaddb with the new "files" file. The input for teph_6 has added to
teph_5.in the following 2 lines:</p>
<pre><code>ifltransport 1
ep_keepbands 1
</code></pre>
<p>and has produced a number of additional files:</p>
<ul>
<li><em>_A2F_TR</em> contain the equivalent Eliashberg spectral functions with Fermi speed factors (how many phonons do we have at a given energy, how much do they couple with the electrons, and how fast are these electrons going). Integrating with appropriate functions of the phonon energy, one gets:</li>
<li>the resistivity as a function of temperature (teph_6.out_ep_RHO and figure) and</li>
<li>the thermal conductivity as a function of temperature (teph_6.out_ep_WTH) but ONLY the electronic contribution. You are still missing the phonon-phonon interactions, which are the limiting factor in the thermal conductivity beyond a few 100 K. For metals at even higher temperature the electrons will often dominate again as they contain more degrees of freedom.</li>
</ul>
<p><img alt="Resistivity of Al as a function of
T" src="../../documents/lesson_eph/teph_6_RHO.png" /></p>
<p>The high T behavior is necessarily linear if you include only first order e-p
coupling and neglect the variation of the GKK off of the Fermi surface. The
inset shows the low T behavior, which is not a simple polynomial (with simple
models it should be T^3 or T^5 - see Ashcroft and Mermin). See the Savrasov
paper above for reference values in simple metals using well converged k- and
q- point grids.</p>
<p>Finally, note that the _RHO and _WTH files contain a series of tensor
components, for the resistivity tensor (2 1 = y x or the current response
along y when you apply an electric field along x). In most systems the tensor
should be diagonal by symmetry, and the value of off-diagonal terms gives an
estimate of the numerical error.</p></div>
        </div>

        <footer class="col-md-12">
<hr>

    <center>Abinit version 8.5.4</center>


    <center>Copyright &copy; 2017 The Abinit Group</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>
        <script>var base_url = '../..';</script>
        <!--
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        -->
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
        <script src="../../extra_javascript/abidocs.js"></script>

    <!--<script>var base_url = '../..';</script>
<script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>

<h1 id="search">Search Results</h1>

<form action="search.html">
  <input name="q" id="mkdocs-search-query" type="text" >
</form>

<div id="mkdocs-search-results">
  Sorry, page not found.
</div>
    -->

    </body>
</html>
