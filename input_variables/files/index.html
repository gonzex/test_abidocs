<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="The Abinit group">
        <link rel="canonical" href="http://www.abinit.org/input_variables/files/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>File-handling - abinit</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/codehilite.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">
    
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">abinit</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../..">Introduction</a>
</li>
                            
<li >
    <a href="../../installation/">Installation</a>
</li>
                            
<li >
    <a href="../../user-guide/help_what_ABINIT_does/">Overview</a>
</li>
                            
<li >
    <a href="../../user-guide/help_abinit/">Abinit</a>
</li>
                            
<li >
    <a href="../../user-guide/help_mrgddb/">Mrgddb</a>
</li>
                            
<li >
    <a href="../../user-guide/help_optic/">Optic</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topics <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../topics/">Complete List</a>
</li>
                            
<li >
    <a href="../../topics/Artificial/">Artificial</a>
</li>
                            
<li >
    <a href="../../topics/AtomManipulator/">AtomManipulator</a>
</li>
                            
<li >
    <a href="../../topics/AtomTypes/">AtomTypes</a>
</li>
                            
<li >
    <a href="../../topics/Bader/">Bader</a>
</li>
                            
<li >
    <a href="../../topics/BandOcc/">BandOcc</a>
</li>
                            
<li >
    <a href="../../topics/Berry/">Berry</a>
</li>
                            
<li >
    <a href="../../topics/BSE/">BSE</a>
</li>
                            
<li >
    <a href="../../topics/ConstrainedPol/">ConstrainedPol</a>
</li>
                            
<li >
    <a href="../../topics/Control/">Control</a>
</li>
                            
<li >
    <a href="../../topics/Coulomb/">Coulomb</a>
</li>
                            
<li >
    <a href="../../topics/CRPA/">CRPA</a>
</li>
                            
<li >
    <a href="../../topics/crystal/">Crystal</a>
</li>
                            
<li >
    <a href="../../topics/Dev/">Dev</a>
</li>
                            
<li >
    <a href="../../topics/DFPT/">DFPT</a>
</li>
                            
<li >
    <a href="../../topics/DFT+U/">DFT+U</a>
</li>
                            
<li >
    <a href="../../topics/DMFT/">DMFT</a>
</li>
                            
<li >
    <a href="../../topics/EffMass/">EffMass</a>
</li>
                            
<li >
    <a href="../../topics/EFG/">EFG</a>
</li>
                            
<li >
    <a href="../../topics/Elastic/">Elastic</a>
</li>
                            
<li >
    <a href="../../topics/ElecBandStructure/">ElecBandStructure</a>
</li>
                            
<li >
    <a href="../../topics/ElecDOS/">ElecDOS</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonInt/">ElPhonInt</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonTransport/">ElPhonTransport</a>
</li>
                            
<li >
    <a href="../../topics/ForcesStresses/">ForcesStresses</a>
</li>
                            
<li >
    <a href="../../topics/FrequencyMeshMBPT/">FrequencyMeshMBPT</a>
</li>
                            
<li >
    <a href="../../topics/GeoConstraints/">GeoConstraints</a>
</li>
                            
<li >
    <a href="../../topics/GeoOpt/">GeoOpt</a>
</li>
                            
<li >
    <a href="../../topics/GW/">GW</a>
</li>
                            
<li >
    <a href="../../topics/GWls/">GWls</a>
</li>
                            
<li >
    <a href="../../topics/Hybrids/">Hybrids</a>
</li>
                            
<li >
    <a href="../../topics/">Home</a>
</li>
                            
<li >
    <a href="../../topics/k-points/">K points</a>
</li>
                            
<li >
    <a href="../../topics/LOTF/">LOTF</a>
</li>
                            
<li >
    <a href="../../topics/MagField/">MagField</a>
</li>
                            
<li >
    <a href="../../topics/MagMom/">MagMom</a>
</li>
                            
<li >
    <a href="../../topics/MolecularDynamics/">MolecularDynamics</a>
</li>
                            
<li >
    <a href="../../topics/multidtset/">Multidtset</a>
</li>
                            
<li >
    <a href="../../topics/nonlinear/">Nonlinear</a>
</li>
                            
<li >
    <a href="../../topics/Optic/">Optic</a>
</li>
                            
<li >
    <a href="../../topics/Output/">Output</a>
</li>
                            
<li >
    <a href="../../topics/parallelism/">Parallelism</a>
</li>
                            
<li >
    <a href="../../topics/PAW/">PAW</a>
</li>
                            
<li >
    <a href="../../topics/PhononBands/">PhononBands</a>
</li>
                            
<li >
    <a href="../../topics/Phonons/">Phonons</a>
</li>
                            
<li >
    <a href="../../topics/PhononWidth/">PhononWidth</a>
</li>
                            
<li >
    <a href="../../topics/PIMD/">PIMD</a>
</li>
                            
<li >
    <a href="../../topics/Planewaves/">Planewaves</a>
</li>
                            
<li >
    <a href="../../topics/positron/">Positron</a>
</li>
                            
<li >
    <a href="../../topics/printing/">Printing</a>
</li>
                            
<li >
    <a href="../../topics/PseudosPAW/">PseudosPAW</a>
</li>
                            
<li >
    <a href="../../topics/q-points/">Q points</a>
</li>
                            
<li >
    <a href="../../topics/RandStopPow/">RandStopPow</a>
</li>
                            
<li >
    <a href="../../topics/Recursion/">Recursion</a>
</li>
                            
<li >
    <a href="../../topics/RPACorrEn/">RPACorrEn</a>
</li>
                            
<li >
    <a href="../../topics/SCFAlgorithms/">SCFAlgorithms</a>
</li>
                            
<li >
    <a href="../../topics/SCFControl/">SCFControl</a>
</li>
                            
<li >
    <a href="../../topics/SelfEnergy/">SelfEnergy</a>
</li>
                            
<li >
    <a href="../../topics/SmartSymm/">SmartSymm</a>
</li>
                            
<li >
    <a href="../../topics/spinpolarisation/">Spinpolarisation</a>
</li>
                            
<li >
    <a href="../../topics/STM/">STM</a>
</li>
                            
<li >
    <a href="../../topics/Susceptibility/">Susceptibility</a>
</li>
                            
<li >
    <a href="../../topics/TDDFT/">TDDFT</a>
</li>
                            
<li >
    <a href="../../topics/TDepES/">TDepES</a>
</li>
                            
<li >
    <a href="../../topics/Temperature/">Temperature</a>
</li>
                            
<li >
    <a href="../../topics/TransPath/">TransPath</a>
</li>
                            
<li >
    <a href="../../topics/TuningSpeed/">TuningSpeed</a>
</li>
                            
<li >
    <a href="../../topics/UnitCell/">UnitCell</a>
</li>
                            
<li >
    <a href="../../topics/vdw/">Vdw</a>
</li>
                            
<li >
    <a href="../../topics/Wannier/">Wannier</a>
</li>
                            
<li >
    <a href="../../topics/Wavelets/">Wavelets</a>
</li>
                            
<li >
    <a href="../../topics/xc/">Xc</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Input Variables <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Abinit</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../varlist_abinit/">All Variables</a>
</li>
            
<li >
    <a href="../basic/">Basic</a>
</li>
            
<li >
    <a href="../bse/">Bethe-Salpeter</a>
</li>
            
<li >
    <a href="../dev/">Developers</a>
</li>
            
<li >
    <a href="../dmft/">DMFT</a>
</li>
            
<li >
    <a href="../eph/">Electron-Phonon</a>
</li>
            
<li >
    <a href="../ffield/">Varff</a>
</li>
            
<li class="active">
    <a href="./">File-handling</a>
</li>
            
<li >
    <a href="../geo/">Geometry</a>
</li>
            
<li >
    <a href="../gstate/">Ground-State</a>
</li>
            
<li >
    <a href="../gw/">GW</a>
</li>
            
<li >
    <a href="../internal/">Internal</a>
</li>
            
<li >
    <a href="../paral/">Parallelism</a>
</li>
            
<li >
    <a href="../paw/">PAW</a>
</li>
            
<li >
    <a href="../dfpt/">DFPT</a>
</li>
            
<li >
    <a href="../rlx/">Relaxation</a>
</li>
            
<li >
    <a href="../vdw/">VdW</a>
</li>
            
<li >
    <a href="../w90/">Wannier90</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../anaddb/">Anaddb</a>
</li>
                            
<li >
    <a href="../optic/">Optic</a>
</li>
                            
<li >
    <a href="../aim/">Aim</a>
</li>
                            
<li >
    <a href="../varset_stats/">Statistics</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Lessons <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../tutorials/welcome/">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Base Tutorials</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/base1/">Base1</a>
</li>
            
<li >
    <a href="../../tutorials/base2/">Base2</a>
</li>
            
<li >
    <a href="../../tutorials/base3/">Base3</a>
</li>
            
<li >
    <a href="../../tutorials/base4/">Base4</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">DFPT</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/rf1/">RF1</a>
</li>
            
<li >
    <a href="../../tutorials/rf2/">RF2</a>
</li>
            
<li >
    <a href="../../tutorials/elastic/">Elastic</a>
</li>
            
<li >
    <a href="../../tutorials/eph/">EPH</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../tutorials/dmft/">DMFT</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Many-Body</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/gw1/">GW1</a>
</li>
            
<li >
    <a href="../../tutorials/gw2/">GW2</a>
</li>
            
<li >
    <a href="../../tutorials/bse/">Bethe-Salpeter</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Parallelism</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/basepar/">Base</a>
</li>
            
<li >
    <a href="../../tutorials/paral_mbt/">Many-Body</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Theory <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../theory/theory_mbt/">MBPT</a>
</li>
                            
<li >
    <a href="../../theory/additional_material/">Additional Material</a>
</li>
                            
<li >
    <a href="../../bibliography/">Bibliography</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../developers/README/">How to write docs</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../about/release-notes/">Release Notes</a>
</li>
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>
                            
<li >
    <a href="../../about/license/">License</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../ffield/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../geo/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/abinit/abinit/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#get1den">get1den</a></li>
        <li class="main "><a href="#get1wf">get1wf</a></li>
        <li class="main "><a href="#getbscoup">getbscoup</a></li>
        <li class="main "><a href="#getbseig">getbseig</a></li>
        <li class="main "><a href="#getbsreso">getbsreso</a></li>
        <li class="main "><a href="#getddb">getddb</a></li>
        <li class="main "><a href="#getddk">getddk</a></li>
        <li class="main "><a href="#getden">getden</a></li>
        <li class="main "><a href="#gethaydock">gethaydock</a></li>
        <li class="main "><a href="#getocc">getocc</a></li>
        <li class="main "><a href="#getqps">getqps</a></li>
        <li class="main "><a href="#getscr">getscr</a></li>
        <li class="main "><a href="#getsuscep">getsuscep</a></li>
        <li class="main "><a href="#getwfk">getwfk</a></li>
        <li class="main "><a href="#getwfq">getwfq</a></li>
        <li class="main "><a href="#ird1den">ird1den</a></li>
        <li class="main "><a href="#ird1wf">ird1wf</a></li>
        <li class="main "><a href="#irdbscoup">irdbscoup</a></li>
        <li class="main "><a href="#irdbseig">irdbseig</a></li>
        <li class="main "><a href="#irdbsreso">irdbsreso</a></li>
        <li class="main "><a href="#irdddb">irdddb</a></li>
        <li class="main "><a href="#irdddk">irdddk</a></li>
        <li class="main "><a href="#irdden">irdden</a></li>
        <li class="main "><a href="#irdhaydock">irdhaydock</a></li>
        <li class="main "><a href="#irdqps">irdqps</a></li>
        <li class="main "><a href="#irdscr">irdscr</a></li>
        <li class="main "><a href="#irdsuscep">irdsuscep</a></li>
        <li class="main "><a href="#irdwfk">irdwfk</a></li>
        <li class="main "><a href="#irdwfq">irdwfq</a></li>
        <li class="main "><a href="#kssform">kssform</a></li>
        <li class="main "><a href="#prt1dm">prt1dm</a></li>
        <li class="main "><a href="#prtden">prtden</a></li>
        <li class="main "><a href="#prtdos">prtdos</a></li>
        <li class="main "><a href="#prtdosm">prtdosm</a></li>
        <li class="main "><a href="#prteig">prteig</a></li>
        <li class="main "><a href="#prtelf">prtelf</a></li>
        <li class="main "><a href="#prtfsurf">prtfsurf</a></li>
        <li class="main "><a href="#prtgden">prtgden</a></li>
        <li class="main "><a href="#prtgeo">prtgeo</a></li>
        <li class="main "><a href="#prtgkk">prtgkk</a></li>
        <li class="main "><a href="#prtgsr">prtgsr</a></li>
        <li class="main "><a href="#prtkden">prtkden</a></li>
        <li class="main "><a href="#prtkpt">prtkpt</a></li>
        <li class="main "><a href="#prtlden">prtlden</a></li>
        <li class="main "><a href="#prtpot">prtpot</a></li>
        <li class="main "><a href="#prtpsps">prtpsps</a></li>
        <li class="main "><a href="#prtspcur">prtspcur</a></li>
        <li class="main "><a href="#prtstm">prtstm</a></li>
        <li class="main "><a href="#prtsuscep">prtsuscep</a></li>
        <li class="main "><a href="#prtvclmb">prtvclmb</a></li>
        <li class="main "><a href="#prtvha">prtvha</a></li>
        <li class="main "><a href="#prtvhxc">prtvhxc</a></li>
        <li class="main "><a href="#prtvol">prtvol</a></li>
        <li class="main "><a href="#prtvolimg">prtvolimg</a></li>
        <li class="main "><a href="#prtvpsp">prtvpsp</a></li>
        <li class="main "><a href="#prtvxc">prtvxc</a></li>
        <li class="main "><a href="#prtwant">prtwant</a></li>
        <li class="main "><a href="#prtwf">prtwf</a></li>
        <li class="main "><a href="#prtwf_full">prtwf_full</a></li>
        <li class="main "><a href="#prtxml">prtxml</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<!-- Return to Top -->

<p><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a></p>
<h2 id="get1den"><strong>get1den</strong><a class="headerlink" href="#get1den" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the first-order density from _1DEN file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a>, <a class="wikilink" href="../../topics/ElPhonInt">ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Relevant only for non self consistent RF calculations (e.g. to get electron
phonon matrix elements) or for non linear RF calculations (to get mixed higher
order derivatives you need several perturbed densities and wave functions).
Indicate the files from which first-order densities must be obtained, in
multi-dataset mode (in single dataset mode, use <a class="wikilink" href="../../input_variables/files/#ird1den">ird1den</a>).<br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="get1wf"><strong>get1wf</strong><a class="headerlink" href="#get1wf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the first-order wavefunctions from _1WF file <br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Eventually used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (in the multi-dataset mode), to indicate
starting wavefunctions, as an alternative to <a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a>, <a class="wikilink" href="../../input_variables/files/#irdwfq">irdwfq</a>,
<a class="wikilink" href="../../input_variables/files/#ird1wf">ird1wf</a>, <a class="wikilink" href="../../input_variables/files/#irdddk">irdddk</a>. One should first read the explanations given for these
latter variables.<br />
The <strong> getwfk </strong> , <strong> getwfq </strong> , <a class="wikilink" href="../../input_variables/files/#get1wf">get1wf</a> and <strong> getddk </strong> variables are
typically used to chain the calculations in the multi-dataset mode, since they
describe from which dataset the OUTPUT wavefunctions are to be taken, as INPUT
wavefunctions of the present dataset.  </p>
<p>We now focus on the <strong> getwfk </strong> input variable (the only one used in ground-
state calculations), but the rules for <strong> getwfq </strong> and <a class="wikilink" href="../../input_variables/files/#get1wf">get1wf</a> are
similar, with _WFK replaced by _WFQ or _1WF.<br />
If <strong> getwfk </strong> ==0, no use of previously computed output wavefunction file
appended with _DSx_WFK is done.<br />
If <strong> getwfk </strong> is positive, its value gives the index of the dataset for
which the output wavefunction file appended with _WFK must be used.<br />
If <strong> getwfk </strong> is -1, the output wf file with _WFK of the previous dataset
must be taken, which is a frequently occurring case.<br />
If <strong> getwfk </strong> is a negative number, it indicates the number of datasets to
go backward to find the needed wavefunction file. In this case, if one refers
to a non existent data set (prior to the first), the wavefunctions are not
initialised from a disk file, so that it is as if <strong> getwfk </strong> =0 for that
initialisation. Thanks to this rule, the use of <strong> getwfk </strong> -1 is rather
straightforward : except for the first wavefunctions, that are not initialized
by reading a disk file, the output wavefunction of one dataset is input of the
next one.<br />
In the case of a ddk calculation in a multi dataset run, in order to compute
correctly the localisation tensor, it is mandatory to declare give getddk the
value of the current dataset (i.e. getddk3 3 ) - this is a bit strange and
should be changed in the future.<br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="getbscoup"><strong>getbscoup</strong><a class="headerlink" href="#getbscoup" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the Bethe-Salpeter COUPling block from ...<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<p>Eventually used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (multi-dataset mode) and, in the case of
a Bethe-Salpeter calculation to indicate that the starting coupling block of
the excitonic Hamiltonian will be taken from the output of a previous dataset.
It is used to chain the calculations, since it describes from which dataset
the OUTPUT coupling block is to be taken, as INPUT of the present dataset.<br />
If <a class="wikilink" href="../../input_variables/files/#getbscoup">getbscoup</a>==0, no such use of previously computed coupling block file is
done.<br />
If <a class="wikilink" href="../../input_variables/files/#getbscoup">getbscoup</a> is positive, its value gives the index of the dataset to be
used as input.<br />
If <a class="wikilink" href="../../input_variables/files/#getbscoup">getbscoup</a> is -1, the output of the previous dataset must be taken,
which is a frequently occuring case.<br />
If <a class="wikilink" href="../../input_variables/files/#getbscoup">getbscoup</a> is a negative number, it indicates the number of datasets to
go backward to find the needed file. In this case, if one refers to a non
existent data set (prior to the first), the coupling block is not initialised
from a disk file, so that it is as if <a class="wikilink" href="../../input_variables/files/#getbscoup">getbscoup</a>=0 for that initialisation.</p>
<hr />
<h2 id="getbseig"><strong>getbseig</strong><a class="headerlink" href="#getbseig" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the Bethe-Salpeter EIGenstates from ...<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v67mbpt:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t11.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials. W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV. First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian,  then the Haydock iterative method is employed to calculate the macroscopic dielectric function. The last dataset solves the BSE problem including the coupling between resonant and anti-resonant transition via brute force diagonalization. Shiva is disabled because the coupling part is unstable on this machine">tests/v67mbpt/Input/t11.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t14.in" title="LiF. Optical properties within BSE and PAW (Haydock method).">tests/v67mbpt/Input/t14.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t50.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with temperature-dependent renormalization WARNING: This feature is still under testing,  files and variables could change in the next versions">tests/v67mbpt/Input/t50.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t51.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with temperature-dependent renormalization WARNING: This feature is still under testing,  files and variables could change in the next versions">tests/v67mbpt/Input/t51.in</a></li>
</ul>
<p>Eventually used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (multi-dataset mode) and, in the case of
a Bethe-Salpeter calculation to indicate that the starting excitonic
eigenstates are to be taken from the output of a previous dataset. It is used
to chain the calculations, since it describes from which dataset the OUTPUT
eigenstates are to be taken, as INPUT eigenstates of the present dataset.<br />
If <a class="wikilink" href="../../input_variables/files/#getbseig">getbseig</a>==0, no such use of previously computed output eigenstates file
is done.<br />
If <a class="wikilink" href="../../input_variables/files/#getbseig">getbseig</a> is positive, its value gives the index of the dataset from
which the output states is to be used as input.<br />
If <a class="wikilink" href="../../input_variables/files/#getbseig">getbseig</a> is -1, the output eigenstates of the previous dataset must be
taken, which is a frequently occurring case.<br />
If <a class="wikilink" href="../../input_variables/files/#getbseig">getbseig</a> is a negative number, it indicates the number of datasets to
go backward to find the needed file. In this case, if one refers to a non
existent data set (prior to the first), the eigenstates are not initialised
from a disk file, so that it is as if <a class="wikilink" href="../../input_variables/files/#getbseig">getbseig</a>=0 for that initialisation.</p>
<hr />
<h2 id="getbsreso"><strong>getbsreso</strong><a class="headerlink" href="#getbsreso" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the Bethe-Salpeter RESOnant block from ...<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v67mbpt:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t11.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials. W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV. First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian,  then the Haydock iterative method is employed to calculate the macroscopic dielectric function. The last dataset solves the BSE problem including the coupling between resonant and anti-resonant transition via brute force diagonalization. Shiva is disabled because the coupling part is unstable on this machine">tests/v67mbpt/Input/t11.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t16.in" title="Silicon: Computation of the excitonic levels with the Bethe-Salpeter equation. Dataset3 uses the band-by-band conjugate gradient method to compute the lowest 10 states Dataset4 performs the same task with partial direct diagonalization (Lapack)">tests/v67mbpt/Input/t16.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t50.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with temperature-dependent renormalization WARNING: This feature is still under testing,  files and variables could change in the next versions">tests/v67mbpt/Input/t50.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t51.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with temperature-dependent renormalization WARNING: This feature is still under testing,  files and variables could change in the next versions">tests/v67mbpt/Input/t51.in</a></li>
</ul>
<p>Eventually used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (multi-dataset mode) and, in the case of
a Bethe-Salpeter calculation to indicate that the starting resonant block of
the excitonic Hamiltonian will be taken from the output of a previous dataset.
It is used to chain the calculations, since it describes from which dataset
the OUTPUT resonant block is to be taken, as INPUT of the present dataset.<br />
If <a class="wikilink" href="../../input_variables/files/#getbsreso">getbsreso</a>==0, no such use of previously computed resonant block file is
done.<br />
If <a class="wikilink" href="../../input_variables/files/#getbsreso">getbsreso</a> is positive, its value gives the index of the dataset to be
used as input.<br />
If <a class="wikilink" href="../../input_variables/files/#getbsreso">getbsreso</a> is -1, the output of the previous dataset must be taken,
which is a frequently occurring case.<br />
If <a class="wikilink" href="../../input_variables/files/#getbsreso">getbsreso</a> is a negative number, it indicates the number of datasets to
go backward to find the needed file. In this case, if one refers to a non
existent data set (prior to the first), the resonant block is not initialised
from a disk file, so that it is as if <a class="wikilink" href="../../input_variables/files/#getbsreso">getbsreso</a>=0 for that initialisation.</p>
<hr />
<h2 id="getddb"><strong>getddb</strong><a class="headerlink" href="#getddb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the DDB from ...<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/ElPhonInt">ElPhonInt</a>, <a class="wikilink" href="../../topics/TDepES">TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t58.in" title="Diamond. Test the getddb variable that cancels the divergence in el-ph for small q-points Such divergence is induced by a residual electric field. Note: The Fan terms in DATASET 6 should be different (renormalized) from the one of DATASET 5.">tests/v7/Input/t58.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t59.in" title="Diamond. Test the getddb variable that cancels the divergence in el-ph for small q-points Such divergence is induced by a residual electric field. Note: DATASET 7 test the irdddb that should behave exactly as getddb.">tests/v7/Input/t59.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t88.in" title="Calculation of phonon linewidths and e-ph coupling parameter lambda.">tests/v7/Input/t88.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t89.in" title="Calculation of e-ph coupling matrix elements">tests/v7/Input/t89.in</a></li>
<li>v8:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v8/Input/t44.in" title="WARNING: This code is still under development. Use at your own risk. Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements.">tests/v8/Input/t44.in</a></li>
</ul>
<p>This variable should be used when performing electron-phonon or temperature-
dependence calculations. The Born effective charge as well as the dielectric
tensor will be read from a previous DFPT calculations of the electric field at
q=Gamma. The use of this variable will trigger the cancellation of a residual
dipole that leads to an unphysical divergence of the GKK with vanishing
q-points. The use of this variable greatly improves the k-point convergence
speed as the density of the k-point grid required to obtain the fulfillment of
the charge neutrality sum rule is usually prohibitively large.<br />
If <a class="wikilink" href="../../input_variables/files/#getddb">getddb</a>==0, no such use of previously computed Born effective charge and
dielectric tensor is done.<br />
If <a class="wikilink" href="../../input_variables/files/#getddb">getddb</a> is positive, its value gives the index of the dataset from which
the output density is to be used as input.<br />
If <a class="wikilink" href="../../input_variables/files/#getddb">getddb</a> is -1, the output density of the previous dataset must be taken,
which is a frequently occurring case.<br />
If <a class="wikilink" href="../../input_variables/files/#getddb">getddb</a> is a negative number, it indicates the number of datasets to go
backward to find the needed file.<br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="getddk"><strong>getddk</strong><a class="headerlink" href="#getddk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the DDK wavefunctions from _1WF file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Eventually used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (in the multi-dataset mode), to indicate
starting wavefunctions, as an alternative to
<a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a>,<a class="wikilink" href="../../input_variables/files/#irdwfq">irdwfq</a>,<a class="wikilink" href="../../input_variables/files/#ird1wf">ird1wf</a>,<a class="wikilink" href="../../input_variables/files/#irdddk">irdddk</a>. One should first read the
explanations given for these latter variables.<br />
The <strong> getwfk </strong> , <strong> getwfq </strong> , <strong> get1wf </strong> and <a class="wikilink" href="../../input_variables/files/#getddk">getddk</a> variables are
typically used to chain the calculations in the multi-dataset mode, since they
describe from which dataset the OUTPUT wavefunctions are to be taken, as INPUT
wavefunctions of the present dataset.  </p>
<p>We now focus on the <strong> getwfk </strong> input variable (the only one used in ground-
state calculations), but the rules for <strong> getwfq </strong> and <strong> get1wf </strong> are
similar, with _WFK replaced by _WFQ or _1WF.<br />
If <strong> getwfk </strong> ==0, no use of previously computed output wavefunction file
appended with _DSx_WFK is done.<br />
If <strong> getwfk </strong> is positive, its value gives the index of the dataset for
which the output wavefunction file appended with _WFK must be used.<br />
If <strong> getwfk </strong> is -1, the output wf file with _WFK of the previous dataset
must be taken, which is a frequently occurring case.<br />
If <strong> getwfk </strong> is a negative number, it indicates the number of datasets to
go backward to find the needed wavefunction file. In this case, if one refers
to a non existent data set (prior to the first), the wavefunctions are not
initialised from a disk file, so that it is as if <strong> getwfk </strong> =0 for that
initialisation. Thanks to this rule, the use of <strong> getwfk </strong> -1 is rather
straightforward : except for the first wavefunctions, that are not initialized
by reading a disk file, the output wavefunction of one dataset is input of the
next one.<br />
In the case of a ddk calculation in a multi dataset run, in order to compute
correctly the localisation tensor, it is mandatory to declare give getddk the
value of the current dataset (i.e. getddk3 3 ) - this is a bit strange and
should be changed in the future.<br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="getden"><strong>getden</strong><a class="headerlink" href="#getden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the DENsity from ...<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Eventually used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (multi-dataset mode) and, in the case of
a ground-state calculation, if <a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a>&lt;0 (non-SCF calculation), to
indicate that the starting density is to be taken from the output of a
previous dataset. It is used to chain the calculations, since it describes
from which dataset the OUTPUT density are to be taken, as INPUT density of the
present dataset.<br />
If <a class="wikilink" href="../../input_variables/files/#getden">getden</a>==0, no such use of previously computed output density file is
done.<br />
If <a class="wikilink" href="../../input_variables/files/#getden">getden</a> is positive, its value gives the index of the dataset from which
the output density is to be used as input.<br />
If <a class="wikilink" href="../../input_variables/files/#getden">getden</a> is -1, the output density of the previous dataset must be taken,
which is a frequently occurring case.<br />
If <a class="wikilink" href="../../input_variables/files/#getden">getden</a> is a negative number, it indicates the number of datasets to go
backward to find the needed file. In this case, if one refers to a non
existent data set (prior to the first), the density is not initialised from a
disk file, so that it is as if <a class="wikilink" href="../../input_variables/files/#getden">getden</a>=0 for that initialisation. Thanks to
this rule, the use of <a class="wikilink" href="../../input_variables/files/#getden">getden</a> -1 is rather straightforward : except for the
first density, that is not initialized by reading a disk file, the output
density of one dataset is input of the next one.<br />
Be careful : the output density file of a run with non-zero <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a> does
not have the proper name (it has a "TIM" indication) for use as an input of an
<a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a>&lt;0 calculation.<br />
One should use the output density of a <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==0 run.<br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="gethaydock"><strong>gethaydock</strong><a class="headerlink" href="#gethaydock" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the HAYDOCK restart file from ...<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<p>Eventually used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (multi-dataset mode) and, in the case of
a Bethe-Salpeter calculation to indicate that the Haydock iterative technique
will be restarted from the output of a previous dataset.<br />
If <a class="wikilink" href="../../input_variables/files/#gethaydock">gethaydock</a>==0, no such use of previously computed coupling block file
is done.<br />
If <a class="wikilink" href="../../input_variables/files/#gethaydock">gethaydock</a> is positive, its value gives the index of the dataset to be
used as input.<br />
If <a class="wikilink" href="../../input_variables/files/#gethaydock">gethaydock</a> is -1, the output of the previous dataset must be taken,
which is a frequently occuring case.<br />
If <a class="wikilink" href="../../input_variables/files/#gethaydock">gethaydock</a> is a negative number, it indicates the number of datasets to
go backward to find the needed file. In this case, if one refers to a non
existent data set (prior to the first), the coupling block is not initialised
from a disk file, so that it is as if <a class="wikilink" href="../../input_variables/files/#gethaydock">gethaydock</a>=0 for that
initialisation.</p>
<hr />
<h2 id="getocc"><strong>getocc</strong><a class="headerlink" href="#getocc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET OCC parameters from ...<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v2:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t11.in" title="Orthorhombic Al system,  q(1/2 0 0),  partial occupation numbers. Compares with frozen-phonon calculations. Examine two cases: varying occupation numbers,  and fixed occupation numbers. A. Varying occupation numbers (occopt=4): RF calculation in dataset 5 gives 2DE equal to -3.812577 Ha,  while finite difference of &quot;TOTAL&quot; energy (datasets 6 and 7,  including entropy term) gives -3.812230 Ha (the agreement could be better with better finite difference) B. Fixed occupation numbers (occopt=2): RF calculation in dataset 8 gives 2DE equal to +5.431807 Ha,  while finite difference of total energy (no entropy term is present with occopt=2) gives +5.431857 Ha (the agreement could be better with better finite difference)">tests/v2/Input/t11.in</a></li>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t18.in" title="Orthorhombic Al system,  q(1/2 0 0),  partial occupation numbers. Compares with frozen-phonon calculations. Similar to test v2 #11,  except use of PBE GGA. Examine two cases: varying occupation numbers,  and fixed occupation numbers. A. Varying occupation numbers (occopt=4): RF calculation in dataset 5 gives 2DE equal to -4.053115 Ha,  while finite difference of &quot;TOTAL&quot; energy (datasets 6 and 7,  including entropy term) gives -4.0475002 Ha. This is fair,  BUT it does not improve with a better finite-difference,  so there is a problem. B. Fixed occupation numbers (occopt=2): RF calculation in dataset 8 gives 2DE equal to +5.394365 Ha,  while finite difference of total energy (no entropy term is present with occopt=2) gives +5.3998556 Ha This is fair,  BUT it does not improve with a better finite-difference,  so there is a problem. Then,  in dataset 11,  compute phonon frequencies at Gamma of the doubled cell. The 2DTE is 10.7997781 Ha,  which corresponds to 5.3998890 Ha,  so in much better agreement with the frozen-phonon calculation. TO BE UNDERSTOOD ...">tests/v3/Input/t18.in</a></li>
</ul>
<p>This variable is typically used to chain the calculations, in the multi-
dataset mode (<a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0), since it describes from which dataset the
array <a class="wikilink" href="../../input_variables/gstate/#occ">occ</a> is to be taken, as input of the present dataset. The occupation
numbers are <a class="wikilink" href="../../EVOLVING/">EVOLVING</a> variables, for which such a chain of calculations is
useful.<br />
If <a class="wikilink" href="../../input_variables/files/#getocc">getocc</a>==0, no such use of previously computed output occupations is
done.<br />
If <a class="wikilink" href="../../input_variables/files/#getocc">getocc</a> is positive, its value gives the index of the dataset from which
the data are to be used as input data. It must be the index of a dataset
already computed in the SAME run.<br />
If <a class="wikilink" href="../../input_variables/files/#getocc">getocc</a> is -1, the output data of the previous dataset must be taken,
which is a frequently occurring case.<br />
If <a class="wikilink" href="../../input_variables/files/#getocc">getocc</a> is a negative number, it indicates the number of datasets to go
backward to find the needed data. In this case, if one refers to a non
existent data set (prior to the first), the date is not initialised from a
disk file, so that it is as if <a class="wikilink" href="../../input_variables/files/#getocc">getocc</a>==0 for that initialisation.<br />
NOTE that a non-zero <a class="wikilink" href="../../input_variables/files/#getocc">getocc</a> MUST be used with <a class="wikilink" href="../../input_variables/basic/#occopt">occopt</a>==2, so that the
number of bands has to be initialized for each k point. Of course, these
numbers of bands must be identical to the numbers of bands of the dataset from
which <a class="wikilink" href="../../input_variables/gstate/#occ">occ</a> will be copied. The same is true for the number of k points.<br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="getqps"><strong>getqps</strong><a class="headerlink" href="#getqps" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET QuasiParticle Structure<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a>, <a class="wikilink" href="../../topics/GW">GW</a>, <a class="wikilink" href="../../topics/Susceptibility">Susceptibility</a>, <a class="wikilink" href="../../topics/SelfEnergy">SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (multi-dataset mode) and <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>=3, or 4
(screening or sigma step of a GW calculation), to indicate that the
eigenvalues and possibly the wavefunctions have to be taken from a previous
quasiparticle calculation (instead of the usual LDA starting point). This is
to achieve quasiparticle self-consistency. See also <a class="wikilink" href="../../input_variables/files/#irdqps">irdqps</a><br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="getscr"><strong>getscr</strong><a class="headerlink" href="#getscr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET SCReening (the inverse dielectric matrix) from ...<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a>, <a class="wikilink" href="../../topics/GW">GW</a>, <a class="wikilink" href="../../topics/SelfEnergy">SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (multi-dataset mode) and <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>=4 (sigma step
of a GW calculation), to indicate that the dielectric matrix (_SCR file) is to
be taken from the output of a previous dataset. It is used to chain the
calculations, since it describes from which dataset the OUTPUT dielectric
matrix is to be taken, as INPUT of the present dataset.<br />
If <a class="wikilink" href="../../input_variables/files/#getscr">getscr</a>==0, no such use of previously computed output _SCR file is done.<br />
If <a class="wikilink" href="../../input_variables/files/#getscr">getscr</a> is positive, its value gives the index of the dataset from which
the output _SCR file is to be used as input.<br />
If <a class="wikilink" href="../../input_variables/files/#getscr">getscr</a> is -1, the output _SCR file of the previous dataset must be
taken, which is a frequently occurring case.<br />
If <a class="wikilink" href="../../input_variables/files/#getscr">getscr</a> is a negative number, it indicates the number of datasets to go
backward to find the needed file. In this case, if one refers to a non
existent data set (prior to the first), the _SCR file is not initialised from
a disk file, so that it is as if <a class="wikilink" href="../../input_variables/files/#getscr">getscr</a>=0 for that initialisation.<br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="getsuscep"><strong>getsuscep</strong><a class="headerlink" href="#getsuscep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET SUSCEPtibility (the irreducible polarizability) from ...<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a>, <a class="wikilink" href="../../topics/GW">GW</a>, <a class="wikilink" href="../../topics/SelfEnergy">SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t70.in" title="Silicon One-shot GW calculation starting either from the SCR file or from the SUSC file. In the later case both the in-core solution and the out-of-core solution for the storage of the inverse dielectric matrix are tested.">tests/v5/Input/t70.in</a></li>
<li>v67mbpt:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t03.in" title="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl.">tests/v67mbpt/Input/t03.in</a></li>
</ul>
<p>Used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (multi-dataset mode) and <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>=4 (sigma step
of a GW calculation), to indicate that the irreducible polarizability (_SUSC
file) is to be taken from the output of a previous dataset. It is used to
chain the calculations, since it describes from which dataset the OUTPUT
susceptibility is to be taken, as INPUT of the present dataset. Performing a
GW calculations starting from the _SUSC file instead of the _SCR file presents
the advantage that starting from the irreducible polarizability, one can
calculate the screened interaction using different expressions without having
to perform a screening calculation from scratch. For example, it is possible
to apply a cutoff to the Coulomb interaction in order to facilitate the
convergence of the GW correction with respect to the size of the supercell
(see <a class="wikilink" href="../../input_variables/gw/#vcutgeo">vcutgeo</a> and <a class="wikilink" href="../../input_variables/gw/#icutcoul">icutcoul</a>)<br />
If <a class="wikilink" href="../../input_variables/files/#getsuscep">getsuscep</a>==0, no such use of previously computed output _SUSC file is
done.<br />
If <a class="wikilink" href="../../input_variables/files/#getsuscep">getsuscep</a> is positive, its value gives the index of the dataset from
which the output _SUSC file is to be used as input.<br />
If <a class="wikilink" href="../../input_variables/files/#getsuscep">getsuscep</a> is -1, the output _SUSC file of the previous dataset must be
taken, which is a frequently occurring case.<br />
If <a class="wikilink" href="../../input_variables/files/#getsuscep">getsuscep</a> is a negative number, it indicates the number of datasets to
go backward to find the needed file. In this case, if one refers to a non
existent data set (prior to the first), the _SUSC file is not initialised from
a disk file, so that it is as if <a class="wikilink" href="../../input_variables/files/#getsuscep">getsuscep</a>=0 for that initialisation.<br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="getwfk"><strong>getwfk</strong><a class="headerlink" href="#getwfk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the wavefunctions from _WFK file <br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Eventually used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (in the multi-dataset mode), to indicate
starting wavefunctions, as an alternative to <a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a>,<a class="wikilink" href="../../input_variables/files/#irdwfq">irdwfq</a>,<a class="wikilink" href="../../input_variables/files/#ird1wf">ird1wf</a>,
or <a class="wikilink" href="../../input_variables/files/#irdddk">irdddk</a>. One should first read the explanations given for these latter
variables.<br />
The <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a>, <strong> getwfq </strong> , <strong> get1wf </strong> and <strong> getddk </strong> variables are
typically used to chain the calculations in the multi-dataset mode, since they
describe from which dataset the OUTPUT wavefunctions are to be taken, as INPUT
wavefunctions of the present dataset.  </p>
<p>We now focus on the <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> input variable (the only one used in ground-
state calculations), but the rules for <strong> getwfq </strong> and <strong> get1wf </strong> are
similar, with _WFK replaced by _WFQ or _1WF.<br />
If <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a>==0, no use of previously computed output wavefunction file
appended with _DSx_WFK is done.<br />
If <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> is positive, its value gives the index of the dataset for which
the output wavefunction file appended with _WFK must be used.<br />
If <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> is -1, the output wf file with _WFK of the previous dataset must
be taken, which is a frequently occurring case.<br />
If <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> is a negative number, it indicates the number of datasets to go
backward to find the needed wavefunction file. In this case, if one refers to
a non existent data set (prior to the first), the wavefunctions are not
initialised from a disk file, so that it is as if <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a>=0 for that
initialisation. Thanks to this rule, the use of <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> -1 is rather
straightforward : except for the first wavefunctions, that are not initialized
by reading a disk file, the output wavefunction of one dataset is input of the
next one.<br />
In the case of a ddk calculation in a multi dataset run, in order to compute
correctly the localisation tensor, it is mandatory to declare give getddk the
value of the current dataset (i.e. getddk3 3 ) - this is a bit strange and
should be changed in the future.<br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="getwfq"><strong>getwfq</strong><a class="headerlink" href="#getwfq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the wavefunctions from _WFQ file <br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Eventually used when <a class="wikilink" href="../../input_variables/basic/#ndtset">ndtset</a>&gt;0 (in the multi-dataset mode), to indicate
starting wavefunctions, as an alternative to <a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a>,<a class="wikilink" href="../../input_variables/files/#irdwfq">irdwfq</a>,<a class="wikilink" href="../../input_variables/files/#ird1wf">ird1wf</a>
or <a class="wikilink" href="../../input_variables/files/#irdddk">irdddk</a>. One should first read the explanations given for these latter
variables.<br />
The <strong> getwfk </strong> , <a class="wikilink" href="../../input_variables/files/#getwfq">getwfq</a>, <strong> get1wf </strong> and <strong> getddk </strong> variables are
typically used to chain the calculations in the multi-dataset mode, since they
describe from which dataset the OUTPUT wavefunctions are to be taken, as INPUT
wavefunctions of the present dataset.  </p>
<p>We now focus on the <strong> getwfk </strong> input variable (the only one used in ground-
state calculations), but the rules for <a class="wikilink" href="../../input_variables/files/#getwfq">getwfq</a> and <strong> get1wf </strong> are
similar, with _WFK replaced by _WFQ or _1WF.<br />
If <strong> getwfk </strong> ==0, no use of previously computed output wavefunction file
appended with _DSx_WFK is done.<br />
If <strong> getwfk </strong> is positive, its value gives the index of the dataset for
which the output wavefunction file appended with _WFK must be used.<br />
If <strong> getwfk </strong> is -1, the output wf file with _WFK of the previous dataset
must be taken, which is a frequently occurring case.<br />
If <strong> getwfk </strong> is a negative number, it indicates the number of datasets to
go backward to find the needed wavefunction file. In this case, if one refers
to a non existent data set (prior to the first), the wavefunctions are not
initialised from a disk file, so that it is as if <strong> getwfk </strong> =0 for that
initialisation. Thanks to this rule, the use of <strong> getwfk </strong> -1 is rather
straightforward : except for the first wavefunctions, that are not initialized
by reading a disk file, the output wavefunction of one dataset is input of the
next one.<br />
In the case of a ddk calculation in a multi dataset run, in order to compute
correctly the localisation tensor, it is mandatory to declare give getddk the
value of the current dataset (i.e. getddk3 3 ) - this is a bit strange and
should be changed in the future.<br />
NOTE : a negative value of a "get" variable indicates the number of datasets
to go backwards; it is not the number to be subtracted from the current
dataset to find the proper dataset. As an example :</p>
<pre><code>  ndtset 3   jdtset 1 2 4  getXXX -1
</code></pre>
<p>refers to dataset 2 when dataset 4 is initialized.</p>
<hr />
<h2 id="ird1den"><strong>ird1den</strong><a class="headerlink" href="#ird1den" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of 1st-order DEN file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a> &lt; 0,
0 otherwise.</p>
<p>Test list:</p>
<ul>
<li>tutorespfn:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorespfn/Input/tnlo_11.in" title="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011">tests/tutorespfn/Input/tnlo_11.in</a></li>
</ul>
<p>If first order density is needed in single dataset mode (for example in
nonlinear optical response), use <a class="wikilink" href="../../input_variables/files/#ird1den">ird1den</a>=1 to read first-order densities
from _DENx files produced in other calculations. In multi-dataset mode use
<a class="wikilink" href="../../input_variables/files/#get1den">get1den</a>.</p>
<p>When iscf &lt; 0, the reading of a DEN file is always enforced.</p>
<p>A non-zero value of <strong> ird1den </strong> is treated in the same way as other "ird"
variables, see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4
</a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>.  </p>
<hr />
<h2 id="ird1wf"><strong>ird1wf</strong><a class="headerlink" href="#ird1wf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of _1WF files <br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>tutorespfn:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorespfn/Input/tnlo_11.in" title="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011">tests/tutorespfn/Input/tnlo_11.in</a></li>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t77.in" title="BaO crystal. Computation of band-by-band decomposition of Born effective charges. Also,  computation of the electronic localization tensor, and its band-by-band decomposition.">tests/v3/Input/t77.in</a></li>
</ul>
<p>Indicates eventual starting wavefunctions. As alternative, one can use the
input variables <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a>, <a class="wikilink" href="../../input_variables/files/#getwfq">getwfq</a>, <a class="wikilink" href="../../input_variables/files/#get1wf">get1wf</a> or <a class="wikilink" href="../../input_variables/files/#getddk">getddk</a>.  </p>
<p>Ground-state calculation :</p>
<ul>
<li>only <strong> irdwfk </strong> and <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> have a meaning </li>
<li>at most one of <strong> irdwfk </strong> or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> can be non-zero </li>
<li>if <strong> irdwfk </strong> and <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> are both zero, initialize wavefunctions with random numbers for ground state calculation. </li>
<li>if <strong> irdwfk </strong> = 1 : read ground state wavefunctions from a disk file appended with _WFK , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
</ul>
<p>Response-function calculation :</p>
<ul>
<li>one and only one of <strong> irdwfk </strong> or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> MUST be non-zero </li>
<li>if <strong> irdwfk </strong> = 1 : read ground state k -wavefunctions from a disk file appended with _WFK , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>only one of <strong> irdwfq </strong> or <a class="wikilink" href="../../input_variables/files/#getwfq">getwfq</a> can be non-zero, if both of them are non-zero, use as k + q file the one defined by <strong> irdwfk </strong> and/or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> </li>
<li>if <strong> irdwfq </strong> = 1 : read ground state k+q -wavefunctions from a disk file appended with _WFQ , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>at most one of <a class="wikilink" href="../../input_variables/files/#ird1wf">ird1wf</a> or <a class="wikilink" href="../../input_variables/files/#get1wf">get1wf</a> can be non-zero </li>
<li>if both are zero, initialize first order wavefunctions to zeroes </li>
<li>if <a class="wikilink" href="../../input_variables/files/#ird1wf">ird1wf</a> = 1 : read first-order wavefunctions from a disk file appended with _1WFx , produced in a previous response function calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>at most one of <strong> irdddk </strong> or <a class="wikilink" href="../../input_variables/files/#getddk">getddk</a> can be non-zero </li>
<li>one of them must be non-zero if an homogeneous electric field calculation is done (presently, a ddk calculation in the same dataset is not allowed) </li>
<li>if <strong> irdddk </strong> = 1 : read first-order ddk wavefunctions from a disk file appended with _1WFx , produced in a previous response function calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
</ul>
<hr />
<h2 id="irdbscoup"><strong>irdbscoup</strong><a class="headerlink" href="#irdbscoup" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of COUPling block<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/BSE">BSE</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<p>Start the Bethe-Salpeter calculation from the BSC file containing the coupling
block produced in a previous run.</p>
<hr />
<h2 id="irdbseig"><strong>irdbseig</strong><a class="headerlink" href="#irdbseig" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of BS_EIG file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/BSE">BSE</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v67mbpt:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t11.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials. W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV. First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian,  then the Haydock iterative method is employed to calculate the macroscopic dielectric function. The last dataset solves the BSE problem including the coupling between resonant and anti-resonant transition via brute force diagonalization. Shiva is disabled because the coupling part is unstable on this machine">tests/v67mbpt/Input/t11.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t14.in" title="LiF. Optical properties within BSE and PAW (Haydock method).">tests/v67mbpt/Input/t14.in</a></li>
</ul>
<p>Start the Bethe-Salpeter calculation from the BS_EIG contining the exciton
eigenvectors produced in a previous run.</p>
<hr />
<h2 id="irdbsreso"><strong>irdbsreso</strong><a class="headerlink" href="#irdbsreso" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of RESOnant block<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/BSE">BSE</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v67mbpt:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t32.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique In t31,  preparation,  BSE equation with Model dielectric function and Haydock (only resonant + W + v),  then full BSE In t32,  bs_interp_mode 1 In t33,  bs_interp_mode 2 In t34,  bs_interp_mode 3 In t35,  Rohlfing-Louie">tests/v67mbpt/Input/t32.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t33.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique In t31,  preparation,  BSE equation with Model dielectric function and Haydock (only resonant + W + v),  then full BSE In t32,  bs_interp_mode 1 In t33,  bs_interp_mode 2 In t34,  bs_interp_mode 3 In t35,  Rohlfing-Louie">tests/v67mbpt/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t34.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique In t31,  preparation,  BSE equation with Model dielectric function and Haydock (only resonant + W + v),  then full BSE In t32,  bs_interp_mode 1 In t33,  bs_interp_mode 2 In t34,  bs_interp_mode 3 In t35,  Rohlfing-Louie">tests/v67mbpt/Input/t34.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t35.in" title="Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique In t31,  preparation,  BSE equation with Model dielectric function and Haydock (only resonant + W + v),  then full BSE In t32,  bs_interp_mode 1 In t33,  bs_interp_mode 2 In t34,  bs_interp_mode 3 In t35,  Rohlfing-Louie">tests/v67mbpt/Input/t35.in</a></li>
</ul>
<p>Start the Bethe-Salpeter calculation from the BSR file containing the resonat
block produced in a previous run.</p>
<hr />
<h2 id="irdddb"><strong>irdddb</strong><a class="headerlink" href="#irdddb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of DDB file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/ElPhonInt">ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a> &lt; 0,
0 otherwise.</p>
<p>Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t58.in" title="Diamond. Test the getddb variable that cancels the divergence in el-ph for small q-points Such divergence is induced by a residual electric field. Note: The Fan terms in DATASET 6 should be different (renormalized) from the one of DATASET 5.">tests/v7/Input/t58.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t59.in" title="Diamond. Test the getddb variable that cancels the divergence in el-ph for small q-points Such divergence is induced by a residual electric field. Note: DATASET 7 test the irdddb that should behave exactly as getddb.">tests/v7/Input/t59.in</a></li>
</ul>
<p>This variable should be used when performing electron-phonon or temperature-
dependence calculations. The Born effective charge as well as the dielectric
tensor will be read from a previous DFPT calculations of the electric field at
q=Gamma. The use of this variable will trigger the cancellation of a residual
dipole that leads to an unphysical divergence of the GKK with vanishing
q-points. The use of this variable greatly improves the k-point convergence
speed as the density of the k-point grid required to obtain the fulfillment of
the charge neutrality sum rule is usually prohibitively large.</p>
<p>A non-zero value of <a class="wikilink" href="../../input_variables/files/#irdddb">irdddb</a> is treated in the same way as other "ird"
variables, see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4
</a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>.  </p>
<hr />
<h2 id="irdddk"><strong>irdddk</strong><a class="headerlink" href="#irdddk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of DDK wavefunctions, in _1WF files<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>tutorespfn:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorespfn/Input/tnlo_10.in" title="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011">tests/tutorespfn/Input/tnlo_10.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorespfn/Input/tnlo_11.in" title="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011">tests/tutorespfn/Input/tnlo_11.in</a></li>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t81.in" title="Compute silicon GS and DDK files,  in preparation for reading in next test using irdwfk and irdddk.">tests/v5/Input/t81.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t82.in" title="Compute silicon electric field perturbation,  using WFK and DDK files produced in previous test.">tests/v5/Input/t82.in</a></li>
</ul>
<p>Indicates eventual starting wavefunctions. As alternative, one can use the
input variables <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a>, <a class="wikilink" href="../../input_variables/files/#getwfq">getwfq</a>, <a class="wikilink" href="../../input_variables/files/#get1wf">get1wf</a> or <a class="wikilink" href="../../input_variables/files/#getddk">getddk</a>.  </p>
<p>Ground-state calculation :</p>
<ul>
<li>only <strong> irdwfk </strong> and <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> have a meaning </li>
<li>at most one of <strong> irdwfk </strong> or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> can be non-zero </li>
<li>if <strong> irdwfk </strong> and <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> are both zero, initialize wavefunctions with random numbers for ground state calculation. </li>
<li>if <strong> irdwfk </strong> = 1 : read ground state wavefunctions from a disk file appended with _WFK , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
</ul>
<p>Response-function calculation :</p>
<ul>
<li>one and only one of <strong> irdwfk </strong> or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> MUST be non-zero </li>
<li>if <strong> irdwfk </strong> = 1 : read ground state k -wavefunctions from a disk file appended with _WFK , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>only one of <strong> irdwfq </strong> or <a class="wikilink" href="../../input_variables/files/#getwfq">getwfq</a> can be non-zero, if both of them are non-zero, use as k + q file the one defined by <strong> irdwfk </strong> and/or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> </li>
<li>if <strong> irdwfq </strong> = 1 : read ground state k+q -wavefunctions from a disk file appended with _WFQ , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>at most one of <strong> ird1wf </strong> or <a class="wikilink" href="../../input_variables/files/#get1wf">get1wf</a> can be non-zero </li>
<li>if both are zero, initialize first order wavefunctions to zeroes </li>
<li>if <strong> ird1wf </strong> = 1 : read first-order wavefunctions from a disk file appended with _1WFx , produced in a previous response function calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>at most one of <a class="wikilink" href="../../input_variables/files/#irdddk">irdddk</a> or <a class="wikilink" href="../../input_variables/files/#getddk">getddk</a> can be non-zero </li>
<li>one of them must be non-zero if an homogeneous electric field calculation is done (presently, a ddk calculation in the same dataset is not allowed) </li>
<li>if <a class="wikilink" href="../../input_variables/files/#irdddk">irdddk</a> = 1 : read first-order ddk wavefunctions from a disk file appended with _1WFx , produced in a previous response function calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
</ul>
<hr />
<h2 id="irdden"><strong>irdden</strong><a class="headerlink" href="#irdden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of DEN file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a> &lt; 0,
0 otherwise.</p>
<p>Test list:</p>
<ul>
<li>tutorespfn:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorespfn/Input/tnlo_8.in" title="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011">tests/tutorespfn/Input/tnlo_8.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorespfn/Input/tnlo_9.in" title="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011">tests/tutorespfn/Input/tnlo_9.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorespfn/Input/tnlo_10.in" title="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011">tests/tutorespfn/Input/tnlo_10.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorespfn/Input/tnlo_11.in" title="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011">tests/tutorespfn/Input/tnlo_11.in</a></li>
<li>tutorial:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorial/Input/tudet_1.in" title="Fe bcc 2 atomic supercell - ferromag.- PAW DJA 2010 &amp; MT 2009 Prelimirary step for test v5#39 (macro_uj) and v5#40 (testirdden)">tests/tutorial/Input/tudet_1.in</a></li>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t38.in" title="Preliminary step for test 40: bcc Fe ferromagnetic structure. Relatively low cut-offs and few k-points. This test is done within GGA and magnetism in PAW formalism. Wavefunction printed to be used in v5#39  test. Density is printed out to prepare v5#40 test.">tests/v5/Input/t38.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t40.in" title="Density from test 38 is read;  then a non self-consistent calculation is done and the m-decomposed LDOS on the first atom is printed out.">tests/v5/Input/t40.in</a></li>
<li>wannier90:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t03.in" title="Cannot be executed in parallel (mlwfovl_qp) Si fcc,  in primitive cell (2 atoms/cell) Test of self-consistent model GW (2 iterations) following Faleev et al., [PRL 93,  126406 (2004)] followed by construction of quasiparticle maximally-localized wannier functions [Hamann &amp; Vanderbilt, arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test- acceptable speed,  and the results are poorly converged.  The input file is sufficiently annotated to serve as a model.  Note that well- converged GW calculations are extremely time consuming,  and in general it is advisable to run the SCGW part separately on a parallel system, and then run a separate serial job modeled on the last dataset, substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps, &quot; with appropriate links to the files produced in the serial run.  Note that the _DEN file from the first dataset is also needed as input,  although the discontinued &quot;irdden&quot; input variable is not needed or supported. Note that acceptable names for the secondary input file needed by the wannier90 library are wannier90.win,  w90.win,  abo_DSn_w90.win (ndtset &gt;0) and abo_w90.win (ndtset=0),  where abo is the 4th line of the .files file and n is the wannier dataset.">tests/wannier90/Input/t03.in</a></li>
</ul>
<p>Start the ground-state calculation from the density file of a previous run.
When iscf &lt; 0, the reading of a DEN file is always enforced.</p>
<p>A non-zero value of <a class="wikilink" href="../../input_variables/files/#irdden">irdden</a> is treated in the same way as other "ird"
variables, see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4
</a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>.  </p>
<hr />
<h2 id="irdhaydock"><strong>irdhaydock</strong><a class="headerlink" href="#irdhaydock" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of the HAYDOCK restart file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/BSE">BSE</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<p>Used to re-start the Haydock iterative technique from the HAYDR_SAVE file
produced in a previous run.</p>
<hr />
<h2 id="irdqps"><strong>irdqps</strong><a class="headerlink" href="#irdqps" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of QuasiParticle Structure<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/GW">GW</a>, <a class="wikilink" href="../../topics/multidtset">multidtset</a>, <a class="wikilink" href="../../topics/Susceptibility">Susceptibility</a>, <a class="wikilink" href="../../topics/SelfEnergy">SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v67mbpt:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t04.in" title="Carbon in diamond structure. Chained GW calculation: The first run produces the WFK,  the SCR,  the SUSC and the QPS file. These file are subsequently read and used in t537 using irdwfk,  irdscr,  irdsuscep and irdqps In the second dataset of t85,  the screened interaction W is approximated using the test-electron expression with the TDDFT ALDA kernel (gwgamma==1).">tests/v67mbpt/Input/t04.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t05.in" title="Carbon in diamond structure. Chained GW calculation: The first run produces the KSS,  the SCR,  the SUSC and the QPS file. These file are subsequently read and used in t537 using irdwfk,  irdscr,  irdsuscep and irdqps In the second dataset of t85,  the screened interaction W is approximated using the test-electron expression with the TDDFT ALDA kernel (gwgamma==1).">tests/v67mbpt/Input/t05.in</a></li>
<li>wannier90:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t03.in" title="Cannot be executed in parallel (mlwfovl_qp) Si fcc,  in primitive cell (2 atoms/cell) Test of self-consistent model GW (2 iterations) following Faleev et al., [PRL 93,  126406 (2004)] followed by construction of quasiparticle maximally-localized wannier functions [Hamann &amp; Vanderbilt, arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test- acceptable speed,  and the results are poorly converged.  The input file is sufficiently annotated to serve as a model.  Note that well- converged GW calculations are extremely time consuming,  and in general it is advisable to run the SCGW part separately on a parallel system, and then run a separate serial job modeled on the last dataset, substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps, &quot; with appropriate links to the files produced in the serial run.  Note that the _DEN file from the first dataset is also needed as input,  although the discontinued &quot;irdden&quot; input variable is not needed or supported. Note that acceptable names for the secondary input file needed by the wannier90 library are wannier90.win,  w90.win,  abo_DSn_w90.win (ndtset &gt;0) and abo_w90.win (ndtset=0),  where abo is the 4th line of the .files file and n is the wannier dataset.">tests/wannier90/Input/t03.in</a></li>
</ul>
<p>Relevant only when <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>=3 or 4. Indicate the file from which the
eigenvalues and possibly the wavefunctions must be obtained, in order to
achieve a self-consistent quasiparticle calculations. See also <a class="wikilink" href="../../input_variables/files/#getqps">getqps</a></p>
<hr />
<h2 id="irdscr"><strong>irdscr</strong><a class="headerlink" href="#irdscr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of the SCReening<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/GW">GW</a>, <a class="wikilink" href="../../topics/multidtset">multidtset</a>, <a class="wikilink" href="../../topics/SelfEnergy">SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>tutoparal:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutoparal/Input/tmbt_4.in" title="GW calculation for crystalline alpha-quartz. Sigma calculation">tests/tutoparal/Input/tmbt_4.in</a></li>
<li>tutorial:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorial/Input/tbs_2.in" title="Crystalline silicon BS run: Tamm-Dancoff approximation solved with the Haydock algorithm.">tests/tutorial/Input/tbs_2.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorial/Input/tbs_3.in" title="Crystalline silicon Convergence of the number of bands in the transition space.">tests/tutorial/Input/tbs_3.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorial/Input/tbs_4.in" title="Crystalline silicon BS run: convergence in ecuteps">tests/tutorial/Input/tbs_4.in</a></li>
<li>v67mbpt:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t04.in" title="Carbon in diamond structure. Chained GW calculation: The first run produces the WFK,  the SCR,  the SUSC and the QPS file. These file are subsequently read and used in t537 using irdwfk,  irdscr,  irdsuscep and irdqps In the second dataset of t85,  the screened interaction W is approximated using the test-electron expression with the TDDFT ALDA kernel (gwgamma==1).">tests/v67mbpt/Input/t04.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t05.in" title="Carbon in diamond structure. Chained GW calculation: The first run produces the KSS,  the SCR,  the SUSC and the QPS file. These file are subsequently read and used in t537 using irdwfk,  irdscr,  irdsuscep and irdqps In the second dataset of t85,  the screened interaction W is approximated using the test-electron expression with the TDDFT ALDA kernel (gwgamma==1).">tests/v67mbpt/Input/t05.in</a></li>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t23.in" title="For SrVO3,  compute density,  WFC and KSS files.">tests/v7/Input/t23.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t24.in" title="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23">tests/v7/Input/t24.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t25.in" title="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals. Uses KSS and SCR file from tests 23 and 24.">tests/v7/Input/t25.in</a></li>
</ul>
<p>Relevant only when <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>=4. Indicate the file from which the
dielectric matrix must be obtained. As alternative, one can use the input
variable <a class="wikilink" href="../../input_variables/files/#getscr">getscr</a>.<br />
When <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>=4, at least one of <a class="wikilink" href="../../input_variables/files/#irdscr">irdscr</a> or <a class="wikilink" href="../../input_variables/files/#getscr">getscr</a> (alternatively,
<a class="wikilink" href="../../input_variables/files/#irdsuscep">irdsuscep</a> or <a class="wikilink" href="../../input_variables/files/#getsuscep">getsuscep</a>) must be non-zero.</p>
<p>A non-zero value of <a class="wikilink" href="../../input_variables/files/#irdscr">irdscr</a> is treated in the same way as other "ird"
variables, see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4
</a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>.</p>
<hr />
<h2 id="irdsuscep"><strong>irdsuscep</strong><a class="headerlink" href="#irdsuscep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of the SUSCEPtibility<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/GW">GW</a>, <a class="wikilink" href="../../topics/multidtset">multidtset</a>, <a class="wikilink" href="../../topics/SelfEnergy">SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v67mbpt:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t04.in" title="Carbon in diamond structure. Chained GW calculation: The first run produces the WFK,  the SCR,  the SUSC and the QPS file. These file are subsequently read and used in t537 using irdwfk,  irdscr,  irdsuscep and irdqps In the second dataset of t85,  the screened interaction W is approximated using the test-electron expression with the TDDFT ALDA kernel (gwgamma==1).">tests/v67mbpt/Input/t04.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t05.in" title="Carbon in diamond structure. Chained GW calculation: The first run produces the KSS,  the SCR,  the SUSC and the QPS file. These file are subsequently read and used in t537 using irdwfk,  irdscr,  irdsuscep and irdqps In the second dataset of t85,  the screened interaction W is approximated using the test-electron expression with the TDDFT ALDA kernel (gwgamma==1).">tests/v67mbpt/Input/t05.in</a></li>
</ul>
<p>Relevant only when <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>=4. Indicate the file from which the
irreducible polarizability must be obtained. As alternative, one can use the
input variable <a class="wikilink" href="../../input_variables/files/#getsuscep">getsuscep</a>.<br />
When <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>=4, at least one of <a class="wikilink" href="../../input_variables/files/#irdsuscep">irdsuscep</a> or <a class="wikilink" href="../../input_variables/files/#getsuscep">getsuscep</a>
(alternatively, <a class="wikilink" href="../../input_variables/files/#irdscr">irdscr</a> or <a class="wikilink" href="../../input_variables/files/#getscr">getscr</a>) must be non-zero.</p>
<p>A non-zero value of <a class="wikilink" href="../../input_variables/files/#irdsuscep">irdsuscep</a> is treated in the same way as other "ird"
variables, see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4
</a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>.</p>
<hr />
<h2 id="irdwfk"><strong>irdwfk</strong><a class="headerlink" href="#irdwfk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of _WFK files<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/multidtset">multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Indicates eventual starting wavefunctions. As alternative, one can use the
input variables <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a>, <a class="wikilink" href="../../input_variables/files/#getwfq">getwfq</a>, <a class="wikilink" href="../../input_variables/files/#get1wf">get1wf</a> or <a class="wikilink" href="../../input_variables/files/#getddk">getddk</a>.  </p>
<p>Ground-state calculation :</p>
<ul>
<li>only <a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a> and <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> have a meaning </li>
<li>at most one of <a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a> or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> can be non-zero </li>
<li>if <a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a> and <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> are both zero, initialize wavefunctions with random numbers for ground state calculation. </li>
<li>if <a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a> = 1 : read ground state wavefunctions from a disk file appended with _WFK , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
</ul>
<p>Response-function calculation :</p>
<ul>
<li>one and only one of <a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a> or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> MUST be non-zero </li>
<li>if <a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a> = 1 : read ground state k -wavefunctions from a disk file appended with _WFK , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>only one of <strong> irdwfq </strong> or <a class="wikilink" href="../../input_variables/files/#getwfq">getwfq</a> can be non-zero, if both of them are non-zero, use as k + q file the one defined by <a class="wikilink" href="../../input_variables/files/#irdwfk">irdwfk</a> and/or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> </li>
<li>if <strong> irdwfq </strong> = 1 : read ground state k+q -wavefunctions from a disk file appended with _WFQ , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>at most one of <strong> ird1wf </strong> or <a class="wikilink" href="../../input_variables/files/#get1wf">get1wf</a> can be non-zero </li>
<li>if both are zero, initialize first order wavefunctions to 0's. </li>
<li>if <strong> ird1wf </strong> = 1 : read first-order wavefunctions from a disk file appended with _1WFx , produced in a previous response function calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>at most one of <strong> irdddk </strong> or <a class="wikilink" href="../../input_variables/files/#getddk">getddk</a> can be non-zero </li>
<li>one of them must be non-zero if an homogeneous electric field calculation is done (presently, a ddk calculation in the same dataset is not allowed) </li>
<li>if <strong> irdddk </strong> = 1 : read first-order ddk wavefunctions from a disk file appended with _1WFx , produced in a previous response function calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
</ul>
<hr />
<h2 id="irdwfq"><strong>irdwfq</strong><a class="headerlink" href="#irdwfq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of _WFQ files<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>paral:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t53.in" title="FCC Al metallic;  10 phonon at 1/4 1/8 1/8">tests/paral/Input/t53.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t53.in" title="FCC Al metallic;  10 phonon at 1/4 1/8 1/8">tests/paral/Input/t53.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t53.in" title="FCC Al metallic;  10 phonon at 1/4 1/8 1/8">tests/paral/Input/t53.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t53.in" title="FCC Al metallic;  10 phonon at 1/4 1/8 1/8">tests/paral/Input/t53.in</a></li>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t51.in" title="This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the previous test. The third q-point is computed here.">tests/v7/Input/t51.in</a></li>
</ul>
<p>Indicates eventual starting wavefunctions. As alternative, one can use the
input variables <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a>, <a class="wikilink" href="../../input_variables/files/#getwfq">getwfq</a>, <a class="wikilink" href="../../input_variables/files/#get1wf">get1wf</a> or <a class="wikilink" href="../../input_variables/files/#getddk">getddk</a>.  </p>
<p>Ground-state calculation :</p>
<ul>
<li>only <strong> irdwfk </strong> and <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> have a meaning </li>
<li>at most one of <strong> irdwfk </strong> or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> can be non-zero </li>
<li>if <strong> irdwfk </strong> and <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> are both zero, initialize wavefunctions with random numbers for ground state calculation. </li>
<li>if <strong> irdwfk </strong> = 1 : read ground state wavefunctions from a disk file appended with _WFK , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
</ul>
<p>Response-function calculation :</p>
<ul>
<li>one and only one of <strong> irdwfk </strong> or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> MUST be non-zero </li>
<li>if <strong> irdwfk </strong> = 1 : read ground state k -wavefunctions from a disk file appended with _WFK , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>only one of <a class="wikilink" href="../../input_variables/files/#irdwfq">irdwfq</a> or <a class="wikilink" href="../../input_variables/files/#getwfq">getwfq</a> can be non-zero, if both of them are non-zero, use as k + q file the one defined by <strong> irdwfk </strong> and/or <a class="wikilink" href="../../input_variables/files/#getwfk">getwfk</a> </li>
<li>if <a class="wikilink" href="../../input_variables/files/#irdwfq">irdwfq</a> = 1 : read ground state k+q -wavefunctions from a disk file appended with _WFQ , produced in a previous ground state calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>at most one of <strong> ird1wf </strong> or <a class="wikilink" href="../../input_variables/files/#get1wf">get1wf</a> can be non-zero </li>
<li>if both are zero, initialize first order wavefunctions to 0's. </li>
<li>if <strong> ird1wf </strong> = 1 : read first-order wavefunctions from a disk file appended with _1WFx , produced in a previous response function calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
<li>at most one of <strong> irdddk </strong> or <a class="wikilink" href="../../input_variables/files/#getddk">getddk</a> can be non-zero </li>
<li>one of them must be non-zero if an homogeneous electric field calculation is done (presently, a ddk calculation in the same dataset is not allowed) </li>
<li>if <strong> irdddk </strong> = 1 : read first-order ddk wavefunctions from a disk file appended with _1WFx , produced in a previous response function calculation (see the <a href="../../../users/generated_files/help_abinit.html#4"> section 4 </a> of the <a class="wikilink" href="../../help_abinit/">help_abinit</a>). </li>
</ul>
<hr />
<h2 id="kssform"><strong>kssform</strong><a class="headerlink" href="#kssform" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Kohn Sham Structure file FORMat<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Susceptibility">Susceptibility</a>, <a class="wikilink" href="../../topics/SelfEnergy">SelfEnergy</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
Test list:</p>
<ul>
<li>etsf_io:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/etsf_io/Input/t02.in" title="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart.">tests/etsf_io/Input/t02.in</a></li>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t23.in" title="For SrVO3,  compute density,  WFC and KSS files.">tests/v7/Input/t23.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t24.in" title="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23">tests/v7/Input/t24.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t25.in" title="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals. Uses KSS and SCR file from tests 23 and 24.">tests/v7/Input/t25.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t71.in" title="Calculation of Projected Wannier functions and compute band structure in the d orbital Wannier basis">tests/v7/Input/t71.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t72.in" title="Calculation of Projected Wannier functions and compute a simplified interpolated band structure">tests/v7/Input/t72.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t78.in" title="For SrVO3,  compute cRPA screened interaction U in the d-dp(b) model">tests/v7/Input/t78.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t79.in" title="For SrVO3,  compute cRPA screened interaction U by excluding an energy window to compute epsilon">tests/v7/Input/t79.in</a></li>
</ul>
<p>Governs the choice of the format for the file that contains the Kohn-Sham
electronic structure information, for use in GW calculations, see the input
variables <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a> and <a class="wikilink" href="../../input_variables/gw/#nbandkss">nbandkss</a>.</p>
<ul>
<li><a class="wikilink" href="../../input_variables/files/#kssform">kssform</a>=1, a single file .kss (double precision) containing complete information on the Kohn Sham Structure (eigenstates and the pseudopotentials used) will be generated through full diagonalization of the complete Hamiltonian matrix. The file has at the beginning the standard abinit header. </li>
<li><a class="wikilink" href="../../input_variables/files/#kssform">kssform</a>=3, a single file .kss (double precision) containing complete information on the Kohn Sham Structure (eigenstates and the pseudopotentials used) will be generated through the usual conjugate gradient algorithm (so, a restricted number of states). The file has at the beginning the standard abinit header. </li>
</ul>
<p>Very important : for the time being, <a class="wikilink" href="../../input_variables/dev/#istwfk">istwfk</a> must be 1 for all the
k-points.</p>
<hr />
<h2 id="prt1dm"><strong>prt1dm</strong><a class="headerlink" href="#prt1dm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT 1-DiMensional potential and density<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>fast:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/fast/Input/t30.in" title="This test is due to Z. Levine. It is a run on Si with the bond center at the origin. Also write density and potential with prtden=9 and prtpot=2 .">tests/fast/Input/t30.in</a></li>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a></li>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t04.in" title="Test natsph_extra,  ratsph_extra,  and xredsph_extra for STS calculation. Al (111) surface slab with very low ecut and ngkpt in the plane.">tests/v7/Input/t04.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t05.in" title="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff and kpts,  non collinear spin case with nspden=4 imposed. First normal case then constrain direction only (DS2) and full value of vector (DS3)">tests/v7/Input/t05.in</a></li>
</ul>
<p>If set &gt;= 1, provide one-dimensional projection of potential and density,
for each of the three axis. This corresponds to averaging the potential or the
density on bi-dimensional slices of the FFT grid.</p>
<hr />
<h2 id="prtden"><strong>prtden</strong><a class="headerlink" href="#prtden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the DENsity<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0 if <a class="wikilink" href="../../input_variables/rlx/#nimage">nimage</a>&gt;1,
1 otherwise.</p>
<p>If set to 1 or a larger value , provide output of electron density in real
space rho(r), in units of electrons/Bohr^3.<br />
If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==0, the name of the density file will be the root output name,
followed by _DEN .<br />
If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==1 or 2, density files will be output at each time step, with
the name being made of</p>
<ul>
<li>the root output name, </li>
<li>followed by _TIMx , where x is related to the timestep (see later) </li>
<li>then followed by _DEN </li>
</ul>
<p>The file structure of the unformatted output file is described below, see
section 6).<br />
If <a class="wikilink" href="../../input_variables/files/#prtden">prtden</a> is lower than 0, two files will be printed for restart every
<a class="wikilink" href="../../input_variables/files/#prtden">prtden</a> step, with the names being made of</p>
<ul>
<li>the root temporary name, </li>
<li>followed by _DEN_x , where x is 0000 or 0001 alternatively. </li>
<li>The most recent of the two files should be used for restart, and copied to root input name_DS2_DEN </li>
<li>To perform a restart, in a multidataset mode, use ndtset 2 and jdtset 2 3 (that is 2 datasets, numbered 2 and 3) </li>
<li>In the dataset 2, get the density you just copied (getden2 -1), perform a non selfconsistent calculation and print the wave function (prtwf2 1) </li>
<li>In the dataset 3, get the previous wf(getwfk3 -1), and continue the calculation </li>
<li>This complicated procedure is due to the fact that reading the density is only allowed for a non sc calculation, and also for a dataset different of 0 or the previous one, the option we choose here. </li>
</ul>
<p>Please note that in the case of PAW (<a class="wikilink" href="../../input_variables/internal/#usepaw">usepaw</a>=1) calculations, the _DEN
density output is not the full physical electron density. If what is wanted is
the full physical electron density, say for post-processing with <a href="../../../users/generated_files/help_aim.html"> AIM
</a> or visualization, prtden &gt; 1
will produce physical electron density or other interesting quantities (see
below). Nevertheless, even in the PAW case, when chaining together
calculations where the density from one calculation is to be used in a
subsequent calculation, it is necessary to use the _DEN files and <strong> not </strong>
one of the other files produced with prtden &gt; 1, i.e. _PAWDEN, ATMDEN_xxx
or else. Note that the usual _DEN file is always generated as soon as prtden
&gt;= 1. Options 2 to 6 for prtden are relevant only for <a class="wikilink" href="../../input_variables/internal/#usepaw">usepaw</a>=1 and
control the output of the full electron density in the PAW case :  </p>
<p><strong> prtden=2 </strong> causes generation of a file _PAWDEN that contains the bulk <strong> valence </strong> charge density together with the PAW on-site contributions, and has the same format as the other density files. <br />
<strong> prtden=3 </strong> causes generation of a file _PAWDEN that contains the bulk <strong> full </strong> charge density (valence+core) <br />
<strong> prtden=4 </strong> causes generation of three files _ATMDEN_CORE, _ATMDEN_VAL and _ATMDEN_FULL which respectively contain the core, valence and full atomic protodensity (the density of the individual component atoms in vacuum superposed at the bulk atomic positions). This can be used to generate various visualizations of the bonding density. <br />
<strong> prtden=5 </strong> options 2 and 4 taken together. <br />
<strong> prtden=6 </strong> options 3 and 4 taken together. <br />
<strong> prtden=7 </strong> causes the generation of all the individual contributions to the bulk <strong> valence </strong> charge density : n_tilde-n_hat (_N_TILDE), n_onsite (_N_ONE) and n_tilde_onsite (_NT_ONE). This is for diagnosis purposes only.   </p>
<p>Options 3 to 6 currently require the user to supply the atomic core and
valence density in external files in the working directory. The files must be
named properly; for example, the files for an atom of type 1 should be named:
"core_density_atom_type1.dat" and "valence_density_atom_type1.dat". The file
should be a text file, where the first line is assumed to be a comment, and
the subsequent lines contain two values each, where the first one is a radial
coordinate and the second the value of the density n(r). Please note that it
is n(r) which should be supplied, <strong> not </strong> n(r)/r^2. The first coordinate
point must be the origin, i.e. <strong> _ r = 0 _ </strong> . The atomic densities are
spherically averaged, so assumed to be completely spherically symmetric, even
for open shells.  </p>
<p>NOTE: in the PAW case, <strong> DO NOT </strong> use _PAWDEN or _ATMDEN_xxx files produced
by prtden &gt; 1 to chain the density output from one calculation as the input
to another, use the _DEN file for that.</p>
<hr />
<h2 id="prtdos"><strong>prtdos</strong><a class="headerlink" href="#prtdos" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the Density Of States<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a>, <a class="wikilink" href="../../topics/ElecDOS">ElecDOS</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Provide output of Density of States if set to 1, 2 or 3. Can either use a
smearing technique (<a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=1), or the tetrahedron method (<a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=2).
If <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=3, provide output of Local Density of States inside a sphere
centered on an atom, as well as the angular-momentum projected DOS, in the
same sphere. The resolution of the linear grid of energies for which the DOS
is computed can be tuned thanks to <a class="wikilink" href="../../input_variables/gstate/#dosdeltae">dosdeltae</a>.</p>
<p>If <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=1, the smeared density of states is obtained from the
eigenvalues, properly weighted at each k point using <a class="wikilink" href="../../input_variables/basic/#wtk">wtk</a>, and smeared
according to <a class="wikilink" href="../../input_variables/basic/#occopt">occopt</a> and <a class="wikilink" href="../../input_variables/gstate/#tsmear">tsmear</a>. All levels that are present in the
calculation are taken into account (occupied and unoccupied). Note that
<a class="wikilink" href="../../input_variables/basic/#occopt">occopt</a> must be between 3 and 7 . Also note that the sampling of the
Brillouin Zone that is needed to get a converged DOS is usually much finer
than the sampling needed to converge the total energy or the geometry of the
system, unless <a class="wikilink" href="../../input_variables/gstate/#tsmear">tsmear</a> is very large (hence the DOS is not obtained
properly).. A separate convergence study is needed.<br />
In order to compute the DOS of an insulator with <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=1, compute its
density thanks to a self-consistent calculation (with a non-metallic
<a class="wikilink" href="../../input_variables/basic/#occopt">occopt</a> value, 0, 1 or 2), then use <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=1, together with
<a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a>=-3, and a metallic <a class="wikilink" href="../../input_variables/basic/#occopt">occopt</a>, between 3 and 7, providing the needed
smearing. If <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=1, the name of the DOS file is the root name for the
output files, followed by "_DOS" .</p>
<p>If <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=2, the DOS is computed using the tetrahedron method. As in the
case of <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=1, all levels that are present in the calculation are taken
into account (occupied and unoccupied). In this case, the k-points must have
been defined using the input variable <a class="wikilink" href="../../input_variables/basic/#ngkpt">ngkpt</a> or the input variable
<a class="wikilink" href="../../input_variables/gstate/#kptrlatt">kptrlatt</a>. There must be at least two non-equivalent points in the
Irreducible Brillouin Zone to use <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=2. It is strongly advised to use
a non-shifted k-point grid (<a class="wikilink" href="../../input_variables/basic/#shiftk">shiftk</a> 0 0 0): such grids contain naturally
more extremal points (band minima and maxima at Gamma or at the zone-
boundaries) than shifted grids, and lead to more non-equivalent points than
shifted grids, for the same grid spacing. There is no need to take care of the
<a class="wikilink" href="../../input_variables/basic/#occopt">occopt</a> or <a class="wikilink" href="../../input_variables/gstate/#tsmear">tsmear</a> input variables, and there is no subtlety to be taken
into account for insulators. The computation can be done in the self-
consistent case as well as in the non-self-consistent case, using <a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a>=-3.
This allows to refine the DOS at fixed starting density.<br />
In that case, if <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==0, the name of the potential file will be the
root output name, followed by _DOS (like in the <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=1 case).<br />
However, if <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==1 or 2, potential files will be output at each time
step, with the name being made of</p>
<ul>
<li>the root output name, </li>
<li>followed by _TIMx , where x is related to the timestep (see later) </li>
<li>then followed by _DOS. </li>
</ul>
<p>If <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=3, the same tetrahedron method as for <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=2 is used, but
the DOS inside a sphere centered on some atom is delivered, as well as the
angular-momentum projected (l=0,1,2,3,4) DOS in the same sphere. The
preparation of this case, the parameters under which the computation is to be
done, and the file denomination is similar to the <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=2 case. However,
three additional input variables might be provided, describing the atoms that
are the center of the sphere (input variables <a class="wikilink" href="../../input_variables/gstate/#natsph">natsph</a> and <a class="wikilink" href="../../input_variables/gstate/#iatsph">iatsph</a>), as
well as the radius of this sphere (input variable <a class="wikilink" href="../../input_variables/gstate/#ratsph">ratsph</a>).<br />
In case of PAW, <a class="wikilink" href="../../input_variables/gstate/#ratsph">ratsph</a> radius has to be greater or equal to largest PAW
radius of the atom types considered (which is read from the PAW atomic data
file; see rc_sph or r_paw). Additional printing and/or approximations in PAW
mode can be controlled with <a class="wikilink" href="../../input_variables/paw/#pawprtdos">pawprtdos</a> keyword (in
particular,<a class="wikilink" href="../../input_variables/paw/#pawprtdos">pawprtdos</a>=2 can be used to compute quickly a very good
approximation of the DOS).  </p>
<p>Note 1: when <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=3, it is possible to output m-decomposed LDOS in _DOS
file; simply use <a class="wikilink" href="../../input_variables/files/#prtdosm">prtdosm</a> keyword.<br />
Note 2: the integrated total DOS in spheres around atoms can be obtained when
<a class="wikilink" href="../../input_variables/gstate/#prtdensph">prtdensph</a> flag is activated. It can be compared to the integrated DOS
provided in _DOS file when <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=3.</p>
<p><a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=4 delivers the sphere-projected DOS (like <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=3), on the
basis of a smearing approach (like <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=1)</p>
<p><a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=5 delivers the spin-spin DOS in the <a class="wikilink" href="../../input_variables/gstate/#nspinor">nspinor</a>==2 case, using the
tetrahedron method (as <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=2).</p>
<hr />
<h2 id="prtdosm"><strong>prtdosm</strong><a class="headerlink" href="#prtdosm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the Density Of States with M decomposition<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a>, <a class="wikilink" href="../../topics/ElecDOS">ElecDOS</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t40.in" title="Density from test 38 is read;  then a non self-consistent calculation is done and the m-decomposed LDOS on the first atom is printed out.">tests/v5/Input/t40.in</a></li>
</ul>
<p>Relevant only when <a class="wikilink" href="../../input_variables/files/#prtdos">prtdos</a>=3.<br />
If set to 1, the m-decomposed LDOS is delivered in DOS file.<br />
Note that <a class="wikilink" href="../../input_variables/files/#prtdosm">prtdosm</a> computes the M-resolved partial dos for complex
spherical harmonics,giving e.g. DOS(L,M) == DOS(L,-M) (without spin-orbit). In
the contrary, the LDA+U occupation matrix, see <a class="wikilink" href="../../input_variables/paw/#dmatpawu">dmatpawu</a> is in the real
spherical harmonics basis.<br />
If set to 2, the m-decomposed LDOS is delivered in DOS file.<br />
In this case, <a class="wikilink" href="../../input_variables/files/#prtdosm">prtdosm</a> computes the M-resolved partial dos for real
spherical harmonics in the same basis as the LDA+U occupation matrix.</p>
<hr />
<h2 id="prteig"><strong>prteig</strong><a class="headerlink" href="#prteig" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT EIGenenergies<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0 if <a class="wikilink" href="../../input_variables/rlx/#nimage">nimage</a> &gt; 1,
1 otherwise.</p>
<p>If set to 1, a file *_EIG, containing the k-points and one-electron
eigenvalues is printed.</p>
<hr />
<h2 id="prtelf"><strong>prtelf</strong><a class="headerlink" href="#prtelf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT Electron Localization Function (ELF)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a></li>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t50.in" title="Lithium atom,  isolated,  in a supercell. Test all current ELF output in different cases - no spin - spin-polarized collinear (nspinor=1,  nspden=2,  nsppol=2,  no spin-orbit) Both with fixed occupation numbers.">tests/v5/Input/t50.in</a></li>
</ul>
<p>If set to 1 or a larger value, provide output of ELF in real space elf(r).
This is a dimensionless quantity bounded between 0 and 1.<br />
The name of the ELF file will be the root output name, followed by _ELF.<br />
Like a _DEN file, it can be analyzed by cut3d. However unlike densities, in
case of spin polarized calculations, the spin down component can not be
obtained by subtracting the spin up component to the total ELF. Hence when
spin polarized calculations are performed the code produces also output files
with _ELF_UP and _ELF_DOWN extensions. (For technical reasons these files
contain also two components but the second is zero. So to perform analysis of
_ELF_UP and _ELF_DOWN files with cut3d you have to answer "ispden= 0 ==&gt;
Total density" when cut3d ask you which ispden to choose. Also remember that
spin down component can not be obtained by using cut3d on the _ELF file. Sorry
for the inconvenience, this will be fixed in the next release.)<br />
ELF is not yet implemented in non collinear spin case.<br />
If prtelf is set to 2, in the case of spin polarized calculation, the total
ELF is computed from an alternative approach which should better take into
account the existence of spin dependent densities (see the documentation in
/doc/theory/ELF of your ABINIT repository)  </p>
<p>Please note that ELF is <strong> not </strong> yet implemented in the case of PAW
(<a class="wikilink" href="../../input_variables/internal/#usepaw">usepaw</a>=1) calculations.</p>
<hr />
<h2 id="prtfsurf"><strong>prtfsurf</strong><a class="headerlink" href="#prtfsurf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT Fermi SURFace file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t14.in" title="MgB2,  space group P6/m m m (#191);  Bravais hP (primitive hexag.) GS calculation followed by a band structure calculation in which the k-path is automatically defined via the ndivsm input variable. The third dataset tests the calculation and the output of the Fermi surface (prtfsurf=1) in the Xcrysden format.">tests/v6/Input/t14.in</a></li>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t88.in" title="Calculation of phonon linewidths and e-ph coupling parameter lambda.">tests/v7/Input/t88.in</a></li>
</ul>
<p>If set to 1, provide Fermi surface file in the BXSF format (Xcrysden) If
<a class="wikilink" href="../../input_variables/files/#prtfsurf">prtfsurf</a>=1, a _BXSF file readable by <a href="http://www.xcrysden.org"> XCrySDen </a>
will be produced at the end of the calculation. The file contains information
on the band structure of the system and can be used to visualize the Fermi
surface or any other energy isosurface. <a class="wikilink" href="../../input_variables/files/#prtfsurf">prtfsurf</a>=1 is compatible only with
SCF calculations (<a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a> &gt; 1) or NSCF runs in which the occupation
factors and Fermi level are recalculated once convergence is achieved
(<a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a> = -3). The two methods should produce the same Fermi surface
provided that the k-meshes are sufficiently dense. The k-mesh used for the
sampling of the Fermi surface can be specified using the standard variables
<a class="wikilink" href="../../input_variables/basic/#ngkpt">ngkpt</a>, (<a class="wikilink" href="../../input_variables/basic/#shiftk">shiftk</a>, and <a class="wikilink" href="../../input_variables/basic/#nshiftk">nshiftk</a>. Note, however, that the mesh must be
homogeneous and centered on gamma (multiple shifts are not supported by
Xcrysden)</p>
<hr />
<h2 id="prtgden"><strong>prtgden</strong><a class="headerlink" href="#prtgden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the Gradient of electron DENsity<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a></li>
<li>v1:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v1/Input/t21.in" title="Isolated Hydrogen atom (see above) Treated with LSD,  Teter rational polynomial parametrization (4/93) (ixc=1). The total energy is -0.4792 Ha. Also additional tests concerning the kinetic energy density calculation, the gradient of electronic density calculation and the Laplacian of electronic density calculation are performed.">tests/v1/Input/t21.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t12.in" title="Isolated Hydrogen atom. Treated with GGA C09x exchange functional (ixc=24). The total energy is -0.429523 Ha. Also additional tests concerning the kinetic energy density calculation, the gradient of electronic density calculation and the Laplacian of electronic density calculation are performed. Test taken from v1/t21.in.">tests/v6/Input/t12.in</a></li>
</ul>
<p>If set to 1 or a larger value, provide output of gradient of electron density
in real space grho(r), in units of Bohr^-(5/2).<br />
The names of the gradient of electron density files will be the root output
name, followed by _GDEN1, _GDEN2, GDEN3 for each principal direction (indeed
it is a vector).<br />
Like a _DEN file, it can be analyzed by cut3d. The file structure of the
unformatted output file is described below, see section 6).</p>
<hr />
<h2 id="prtgeo"><strong>prtgeo</strong><a class="headerlink" href="#prtgeo" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the GEOmetry analysis<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>fast:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/fast/Input/t27.in" title="8-atom Si cube to set up brdmin and MD runs with natfix. Output also DEN,  POT and GEO files">tests/fast/Input/t27.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/fast/Input/t28.in" title="brdmin with natfix. Output also DEN,  POT and GEO files">tests/fast/Input/t28.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/fast/Input/t29.in" title="move with natfix. Output also GEO files">tests/fast/Input/t29.in</a></li>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t30.in" title="Hydrure of Lithium-Boron,  in a face-centered monoclinic cell. Test the recognition of the space group (C2/c (# 15)). Was lacking a case before Dec 2011.">tests/v6/Input/t30.in</a></li>
</ul>
<p>If set to 1 or a larger value, provide output of geometrical analysis (bond
lengths and bond angles). The value of <a class="wikilink" href="../../input_variables/files/#prtgeo">prtgeo</a> is taken by the code to be
the maximum coordination number of atoms in the system.<br />
It will deduce a maximum number of "nearest" and "next-nearest" neighbors
accordingly , and compute corresponding bond lengths.<br />
It will compute bond angles for the "nearest" neighbours only.<br />
If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==0, the name of the file will be the root output name, followed
by _GEO .<br />
If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==1 or 2, one file will be output at each time step, with the
name being made of</p>
<ul>
<li>the root output name, </li>
<li>followed by _TIMx , where x is related to the timestep (see later) </li>
<li>then followed by _GEO </li>
</ul>
<p>The content of the file should be rather self-explanatory.<br />
No output is provided by <a class="wikilink" href="../../input_variables/files/#prtgeo">prtgeo</a> is lower than or equal to 0.<br />
If <a class="wikilink" href="../../input_variables/files/#prtgeo">prtgeo</a>&gt;0, the maximum number of atoms (<a class="wikilink" href="../../input_variables/basic/#natom">natom</a>) is 9999.</p>
<hr />
<h2 id="prtgkk"><strong>prtgkk</strong><a class="headerlink" href="#prtgkk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the GKK matrix elements file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a>, <a class="wikilink" href="../../topics/ElPhonInt">ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>tutorespfn:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorespfn/Input/teph_1.in" title="the sequence of datasets makes the ground states and all of the explicit perturbations of the single Al atom in all directions,  for the irreducible qpoints in a 2x2x2 grid. Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)">tests/tutorespfn/Input/teph_1.in</a></li>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t85.in" title="FCC Aluminium - get phonons and ddk in preparation for an electron-phonon coupling run. a few extra features are used compared to the tutorial.">tests/v5/Input/t85.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t72.in" title="Ground state and phonons of hcp TiNb alloy">tests/v6/Input/t72.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t90.in" title="Ground state and phonons of hcp Ti (similar to test 72,  but grid 2 2 4)">tests/v6/Input/t90.in</a></li>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t90.in" title="Ground state and phonons of bcc Li">tests/v7/Input/t90.in</a></li>
</ul>
<p>If set to 1, provide output of electron-phonon "gkk" matrix elements, for
further treatment by mrggkk utility or anaddb utility. Note that symmetry will
be disabled for the calculation of the perturbation, forcing the inclusion of
all k-points and all perturbation directions. Additional information on
electron-phonon treatment in ABINIT is given in the tutorial
~abinit/doc/tutorial/lesson_eph.html and in ~abinit/doc/users/elphon_manual.ps</p>
<hr />
<h2 id="prtgsr"><strong>prtgsr</strong><a class="headerlink" href="#prtgsr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the GSR file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> prtgsr = 0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t30.in" title="Si in 2-atom diamond unit cell (nkpt 2;  ecut 6) In dataset 1,  ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16). the eigenvectors necessary for the GW calculation being stored in _WFK. In dataset 2,  ABINIT computes the eps^-1 matrix (optdriver 3) nband 10) for the GW calculation and stores it in _SCR. In dataset 3-6,  ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models.">tests/v3/Input/t30.in</a></li>
</ul>
<p>If set to 1, ABINIT will produce a GSR file at the end of the GS calculation.
The GSR file contains the most important GS results (band structure, forces,
stresses, electronic density). The GSR file can be read by AbiPy and used for
futher postprocessing.<br />
Note that, by default, the GSR file contains the electronic density unless
<a class="wikilink" href="../../input_variables/files/#prtden">prtden</a> is set to 0.</p>
<hr />
<h2 id="prtkden"><strong>prtkden</strong><a class="headerlink" href="#prtkden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the Kinetic energy DENsity<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>libxc:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/libxc/Input/t19.in" title="Argon solid,  experimental lattice parameter. Realistic parameters are used (ecut=20,  ngkpt=2x2x2 shifted 4 times,  but centered on Gamma). Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson). The LDA gap is observed at Gamma : 8.071 eV,  is in reasonable agreement with the gap from the TB paper PRL 102,  226401 (2009), where it is mentioned to be 8.16 eV. The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV. The reading of the kinetic energy density,  to start a non-SCF calculation is not yet implemented, as of ABINITv6.12.0 . This test was used to examine the speed of the convergence in case of elongated cells,  up to 16 atoms. The mGGA convergence was found to be similar to the LDA convergence. Also,  test non-self-consistent mGGA calculation,  with reading of the previously produced _DEN and _KDEN files.">tests/libxc/Input/t19.in</a></li>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a></li>
<li>v1:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v1/Input/t21.in" title="Isolated Hydrogen atom (see above) Treated with LSD,  Teter rational polynomial parametrization (4/93) (ixc=1). The total energy is -0.4792 Ha. Also additional tests concerning the kinetic energy density calculation, the gradient of electronic density calculation and the Laplacian of electronic density calculation are performed.">tests/v1/Input/t21.in</a></li>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t51.in" title="Bismuth atom,  isolated,  in a supercell. Compares different spin treatments : - spin-polarized collinear (nspinor=1,  nspden=2,  nsppol=2,  no spin-orbit) - spinor (nspinor=2,  nspden=4,  nsppol=1,  no spin-orbit) Both with fixed occupation numbers and metallic occupations. This test has been contributed by L.E. Diaz. Additional test added for kinetic energy density by A. Lherbier">tests/v5/Input/t51.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t12.in" title="Isolated Hydrogen atom. Treated with GGA C09x exchange functional (ixc=24). The total energy is -0.429523 Ha. Also additional tests concerning the kinetic energy density calculation, the gradient of electronic density calculation and the Laplacian of electronic density calculation are performed. Test taken from v1/t21.in.">tests/v6/Input/t12.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t17.in" title="Bi atom in a big supercell. Test the application of a Zeeman field.">tests/v6/Input/t17.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t31.in" title="Tests series for the mGGA implementation (from 31 to 33) Silicon bulk. Two datasets are run. One (classic) LDA calculation with ixc 7. One with a fake native mGGA (fake1,  i.e. ixc 31) and using effmass_free=1.01. Both calculation should give the same total energy (change in kinetic energy due to effmass_free is compensated by the fake mGGA using kinetic energy density: taur). (Two other datasets are also run for spin polarized case)">tests/v6/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t32.in" title="Test the mGGA implementation. Silicon bulk. Two datasets are run. One with a fake native mGGA (fake2,  i.e. ixc 32) involving laplacian of the density. One with a fake native mGGA (fake3,  i.e. ixc 33) involving gradient of the density. Both calculation should give the same total and exchange-correlation energies. (Two other datasets are also run for spin polarized case)">tests/v6/Input/t32.in</a></li>
</ul>
<p>If set to 1 or a larger value , provide output of kinetic energy density in
real space tau(r), in units of Bohr^-5.<br />
The name of the kinetic energy density file will be the root output name,
followed by _KDEN.<br />
Like a _DEN file, it can be analyzed by cut3d. The file structure of the
unformatted output file is described below (see <a href="../../../users/generated_files/help_abinit.html#6"> section 6
</a>).<br />
Note that the computation of the kinetic energy density must be activate,
thanks to the input variable <a class="wikilink" href="../../input_variables/gstate/#usekden">usekden</a>.<br />
Please note that kinetic energy density is <strong> not </strong> yet implemented in the
case of PAW (<a class="wikilink" href="../../input_variables/internal/#usepaw">usepaw</a>=1) calculations.</p>
<hr />
<h2 id="prtkpt"><strong>prtkpt</strong><a class="headerlink" href="#prtkpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the K-PoinTs sets<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a>, <a class="wikilink" href="../../topics/Output">Output</a>, <a class="wikilink" href="../../topics/k-points">k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>If set /= 0 , proceeds to a detailed analysis of different k point grids.
Works only if <a class="wikilink" href="../../input_variables/basic/#kptopt">kptopt</a> is positive, and neither <a class="wikilink" href="../../input_variables/gstate/#kptrlatt">kptrlatt</a> nor <a class="wikilink" href="../../input_variables/basic/#ngkpt">ngkpt</a>
are defined. ABINIT will stop after this analysis.</p>
<p>Different sets of k point grids are defined, with common values of <a class="wikilink" href="../../input_variables/basic/#shiftk">shiftk</a>.
In each set, ABINIT increases the length of vectors of the supercell (see
<a class="wikilink" href="../../input_variables/gstate/#kptrlatt">kptrlatt</a>) by integer steps. The different sets are labelled by "iset". For
each k point grid, <a class="wikilink" href="../../input_variables/gstate/#kptrlen">kptrlen</a> and <a class="wikilink" href="../../input_variables/basic/#nkpt">nkpt</a> are computed (the latter always
invoking <a class="wikilink" href="../../input_variables/basic/#kptopt">kptopt</a>=1, that is, full use of symmetries). A series is finished
when the computed <a class="wikilink" href="../../input_variables/gstate/#kptrlen">kptrlen</a> is twice larger than the input variable
<a class="wikilink" href="../../input_variables/gstate/#kptrlen">kptrlen</a>. After the examination of the different sets, ABINIT summarizes,
for each <a class="wikilink" href="../../input_variables/basic/#nkpt">nkpt</a>, the best possible grid, that is, the one with the largest
computed <a class="wikilink" href="../../input_variables/gstate/#kptrlen">kptrlen</a>.</p>
<p>Note that this analysis is also performed when <a class="wikilink" href="../../input_variables/files/#prtkpt">prtkpt</a>=0, as soon as
neither <a class="wikilink" href="../../input_variables/gstate/#kptrlatt">kptrlatt</a> nor <a class="wikilink" href="../../input_variables/basic/#ngkpt">ngkpt</a> are defined. But, in this case, no analysis
report is given, and the code selects the grid with the smaller <a class="wikilink" href="../../input_variables/basic/#ngkpt">ngkpt</a> for
the desired <a class="wikilink" href="../../input_variables/gstate/#kptrlen">kptrlen</a>. However, this analysis takes some times (well
sometimes, it is only a few seconds - it depends on the value of the input
<a class="wikilink" href="../../input_variables/gstate/#kptrlen">kptrlen</a>), and it is better to examine the full analysis for a given cell
and set of symmetries, <a class="wikilink" href="../../input_variables/basic/#shiftk">shiftk</a> for all the production runs.</p>
<p>if set to -2, the code stops in invars1 after the computation of the
irreducible set and a file named kpts.nc with the list of the k-points and the
corresponding weights is produced</p>
<hr />
<h2 id="prtlden"><strong>prtlden</strong><a class="headerlink" href="#prtlden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the Laplacian of electron DENsity<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a></li>
<li>v1:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v1/Input/t21.in" title="Isolated Hydrogen atom (see above) Treated with LSD,  Teter rational polynomial parametrization (4/93) (ixc=1). The total energy is -0.4792 Ha. Also additional tests concerning the kinetic energy density calculation, the gradient of electronic density calculation and the Laplacian of electronic density calculation are performed.">tests/v1/Input/t21.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t12.in" title="Isolated Hydrogen atom. Treated with GGA C09x exchange functional (ixc=24). The total energy is -0.429523 Ha. Also additional tests concerning the kinetic energy density calculation, the gradient of electronic density calculation and the Laplacian of electronic density calculation are performed. Test taken from v1/t21.in.">tests/v6/Input/t12.in</a></li>
</ul>
<p>If set to 1 or a larger value, provide output of Laplacian of electron density
in real space grho(r), in units of Bohr^-(7/2).<br />
The name of the Laplacian of electron density file will be the root output
name, followed by _LDEN.<br />
Like a _DEN file, it can be analyzed by cut3d. The file structure of the
unformatted output file is described below (see <a href="../../../users/generated_files/help_abinit.html#6"> section 6
</a>).</p>
<hr />
<h2 id="prtpot"><strong>prtpot</strong><a class="headerlink" href="#prtpot" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT total POTential<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>If set &gt;=1 , provide output of the total (Kohn-Sham) potential (sum of
local pseudo-potential, Hartree potential, and xc potential).</p>
<p>If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==0, the name of the potential file will be the root output name,
followed by _POT.<br />
If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==1 or 2, potential file will be output at each time step, with
the name being made of</p>
<ul>
<li>the root output name, </li>
<li>followed by _TIMx , where x is related to the timestep (see later) </li>
<li>then followed by _POT. </li>
</ul>
<p>The file structure of this unformatted output file is described in <a href="../../../users/generated_files/help_abinit.html#localpotfile"> section
6.6 </a> of the
<a class="wikilink" href="../../help_abinit/">help_abinit</a>. No output is provided by a negative value of this variable.</p>
<hr />
<h2 id="prtpsps"><strong>prtpsps</strong><a class="headerlink" href="#prtpsps" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRint the PSPS file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t10.in" title="Nickel ferromagnetic fcc structure with an ONCVPSP pseudo containing valence density. We test several improvements that are available when the NC file contains the PS valence charge. More specifically,  we test the initialization of the density from atomic quantities (initro.F90), the correction to the forces due to the residuals and the extrapolation of the density for structural relaxations (well,  xred is fixed by symmetry). We also test the treatment of the core charge in G-space in the case of GS calculations By default,  abinit handles XCCC in real space,  here we use nc_xccc_gspace==1 to treat it in G-space using the same approach as the one used in PAW.">tests/v7/Input/t10.in</a></li>
</ul>
<p>If set to 1, the code produces a netcdf file (PSPS.nc) with the internal
tables used by Abinit to apply the pseudopotential part of the KS Hamiltonian.
The data can be visualized with AbiPy. if prtpsps is set to -1, the code will
exit after the output of the PSPS.nc file.</p>
<hr />
<h2 id="prtspcur"><strong>prtspcur</strong><a class="headerlink" href="#prtspcur" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the SPin CURrent density<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t46.in" title="preliminary spin current output test: output x y z- spin current density in x, y, z directions">tests/v5/Input/t46.in</a></li>
</ul>
<p>If set to 1 or a larger value, provide output of the current density of
different direction spins (x,y,z) in the whole unit cell. Should require
spinorial wave functions <a class="wikilink" href="../../input_variables/gstate/#nspinor">nspinor</a> = 2. Experimental: this does not work
yet.</p>
<hr />
<h2 id="prtstm"><strong>prtstm</strong><a class="headerlink" href="#prtstm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the STM density<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a>, <a class="wikilink" href="../../topics/STM">STM</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t46.in" title="5-atom Al slab,  with three vacuum layers. First,  converge the wavefunctions,  then compute the STM charge density below and above the Fermi energy,  within a 2eV range.">tests/v4/Input/t46.in</a></li>
</ul>
<p>If set to 1 or a larger value, provide output of the electron density in real
space rho(r), made only from the electrons close to the Fermi energy, in a
range of energy (positive or negative), determined by the (positive or
negative, but non-zero) value of the STM bias <a class="wikilink" href="../../input_variables/gstate/#stmbias">stmbias</a>.<br />
This is a very approximate way to obtain STM profiles : one can choose an
equidensity surface, and consider that the STM tip will follow this surface.
Such equidensity surface might be determined with the help of Cut3D, and
further post-processing of it (to be implemented). The big approximations of
this technique are : neglect of the finite size of the tip, and position-
independent transfer matrix elements between the tip and the surface.<br />
The charge density is provided in units of electrons/Bohr^3. The name of the
STM density file will be the root output name, followed by _STM . Like a _DEN
file, it can be analyzed by cut3d. The file structure of this unformatted
output file is described in <a href="../../../users/generated_files/help_abinit.html#densoutputfile"> section 6.5
</a> of the
<a class="wikilink" href="../../help_abinit/">help_abinit</a>.<br />
For the STM charge density to be generated, one must give, as an input file,
the converged wavefunctions obtained from a previous run, at exactly the same
k-points and cut-off energy, self-consistently determined, using the
occupation numbers from <a class="wikilink" href="../../input_variables/basic/#occopt">occopt</a>=7.<br />
In the run with positive <a class="wikilink" href="../../input_variables/files/#prtstm">prtstm</a>, one has to use :</p>
<ul>
<li>positive <a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a> </li>
<li><a class="wikilink" href="../../input_variables/basic/#occopt">occopt</a>=7, with specification of <a class="wikilink" href="../../input_variables/gstate/#tsmear">tsmear</a> </li>
<li><a class="wikilink" href="../../input_variables/basic/#nstep">nstep</a>=1 </li>
<li>the <a class="wikilink" href="../../input_variables/basic/#tolwfr">tolwfr</a> convergence criterion </li>
<li><a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>=0 (this is the default value) </li>
<li><a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>=0 (this is the default value) </li>
</ul>
<p>Note that you might have to adjust the value of <a class="wikilink" href="../../input_variables/basic/#nband">nband</a> as well, for the
treatment of unoccupied states, because the automatic determination of
<a class="wikilink" href="../../input_variables/basic/#nband">nband</a> will often not include enough unoccupied states.<br />
When <a class="wikilink" href="../../input_variables/files/#prtstm">prtstm</a> is non-zero, the stress tensor is set to zero.<br />
No output of _STM file is provided by <a class="wikilink" href="../../input_variables/files/#prtstm">prtstm</a> lower or equal to 0.<br />
No other printing variables for density or potentials should be activated
(e.g. <a class="wikilink" href="../../input_variables/files/#prtden">prtden</a> has to be set to zero).</p>
<hr />
<h2 id="prtsuscep"><strong>prtsuscep</strong><a class="headerlink" href="#prtsuscep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the SUSCEPtibility file (the irreducible polarizability)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t87.in" title="Test on splitting screening calculation using nqptdm and qptdm Si in 2-atom diamond unit cell (nkpt 2;  ecut 6) In dataset 1,  ABINIT finds the ground state (tolwfr 1.0d-16) the eigenvectors necessary for the GW calculation being stored in _WFK. In datasets 2-4,  ABINIT computes the eps^-1 matrix for 1 qpt,  2 qpts,  3qpts respectively">tests/v3/Input/t87.in</a></li>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t70.in" title="Silicon One-shot GW calculation starting either from the SCR file or from the SUSC file. In the later case both the in-core solution and the out-of-core solution for the storage of the inverse dielectric matrix are tested.">tests/v5/Input/t70.in</a></li>
<li>v67mbpt:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t03.in" title="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl.">tests/v67mbpt/Input/t03.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t04.in" title="Carbon in diamond structure. Chained GW calculation: The first run produces the WFK,  the SCR,  the SUSC and the QPS file. These file are subsequently read and used in t537 using irdwfk,  irdscr,  irdsuscep and irdqps In the second dataset of t85,  the screened interaction W is approximated using the test-electron expression with the TDDFT ALDA kernel (gwgamma==1).">tests/v67mbpt/Input/t04.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v67mbpt/Input/t37.in" title="LiF. Hilbert transform for chi0. Use nfreqre and freqremin,  freqremax to split the calculation along the real axis. The SCR files produced in dataset 3 and 4 are then merged my mrgscr in the next test.">tests/v67mbpt/Input/t37.in</a></li>
</ul>
<p>If set to 0, no _SUSC file will be produced after the screening calculation,
only the _SCR file will be output.</p>
<hr />
<h2 id="prtvclmb"><strong>prtvclmb</strong><a class="headerlink" href="#prtvclmb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT V CouLoMB<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t28.in" title="GaAs with PAW and spin-orbit coupling. 2x2x2 K grid;  low cut-off for test Test paral_kgb==1 with MPI-FFT/spinor parallelization,  the IO of the WFK file, the output of potential files and the calculation of PJDOS in parallel (PW term + on-site contributions)">tests/mpiio/Input/t28.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t04.in" title="Hydrogen dimer in a big cell. Produce different files (_DEN,  _POT,  _VHXC,  _VHA),  for subsequent analysis by CUT3D (see next run). Note the following values,  that will allow to check the correctness of the subsequent analysis : Kinetic energy  =  1.02998395409183E+00 Hartree energy  =  8.05073794254872E-01 Loc. psp. energy= -2.53949740885919E+00 Band energy (Ha)=  -7.2732761066E-01 Also,  the mean of the Vxc potential is announced to be Average Vxc (hartree)=  -0.05293">tests/v6/Input/t04.in</a></li>
</ul>
<p>If set &gt;= 0 outputs a file with the Coulomb potential, defined as Hartree +
local Pseudopotential.</p>
<p>If <strong>prtvclmb=1</strong> and in case of PAW (<a class="wikilink" href="../../input_variables/internal/#usepaw">usepaw</a> &gt; 0), the full core potential
is added for the Hartree part, with the on-site corrections vh1 - vht1.</p>
<p>If <strong>prtvclmb=2</strong>, only the smooth part of the Coulomb potential is output.</p>
<hr />
<h2 id="prtvha"><strong>prtvha</strong><a class="headerlink" href="#prtvha" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT V_HArtree<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>fast:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/fast/Input/t30.in" title="This test is due to Z. Levine. It is a run on Si with the bond center at the origin. Also write density and potential with prtden=9 and prtpot=2 .">tests/fast/Input/t30.in</a></li>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t28.in" title="GaAs with PAW and spin-orbit coupling. 2x2x2 K grid;  low cut-off for test Test paral_kgb==1 with MPI-FFT/spinor parallelization,  the IO of the WFK file, the output of potential files and the calculation of PJDOS in parallel (PW term + on-site contributions)">tests/mpiio/Input/t28.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t04.in" title="Hydrogen dimer in a big cell. Produce different files (_DEN,  _POT,  _VHXC,  _VHA),  for subsequent analysis by CUT3D (see next run). Note the following values,  that will allow to check the correctness of the subsequent analysis : Kinetic energy  =  1.02998395409183E+00 Hartree energy  =  8.05073794254872E-01 Loc. psp. energy= -2.53949740885919E+00 Band energy (Ha)=  -7.2732761066E-01 Also,  the mean of the Vxc potential is announced to be Average Vxc (hartree)=  -0.05293">tests/v6/Input/t04.in</a></li>
<li>v8:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v8/Input/t02.in" title="Geometry optimization with LBFGS">tests/v8/Input/t02.in</a></li>
</ul>
<p>If set &gt;=1 , provide output of the Hartree potential.  </p>
<p>If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==0, the name of the potential file will be the root output name,
followed by _VHA.<br />
If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==1 or 2, potential files will be output at each time step, with
the name being made of</p>
<ul>
<li>the root output name, </li>
<li>followed by _TIMx , where x is related to the timestep (see later) </li>
<li>then followed by _VHA. </li>
</ul>
<p>The file structure of this unformatted output file is described in <a href="../../../users/generated_files/help_abinit.html#localpotfile"> section
6.6 </a> of the
<a class="wikilink" href="../../help_abinit/">help_abinit</a>. No output is provided by a negative value of this variable.</p>
<hr />
<h2 id="prtvhxc"><strong>prtvhxc</strong><a class="headerlink" href="#prtvhxc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT V_HXC<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>fast:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/fast/Input/t30.in" title="This test is due to Z. Levine. It is a run on Si with the bond center at the origin. Also write density and potential with prtden=9 and prtpot=2 .">tests/fast/Input/t30.in</a></li>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t28.in" title="GaAs with PAW and spin-orbit coupling. 2x2x2 K grid;  low cut-off for test Test paral_kgb==1 with MPI-FFT/spinor parallelization,  the IO of the WFK file, the output of potential files and the calculation of PJDOS in parallel (PW term + on-site contributions)">tests/mpiio/Input/t28.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t42.in" title="Si/Ge heterojunction : 4 layer each. Output the density and potential. Prepare the macroaverage analysis,  see next tests.">tests/v4/Input/t42.in</a></li>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t31.in" title="Stishovite,  high-pressure polymorph of SiO2. LDA. Computation of the electric field gradient at each atomic site. This tests the implementation of the PAW-based efg algorithm as outlined in Profeta,  Mauri,  and Pickard,  J. Am. Chem. Soc. 125,  541-548 (2003). Coded by J. Zwanziger and M. Torrent.">tests/v5/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t32.in" title="Stishovite,  high-pressure polymorph of SiO2. GGA (PBE). Computation of the electric field gradient at each atomic site. This tests the implementation of the PAW-based efg algorithm as outlined in Profeta,  Mauri,  and Pickard,  J. Am. Chem. Soc. 125,  541-548 (2003).">tests/v5/Input/t32.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t34.in" title="Stishovite,  high-pressure polymorph of SiO2. LDA. Computation of the Fermi contact term at each atomic site. Coded and contributed by J. Zwanziger.">tests/v5/Input/t34.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t35.in" title="Stishovite,  high-pressure polymorph of SiO2. LDA. Computation of the electric field gradient at each site using both PAW and a simple point charge model. Coded and contributed by J. Zwanziger.">tests/v5/Input/t35.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t04.in" title="Hydrogen dimer in a big cell. Produce different files (_DEN,  _POT,  _VHXC,  _VHA),  for subsequent analysis by CUT3D (see next run). Note the following values,  that will allow to check the correctness of the subsequent analysis : Kinetic energy  =  1.02998395409183E+00 Hartree energy  =  8.05073794254872E-01 Loc. psp. energy= -2.53949740885919E+00 Band energy (Ha)=  -7.2732761066E-01 Also,  the mean of the Vxc potential is announced to be Average Vxc (hartree)=  -0.05293">tests/v6/Input/t04.in</a></li>
</ul>
<p>If set &gt;=1 , provide output of the sum of the Hartree potential and xc
potential.</p>
<p>If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==0, the name of the potential file will be the root output name,
followed by _VHXC.<br />
If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==1 or 2, potential files will be output at each time step, with
the name being made of</p>
<ul>
<li>the root output name, </li>
<li>followed by _TIMx , where x is related to the timestep (see later) </li>
<li>then followed by _VHXC. </li>
</ul>
<p>The file structure of this unformatted output file is described in <a href="../../../users/generated_files/help_abinit.html#localpotfile"> section
6.6 </a> of the
<a class="wikilink" href="../../help_abinit/">help_abinit</a>. No output is provided by a negative value of this variable.</p>
<hr />
<h2 id="prtvol"><strong>prtvol</strong><a class="headerlink" href="#prtvol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT VOLume<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a>, <a class="wikilink" href="../../topics/Output">Output</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Control the volume of printed output. In particular, this concerns the
explicit echo of eigenenergies and residuals for all bands and k points in the
main output file. Also, the analysis of the value and location of the maximal
density (and magnetization).<br />
Standard choice is 0. Positive values print more in the output and log files,
while negative values are for debugging (or preprocessing only), and cause the
code to stop at some point.</p>
<ul>
<li>0 =&gt; The eigenenergies and residuals for all bands and k points are not echoed in the main output file. There are exceptions: the eigenvalues of the first k point are printed at the end of the SCF loop, and also, if <a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a>=-2 and <a class="wikilink" href="../../input_variables/basic/#kptopt">kptopt</a>&lt;=0, the eigenvalues for all the k points are printed anyway, for a maximum of 50 k-points. Due to some subtlety, if for <strong>some</strong> dataset <a class="wikilink" href="../../input_variables/files/#prtvol">prtvol</a> is non-zero, the limit for input and output echoes cannot be enforced, so it is like if <a class="wikilink" href="../../input_variables/files/#prtvol">prtvol</a>=1 for <strong>all</strong> the datasets for which <a class="wikilink" href="../../input_variables/files/#prtvol">prtvol</a> was set to 0.</li>
<li>1 =&gt; the eigenvalues for the first 50 k-points are printed in all cases, at the end of the SCF loop.</li>
<li>2 =&gt; all the eigenvalues and the residuals are printed at the end of the SCF loop. Also, the analysis of the value and location of the maximal density (and magnetization) is printed.</li>
<li>3 =&gt; Print memory information for lobpcg </li>
<li>4 =&gt; Like 3 and prints information of lobpcg algorithm convergence</li>
<li>10 =&gt; the eigenvalues are printed for every SCF iteration, as well as other additions (to be specified in the future...) </li>
</ul>
<p>Debugging options :</p>
<ul>
<li>= -1 =&gt; stop in abinit (main program), before call driver. Useful to see the effect of the preprocessing of input variables (memory needed, effect of symmetries, k points ...) without going further. Run very fast, on the order of the second.</li>
<li>=-2 =&gt; same as -1, except that print only the first dataset. All the non default input variables associated to all datasets are printed in the output file, but only for the first dataset. Also all the input variables are written in the NetCDF file \"OUT.nc\", even if the value is the default.</li>
<li>= -3 =&gt; stop in gstate, before call scfcv, move or brdmin. Useful to debug pseudopotentials</li>
<li>= -4 =&gt; stop in move, after completion of all loops</li>
<li>= -5 =&gt; stop in brdmin, after completion of all loops</li>
<li>= -6 =&gt; stop in scfcv, after completion of all loops </li>
<li>= -7 =&gt; stop in vtorho, after the first rho is obtained</li>
<li>= -8 =&gt; stop in vtowfk, after the first k point is treated</li>
<li>= -9 =&gt; stop in cgwf, after the first wf is optimized</li>
<li>= -10 =&gt; stop in getghc, after the Hamiltonian is applied once</li>
</ul>
<p>This debugging feature is not yet activated in the RF routines. Note that
<a class="wikilink" href="../../input_variables/dev/#fftalg">fftalg</a> offers another option for debugging.</p>
<hr />
<h2 id="prtvolimg"><strong>prtvolimg</strong><a class="headerlink" href="#prtvolimg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT VOLume for IMaGes<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a>, <a class="wikilink" href="../../topics/Output">Output</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>paral:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t08.in" title="Test the string method within parallelization over images Inspired by test v6#22. Hydrogen diatomic molecule in a cell,  close to BCC 7 images,  exploring the transition path. Three datasets,  testing each value of prtvolimg. Processors distribution automatically determined:">tests/paral/Input/t08.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t08.in" title="Test the string method within parallelization over images Inspired by test v6#22. Hydrogen diatomic molecule in a cell,  close to BCC 7 images,  exploring the transition path. Three datasets,  testing each value of prtvolimg. Processors distribution automatically determined:">tests/paral/Input/t08.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t08.in" title="Test the string method within parallelization over images Inspired by test v6#22. Hydrogen diatomic molecule in a cell,  close to BCC 7 images,  exploring the transition path. Three datasets,  testing each value of prtvolimg. Processors distribution automatically determined:">tests/paral/Input/t08.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t08.in" title="Test the string method within parallelization over images Inspired by test v6#22. Hydrogen diatomic molecule in a cell,  close to BCC 7 images,  exploring the transition path. Three datasets,  testing each value of prtvolimg. Processors distribution automatically determined:">tests/paral/Input/t08.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t21.in" title="Bismuth,  rhombohedral,  two atoms per unit cell Scalar relativistic. Relax four different images,  using the steepest descent algorithm.">tests/v6/Input/t21.in</a></li>
<li>v8:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v8/Input/t05.in" title="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint.">tests/v8/Input/t05.in</a></li>
</ul>
<p>Control the volume of printed output when an algorithm using images of the
cell is used (<a class="wikilink" href="../../input_variables/rlx/#nimage">nimage</a>&gt;1).<br />
When such an algorithm is activated, the printing volume (in output file) can
be large and difficult to read.<br />
Using <strong> prtvolimg=1 </strong> , the printing volume, for each image, is reduced to
unit cell, atomic positions, total energy, forces, stresses, velocities and
convergence residuals.<br />
Using <strong> prtvolimg=2 </strong> , the printing volume, for each image, is reduced to
total energy and convergence residuals only.</p>
<hr />
<h2 id="prtvpsp"><strong>prtvpsp</strong><a class="headerlink" href="#prtvpsp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT V_PSeudoPotential<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t28.in" title="GaAs with PAW and spin-orbit coupling. 2x2x2 K grid;  low cut-off for test Test paral_kgb==1 with MPI-FFT/spinor parallelization,  the IO of the WFK file, the output of potential files and the calculation of PJDOS in parallel (PW term + on-site contributions)">tests/mpiio/Input/t28.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t04.in" title="Hydrogen dimer in a big cell. Produce different files (_DEN,  _POT,  _VHXC,  _VHA),  for subsequent analysis by CUT3D (see next run). Note the following values,  that will allow to check the correctness of the subsequent analysis : Kinetic energy  =  1.02998395409183E+00 Hartree energy  =  8.05073794254872E-01 Loc. psp. energy= -2.53949740885919E+00 Band energy (Ha)=  -7.2732761066E-01 Also,  the mean of the Vxc potential is announced to be Average Vxc (hartree)=  -0.05293">tests/v6/Input/t04.in</a></li>
</ul>
<p>If set &gt;=1 , provide output of the local pseudo potential.  </p>
<p>If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==0, the name of the potential file will be the root output name,
followed by _VPSP.<br />
If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==1 or 2, potential files will be output at each time step, with
the name being made of</p>
<ul>
<li>the root output name, </li>
<li>followed by _TIMx , where x is related to the timestep (see later) </li>
<li>then followed by _VPSP. </li>
</ul>
<p>The file structure of this unformatted output file is described in <a href="../../../users/generated_files/help_abinit.html#localpotfile"> section
6.6 </a> of the
<a class="wikilink" href="../../help_abinit/">help_abinit</a>. No output is provided by a negative value of this variable.</p>
<hr />
<h2 id="prtvxc"><strong>prtvxc</strong><a class="headerlink" href="#prtvxc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT V_XC<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>bigdft:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/bigdft/Input/t22.in" title="H2O in isolated boundary conditions (plane waves,  NC),  try tu use Damiens Poisson cutoff. Water molecule with HGH pseudo-potentials. This checks that a negative value in rhor will not make the Poisson solver crashes on XC computation.">tests/bigdft/Input/t22.in</a></li>
<li>fast:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/fast/Input/t30.in" title="This test is due to Z. Levine. It is a run on Si with the bond center at the origin. Also write density and potential with prtden=9 and prtpot=2 .">tests/fast/Input/t30.in</a></li>
<li>mpiio:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t26.in" title="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS.">tests/mpiio/Input/t26.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t27.in" title="C-diamond,  Bulk,  2 atoms,  with NC pseudo generated with oncvps-3.2.3. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test also prtdos (PJDOS) in parallel with MPI-FFT. Similar to t26.in">tests/mpiio/Input/t27.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/mpiio/Input/t28.in" title="GaAs with PAW and spin-orbit coupling. 2x2x2 K grid;  low cut-off for test Test paral_kgb==1 with MPI-FFT/spinor parallelization,  the IO of the WFK file, the output of potential files and the calculation of PJDOS in parallel (PW term + on-site contributions)">tests/mpiio/Input/t28.in</a></li>
<li>v8:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v8/Input/t02.in" title="Geometry optimization with LBFGS">tests/v8/Input/t02.in</a></li>
</ul>
<p>If set &gt;=1 , provide output of the exchange-correlation potential.</p>
<p>If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==0, the name of the potential file will be the root output name,
followed by _VXC.<br />
If <a class="wikilink" href="../../input_variables/rlx/#ionmov">ionmov</a>==1 or 2, potential files will be output at each time step, with
the name being made of</p>
<ul>
<li>the root output name, </li>
<li>followed by _TIMx , where x is related to the timestep (see later) </li>
<li>then followed by _VXC. </li>
</ul>
<p>The file structure of this unformatted output file is described in <a href="../../../users/generated_files/help_abinit.html#localpotfile"> section
6.6 </a> of the
<a class="wikilink" href="../../help_abinit/">help_abinit</a>. No output is provided by a negative value of this variable.</p>
<hr />
<h2 id="prtwant"><strong>prtwant</strong><a class="headerlink" href="#prtwant" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT WANT file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a>, <a class="wikilink" href="../../topics/Wannier">Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Flag used to indicate that either the Wannier90 or the WanT interfaces will be
used.</p>
<ul>
<li><a class="wikilink" href="../../input_variables/files/#prtwant">prtwant</a>=1 =&gt; Use the <strong> ABINIT- WanT </strong> interface. </li>
</ul>
<p>Provide an output file that can be used by the WanT postprocessing program
(see http://www.wannier-transport.org). The value of the prtwant indicates the
version of the WanT code that can read it. Currently only the value
<a class="wikilink" href="../../input_variables/files/#prtwant">prtwant</a>=1 is implemented, corresponding to WanT version 1.0.1, available
since Oct. 22, 2004.</p>
<p>Notes : Several requirements must be fulfilled by the wavefunction. Among
them, two are mandatory:  </p>
<pre><code>* 1\. An uniform grid of k-points, including the GAMMA point must be used. 
* 2\. The use of time reversal symmetry is not allowed (istwfk=1) 
* 3\. The list of k-points must be ordered, such that the coordinates, namely three-components vectors has the third index varying the most rapidly, then the second index, then the first index
</code></pre>
<p>If these requirement are not fulfilled, the program will stop and an error
message is returned.</p>
<p>As an example of k-point grid in case of systems that have some 3D character
(1D systems are easy) :</p>
<pre><code>         nkpt 8
kpt  0   0   0
0   0   1/2
0   1/2 0
0   1/2 1/2
1/2 0   0
1/2 0   1/2
1/2 1/2 0
1/2 1/2 1/2
istwfk 8*1
</code></pre>
<p>Also, in order to use WanT as a postprocessing program for ABINIT you might
have to recompile it with the appropriate flags (see ABINIT makefile). Up to
now only the -convert big-endian was found to be mandatory, for machines with
little-endian default choice.</p>
<ul>
<li><a class="wikilink" href="../../input_variables/files/#prtwant">prtwant</a>=2 =&gt; Use the <strong> ABINIT- Wannier90 </strong> interface. </li>
</ul>
<p>ABINIT will produce the input files required by Wannier90 and it will run
Wannier90 to produce the Maximally-locallized Wannier functions (see <a href="http://www.wannier.org">
http://www.wannier.org </a> ).</p>
<p>Notes:</p>
<pre><code>* The files that are created can also be used by Wannier90 in stand-alone mode. 
* In order to use Wannier90 as a postprocessing program for ABINIT you might have to recompile it with the appropriate flags (see ABINIT makefile). You might use ./configure --enable-wannier90 
* There are some other variables related to the interface of Wannier90 and ABINIT. See [[varset:w90]].
</code></pre>
<ul>
<li><a class="wikilink" href="../../input_variables/files/#prtwant">prtwant</a>=3 =&gt; Use the <strong> ABINIT- Wannier90 </strong> interface after converting the input wavefunctions to <strong>quasiparticle</strong> wavefunctions. </li>
</ul>
<p>ABINIT will produce the input files required by Wannier90 and it will run
Wannier90 to produce the Maximally-localized Wannier functions (see <a href="http://www.wannier.org">
http://www.wannier.org </a> ).</p>
<p>Additional Notes:</p>
<pre><code>* An input file of LDA wave functions is required which is completely consistent with the _KSS file used in the self-consistent GW calculation. This means that [[kssform]] 3 must be used to create the _KSS file and the output _WFK file from the same run must be used as input here. 
* Wannier90 requires [[nshiftk]]=1, and [[shiftk]]= 0 0 0 is recommended. The k-point set used for the GW calculation, typically the irreducible BZ set created using [[kptopt]]=1, and that for the Abinit- Wannier90 interface must be consistent. 
* Full-BZ wavefunctions should be generated in the run calling the interface by setting [[kptopt]]=3, [[iscf]]=-2, and [[nstep]]=3. This will simply use symmetry to transform the input IBZ wavefunctions to the full BZ set, still consistent with the GW _KSS input. 
* The final _QPS file created by the self-consistent GW run is required as input. 
* Any value of [[gwcalctyp]] between between 20 and 29 should be suitable, so, for example, Hartree-Fock maximally-localized Wannier functions could be generated setting [[gwcalctyp]]=25.
</code></pre>
<hr />
<h2 id="prtwf"><strong>prtwf</strong><a class="headerlink" href="#prtwf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT the WaveFunction<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a>, <a class="wikilink" href="../../topics/vdw">vdw</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0 if <a class="wikilink" href="../../input_variables/rlx/#nimage">nimage</a> &gt; 1,
1 otherwise.</p>
<p>If <a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a>=1 , provide output of wavefunction and eigenvalue file, as
described in <a href="../../../users/generated_files/help_abinit.html#wavefctfile"> section 6.7
</a> of the main
<a class="wikilink" href="../../help_abinit/">help_abinit</a>.<br />
For a standard ground-state calculation, the name of the wavefunction file
will be the root output name, followed by _WFK. If <a class="wikilink" href="../../input_variables/gstate/#nqpt">nqpt</a>=1, the root name
will be followed by _WFQ. For response-function calculations, the root name
will be followed by _1WFx, where x is the number of the perturbation. The
dataset information will be added as well, if relevant.<br />
No wavefunction output is provided by <a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a>=0.<br />
If <a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a>=-1, the code writes the wavefunction file only if convergence is
not achieved in the self-consistent cycle.</p>
<p>If <a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a>=2, a file pwfn.data is produced, to be used as input for the
CASINO QMC code. See more explanation at the end of this section.<br />
If <a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a>=3, the file that is created is nearly the same as with
<a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a>=1, except that the records that should contain the wavefunction is
empty (so, such records exist, but store nothing). This is useful to generate
size-reduced DDK files, to perform an optic run. Indeed, in the latter case,
only matrix elements are needed [so, no wavefunction], but possibly a large
number of conduction bands, so that the DDK file might be huge if it contains
the wavefunctions.</p>
<p>Further explanation for the <a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a>=2 case. To produce a wave function
suitable for use as a CASINO trial wave function, certain ABINIT parameters
must be set correctly. Primarily, CASINO (and QMC methods generally) can only
take advantage of time-reversal symmetry, and not the full set of symmetries
of the crystal structure. Therefore, ABINIT must be instructed to generate
k-points not just in the Irreducible Brillouin Zone, but in a full half of the
Brillouin Zone (using time-reversal symmetry to generate the other half).
Additionally, unless instructed otherwise, Abinit avoids the need for internal
storage of many of the coefficients of its wave functions for k-points that
have the property 2k=G_latt, where G_latt is a reciprocal lattice vector, by
making use of the property that c_k(G)=c^*_k(-G-G_latt). Abinit must be
instructed not to do this in order to output the full set of coefficients for
use in CASINO. See the ABINIT theoretical background documents
ABINIT/Infos/Theory/geometry.pdf and ABINIT/Infos/Theory/1WF.pdf for more
information.<br />
The first of these requirements is met by setting the ABINIT input variable
kptopt to 2 (see ABINIT/Infos/varbas.html#kptopt) and the second by setting
istwfk to 1 for all the k points (see ABINIT/Infos/vardev.html#istwfk). Since
CASINO is typically run with relatively small numbers of k-points, this is
easily done by defining an array of "1" in the input file.<br />
For example, for the 8 k-points generated with ngkpt 2 2 2, we add the
following lines to the input file:</p>
<pre><code>  # Turn off special storage mode for time-reversal k-points
istwfk 1 1 1 1 1 1 1 1
# Use only time reversal symmetry, not full set of symmetries.
kptopt 2
</code></pre>
<p>Other useful input variables of relevance to the plane waves ABINIT will
produce include ecut, nshiftk, shiftk, nband, occopt, occ, spinat and nsppol
(see relevant input variable documents in ABINIT/Infos/). If ABINIT is run in
multiple dataset mode, the different wave functions for the various datasets
are exported as pwfn1.data, pwfn2.data, ..., pwfnn.data where the numbers are
the contents of the contents of the input array jdtset (defaults to
1,2,...,ndtset).<br />
Once the routine is incorporated into the ABINIT package it is anticipated
that there will be an input variable to control whether or not a CASINO
pwfn.data file is written.</p>
<p>Other issues related to <a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a>=2.<br />
The exporter does not currently work when ABINIT is used in parallel mode on
multiple processors if k-point parallelism is chosen. ABINIT does not store
the full wave function on each processor but rather splits the k-points
between the processors, so no one processor could write out the whole file.
Clearly this could be fixed but we have not done it yet. The sort of plane
wave DFT calculations usually required to generate QMC trial wave functions
execute very rapidly anyway and will generally not require a parallel
machines. The outqmc routine currently bails out with an error if this
combination of modes is selected - this will hopefully be fixed later.<br />
There has not been very extensive testing of less common situations such as
different numbers of bands for different k-points, and more complicated spin
polarized systems, so care should be taken when using the output in these
circumstances.<br />
If there is any doubt about the output of this routine, the first place to
look is the log file produced by ABINIT: if there are any warnings about
incorrectly normalized orbitals or non-integer occupation numbers there is
probably something set wrong in the input file.</p>
<hr />
<h2 id="prtwf_full"><strong>prtwf_full</strong><a class="headerlink" href="#prtwf_full" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT Wavefunction file on the FULL mesh<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a> == 1<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t36.in" title="Si in diamond structure. Test ABINIT --&gt; LOBSTER converter. The first dataset performs a standard SCF run with symmetries. The second dataset calls the converter to generate a new WFK in the full BZ with istwfk==1. The third dataset reads the WFK in the full BZ and it's expected to exit after the first iteration since wavefunctions are already converged.">tests/v7/Input/t36.in</a></li>
</ul>
<p>If set to 1 in a ground-state calculation, the code will output another WFK
file (with extension FULL_WFK) containing the wavefunctions in the full BZ as
well as a text file with the tables used for the tetrahedron method. Note that
prtwf_full requires <a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a> == 1 and a ground-state calculation done on a
homogeneous k-mesh (see <a class="wikilink" href="../../input_variables/basic/#ngkpt">ngkpt</a> and <a class="wikilink" href="../../input_variables/basic/#shiftk">shiftk</a>). The tetrahedron table is
produced only if the number of k-points in the irreducible zone (<a class="wikilink" href="../../input_variables/basic/#nkpt">nkpt</a>) is
greater than 3.</p>
<hr />
<h2 id="prtxml"><strong>prtxml</strong><a class="headerlink" href="#prtxml" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT an XML output<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t79.in" title="Make a simple geometry relaxation and validate the XML output (testing prtxml).">tests/v5/Input/t79.in</a></li>
</ul>
<p>Create an XML output with common values. The corresponding DTD is distributed
in sources as extras/post_processing/abinitRun.dtd. All the DTD is not yet
implemented and this one is currently restricted to ground-state computations
(and derivative such as geometry optimisation).</p>
<hr /></div>
        </div>

        <footer class="col-md-12">
<hr>

    <center>Abinit version 8.5.4</center>


    <center>Copyright &copy; 2017 The Abinit Group</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>
        <script>var base_url = '../..';</script>
        <!--
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        -->
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
        <script src="../../extra_javascript/abidocs.js"></script>

    <!--<script>var base_url = '../..';</script>
<script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>

<h1 id="search">Search Results</h1>

<form action="search.html">
  <input name="q" id="mkdocs-search-query" type="text" >
</form>

<div id="mkdocs-search-results">
  Sorry, page not found.
</div>
    -->

    </body>
</html>
