<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="The Abinit group">
        <link rel="canonical" href="http://www.abinit.org/input_variables/dfpt/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>DFPT - abinit</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/codehilite.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">
    
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">abinit</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../..">Introduction</a>
</li>
                            
<li >
    <a href="../../installation/">Installation</a>
</li>
                            
<li >
    <a href="../../user-guide/help_what_ABINIT_does/">Overview</a>
</li>
                            
<li >
    <a href="../../user-guide/help_abinit/">Abinit</a>
</li>
                            
<li >
    <a href="../../user-guide/help_mrgddb/">Mrgddb</a>
</li>
                            
<li >
    <a href="../../user-guide/help_optic/">Optic</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topics <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../topics/">Complete List</a>
</li>
                            
<li >
    <a href="../../topics/Artificial/">Artificial</a>
</li>
                            
<li >
    <a href="../../topics/AtomManipulator/">AtomManipulator</a>
</li>
                            
<li >
    <a href="../../topics/AtomTypes/">AtomTypes</a>
</li>
                            
<li >
    <a href="../../topics/Bader/">Bader</a>
</li>
                            
<li >
    <a href="../../topics/BandOcc/">BandOcc</a>
</li>
                            
<li >
    <a href="../../topics/Berry/">Berry</a>
</li>
                            
<li >
    <a href="../../topics/BSE/">BSE</a>
</li>
                            
<li >
    <a href="../../topics/ConstrainedPol/">ConstrainedPol</a>
</li>
                            
<li >
    <a href="../../topics/Control/">Control</a>
</li>
                            
<li >
    <a href="../../topics/Coulomb/">Coulomb</a>
</li>
                            
<li >
    <a href="../../topics/CRPA/">CRPA</a>
</li>
                            
<li >
    <a href="../../topics/crystal/">Crystal</a>
</li>
                            
<li >
    <a href="../../topics/Dev/">Dev</a>
</li>
                            
<li >
    <a href="../../topics/DFPT/">DFPT</a>
</li>
                            
<li >
    <a href="../../topics/DFT+U/">DFT+U</a>
</li>
                            
<li >
    <a href="../../topics/DMFT/">DMFT</a>
</li>
                            
<li >
    <a href="../../topics/EffMass/">EffMass</a>
</li>
                            
<li >
    <a href="../../topics/EFG/">EFG</a>
</li>
                            
<li >
    <a href="../../topics/Elastic/">Elastic</a>
</li>
                            
<li >
    <a href="../../topics/ElecBandStructure/">ElecBandStructure</a>
</li>
                            
<li >
    <a href="../../topics/ElecDOS/">ElecDOS</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonInt/">ElPhonInt</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonTransport/">ElPhonTransport</a>
</li>
                            
<li >
    <a href="../../topics/ForcesStresses/">ForcesStresses</a>
</li>
                            
<li >
    <a href="../../topics/FrequencyMeshMBPT/">FrequencyMeshMBPT</a>
</li>
                            
<li >
    <a href="../../topics/GeoConstraints/">GeoConstraints</a>
</li>
                            
<li >
    <a href="../../topics/GeoOpt/">GeoOpt</a>
</li>
                            
<li >
    <a href="../../topics/GW/">GW</a>
</li>
                            
<li >
    <a href="../../topics/GWls/">GWls</a>
</li>
                            
<li >
    <a href="../../topics/Hybrids/">Hybrids</a>
</li>
                            
<li >
    <a href="../../topics/">Home</a>
</li>
                            
<li >
    <a href="../../topics/k-points/">K points</a>
</li>
                            
<li >
    <a href="../../topics/LOTF/">LOTF</a>
</li>
                            
<li >
    <a href="../../topics/MagField/">MagField</a>
</li>
                            
<li >
    <a href="../../topics/MagMom/">MagMom</a>
</li>
                            
<li >
    <a href="../../topics/MolecularDynamics/">MolecularDynamics</a>
</li>
                            
<li >
    <a href="../../topics/multidtset/">Multidtset</a>
</li>
                            
<li >
    <a href="../../topics/nonlinear/">Nonlinear</a>
</li>
                            
<li >
    <a href="../../topics/Optic/">Optic</a>
</li>
                            
<li >
    <a href="../../topics/Output/">Output</a>
</li>
                            
<li >
    <a href="../../topics/parallelism/">Parallelism</a>
</li>
                            
<li >
    <a href="../../topics/PAW/">PAW</a>
</li>
                            
<li >
    <a href="../../topics/PhononBands/">PhononBands</a>
</li>
                            
<li >
    <a href="../../topics/Phonons/">Phonons</a>
</li>
                            
<li >
    <a href="../../topics/PhononWidth/">PhononWidth</a>
</li>
                            
<li >
    <a href="../../topics/PIMD/">PIMD</a>
</li>
                            
<li >
    <a href="../../topics/Planewaves/">Planewaves</a>
</li>
                            
<li >
    <a href="../../topics/positron/">Positron</a>
</li>
                            
<li >
    <a href="../../topics/printing/">Printing</a>
</li>
                            
<li >
    <a href="../../topics/PseudosPAW/">PseudosPAW</a>
</li>
                            
<li >
    <a href="../../topics/q-points/">Q points</a>
</li>
                            
<li >
    <a href="../../topics/RandStopPow/">RandStopPow</a>
</li>
                            
<li >
    <a href="../../topics/Recursion/">Recursion</a>
</li>
                            
<li >
    <a href="../../topics/RPACorrEn/">RPACorrEn</a>
</li>
                            
<li >
    <a href="../../topics/SCFAlgorithms/">SCFAlgorithms</a>
</li>
                            
<li >
    <a href="../../topics/SCFControl/">SCFControl</a>
</li>
                            
<li >
    <a href="../../topics/SelfEnergy/">SelfEnergy</a>
</li>
                            
<li >
    <a href="../../topics/SmartSymm/">SmartSymm</a>
</li>
                            
<li >
    <a href="../../topics/spinpolarisation/">Spinpolarisation</a>
</li>
                            
<li >
    <a href="../../topics/STM/">STM</a>
</li>
                            
<li >
    <a href="../../topics/Susceptibility/">Susceptibility</a>
</li>
                            
<li >
    <a href="../../topics/TDDFT/">TDDFT</a>
</li>
                            
<li >
    <a href="../../topics/TDepES/">TDepES</a>
</li>
                            
<li >
    <a href="../../topics/Temperature/">Temperature</a>
</li>
                            
<li >
    <a href="../../topics/TransPath/">TransPath</a>
</li>
                            
<li >
    <a href="../../topics/TuningSpeed/">TuningSpeed</a>
</li>
                            
<li >
    <a href="../../topics/UnitCell/">UnitCell</a>
</li>
                            
<li >
    <a href="../../topics/vdw/">Vdw</a>
</li>
                            
<li >
    <a href="../../topics/Wannier/">Wannier</a>
</li>
                            
<li >
    <a href="../../topics/Wavelets/">Wavelets</a>
</li>
                            
<li >
    <a href="../../topics/xc/">Xc</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Input Variables <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Abinit</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../varlist_abinit/">All Variables</a>
</li>
            
<li >
    <a href="../basic/">Basic</a>
</li>
            
<li >
    <a href="../bse/">Bethe-Salpeter</a>
</li>
            
<li >
    <a href="../dev/">Developers</a>
</li>
            
<li >
    <a href="../dmft/">DMFT</a>
</li>
            
<li >
    <a href="../eph/">Electron-Phonon</a>
</li>
            
<li >
    <a href="../ffield/">Varff</a>
</li>
            
<li >
    <a href="../files/">File-handling</a>
</li>
            
<li >
    <a href="../geo/">Geometry</a>
</li>
            
<li >
    <a href="../gstate/">Ground-State</a>
</li>
            
<li >
    <a href="../gw/">GW</a>
</li>
            
<li >
    <a href="../internal/">Internal</a>
</li>
            
<li >
    <a href="../paral/">Parallelism</a>
</li>
            
<li >
    <a href="../paw/">PAW</a>
</li>
            
<li class="active">
    <a href="./">DFPT</a>
</li>
            
<li >
    <a href="../rlx/">Relaxation</a>
</li>
            
<li >
    <a href="../vdw/">VdW</a>
</li>
            
<li >
    <a href="../w90/">Wannier90</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../anaddb/">Anaddb</a>
</li>
                            
<li >
    <a href="../optic/">Optic</a>
</li>
                            
<li >
    <a href="../aim/">Aim</a>
</li>
                            
<li >
    <a href="../varset_stats/">Statistics</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Lessons <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../tutorials/welcome/">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Base Tutorials</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/base1/">Base1</a>
</li>
            
<li >
    <a href="../../tutorials/base2/">Base2</a>
</li>
            
<li >
    <a href="../../tutorials/base3/">Base3</a>
</li>
            
<li >
    <a href="../../tutorials/base4/">Base4</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">DFPT</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/rf1/">RF1</a>
</li>
            
<li >
    <a href="../../tutorials/rf2/">RF2</a>
</li>
            
<li >
    <a href="../../tutorials/elastic/">Elastic</a>
</li>
            
<li >
    <a href="../../tutorials/eph/">EPH</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../tutorials/dmft/">DMFT</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Many-Body</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/gw1/">GW1</a>
</li>
            
<li >
    <a href="../../tutorials/gw2/">GW2</a>
</li>
            
<li >
    <a href="../../tutorials/bse/">Bethe-Salpeter</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Parallelism</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/basepar/">Base</a>
</li>
            
<li >
    <a href="../../tutorials/paral_mbt/">Many-Body</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Theory <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../theory/theory_mbt/">MBPT</a>
</li>
                            
<li >
    <a href="../../theory/additional_material/">Additional Material</a>
</li>
                            
<li >
    <a href="../../bibliography/">Bibliography</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../developers/README/">How to write docs</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../about/release-notes/">Release Notes</a>
</li>
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>
                            
<li >
    <a href="../../about/license/">License</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../paw/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../rlx/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/abinit/abinit/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#bdeigrf">bdeigrf</a></li>
        <li class="main "><a href="#d3e_pert1_atpol">d3e_pert1_atpol</a></li>
        <li class="main "><a href="#d3e_pert1_dir">d3e_pert1_dir</a></li>
        <li class="main "><a href="#d3e_pert1_elfd">d3e_pert1_elfd</a></li>
        <li class="main "><a href="#d3e_pert1_phon">d3e_pert1_phon</a></li>
        <li class="main "><a href="#d3e_pert2_atpol">d3e_pert2_atpol</a></li>
        <li class="main "><a href="#d3e_pert2_dir">d3e_pert2_dir</a></li>
        <li class="main "><a href="#d3e_pert2_elfd">d3e_pert2_elfd</a></li>
        <li class="main "><a href="#d3e_pert2_phon">d3e_pert2_phon</a></li>
        <li class="main "><a href="#d3e_pert3_atpol">d3e_pert3_atpol</a></li>
        <li class="main "><a href="#d3e_pert3_dir">d3e_pert3_dir</a></li>
        <li class="main "><a href="#d3e_pert3_elfd">d3e_pert3_elfd</a></li>
        <li class="main "><a href="#d3e_pert3_phon">d3e_pert3_phon</a></li>
        <li class="main "><a href="#dfpt_sciss">dfpt_sciss</a></li>
        <li class="main "><a href="#efmas">efmas</a></li>
        <li class="main "><a href="#efmas_bands">efmas_bands</a></li>
        <li class="main "><a href="#efmas_calc_dirs">efmas_calc_dirs</a></li>
        <li class="main "><a href="#efmas_deg">efmas_deg</a></li>
        <li class="main "><a href="#efmas_deg_tol">efmas_deg_tol</a></li>
        <li class="main "><a href="#efmas_dim">efmas_dim</a></li>
        <li class="main "><a href="#efmas_dirs">efmas_dirs</a></li>
        <li class="main "><a href="#efmas_n_dirs">efmas_n_dirs</a></li>
        <li class="main "><a href="#efmas_ntheta">efmas_ntheta</a></li>
        <li class="main "><a href="#elph2_imagden">elph2_imagden</a></li>
        <li class="main "><a href="#eph_task">eph_task</a></li>
        <li class="main "><a href="#esmear">esmear</a></li>
        <li class="main "><a href="#frzfermi">frzfermi</a></li>
        <li class="main "><a href="#ieig2rf">ieig2rf</a></li>
        <li class="main "><a href="#ph_ngqpt">ph_ngqpt</a></li>
        <li class="main "><a href="#ph_qpath">ph_qpath</a></li>
        <li class="main "><a href="#prepanl">prepanl</a></li>
        <li class="main "><a href="#prepgkk">prepgkk</a></li>
        <li class="main "><a href="#prtbbb">prtbbb</a></li>
        <li class="main "><a href="#rf2_dkdk">rf2_dkdk</a></li>
        <li class="main "><a href="#rfasr">rfasr</a></li>
        <li class="main "><a href="#rfatpol">rfatpol</a></li>
        <li class="main "><a href="#rfddk">rfddk</a></li>
        <li class="main "><a href="#rfdir">rfdir</a></li>
        <li class="main "><a href="#rfelfd">rfelfd</a></li>
        <li class="main "><a href="#rfmagn">rfmagn</a></li>
        <li class="main "><a href="#rfmeth">rfmeth</a></li>
        <li class="main "><a href="#rfphon">rfphon</a></li>
        <li class="main "><a href="#rfstrs">rfstrs</a></li>
        <li class="main "><a href="#rfuser">rfuser</a></li>
        <li class="main "><a href="#smdelta">smdelta</a></li>
        <li class="main "><a href="#td_maxene">td_maxene</a></li>
        <li class="main "><a href="#td_mexcit">td_mexcit</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<!-- Return to Top -->

<p><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a></p>
<h2 id="bdeigrf"><strong>bdeigrf</strong><a class="headerlink" href="#bdeigrf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BanD for second-order EIGenvalues from Response-Function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/TDepES">TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -1<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a> in [1,2,3,4,5]  </p>
<p>that is, if the user is performing second-order eigenvalue calculations using
response-functions.  </p>
<p>The variable <a class="wikilink" href="../../input_variables/dfpt/#bdeigrf">bdeigrf</a> is the maximum number of bands for which the second-
order eigenvalues must be calculated: the full number of bands is still used
during the computation of these corrections.  </p>
<p>If <a class="wikilink" href="../../input_variables/dfpt/#bdeigrf">bdeigrf</a> is set to -1, the code will automatically set <a class="wikilink" href="../../input_variables/dfpt/#bdeigrf">bdeigrf</a> equal
to nband.</p>
<hr />
<h2 id="d3e_pert1_atpol"><strong>d3e_pert1_atpol</strong><a class="headerlink" href="#d3e_pert1_atpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 1: limits of ATomic POLarisations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, 1]<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<p>Controls the range of atoms for which displacements will be considered in non-
linear computations (using the 2n+1 theorem), for the 1st perturbation.<br />
May take values from 1 to <a class="wikilink" href="../../input_variables/basic/#natom">natom</a>, with
<strong>d3e_pert1_atpol</strong>(1)&lt;=<strong>d3e_pert1_atpol</strong>(2).<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a> for additional details.</p>
<hr />
<h2 id="d3e_pert1_dir"><strong>d3e_pert1_dir</strong><a class="headerlink" href="#d3e_pert1_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 1: DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<p>Gives the directions to be considered in non-linear computations (using the
2n+1 theorem), for the 1st perturbation.<br />
The three elements corresponds to the three primitive vectors, either in real
space (atomic displacement), or in reciprocal space (electric field
perturbation).<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfdir">rfdir</a> for additional details.</p>
<hr />
<h2 id="d3e_pert1_elfd"><strong>d3e_pert1_elfd</strong><a class="headerlink" href="#d3e_pert1_elfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 1: ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<p>Turns on electric field perturbation in non-linear computation, as 1st
perturbation. Actually, such calculations requires first the non-self-
consistent calculation of derivatives with respect to k, independently of the
electric field perturbation itself.<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfelfd">rfelfd</a> for additional details.</p>
<hr />
<h2 id="d3e_pert1_phon"><strong>d3e_pert1_phon</strong><a class="headerlink" href="#d3e_pert1_phon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 1: PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<p>Turns on atomic displacement perturbation in non-linear computation, as 1st
perturbation.<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfphon">rfphon</a> for additional details.</p>
<hr />
<h2 id="d3e_pert2_atpol"><strong>d3e_pert2_atpol</strong><a class="headerlink" href="#d3e_pert2_atpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 2: limits of ATomic POLarisations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, 1]<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t83.in" title="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)">tests/v3/Input/t83.in</a></li>
</ul>
<p>Controls the range of atoms for which displacements will be considered in non-
linear computations (using the 2n+1 theorem), for the 2nd perturbation.<br />
May take values from 1 to <a class="wikilink" href="../../input_variables/basic/#natom">natom</a>, with
<strong>d3e_pert2_atpol</strong>(1)&lt;=<strong>d3e_pert2_atpol</strong>(2).<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a> for additional details.</p>
<hr />
<h2 id="d3e_pert2_dir"><strong>d3e_pert2_dir</strong><a class="headerlink" href="#d3e_pert2_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 2: DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<p>Gives the directions to be considered in non-linear computations (using the
2n+1 theorem), for the 2nd perturbation.<br />
The three elements corresponds to the three primitive vectors, either in real
space (atomic displacement), or in reciprocal space (electric field
perturbation).<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfdir">rfdir</a> for additional details.</p>
<hr />
<h2 id="d3e_pert2_elfd"><strong>d3e_pert2_elfd</strong><a class="headerlink" href="#d3e_pert2_elfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 2: ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<p>Turns on electric field perturbation in non-linear computation, as 2nd
perturbation. Actually, such calculations requires first the non-self-
consistent calculation of derivatives with respect to k, independently of the
electric field perturbation itself.<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfelfd">rfelfd</a> for additional details.</p>
<hr />
<h2 id="d3e_pert2_phon"><strong>d3e_pert2_phon</strong><a class="headerlink" href="#d3e_pert2_phon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 2: PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t83.in" title="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)">tests/v3/Input/t83.in</a></li>
</ul>
<p>Turns on atomic displacement perturbation in non-linear computation, as 2nd
perturbation.<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfphon">rfphon</a> for additional details.</p>
<hr />
<h2 id="d3e_pert3_atpol"><strong>d3e_pert3_atpol</strong><a class="headerlink" href="#d3e_pert3_atpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 3: limits of ATomic POLarisations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, 1]<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t83.in" title="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)">tests/v3/Input/t83.in</a></li>
</ul>
<p>Controls the range of atoms for which displacements will be considered in non-
linear computations (using the 2n+1 theorem), for the 3rd perturbation.<br />
May take values from 1 to <a class="wikilink" href="../../input_variables/basic/#natom">natom</a>, with
<strong>d3e_pert3_atpol</strong>(1)&lt;=<strong>d3e_pert3_atpol</strong>(2).<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a> for additional details.</p>
<hr />
<h2 id="d3e_pert3_dir"><strong>d3e_pert3_dir</strong><a class="headerlink" href="#d3e_pert3_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 3: DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<p>Gives the directions to be considered in non-linear computations (using the
2n+1 theorem), for the 3rd perturbation.<br />
The three elements corresponds to the three primitive vectors, either in real
space (atomic displacement), or in reciprocal space (electric field
perturbation).<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfdir">rfdir</a> for additional details.</p>
<hr />
<h2 id="d3e_pert3_elfd"><strong>d3e_pert3_elfd</strong><a class="headerlink" href="#d3e_pert3_elfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 3: ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<p>Turns on electric field perturbation in non-linear computation, as 3rd
perturbation. Actually, such calculations requires first the non-self-
consistent calculation of derivatives with respect to k, independently of the
electric field perturbation itself.<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfelfd">rfelfd</a> for additional details.</p>
<hr />
<h2 id="d3e_pert3_phon"><strong>d3e_pert3_phon</strong><a class="headerlink" href="#d3e_pert3_phon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3rd Derivative of Energy, mixed PERTurbation 3: PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==5 (non-linear response computations)<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t83.in" title="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)">tests/v3/Input/t83.in</a></li>
</ul>
<p>Turns on atomic displacement perturbation in non-linear computation, as 3rd
perturbation.<br />
See <a class="wikilink" href="../../input_variables/dfpt/#rfphon">rfphon</a> for additional details.</p>
<hr />
<h2 id="dfpt_sciss"><strong>dfpt_sciss</strong><a class="headerlink" href="#dfpt_sciss" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DFPT SCISSor operator<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t46.in" title="Si in diamond structure;  2 special points;  low ecut. With a 4x4x4 k point grid (!only one shift,  but OK because symmetry is imposed),  compute the dielectric constant with a scissor . Note that the fulfilment of the charge neutrality sum rule,  already broken without a scissor operator,  is strongly affected by a scissor">tests/v7/Input/t46.in</a></li>
</ul>
<p>It is the value of the "scissors operator", the shift of conduction band
eigenvalues, used in response function calculations.<br />
Can be specified in Ha (the default), Ry, eV or Kelvin, since <strong> ecut </strong> has
the '<a class="wikilink" href="../../ENERGY/">ENERGY</a>' characteristics. (1 Ha=27.2113845 eV)<br />
Typical use is for response to electric field (<a class="wikilink" href="../../input_variables/dfpt/#rfelfd">rfelfd</a>=3), but NOT for d/dk
(<a class="wikilink" href="../../input_variables/dfpt/#rfelfd">rfelfd</a>=2) and phonon responses.</p>
<hr />
<h2 id="efmas"><strong>efmas</strong><a class="headerlink" href="#efmas" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/EffMass">EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t80.in" title="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00.">tests/v7/Input/t80.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t81.in" title="Silicon. Silicon effective mass tensor in PAW for multiple bands and k-points.">tests/v7/Input/t81.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t82.in" title="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling.">tests/v7/Input/t82.in</a></li>
</ul>
<p>Turns on effective mass tensor calculations. Such calculations requires the
non-self-consistent calculation of derivatives with respect to k, in the same
dataset. It must therefore be used with <a class="wikilink" href="../../input_variables/dfpt/#rfelfd">rfelfd</a>=2.  </p>
<ul>
<li>0=&gt;no effective mass tensor calculation </li>
<li>1=&gt;effective mass tensor calculation </li>
</ul>
<p>At the present time, both norm-conserving (NC) and PAW calculations are
supported. Also, for PAW calculations only, <a class="wikilink" href="../../input_variables/gstate/#nspinor">nspinor</a>==2 and
<a class="wikilink" href="../../input_variables/paw/#pawspnorb">pawspnorb</a>==1 (i.e. spin-orbit (SO) calculations) is supported. NC SO
calculations are NOT currently supported. Also, for both NC and PAW,
<a class="wikilink" href="../../input_variables/gstate/#nspden">nspden</a>/=1 and <a class="wikilink" href="../../input_variables/basic/#nsppol">nsppol</a>/=1 are NOT supported.</p>
<hr />
<h2 id="efmas_bands"><strong>efmas_bands</strong><a class="headerlink" href="#efmas_bands" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, BANDS to be treated.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/EffMass">EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2,<a class="wikilink" href="../../input_variables/basic/#nkpt">nkpt</a>)<br />
<em>Default value:</em> The full range of band available in the calculation for each k-point.<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#efmas">efmas</a>==1<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t80.in" title="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00.">tests/v7/Input/t80.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t81.in" title="Silicon. Silicon effective mass tensor in PAW for multiple bands and k-points.">tests/v7/Input/t81.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t82.in" title="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling.">tests/v7/Input/t82.in</a></li>
</ul>
<p>This variable controls the range of bands for which the effective mass is to
be calculated. If a band is degenerate, all other bands of the degenerate
group will automatically be treated, even if they were not part of the user
specified range.</p>
<hr />
<h2 id="efmas_calc_dirs"><strong>efmas_calc_dirs</strong><a class="headerlink" href="#efmas_calc_dirs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, CALCulate along DIRectionS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/EffMass">EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#efmas">efmas</a>==1<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t80.in" title="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00.">tests/v7/Input/t80.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t82.in" title="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling.">tests/v7/Input/t82.in</a></li>
</ul>
<p>Allows the user to calculate the scalar effective mass of all bands specified
by <a class="wikilink" href="../../input_variables/dfpt/#efmas_bands">efmas_bands</a> along specific directions in reciprocal space. This is
particularly useful when considering degenerate bands, which are usually
warped, and thus cannot have their dispersion (hessian) and effective mass
expressed as a tensor. This allows the user to see the more complex angular
behavior of effective masses in these cases, for instance.</p>
<p>When <a class="wikilink" href="../../input_variables/dfpt/#efmas_calc_dirs">efmas_calc_dirs</a>==0, no directions are read from the input file (using
<a class="wikilink" href="../../input_variables/dfpt/#efmas_dirs">efmas_dirs</a>) and the effective masses along the 3 cartesian directions are
output by default.</p>
<p>When <a class="wikilink" href="../../input_variables/dfpt/#efmas_calc_dirs">efmas_calc_dirs</a>==1, 2 or 3, <a class="wikilink" href="../../input_variables/dfpt/#efmas_n_dirs">efmas_n_dirs</a> directions are read from
<a class="wikilink" href="../../input_variables/dfpt/#efmas_dirs">efmas_dirs</a>, assuming cartesian, reduced or angular (theta,phi)
coordinates, respectively. In the case <a class="wikilink" href="../../input_variables/dfpt/#efmas_calc_dirs">efmas_calc_dirs</a>==3, 2 real values
per directions are read, whereas 3 real values are read in the two other
cases.</p>
<hr />
<h2 id="efmas_deg"><strong>efmas_deg</strong><a class="headerlink" href="#efmas_deg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, activate DEGenerate formalism<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/EffMass">EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#efmas">efmas</a>&gt;0<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t82.in" title="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling.">tests/v7/Input/t82.in</a></li>
</ul>
<p>Activate (==1) or not (==0) the treatment of degenerate bands (within a
criterion <a class="wikilink" href="../../input_variables/dfpt/#efmas_deg_tol">efmas_deg_tol</a>) using the transport equivalent effective mass
idea (see <a href="https://doi.org/10.1103/PhysRevB.89.155131">PRB 89 155131 (2014)</a>).</p>
<hr />
<h2 id="efmas_deg_tol"><strong>efmas_deg_tol</strong><a class="headerlink" href="#efmas_deg_tol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, DEGeneracy TOLerance<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/EffMass">EffMass</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1e-05<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#efmas_deg">efmas_deg</a>==1<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t82.in" title="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling.">tests/v7/Input/t82.in</a></li>
</ul>
<p>Energy difference below which 2 bands are considered degenerate (and treated
using the formalism activated with <a class="wikilink" href="../../input_variables/dfpt/#efmas_deg">efmas_deg</a>==1). <a class="wikilink" href="../../input_variables/dfpt/#efmas_deg_tol">efmas_deg_tol</a> has
the '<a class="wikilink" href="../../ENERGY/">ENERGY</a>' characteristics.</p>
<hr />
<h2 id="efmas_dim"><strong>efmas_dim</strong><a class="headerlink" href="#efmas_dim" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, DIMension of the effective mass tensor<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/EffMass">EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#efmas">efmas</a>==1<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t80.in" title="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00.">tests/v7/Input/t80.in</a></li>
</ul>
<p>For 2D or 1D systems, the band dispersion goes to 0 perpendicular to the
system, which causes the inverse effective mass to be singular, i.e. the
effective mass to be NaN. This keyword circumvents the problem by eliminating
the troublesome dimensions from the inverse effective mass.</p>
<p>In 2D, the Z axis is ignored and, in 1D, the Z and Y axis are ignored.</p>
<p>Also, note that in the 2D degenerate case, a subtlety arises: the 'transport
equivalent' effective mass does not determine the scale of the transport
tensors (conductivity and others). Therefore, for this specific case, the
factor by which these transport tensors should be scaled once determined from
the 'transport equivatlent' effective mass tensor is output separately on the
line immediately after the effective mass.</p>
<hr />
<h2 id="efmas_dirs"><strong>efmas_dirs</strong><a class="headerlink" href="#efmas_dirs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, DIRectionS to be calculated<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/EffMass">EffMass</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3 or 2,<a class="wikilink" href="../../input_variables/dfpt/#efmas_n_dirs">efmas_n_dirs</a>)<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#efmas_calc_dirs">efmas_calc_dirs</a>&gt;0<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t80.in" title="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00.">tests/v7/Input/t80.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t82.in" title="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling.">tests/v7/Input/t82.in</a></li>
</ul>
<p>List of <a class="wikilink" href="../../input_variables/dfpt/#efmas_n_dirs">efmas_n_dirs</a> directions to be considered according to the value of
<a class="wikilink" href="../../input_variables/dfpt/#efmas_calc_dirs">efmas_calc_dirs</a>. The directions are specified by 3 real values if
<a class="wikilink" href="../../input_variables/dfpt/#efmas_calc_dirs">efmas_calc_dirs</a>==1 or 2 and by 2 real values if <a class="wikilink" href="../../input_variables/dfpt/#efmas_calc_dirs">efmas_calc_dirs</a>==3.</p>
<hr />
<h2 id="efmas_n_dirs"><strong>efmas_n_dirs</strong><a class="headerlink" href="#efmas_n_dirs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, Number of DIRectionS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/EffMass">EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#efmas_calc_dirs">efmas_calc_dirs</a>&gt;0<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t80.in" title="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00.">tests/v7/Input/t80.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t82.in" title="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling.">tests/v7/Input/t82.in</a></li>
</ul>
<p>Number of directions in <a class="wikilink" href="../../input_variables/dfpt/#efmas_dirs">efmas_dirs</a>, to be considered according to
<a class="wikilink" href="../../input_variables/dfpt/#efmas_calc_dirs">efmas_calc_dirs</a>.</p>
<hr />
<h2 id="efmas_ntheta"><strong>efmas_ntheta</strong><a class="headerlink" href="#efmas_ntheta" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, Number of points for integration w/r to THETA<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/EffMass">EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1000<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#efmas">efmas</a>==1 and <a class="wikilink" href="../../input_variables/dfpt/#efmas_bands">efmas_bands</a>==(degenerate band index)<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t80.in" title="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00.">tests/v7/Input/t80.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t81.in" title="Silicon. Silicon effective mass tensor in PAW for multiple bands and k-points.">tests/v7/Input/t81.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t82.in" title="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling.">tests/v7/Input/t82.in</a></li>
</ul>
<p>When a band is degenerate, the usual definition of effective mass becomes
invalid. However, it is still possible to define a 'transport equivalent mass
tensor' that reproduces the contribution of the band to the conductivity
tensor. To obtain this tensor, an integration over the solid sphere is
required. The default value gives a tensor accurate to the 4th decimal in Ge.</p>
<hr />
<h2 id="elph2_imagden"><strong>elph2_imagden</strong><a class="headerlink" href="#elph2_imagden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ELectron-PHonon interaction at 2nd order : IMAGinary shift of the DENominator<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/TDepES">TDepES</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a> != 0  </p>
<p>that is, if the user is performing performing second-order eigenvalue
calculations using response-functions.  </p>
<p>The variable <a class="wikilink" href="../../input_variables/dfpt/#elph2_imagden">elph2_imagden</a> determines the imaginary shift of the
denominator of the sum-over-states in the perturbation denominator,
(e_{nk}-e_{n'k'}+i <a class="wikilink" href="../../input_variables/dfpt/#elph2_imagden">elph2_imagden</a>). One should use a width comparable with
the Debye frequency or the maximum phonon frequency.<br />
Can be specified in Ha (the default), Ry, eV or Kelvin, since <strong> ecut </strong> has
the '<a class="wikilink" href="../../ENERGY/">ENERGY</a>' characteristics. (1 Ha=27.2113845 eV)</p>
<hr />
<h2 id="eph_task"><strong>eph_task</strong><a class="headerlink" href="#eph_task" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron-PHonon: Task<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/ElPhonInt">ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t89.in" title="Calculation of e-ph coupling matrix elements">tests/v7/Input/t89.in</a></li>
<li>v8:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v8/Input/t44.in" title="WARNING: This code is still under development. Use at your own risk. Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements.">tests/v8/Input/t44.in</a></li>
</ul>
<p>When <a class="wikilink" href="../../input_variables/gstate/#optdriver">optdriver</a>==7, select the task to be performed. The choice is among :<br />
<a class="wikilink" href="../../input_variables/dfpt/#eph_task">eph_task</a>=1 : phonon linewidth<br />
<a class="wikilink" href="../../input_variables/dfpt/#eph_task">eph_task</a>=2 : electron-phonon coupling elements</p>
<hr />
<h2 id="esmear"><strong>esmear</strong><a class="headerlink" href="#esmear" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Eigenvalue SMEARing<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/TDepES">TDepES</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.01<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/dfpt/#smdelta">smdelta</a> != 0<br />
Test list:</p>
<ul>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t60.in" title="Crystalline Silicon Test the smearing parameter ESMEAR of the imaginary second order eigenvalues for Q-point (0 0 0),  contained in the EIGI2D files. Parameters are far from convergence,  nband=5 and nkpt=16.">tests/v6/Input/t60.in</a></li>
</ul>
<p>that is, if the user is performing simulations of the electronic lifetimes
induced by the electron-phonon coupling.  </p>
<p>The variable <a class="wikilink" href="../../input_variables/dfpt/#esmear">esmear</a> determines the width of the functions approximating
the delta function, \delta(e_{nk}-e_{n'k'}), present in the expression of the
lifetimes. One should use a width comparable with the Debye frequency or the
maximum phonon frequency.<br />
Can be specified in Ha (the default), Ry, eV or Kelvin, since <strong> ecut </strong> has
the '<a class="wikilink" href="../../ENERGY/">ENERGY</a>' characteristics. (1 Ha=27.2113845 eV)</p>
<hr />
<h2 id="frzfermi"><strong>frzfermi</strong><a class="headerlink" href="#frzfermi" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FReeZe FERMI energy<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v2:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t26.in" title="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 28. The chosen grid (too coarse,  though) is (0 0 0),  (1/4 1/4 0),  (1/2 1/2 0),  (1/2 0 0), (1/2 1/4 1/4),  (1/2 -1/4 1/4)  (in reduced coordinates). The ecut and nkpt parameters are really too low (see test 28), but parameters suitable for physical results (see test 29) are also provided in the input files.">tests/v2/Input/t26.in</a></li>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t75.in" title="O2 (non-spin-polarized,  non-linear XC core correction,  LDA) Metallic occupation numbers. For metallic occupation numbers, RF computation of 2DTE at Gamma,  when taking Fermi energy changes (frzfermi=0),  will give the same answer than finite-difference of GS computations. However,  prior to v4.4,  the change of Fermi energy due to the perturbation was not computed. This corresponds to calculations performed with frzfermi=1 (should be used only for testing purposes). In dataset 1-3,  one computes the total energy and forces, without symmetries,  as it should be for accurate finite-difference tests. The reduced gradients with respect to displacements of the first atom along z in datasets 1 and 3 are -5.705344113253 Ha and -5.692553418498 Ha,  giving the 2DTE of 127.90 Ha. In dataset 4,  RF is computed with the Fermi energy correction, and the agreement with finite-differences of datasets 1 and 3 is good : one gets 127.9068 Ha . In dataset 5,  RF is computed with frozen Fermi energy and the disagreement with finite-differences of datasets 1 and 3 is large: one gets 100.9991668 Ha .">tests/v3/Input/t75.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t89.in" title="Computation of phonons frequencies for metallic occupations at q=0 0 0 within PAW O2 (nsppol=1);  this test is directly inspired by test v3#75. In datasets 1-3,  one computes the total energy and forces,  without symmetries, as it should be for accurate finite-difference tests. From the reduced gradients with respect to displacements,  one can deduce a 2DTE of 149.9614 Ha. In dataset 4,  RF is computed with the Fermi energy correction, and the agreement with finite-differences of datasets 1 and 3 is good : one gets 149.9612 Ha. In dataset 5,  RF is computed with frozen Fermi energy and the disagreement with finite-differences of datasets 1 and 3 is large: one gets 124.9787 Ha.">tests/v6/Input/t89.in</a></li>
</ul>
<p>Can be used to suppress artificially the first-order change of Fermi energy,
in case of Response Function calculation for metals at Q=0. The input variable
<a class="wikilink" href="../../input_variables/dfpt/#frzfermi">frzfermi</a>, if set to 1, allows to suppress this contribution, but this is
incorrect.</p>
<hr />
<h2 id="ieig2rf"><strong>ieig2rf</strong><a class="headerlink" href="#ieig2rf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for second-order EIGenvalues from Response-Function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/TDepES">TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>If <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a> is greater then 0, the code will produce a file, named with the
trailing suffix _EIGR2D, containing the second-order electronic eigenvalues
for the perturbation. These files are used in the calculation of the thermal
correction to the electronic eigenvalues.  </p>
<p>If <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a> is set to 1, the second-order electronic eigenvalues will be
calculated from the DFPT method (Sternheimer).<br />
If <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a> is set to 2, the second-order electronic eigenvalues will be
calculated from the Allen-Cardona method. (sum over states)<br />
If <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a> is set to 3, the second-order electronic eigenvalues will be
calculated from the DFPT method (sum over states) but using a different part
of the code. This is equivalent to <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a> = 1 [debuging]<br />
If <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a> is set to 4, the second-order electronic eigenvalues will be
calculated from the dynamical DFPT method (Sternheimer). The code will
generate _EIGR2D.nc files that contain the electron-phonon matrix element
squared on the space orthogonal to the active space. The code will also
produce _FAN.nc files that contain the electron-phonon matrix elements
squared. Note that <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a>=4 can only be used if Abinit is compiled with
NETCDF support.<br />
If <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a> is set to 5, the second-order electronic eigenvalues will be
calculated from the dynamical DFPT method (Sternheimer). The code will
generate _EIGR2D.nc files that contain the electron-phonon matrix element
square on the space orthogonal to the active space. The code will also produce
_GKK.nc files that contain electron-phonon matrix elements. This option is
preferable for large system to <a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a>=4 as the GKK files take less much
less disk space and memory (but run a little bit slower). Note that
<a class="wikilink" href="../../input_variables/dfpt/#ieig2rf">ieig2rf</a>=5 can only be used if Abinit is compiled with NETCDF support.<br />
Related variables :
<a class="wikilink" href="../../input_variables/dfpt/#bdeigrf">bdeigrf</a>,<a class="wikilink" href="../../input_variables/dfpt/#elph2_imagden">elph2_imagden</a>,<a class="wikilink" href="../../input_variables/dev/#getgam_eig2nkq">getgam_eig2nkq</a>,<a class="wikilink" href="../../input_variables/dfpt/#smdelta">smdelta</a></p>
<hr />
<h2 id="ph_ngqpt"><strong>ph_ngqpt</strong><a class="headerlink" href="#ph_ngqpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PHonons: Number of Grid points for Q-PoinT mesh.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/q-points">q-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [20, 20, 20]<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t88.in" title="Calculation of phonon linewidths and e-ph coupling parameter lambda.">tests/v7/Input/t88.in</a></li>
<li>v8:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v8/Input/t44.in" title="WARNING: This code is still under development. Use at your own risk. Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements.">tests/v8/Input/t44.in</a></li>
</ul>
<p>This variable defines the q-mesh used to compute the phonon DOS and the
Eliashberg function via Fourier interpolation. Related input variables:
<a class="wikilink" href="../../input_variables/eph/#ph_qshift">ph_qshift</a> and <a class="wikilink" href="../../input_variables/eph/#ph_nqshift">ph_nqshift</a>.</p>
<hr />
<h2 id="ph_qpath"><strong>ph_qpath</strong><a class="headerlink" href="#ph_qpath" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Phonons: Q-PATH<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/q-points">q-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,ph_nqpath)<br />
<em>Default value:</em> None<br />
<em>Only relevant if:</em> specified(<a class="wikilink" href="../../input_variables/eph/#ph_nqpath">ph_nqpath</a>)<br />
Test list:</p>
<ul>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t88.in" title="Calculation of phonon linewidths and e-ph coupling parameter lambda.">tests/v7/Input/t88.in</a></li>
<li>v8:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v8/Input/t44.in" title="WARNING: This code is still under development. Use at your own risk. Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements.">tests/v8/Input/t44.in</a></li>
</ul>
<p>This array contains the list of special q-points used to construct the q-path
for phonon band structures and phonon linewidths. See also <a class="wikilink" href="../../input_variables/eph/#ph_nqpath">ph_nqpath</a> and
[<a class="wikilink" href="../../input_variables/eph/#ph_ndivsm">ph_ndivsm</a>.</p>
<hr />
<h2 id="prepanl"><strong>prepanl</strong><a class="headerlink" href="#prepanl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PREPAre Non-Linear response calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/nonlinear">nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>The computation of third-order derivatives from the 2n+1 theorem requires the
first-order wavefunctions and densities obtained from a linear response
calculation. The standard approach in a linear response calculation is (i) to
compute only the irreducible perturbations, and (ii) to use symmetries to
reduce the number of k-points for the k-point integration.<br />
This approach cannot be applied, presently (v4.1), if the first-order
wavefunctions are to be used to compute third-order derivatives. First, for
electric fields, the code needs the derivatives along the three directions.
Still, in case of phonons, only the irreducible perturbations are required.
Second, for both electric fields and phonons, the wavefunctions must be
available in half the BZ (kptopt=2), or the full BZ (kptopt=3).<br />
During the linear response calculation, in order to prepare a non-linear
calculation, one should put <a class="wikilink" href="../../input_variables/dfpt/#prepanl">prepanl</a> to 1 in order to force ABINIT (i) to
compute the electric field perturbation along the three directions explicitly,
and (ii) to keep the full number of k-points.</p>
<hr />
<h2 id="prepgkk"><strong>prepgkk</strong><a class="headerlink" href="#prepgkk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PREPAre GKK calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/ElPhonInt">ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>tutorespfn:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutorespfn/Input/teph_1.in" title="the sequence of datasets makes the ground states and all of the explicit perturbations of the single Al atom in all directions,  for the irreducible qpoints in a 2x2x2 grid. Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)">tests/tutorespfn/Input/teph_1.in</a></li>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t85.in" title="FCC Aluminium - get phonons and ddk in preparation for an electron-phonon coupling run. a few extra features are used compared to the tutorial.">tests/v5/Input/t85.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t72.in" title="Ground state and phonons of hcp TiNb alloy">tests/v6/Input/t72.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t90.in" title="Ground state and phonons of hcp Ti (similar to test 72,  but grid 2 2 4)">tests/v6/Input/t90.in</a></li>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t90.in" title="Ground state and phonons of bcc Li">tests/v7/Input/t90.in</a></li>
</ul>
<p>The calculation of electron-phonon coupling quantities requires the presence
of all the perturbations (all atoms in all directions) for the chosen set of
(irreducible) q-points. To impose this and prevent ABINIT from using symmetry
to reduce the number of perturbations, set <a class="wikilink" href="../../input_variables/dfpt/#prepgkk">prepgkk</a> to 1. Use in
conjunction with <a class="wikilink" href="../../input_variables/files/#prtgkk">prtgkk</a>.</p>
<hr />
<h2 id="prtbbb"><strong>prtbbb</strong><a class="headerlink" href="#prtbbb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT Band-By-Band decomposition<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/printing">printing</a>, <a class="wikilink" href="../../topics/Output">Output</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t77.in" title="BaO crystal. Computation of band-by-band decomposition of Born effective charges. Also,  computation of the electronic localization tensor, and its band-by-band decomposition.">tests/v3/Input/t77.in</a></li>
</ul>
<p>If <a class="wikilink" href="../../input_variables/dfpt/#prtbbb">prtbbb</a> is 1, print the band-by-band decomposition of Born effective
charges and localization tensor, in case they are computed. See Ph. Ghosez and
X. Gonze, J. Phys.: Condens. Matter 12, 9179 (2000).</p>
<hr />
<h2 id="rf2_dkdk"><strong>rf2_dkdk</strong><a class="headerlink" href="#rf2_dkdk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function : 2nd Derivative of wavefunctions with respect to K<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<p>UNUSABLE (in development)</p>
<p>Activates computation of second derivatives of wavefunctions with respect to
wavevectors. This is not strictly a response function but is a needed
auxiliary quantity in the calculations of 3rd-order derivatives of the energy
(non-linear response). The directions for the derivatives are determined by
<a class="wikilink" href="../../input_variables/dfpt/#rfdir">rfdir</a> (TO BE CORRECTED!).</p>
<ul>
<li>0=&gt;no derivative calculation </li>
<li>1=&gt;calculation along diagonal directions (d2/(dk_i dk_i), natom+10 is activated) </li>
<li>2=&gt;calculation along off-diagonal directions (d2/(dk_i dk_j), natom+11 is activated) </li>
<li>3=&gt;calculation along all directions (both natom+10 and natom+11 are activated) </li>
</ul>
<hr />
<h2 id="rfasr"><strong>rfasr</strong><a class="headerlink" href="#rfasr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function : Acoustic Sum Rule<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Phonons">Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t24.in" title="GeTe in rhombohedral structure Test the computation of phonons,  dielectric tensor and Born effective charges,  with and without spin-orbit coupling.">tests/v5/Input/t24.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t37.in" title="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . Warning : only valid for Gamma,  AND the temperature-dependent shifts must be averaged over degenerate states.">tests/v6/Input/t37.in</a></li>
<li>v7:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t50.in" title="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . The temperature-dependent shifts must be averaged over degenerate states. This temperature-dependent calculation make use of a k-point interpolation to speed up the convergence study with respect to the q-points integration. Two q-points are computed.">tests/v7/Input/t50.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t51.in" title="This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the previous test. The third q-point is computed here.">tests/v7/Input/t51.in</a></li>
</ul>
<p>Control the evaluation of the acoustic sum rule in effective charges and
dynamical matrix at Gamma within a response function calculation (not active
at the level of producing the DDB, but at the level of the phonon
eigenfrequencies output).</p>
<ul>
<li>0 =&gt; no acoustic sum rule imposed </li>
<li>1 =&gt; acoustic sum rule imposed for dynamical matrix at Gamma, and charge neutrality imposed with extra charge evenly distributed among atoms </li>
<li>2 =&gt; acoustic sum rule imposed for dynamical matrix at Gamma, and charge neutrality imposed with extra charge given proportionally to those atoms with the largest effective charge. </li>
</ul>
<p>The treatment of the acoustic sum rule and charge neutrality sum rule is finer
at the level of the ANADDB utility, with the two independent input variables
<a class="wikilink" href="../../input_variables/anaddb/#asr">asr</a> and <a class="wikilink" href="../../input_variables/anaddb/#chneut">chneut</a>.</p>
<hr />
<h2 id="rfatpol"><strong>rfatpol</strong><a class="headerlink" href="#rfatpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function : ATomic POLarisation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a>, <a class="wikilink" href="../../topics/Elastic">Elastic</a>, <a class="wikilink" href="../../topics/Phonons">Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, 1]  </p>
<p>Control the range of atoms for which displacements will be considered in
phonon calculations (atomic polarizations), using the 2n+1 theorem.<br />
These values are only relevant to phonon response function calculations.<br />
May take values from 1 to <a class="wikilink" href="../../input_variables/basic/#natom">natom</a>, with <a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a>(1)&lt;=<a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a>(2).<br />
The atoms to be moved will be defined by the<br />
do-loop variable iatpol :<br />
do iatpol=<a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a>(1),<a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a>(2)<br />
For the calculation of a full dynamical matrix, use <a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a>(1)=1 and
<a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a>(2)=<a class="wikilink" href="../../input_variables/basic/#natom">natom</a>, together with <a class="wikilink" href="../../input_variables/dfpt/#rfdir">rfdir</a> 1 1 1 . For selected
elements of the dynamical matrix, use different values of <a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a> and/or
<a class="wikilink" href="../../input_variables/dfpt/#rfdir">rfdir</a>. The name 'iatpol' is used for the part of the internal variable
ipert when it runs from 1 to <a class="wikilink" href="../../input_variables/basic/#natom">natom</a>. The internal variable ipert can also
assume values larger than <a class="wikilink" href="../../input_variables/basic/#natom">natom</a>, denoting perturbations of electric field
or stress type (see <a href="../../../users/generated_files/help_respfn.html"> the response function help file
</a> ).</p>
<hr />
<h2 id="rfddk"><strong>rfddk</strong><a class="headerlink" href="#rfddk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to Derivative with respect to K<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v5:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t30.in" title="Compute DDK response in PAW formalism for two different but equivalent input variables: rfddk 1,  rfelfd 2">tests/v5/Input/t30.in</a></li>
</ul>
<p>Activates computation of derivatives of ground state wavefunctions with
respect to wavevectors. This is not strictly a response function but is a
needed auxiliary quantity in the electric field calculations (see <a class="wikilink" href="../../input_variables/dfpt/#rfelfd">rfelfd</a>)
The directions for the derivatives are determined by <a class="wikilink" href="../../input_variables/dfpt/#rfdir">rfdir</a>.</p>
<ul>
<li>0=&gt;no derivative calculation </li>
<li>1=&gt;calculation of first derivatives of wavefunctions with respect to k points (d/dk calculation). The exact same functionality is provided by <a class="wikilink" href="../../input_variables/dfpt/#rfelfd">rfelfd</a> = 2. </li>
</ul>
<hr />
<h2 id="rfdir"><strong>rfdir</strong><a class="headerlink" href="#rfdir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function : DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a>, <a class="wikilink" href="../../topics/Elastic">Elastic</a>, <a class="wikilink" href="../../topics/Phonons">Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]  </p>
<p>Gives the directions to be considered for response function calculations (also
for the Berry phase computation of the polarization, see the <a class="wikilink" href="../../input_variables/ffield/#berryopt">berryopt</a>
input variable).<br />
The three elements corresponds to the three primitive vectors, either in real
space (phonon calculations), or in reciprocal space (d/dk, homogeneous
electric field, homogeneous magnetic field calculations). So, they generate a
basis for the generation of the dynamical matrix or the macroscopic dielectric
tensor or magnetic susceptibility and magnetic shielding, or the effective
charge tensors.<br />
If equal to 1, response functions, as defined by <a class="wikilink" href="../../input_variables/dfpt/#rfddk">rfddk</a>, <a class="wikilink" href="../../input_variables/dfpt/#rfelfd">rfelfd</a>,
<a class="wikilink" href="../../input_variables/dfpt/#rfphon">rfphon</a>, <a class="wikilink" href="../../input_variables/dfpt/#rfdir">rfdir</a> and <a class="wikilink" href="../../input_variables/dfpt/#rfatpol">rfatpol</a>, are to be computed for the
corresponding direction. If 0, this direction should not be considered.</p>
<hr />
<h2 id="rfelfd"><strong>rfelfd</strong><a class="headerlink" href="#rfelfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to the ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/EffMass">EffMass</a>, <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Turns on electric field response function calculations. Actually, such
calculations requires first the non-self-consistent calculation of derivatives
with respect to k, independently of the electric field perturbation itself.</p>
<ul>
<li>0=&gt;no electric field perturbation </li>
<li>1=&gt;full calculation, with first the derivative of ground-state wavefunction with respect to k (d/dk calculation), by a non-self-consistent calculation, then the generation of the first-order response to an homogeneous electric field </li>
<li>2=&gt;only the derivative of ground-state wavefunctions with respect to k </li>
<li>3=&gt;only the generation of the first-order response to the electric field, assuming that the data on derivative of ground-state wavefunction with respect to k is available on disk. </li>
</ul>
<p>(Note : because the tolerances to be used for derivatives or homogeneous
electric field are different, one often does the calculation of derivatives in
a separate dataset, followed by calculation of electric field response as well
as phonon.<br />
The options 2 and 3 proves useful in that context ; also, in case a scissor
shift is to be used, it is usually not applied for the d/dk response).</p>
<hr />
<h2 id="rfmagn"><strong>rfmagn</strong><a class="headerlink" href="#rfmagn" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to MAGNetic B-field perturbation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v8:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v8/Input/t20.in" title="Response of magnetic metal to external magnetic field. First,  ground state wf is computed,  then dfpt calculation.">tests/v8/Input/t20.in</a></li>
</ul>
<p>It must be equal to 1 to run response function calculations with respect to
external magnetic field. Currently, orbital magnetism is not taken into
account and the perturbing potential has Zeeman form.</p>
<hr />
<h2 id="rfmeth"><strong>rfmeth</strong><a class="headerlink" href="#rfmeth" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function METHod<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
Test list:</p>
<p>Selects method used in response function calculations. Presently, only 1 is
allowed.</p>
<hr />
<h2 id="rfphon"><strong>rfphon</strong><a class="headerlink" href="#rfphon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>It must be equal to 1 to run phonon response function calculations.</p>
<hr />
<h2 id="rfstrs"><strong>rfstrs</strong><a class="headerlink" href="#rfstrs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to STRainS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a>, <a class="wikilink" href="../../topics/Elastic">Elastic</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>Used to run strain response-function calculations (e.g. needed to get elastic
constants). Define, with <a class="wikilink" href="../../input_variables/dfpt/#rfdir">rfdir</a>, the set of perturbations.</p>
<ul>
<li>0=&gt;no strain perturbation </li>
<li>1=&gt;only uniaxial strain(s) (ipert=natom+3 is activated) </li>
<li>2=&gt;only shear strain(s) (ipert=natom+4 is activated) </li>
<li>3=&gt;both uniaxial and shear strain(s) (both ipert=natom+3 and ipert=natom+4 are activated) </li>
</ul>
<p>See the possible restrictions on the use of strain perturbations, in the <a href="../../../users/generated_files/help_respfn.html#1">
respfn help file </a> .</p>
<hr />
<h2 id="rfuser"><strong>rfuser</strong><a class="headerlink" href="#rfuser" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function, USER-defined<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/DFPT">DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<p>Available to the developpers, to activate the use of ipert=natom+6 and
ipert=natom+7, two sets of perturbations that the developpers can define.  </p>
<ul>
<li>0=&gt;no computations for ipert=natom+6 or ipert=natom+7 </li>
<li>1=&gt;response with respect to perturbation natom+6 will be computed </li>
<li>2=&gt;response with respect to perturbation natom+7 will be computed </li>
<li>3=&gt;responses with respect to perturbations natom+6 and natom+7 will be computed </li>
</ul>
<p>In order to define and use correctly the new perturbations, the developper
might have to include code lines or additional routines at the level of the
following routines : dfpt_cgwf.F90, dfpt_dyout.F90, dfpt_symph.F90,
dfpt_dyout.F90, dfpt_etot.F90, littlegroup_pert.F90, dfpt_looppert.F90,
dfpt_mkcor.F90, dfpt_nstdy.F90, dfpt_nstwf.F90, respfn.F90, dfpt_scfcv.F90,
irreducible_set_pert.F90, dfpt_vloca.F90, dfpt_vtorho.F90, dfpt_vtowfk.F90. In
these routines, the developper should pay a particular attention to the rfpert
array, defined in the routine respfn.F90 , as well as to the ipert local
variable.</p>
<hr />
<h2 id="smdelta"><strong>smdelta</strong><a class="headerlink" href="#smdelta" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SMeared DELTA function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/TDepES">TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<p>When <a class="wikilink" href="../../input_variables/dfpt/#smdelta">smdelta</a> in non-zero, it will trigger the calculation of the imaginary
part of the second-order electronic eigenvalues, which can be related to the
electronic lifetimes. The delta function is evaluated using:  </p>
<ul>
<li>when <a class="wikilink" href="../../input_variables/dfpt/#smdelta">smdelta</a> == 1, Fermi-Dirac smearing : 0.25_dp/(cosh(xx/2.0_dp)**2 </li>
<li>when <a class="wikilink" href="../../input_variables/dfpt/#smdelta">smdelta</a> == 2, Cold smearing by Marzari using the parameter a=-.5634 (minimization of the bump): exp(-xx2)/sqrt(pi) * (1.5d0+xx<em>(-a</em>1.5d0+xx<em>(-1.0d0+a</em>xx))) </li>
<li>when <a class="wikilink" href="../../input_variables/dfpt/#smdelta">smdelta</a> == 3, Cold smearing by Marzari using the parameter a=-.8165 (monotonic function in the tail): as 2 but different a </li>
<li>when <a class="wikilink" href="../../input_variables/dfpt/#smdelta">smdelta</a> == 4, Smearing of Methfessel and Paxton (PRB40,3616(1989)) with Hermite polynomial of degree 2, corresponding to "Cold smearing" of N. Marzari with a=0 (so, same smeared delta function as smdelta=2, with different a). </li>
<li>when <a class="wikilink" href="../../input_variables/dfpt/#smdelta">smdelta</a> == 5, Gaussian smearing : 1.0d0<em>exp(-xx</em>*2)/sqrt(pi) </li>
</ul>
<hr />
<h2 id="td_maxene"><strong>td_maxene</strong><a class="headerlink" href="#td_maxene" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Time-Dependent dft : MAXimal kohn-sham ENErgy difference<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/TDDFT">TDDFT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
Test list:</p>
<ul>
<li>v1:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v1/Input/t69.in" title="Excited states of the Mg atom,  with (ixc=1,  spin-polarized Teter functional). Use the multi-dataset mode. Can be compared with the results in Vasiliev et al,  PRL 82,  1919 (1999). With the values acell 18,  ecut 3.5,  nband2 10,  the present test generates KS diff=3.46eV,  TDLDA(1S1P)=4.48eV,  TDLDA(1S3P)=2.81eV With the values acell 22,  ecut 3.5,  nband2 22,  ABINIT generates KS diff=3.40eV,  TDLDA(1S1P)=4.35eV,  TDLDA(1S3P)=2.77eV Vasiliev gets KS diff=3.39eV,  TDLDA(1S1P)=4.34eV,  TDLDA(1S3P)=2.79eV">tests/v1/Input/t69.in</a></li>
</ul>
<p>The Matrix to be diagonalized in the Casida framework (see "Time-Dependent
Density Functional Response Theory of Molecular systems: Theory, Computational
Methods, and Functionals", by M.E. Casida, in Recent Developments and
Applications of Modern Density Functional Theory, edited by J.M. Seminario
(Elsevier, Amsterdam, 1996).) is a NxN matrix, where, by default, N is the
product of the number of occupied states by the number of unoccupied states.<br />
The input variable <a class="wikilink" href="../../input_variables/dfpt/#td_maxene">td_maxene</a> allows to diminish N : it selects only the
pairs of occupied and unoccupied states for which the Kohn-Sham energy
difference is less than <a class="wikilink" href="../../input_variables/dfpt/#td_maxene">td_maxene</a>. The default value 0.0 means that all
pairs are taken into account.<br />
See <a class="wikilink" href="../../input_variables/dfpt/#td_mexcit">td_mexcit</a> for an alternative way to decrease N.</p>
<hr />
<h2 id="td_mexcit"><strong>td_mexcit</strong><a class="headerlink" href="#td_mexcit" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Time-Dependent dft : Maximal number of EXCITations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/TDDFT">TDDFT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v1:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v1/Input/t69.in" title="Excited states of the Mg atom,  with (ixc=1,  spin-polarized Teter functional). Use the multi-dataset mode. Can be compared with the results in Vasiliev et al,  PRL 82,  1919 (1999). With the values acell 18,  ecut 3.5,  nband2 10,  the present test generates KS diff=3.46eV,  TDLDA(1S1P)=4.48eV,  TDLDA(1S3P)=2.81eV With the values acell 22,  ecut 3.5,  nband2 22,  ABINIT generates KS diff=3.40eV,  TDLDA(1S1P)=4.35eV,  TDLDA(1S3P)=2.77eV Vasiliev gets KS diff=3.39eV,  TDLDA(1S1P)=4.34eV,  TDLDA(1S3P)=2.79eV">tests/v1/Input/t69.in</a></li>
</ul>
<p>The Matrix to be diagonalized in the Casida framework (see "Time-Dependent
Density Functional Response Theory of Molecular systems: Theory, Computational
Methods, and Functionals", by M.E. Casida, in Recent Developments and
Applications of Modern Density Functional Theory, edited by J.M. Seminario
(Elsevier, Amsterdam, 1996).) is a NxN matrix, where, by default, N is the
product of the number of occupied states by the number of unoccupied states.<br />
The input variable <a class="wikilink" href="../../input_variables/dfpt/#td_mexcit">td_mexcit</a> allows to diminish N : it selects the first
<a class="wikilink" href="../../input_variables/dfpt/#td_mexcit">td_mexcit</a> pairs of occupied and unoccupied states, ordered with respect to
increasing Kohn-Sham energy difference. However, when <a class="wikilink" href="../../input_variables/dfpt/#td_mexcit">td_mexcit</a> is zero,
all pairs are allowed.<br />
See <a class="wikilink" href="../../input_variables/dfpt/#td_maxene">td_maxene</a> for an alternative way to decrease N.</p>
<hr /></div>
        </div>

        <footer class="col-md-12">
<hr>

    <center>Abinit version 8.5.4</center>


    <center>Copyright &copy; 2017 The Abinit Group</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>
        <script>var base_url = '../..';</script>
        <!--
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        -->
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
        <script src="../../extra_javascript/abidocs.js"></script>

    <!--<script>var base_url = '../..';</script>
<script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>

<h1 id="search">Search Results</h1>

<form action="search.html">
  <input name="q" id="mkdocs-search-query" type="text" >
</form>

<div id="mkdocs-search-results">
  Sorry, page not found.
</div>
    -->

    </body>
</html>
