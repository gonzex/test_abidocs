<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="The Abinit group">
        <link rel="canonical" href="http://www.abinit.org/input_variables/aim/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Aim - abinit</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/codehilite.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">
    
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">abinit</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../..">Introduction</a>
</li>
                            
<li >
    <a href="../../installation/">Installation</a>
</li>
                            
<li >
    <a href="../../user-guide/help_what_ABINIT_does/">Overview</a>
</li>
                            
<li >
    <a href="../../user-guide/help_abinit/">Abinit</a>
</li>
                            
<li >
    <a href="../../user-guide/help_mrgddb/">Mrgddb</a>
</li>
                            
<li >
    <a href="../../user-guide/help_optic/">Optic</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topics <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../topics/">Complete List</a>
</li>
                            
<li >
    <a href="../../topics/Artificial/">Artificial</a>
</li>
                            
<li >
    <a href="../../topics/AtomManipulator/">AtomManipulator</a>
</li>
                            
<li >
    <a href="../../topics/AtomTypes/">AtomTypes</a>
</li>
                            
<li >
    <a href="../../topics/Bader/">Bader</a>
</li>
                            
<li >
    <a href="../../topics/BandOcc/">BandOcc</a>
</li>
                            
<li >
    <a href="../../topics/Berry/">Berry</a>
</li>
                            
<li >
    <a href="../../topics/BSE/">BSE</a>
</li>
                            
<li >
    <a href="../../topics/ConstrainedPol/">ConstrainedPol</a>
</li>
                            
<li >
    <a href="../../topics/Control/">Control</a>
</li>
                            
<li >
    <a href="../../topics/Coulomb/">Coulomb</a>
</li>
                            
<li >
    <a href="../../topics/CRPA/">CRPA</a>
</li>
                            
<li >
    <a href="../../topics/crystal/">Crystal</a>
</li>
                            
<li >
    <a href="../../topics/Dev/">Dev</a>
</li>
                            
<li >
    <a href="../../topics/DFPT/">DFPT</a>
</li>
                            
<li >
    <a href="../../topics/DFT+U/">DFT+U</a>
</li>
                            
<li >
    <a href="../../topics/DMFT/">DMFT</a>
</li>
                            
<li >
    <a href="../../topics/EffMass/">EffMass</a>
</li>
                            
<li >
    <a href="../../topics/EFG/">EFG</a>
</li>
                            
<li >
    <a href="../../topics/Elastic/">Elastic</a>
</li>
                            
<li >
    <a href="../../topics/ElecBandStructure/">ElecBandStructure</a>
</li>
                            
<li >
    <a href="../../topics/ElecDOS/">ElecDOS</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonInt/">ElPhonInt</a>
</li>
                            
<li >
    <a href="../../topics/ElPhonTransport/">ElPhonTransport</a>
</li>
                            
<li >
    <a href="../../topics/ForcesStresses/">ForcesStresses</a>
</li>
                            
<li >
    <a href="../../topics/FrequencyMeshMBPT/">FrequencyMeshMBPT</a>
</li>
                            
<li >
    <a href="../../topics/GeoConstraints/">GeoConstraints</a>
</li>
                            
<li >
    <a href="../../topics/GeoOpt/">GeoOpt</a>
</li>
                            
<li >
    <a href="../../topics/GW/">GW</a>
</li>
                            
<li >
    <a href="../../topics/GWls/">GWls</a>
</li>
                            
<li >
    <a href="../../topics/Hybrids/">Hybrids</a>
</li>
                            
<li >
    <a href="../../topics/">Home</a>
</li>
                            
<li >
    <a href="../../topics/k-points/">K points</a>
</li>
                            
<li >
    <a href="../../topics/LOTF/">LOTF</a>
</li>
                            
<li >
    <a href="../../topics/MagField/">MagField</a>
</li>
                            
<li >
    <a href="../../topics/MagMom/">MagMom</a>
</li>
                            
<li >
    <a href="../../topics/MolecularDynamics/">MolecularDynamics</a>
</li>
                            
<li >
    <a href="../../topics/multidtset/">Multidtset</a>
</li>
                            
<li >
    <a href="../../topics/nonlinear/">Nonlinear</a>
</li>
                            
<li >
    <a href="../../topics/Optic/">Optic</a>
</li>
                            
<li >
    <a href="../../topics/Output/">Output</a>
</li>
                            
<li >
    <a href="../../topics/parallelism/">Parallelism</a>
</li>
                            
<li >
    <a href="../../topics/PAW/">PAW</a>
</li>
                            
<li >
    <a href="../../topics/PhononBands/">PhononBands</a>
</li>
                            
<li >
    <a href="../../topics/Phonons/">Phonons</a>
</li>
                            
<li >
    <a href="../../topics/PhononWidth/">PhononWidth</a>
</li>
                            
<li >
    <a href="../../topics/PIMD/">PIMD</a>
</li>
                            
<li >
    <a href="../../topics/Planewaves/">Planewaves</a>
</li>
                            
<li >
    <a href="../../topics/positron/">Positron</a>
</li>
                            
<li >
    <a href="../../topics/printing/">Printing</a>
</li>
                            
<li >
    <a href="../../topics/PseudosPAW/">PseudosPAW</a>
</li>
                            
<li >
    <a href="../../topics/q-points/">Q points</a>
</li>
                            
<li >
    <a href="../../topics/RandStopPow/">RandStopPow</a>
</li>
                            
<li >
    <a href="../../topics/Recursion/">Recursion</a>
</li>
                            
<li >
    <a href="../../topics/RPACorrEn/">RPACorrEn</a>
</li>
                            
<li >
    <a href="../../topics/SCFAlgorithms/">SCFAlgorithms</a>
</li>
                            
<li >
    <a href="../../topics/SCFControl/">SCFControl</a>
</li>
                            
<li >
    <a href="../../topics/SelfEnergy/">SelfEnergy</a>
</li>
                            
<li >
    <a href="../../topics/SmartSymm/">SmartSymm</a>
</li>
                            
<li >
    <a href="../../topics/spinpolarisation/">Spinpolarisation</a>
</li>
                            
<li >
    <a href="../../topics/STM/">STM</a>
</li>
                            
<li >
    <a href="../../topics/Susceptibility/">Susceptibility</a>
</li>
                            
<li >
    <a href="../../topics/TDDFT/">TDDFT</a>
</li>
                            
<li >
    <a href="../../topics/TDepES/">TDepES</a>
</li>
                            
<li >
    <a href="../../topics/Temperature/">Temperature</a>
</li>
                            
<li >
    <a href="../../topics/TransPath/">TransPath</a>
</li>
                            
<li >
    <a href="../../topics/TuningSpeed/">TuningSpeed</a>
</li>
                            
<li >
    <a href="../../topics/UnitCell/">UnitCell</a>
</li>
                            
<li >
    <a href="../../topics/vdw/">Vdw</a>
</li>
                            
<li >
    <a href="../../topics/Wannier/">Wannier</a>
</li>
                            
<li >
    <a href="../../topics/Wavelets/">Wavelets</a>
</li>
                            
<li >
    <a href="../../topics/xc/">Xc</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Input Variables <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Abinit</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../varlist_abinit/">All Variables</a>
</li>
            
<li >
    <a href="../basic/">Basic</a>
</li>
            
<li >
    <a href="../bse/">Bethe-Salpeter</a>
</li>
            
<li >
    <a href="../dev/">Developers</a>
</li>
            
<li >
    <a href="../dmft/">DMFT</a>
</li>
            
<li >
    <a href="../eph/">Electron-Phonon</a>
</li>
            
<li >
    <a href="../ffield/">Varff</a>
</li>
            
<li >
    <a href="../files/">File-handling</a>
</li>
            
<li >
    <a href="../geo/">Geometry</a>
</li>
            
<li >
    <a href="../gstate/">Ground-State</a>
</li>
            
<li >
    <a href="../gw/">GW</a>
</li>
            
<li >
    <a href="../internal/">Internal</a>
</li>
            
<li >
    <a href="../paral/">Parallelism</a>
</li>
            
<li >
    <a href="../paw/">PAW</a>
</li>
            
<li >
    <a href="../dfpt/">DFPT</a>
</li>
            
<li >
    <a href="../rlx/">Relaxation</a>
</li>
            
<li >
    <a href="../vdw/">VdW</a>
</li>
            
<li >
    <a href="../w90/">Wannier90</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../anaddb/">Anaddb</a>
</li>
                            
<li >
    <a href="../optic/">Optic</a>
</li>
                            
<li class="active">
    <a href="./">Aim</a>
</li>
                            
<li >
    <a href="../varset_stats/">Statistics</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Lessons <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../tutorials/welcome/">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Base Tutorials</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/base1/">Base1</a>
</li>
            
<li >
    <a href="../../tutorials/base2/">Base2</a>
</li>
            
<li >
    <a href="../../tutorials/base3/">Base3</a>
</li>
            
<li >
    <a href="../../tutorials/base4/">Base4</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">DFPT</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/rf1/">RF1</a>
</li>
            
<li >
    <a href="../../tutorials/rf2/">RF2</a>
</li>
            
<li >
    <a href="../../tutorials/elastic/">Elastic</a>
</li>
            
<li >
    <a href="../../tutorials/eph/">EPH</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../tutorials/dmft/">DMFT</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Many-Body</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/gw1/">GW1</a>
</li>
            
<li >
    <a href="../../tutorials/gw2/">GW2</a>
</li>
            
<li >
    <a href="../../tutorials/bse/">Bethe-Salpeter</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Parallelism</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/basepar/">Base</a>
</li>
            
<li >
    <a href="../../tutorials/paral_mbt/">Many-Body</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Theory <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../theory/theory_mbt/">MBPT</a>
</li>
                            
<li >
    <a href="../../theory/additional_material/">Additional Material</a>
</li>
                            
<li >
    <a href="../../bibliography/">Bibliography</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../developers/README/">How to write docs</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../about/release-notes/">Release Notes</a>
</li>
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>
                            
<li >
    <a href="../../about/license/">License</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../optic/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../varset_stats/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/abinit/abinit/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#atom">atom</a></li>
        <li class="main "><a href="#atrad">atrad</a></li>
        <li class="main "><a href="#coff1">coff1</a></li>
        <li class="main "><a href="#coff2">coff2</a></li>
        <li class="main "><a href="#crit">crit</a></li>
        <li class="main "><a href="#denout">denout</a></li>
        <li class="main "><a href="#dltyp">dltyp</a></li>
        <li class="main "><a href="#dpclim">dpclim</a></li>
        <li class="main "><a href="#foldep">foldep</a></li>
        <li class="main "><a href="#follow">follow</a></li>
        <li class="main "><a href="#folstp">folstp</a></li>
        <li class="main "><a href="#gpsurf">gpsurf</a></li>
        <li class="main "><a href="#inpt">inpt</a></li>
        <li class="main "><a href="#irho">irho</a></li>
        <li class="main "><a href="#ivol">ivol</a></li>
        <li class="main "><a href="#lapout">lapout</a></li>
        <li class="main "><a href="#lgrad">lgrad</a></li>
        <li class="main "><a href="#lgrad2">lgrad2</a></li>
        <li class="main "><a href="#lstep">lstep</a></li>
        <li class="main "><a href="#lstep2">lstep2</a></li>
        <li class="main "><a href="#maxatd">maxatd</a></li>
        <li class="main "><a href="#maxcpd">maxcpd</a></li>
        <li class="main "><a href="#ngrid">ngrid</a></li>
        <li class="main "><a href="#nphi">nphi</a></li>
        <li class="main "><a href="#nsa">nsa</a></li>
        <li class="main "><a href="#nsb">nsb</a></li>
        <li class="main "><a href="#nsc">nsc</a></li>
        <li class="main "><a href="#ntheta">ntheta</a></li>
        <li class="main "><a href="#phimax">phimax</a></li>
        <li class="main "><a href="#phimin">phimin</a></li>
        <li class="main "><a href="#radstp">radstp</a></li>
        <li class="main "><a href="#ratmin">ratmin</a></li>
        <li class="main "><a href="#rsurdir">rsurdir</a></li>
        <li class="main "><a href="#rsurf">rsurf</a></li>
        <li class="main "><a href="#scal">scal</a></li>
        <li class="main "><a href="#surf">surf</a></li>
        <li class="main "><a href="#thetamax">thetamax</a></li>
        <li class="main "><a href="#thetamin">thetamin</a></li>
        <li class="main "><a href="#vpts">vpts</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<!-- Return to Top -->

<p><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a></p>
<h2 id="atom"><strong>atom</strong><a class="headerlink" href="#atom" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> index of ATOM<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>Index of the investigated atom.</p>
<hr />
<h2 id="atrad"><strong>atrad</strong><a class="headerlink" href="#atrad" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> bader ATomic RADius<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>A first estimation of the Bader radius (not too important - it is used only
two times)</p>
<hr />
<h2 id="coff1"><strong>coff1</strong><a class="headerlink" href="#coff1" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> COeFFicient 1<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.98<br />
Test list:</p>
<p>See the input variable <a class="wikilink" href="../../ratmin@aim/">ratmin@aim</a>.</p>
<hr />
<h2 id="coff2"><strong>coff2</strong><a class="headerlink" href="#coff2" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> COeFFicient 2<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.95<br />
Test list:</p>
<p>See the input variable <a class="wikilink" href="../../ratmin@aim/">ratmin@aim</a>.</p>
<hr />
<h2 id="crit"><strong>crit</strong><a class="headerlink" href="#crit" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> computation of CRITical points<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>Drives the computation of critical points.</p>
<ul>
<li>[0] not </li>
<li>[-1] reading from the file ``root''.crit </li>
<li>[1] calculated (simplified version) </li>
<li>[2] calculated (standard version - recommended) </li>
<li>[3] calculated (the original version) </li>
</ul>
<p>The original version searches all critical points (CPs) starting from the
center between two and three atoms (atom - neighbor(s)) by Newton-Raphson
algorithm - without tests (not recommended) - don't use together with surface
analysis !</p>
<p>The simplified and standard versions search CP(3,-1) starting from the center
of the pairs~atom-neighbor; then CP(3,1) from the center between two CP(3,-1)
and finally CP(3,3) from the center between two CP(3,1). The robust
Popeliers's algorithm is used. The difference between the two is based in the
fact that the standard version makes the test if the CP is really on the Bader
surface of the calculated atom for each CP, while the simplified version does
this only for CP(3,-1). When CP analysis is rather fast (with respect to
surface determination), 2 is recommended. In all cases the number of neighbors
considered is limited by distance cutoff (variable <a class="wikilink" href="../../maxatd@aim/">maxatd@aim</a>)</p>
<hr />
<h2 id="denout"><strong>denout</strong><a class="headerlink" href="#denout" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> electronic DENsity OUTput<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<p>Output of the electronic density. The specification of the line (plane) in the
real space must be given in the input variable <a class="wikilink" href="../../vpts@aim/">vpts@aim</a> and grid in
<a class="wikilink" href="../../ngrid@aim/">ngrid@aim</a>. It is also possible to get only the valence density or the core
density (see <a class="wikilink" href="../../dltyp@aim/">dltyp@aim</a>).</p>
<ul>
<li>0, no output </li>
<li>1, 1D distribution </li>
<li>2, 2D distribution </li>
</ul>
<hr />
<h2 id="dltyp"><strong>dltyp</strong><a class="headerlink" href="#dltyp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Density or Laplacian TYP output<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<p>Specification of the contribution of the electronic density corresponding to
the density and/or laplacian output (see <a class="wikilink" href="../../denout@aim/">denout@aim</a> and <a class="wikilink" href="../../lapout@aim/">lapout@aim</a>)</p>
<ul>
<li>0, total electronic density </li>
<li>1, only the valence density </li>
<li>2, only the core density </li>
</ul>
<hr />
<h2 id="dpclim"><strong>dpclim</strong><a class="headerlink" href="#dpclim" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DPCLIM<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.d-2<br />
Test list:</p>
<ul>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a></li>
</ul>
<p>If two "numerically different" critical points are separated by less than
<strong>dpclim</strong>, they are considered to be the same critical point. This often
happens because of numerical inaccuracies : one CP might be "seen" by two
different finite elements. The default should be OK when the ecut is quite
large, on the order of 60 Hartree. For less accurate calculations of the
density, increase the default value to 5.d-2, let's say.</p>
<hr />
<h2 id="foldep"><strong>foldep</strong><a class="headerlink" href="#foldep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FOLlow DEParture<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0.0<br />
Test list:</p>
<p>Needed in the case <a class="wikilink" href="../../input_variables/aim/#follow">follow</a>=1 only. Defines the starting point.</p>
<hr />
<h2 id="follow"><strong>follow</strong><a class="headerlink" href="#follow" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FOLLOW the gradient path<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>Follow the gradient path to the corresponding atom starting from the position
specified in the input variable <a class="wikilink" href="../../input_variables/aim/#foldep">foldep</a>.</p>
<hr />
<h2 id="folstp"><strong>folstp</strong><a class="headerlink" href="#folstp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FOLlow STeP<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.5<br />
Test list:</p>
<p>The first step for following the gradient path.</p>
<hr />
<h2 id="gpsurf"><strong>gpsurf</strong><a class="headerlink" href="#gpsurf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GraPhic output for the bader SURFace<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>Drives the graphic output (gnuplot script) of the irreducible part of the
calculated Bader surface.</p>
<ul>
<li>0, not output </li>
<li>1, output </li>
</ul>
<hr />
<h2 id="inpt"><strong>inpt</strong><a class="headerlink" href="#inpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> numer of INtegration PoinTs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 100<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>Number of radial points used for integration of the Bader charge (not too
sensitive).</p>
<hr />
<h2 id="irho"><strong>irho</strong><a class="headerlink" href="#irho" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integration of the charge density RHO<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>Drives the integration of the charge of the Bader atom.</p>
<ul>
<li>0, not calculated </li>
<li>1, calculated (usual mode) </li>
</ul>
<hr />
<h2 id="ivol"><strong>ivol</strong><a class="headerlink" href="#ivol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integration of the VOLume<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>Drives the integration of the volume of the Bader atom.</p>
<ul>
<li>0, not calculated </li>
<li>1, calculated </li>
</ul>
<hr />
<h2 id="lapout"><strong>lapout</strong><a class="headerlink" href="#lapout" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> electronic density LAPlacian OUTput<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<p>Output of the laplacian of electronic density. The specification of the line
(plane) in the real space must be given in the input variable <a class="wikilink" href="../../input_variables/aim/#vpts">vpts</a> and
grid in <a class="wikilink" href="../../input_variables/aim/#ngrid">ngrid</a>. It is also possible to get only the valence density or
the core density (see <a class="wikilink" href="../../input_variables/aim/#dltyp">dltyp</a>).</p>
<ul>
<li>0, no output </li>
<li>1, 1D distribution </li>
<li>2, 2D distribution </li>
</ul>
<hr />
<h2 id="lgrad"><strong>lgrad</strong><a class="headerlink" href="#lgrad" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Low GRADient criterion<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.d-12<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
</ul>
<p>The search for one particular CP is decided to be successful when either the
norm of the gradient of the electron density is smaller than <strong>lgrad</strong> or when
the length of the planned search step is smaller than <a class="wikilink" href="../../input_variables/aim/#lstep">lstep</a>. If the
number of search step becomes larger than an internal limit (presently set to
100), one will allow a weaker criteria for satisfaction, based on
<a class="wikilink" href="../../input_variables/aim/#lgrad2">lgrad2</a> and <a class="wikilink" href="../../input_variables/aim/#lstep2">lstep2</a>. If the internal limit is reached, and the
criteria on <a class="wikilink" href="../../input_variables/aim/#lgrad2">lgrad2</a> and <a class="wikilink" href="../../input_variables/aim/#lstep2">lstep2</a> are not satisfied, then the
searching procedure continues with the next seed.</p>
<hr />
<h2 id="lgrad2"><strong>lgrad2</strong><a class="headerlink" href="#lgrad2" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Low GRADient criterion 2<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.d-5<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
</ul>
<p>Determines the criterion for deciding that a CP has been found. See
<a class="wikilink" href="../../input_variables/aim/#lgrad">lgrad</a> for more details.</p>
<hr />
<h2 id="lstep"><strong>lstep</strong><a class="headerlink" href="#lstep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Length of the planned search STEP<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.d-10<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
</ul>
<p>Determines the criterion for deciding a CP has been found. See <a class="wikilink" href="../../input_variables/aim/#lgrad">lgrad</a>
for more details.</p>
<hr />
<h2 id="lstep2"><strong>lstep2</strong><a class="headerlink" href="#lstep2" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Length of the planned search STEP 2<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.d-5<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
</ul>
<p>Determines the criterion for deciding that a CP has been found. See
<a class="wikilink" href="../../input_variables/aim/#lgrad">lgrad</a> for more details.</p>
<hr />
<h2 id="maxatd"><strong>maxatd</strong><a class="headerlink" href="#maxatd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MAXimal ATomic Distance<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10.0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>Atoms within this maximal distance are considered in order to start the search
of a CP.</p>
<p>Note that the supercell, determined by <a class="wikilink" href="../../input_variables/aim/#nsa">nsa</a>, <a class="wikilink" href="../../input_variables/aim/#nsb">nsb</a>, and
<a class="wikilink" href="../../input_variables/aim/#nsc">nsc</a> might be too small to actually lead to the consideration of all
the desired atoms.</p>
<hr />
<h2 id="maxcpd"><strong>maxcpd</strong><a class="headerlink" href="#maxcpd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MAXimal CP Distance<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 5.0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>The CPs are searched for within this maximal distance.</p>
<p>Note that the supercell, determined by <a class="wikilink" href="../../input_variables/aim/#nsa">nsa</a>, <a class="wikilink" href="../../input_variables/aim/#nsb">nsb</a>, and
<a class="wikilink" href="../../input_variables/aim/#nsc">nsc</a> might be too small to actually lead to the consideration of all
the critical points.</p>
<hr />
<h2 id="ngrid"><strong>ngrid</strong><a class="headerlink" href="#ngrid" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of GRID points<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> 2*30<br />
Test list:</p>
<p>Defines the grid in real space, for the density and laplacian outputs,
governed by <a class="wikilink" href="../../input_variables/aim/#denout">denout</a> and <a class="wikilink" href="../../input_variables/aim/#lapout">lapout</a>.</p>
<hr />
<h2 id="nphi"><strong>nphi</strong><a class="headerlink" href="#nphi" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of PHI angle<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 48<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>With <a class="wikilink" href="../../input_variables/aim/#ntheta">ntheta</a>, this variable defines the angular grid for the
integration within the Bader volume, in particular, the number of phi angles,
to be used between <a class="wikilink" href="../../input_variables/aim/#phimin">phimin</a> and <a class="wikilink" href="../../input_variables/aim/#phimax">phimax</a>. When the difference
between these two variables is 2 pi, the recommended value of <strong>nphi</strong> is 48.
When it is pi (for symmetry reasons), the recommended value is 32. When it is
pi/2 (for symmetry reasons), the recommended value is 20.</p>
<hr />
<h2 id="nsa"><strong>nsa</strong><a class="headerlink" href="#nsa" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Supercell points in direction A<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
</ul>
<p>These variables define a "supercell", from the primitive cell repeated along
each primitive direction. This supercell is build as follows :</p>
<pre><code>  do isa=-nsa,nsa
   do isb=-nsb,nsb
    do isc=-nsc,nsc
      -&gt; here, the cell is translated by the vector
      -&gt; (isa,isb,isc) in crystallographic coordinates
      -&gt; and accumulated, to give the supercell
    enddo
   enddo
  enddo
</code></pre>
<hr />
<h2 id="nsb"><strong>nsb</strong><a class="headerlink" href="#nsb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Supercell points in direction B<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
</ul>
<p>These variables define a "supercell", from the primitive cell repeated along
each primitive direction. This supercell is build as follows :</p>
<pre><code>  do isa=-nsa,nsa
   do isb=-nsb,nsb
    do isc=-nsc,nsc
      -&gt; here, the cell is translated by the vector
      -&gt; (isa,isb,isc) in crystallographic coordinates
      -&gt; and accumulated, to give the supercell
    enddo
   enddo
  enddo
</code></pre>
<hr />
<h2 id="nsc"><strong>nsc</strong><a class="headerlink" href="#nsc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Supercell points in direction C<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
</ul>
<p>These variables define a "supercell", from the primitive cell repeated along
each primitive direction. This supercell is build as follows :</p>
<pre><code>  do isa=-nsa,nsa
   do isb=-nsb,nsb
    do isc=-nsc,nsc
      -&gt; here, the cell is translated by the vector
      -&gt; (isa,isb,isc) in crystallographic coordinates
      -&gt; and accumulated, to give the supercell
    enddo
   enddo
  enddo
</code></pre>
<hr />
<h2 id="ntheta"><strong>ntheta</strong><a class="headerlink" href="#ntheta" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of THETA angles<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 32<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>With <a class="wikilink" href="../../input_variables/aim/#nphi">nphi</a>, this variable defines the angular grid for the integration
within the Bader volume, in particular, the number of theta angles, to be used
between <a class="wikilink" href="../../input_variables/aim/#thetamin">thetamin</a> and <a class="wikilink" href="../../input_variables/aim/#thetamax">thetamax</a>. When the difference between
these two variables is pi, the recommended value of <strong>ntheta</strong> is 32. When it
is pi/2 (for symmetry reasons), the recommended value is 20.</p>
<hr />
<h2 id="phimax"><strong>phimax</strong><a class="headerlink" href="#phimax" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PHI MAXimal angle<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2.0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
</ul>
<p>Angular limits of integration of the Bader volume for the phi variables. The
number of integration points is given by <a class="wikilink" href="../../input_variables/aim/#nphi">nphi</a>. The range of
integration can be decreased if there are symmetry reasons for doing this.</p>
<hr />
<h2 id="phimin"><strong>phimin</strong><a class="headerlink" href="#phimin" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PHI MINimal angle<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
Test list:</p>
<p>Angular limits of integration of the Bader volume for the phi variables. The
number of integration points is given by <a class="wikilink" href="../../input_variables/aim/#nphi">nphi</a>. The range of
integration can be decreased if there are symmetry reasons for doing this.</p>
<hr />
<h2 id="radstp"><strong>radstp</strong><a class="headerlink" href="#radstp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RADial STeP<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.05<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>The length of the first step in the search of the exact Bader radius.</p>
<hr />
<h2 id="ratmin"><strong>ratmin</strong><a class="headerlink" href="#ratmin" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Radius Atomic MINimal<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>The first estimation of the smallest radius of the basin of the atom (the
distance at which the procedure that follows the gradient path announces that
the gradient path finishes in the corresponding atom) This parameter is very
important for the speed of the calculation, but this first estimation is not
usually used because the program makes a new one based on the knowledge of
CPs. In fact after the CP analysis, the new estimation is done by the product
of the ad hoc parameter <a class="wikilink" href="../../input_variables/aim/#coff1">coff1</a> (default 0.98) by the distance of the
nearest bonding CP. If there is a problem later, <a class="wikilink" href="../../input_variables/aim/#coff2">coff2</a> (default 0.95)
is used instead.</p>
<hr />
<h2 id="rsurdir"><strong>rsurdir</strong><a class="headerlink" href="#rsurdir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Radius SURface DIRection<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> 2*0.0<br />
Test list:</p>
<p>In the case <a class="wikilink" href="../../input_variables/aim/#rsurf">rsurf</a>=1, gives the direction (angular coordinates
theta,phi) along which the radius of the Bader surface is to be determined.</p>
<hr />
<h2 id="rsurf"><strong>rsurf</strong><a class="headerlink" href="#rsurf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> computation of the Radius bader SURFace<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<p>Drive the computation of the radius of the Bader surface for the angles
specified in the input variable <a class="wikilink" href="../../input_variables/aim/#rsurdir">rsurdir</a></p>
<ul>
<li>0, not calculated </li>
<li>1, calculated </li>
</ul>
<hr />
<h2 id="scal"><strong>scal</strong><a class="headerlink" href="#scal" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SCALing of the cartesian coordinates<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 1.0 1.0 1.0<br />
Test list:</p>
<hr />
<h2 id="surf"><strong>surf</strong><a class="headerlink" href="#surf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> computation of the bader SURFace<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
<li>v6:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>
<p>Drive the computation of the full Bader surface.</p>
<ul>
<li>0, not calculated </li>
<li>1, calculated </li>
</ul>
<hr />
<h2 id="thetamax"><strong>thetamax</strong><a class="headerlink" href="#thetamax" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> THETA MAXimal angle<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> pi<br />
Test list:</p>
<ul>
<li>v3:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
<li>v4:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
</ul>
<p>Angular limits of integration of the Bader volume for the theta variables. The
number of integration points is given by <a class="wikilink" href="../../input_variables/aim/#ntheta">ntheta</a>. The range of
integration can be decreased if there are symmetry reasons for doing this.</p>
<hr />
<h2 id="thetamin"><strong>thetamin</strong><a class="headerlink" href="#thetamin" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> THETA MINimal angle<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
Test list:</p>
<p>Angular limits of integration of the Bader volume for the theta variables. The
number of integration points is given by <a class="wikilink" href="../../input_variables/aim/#ntheta">ntheta</a>. The range of
integration can be decreased if there are symmetry reasons for doing this.</p>
<hr />
<h2 id="vpts"><strong>vpts</strong><a class="headerlink" href="#vpts" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Vectors defining the PoinTS of the surface<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Bader">Bader</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (6)<br />
<em>commentdims:</em> 6 for 1D, 9 for 2D<br />
<em>Default value:</em> 6*0.0<br />
Test list:</p>
<p>Basic vectors of the line or rectangle in real space, defining the points for
which the density or laplacian will be computed, thanks to <a class="wikilink" href="../../input_variables/aim/#denout">denout</a> or
<a class="wikilink" href="../../input_variables/aim/#lapout">lapout</a></p>
<hr /></div>
        </div>

        <footer class="col-md-12">
<hr>

    <center>Abinit version 8.5.4</center>


    <center>Copyright &copy; 2017 The Abinit Group</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>
        <script>var base_url = '../..';</script>
        <!--
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        -->
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
        <script src="../../extra_javascript/abidocs.js"></script>

    <!--<script>var base_url = '../..';</script>
<script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>

<h1 id="search">Search Results</h1>

<form action="search.html">
  <input name="q" id="mkdocs-search-query" type="text" >
</form>

<div id="mkdocs-search-results">
  Sorry, page not found.
</div>
    -->

    </body>
</html>
