<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="The Abinit group">
    <link rel="canonical" href="http://www.abinit.org/input_variables/w90/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Wannier90 - abinit</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../css/codehilite.css" rel="stylesheet">
    <link href="../../css/extra.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->


    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "w90iniprj", url: "#w90iniprj", children: [
          ]},
          {title: "w90prtunk", url: "#w90prtunk", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      <script src="../../extra_javascript/abidocs.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../anaddb/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../anaddb/" class="btn btn-xs btn-link">
        Anaddb
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../vdw/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../vdw/" class="btn btn-xs btn-link">
        VdW
      </a>
    </div>
    
  </div>

    

    <!-- Return to Top -->

<p><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a></p>
<h2 id="w90iniprj"><strong>w90iniprj</strong><a class="headerlink" href="#w90iniprj" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Wannier90- INItial PROJections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Wannier">Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/files/#prtwant">prtwant</a>==2 or <a class="wikilink" href="../../input_variables/files/#prtwant">prtwant</a>==3<br />
Test list:</p>
<ul>
<li>tutoplugs:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutoplugs/Input/tw90_3.in" title="Silane SiH4. Generation of Wannier functions via Wannier90 code.">tests/tutoplugs/Input/tw90_3.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutoplugs/Input/tw90_4.in" title="Test Wannier90 interface with NC pseudos">tests/tutoplugs/Input/tw90_4.in</a></li>
<li>wannier90:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t01.in" title="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use...">tests/wannier90/Input/t01.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t02.in" title="The same as in 01 but using PAW.">tests/wannier90/Input/t02.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t03.in" title="Cannot be executed in parallel (mlwfovl_qp) Si fcc,  in primitive cell (2 atoms/cell) Test of self-consistent model GW (2 iterations) following Faleev et al., [PRL 93,  126406 (2004)] followed by construction of quasiparticle maximally-localized wannier functions [Hamann &amp; Vanderbilt, arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test- acceptable speed,  and the results are poorly converged.  The input file is sufficiently annotated to serve as a model.  Note that well- converged GW calculations are extremely time consuming,  and in general it is advisable to run the SCGW part separately on a parallel system, and then run a separate serial job modeled on the last dataset, substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps, &quot; with appropriate links to the files produced in the serial run.  Note that the _DEN file from the first dataset is also needed as input,  although the discontinued &quot;irdden&quot; input variable is not needed or supported. Note that acceptable names for the secondary input file needed by the wannier90 library are wannier90.win,  w90.win,  abo_DSn_w90.win (ndtset &gt;0) and abo_w90.win (ndtset=0),  where abo is the 4th line of the .files file and n is the wannier dataset.">tests/wannier90/Input/t03.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t11.in" title="Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions.">tests/wannier90/Input/t11.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t12.in" title="Argon FCC Test the approach of Ambrosetti and Silvestrelli to assess van der Waals interactions.">tests/wannier90/Input/t12.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t13.in" title="Argon FCC Test the approach of Silvestrelli to assess van der Waals interactions,  combining the QHO model with Wannier functions.">tests/wannier90/Input/t13.in</a></li>
</ul>
<p>In order to find the Maximally Localized Wannier Functions, the user has to
provide an initial guess. A set of localized trial orbitals is chosen
corresponding to some rough initial guess at the Wannier Functions, and these
are projected onto the Bloch eigenstates. See Ivo Souza, Nicola Marzari, and
David Vanderbilt. Phys. Rev. B, 65, 035109 (2001).<br />
These initial projections are stored in a file .amn and the variable <strong>
w90iniprj </strong> is used to construct them:</p>
<ul>
<li>
<p><strong> w90iniprj </strong> =1: Random projections.   </p>
</li>
<li>
<p><strong> w90iniprj </strong> =2: The initial projections will be a linear combination of hydrogenic atomic orbitals. <br />
The user has to define the projections in the secondary input file
wannier90.win<br />
Information about how to define them can be found in the manual of Wannier90.
See  <a href="http://www.wannier.org"> www.wannier.org </a></p>
</li>
</ul>
<hr />
<h2 id="w90prtunk"><strong>w90prtunk</strong><a class="headerlink" href="#w90prtunk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Wannier90- PRINT UNKp.s file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink" href="../../topics/Wannier">Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Comment:</em> The default is set to zero because UNKp.s files occupy a lot of
memory.<br />
<em>Only relevant if:</em> <a class="wikilink" href="../../input_variables/files/#prtwant">prtwant</a>==2 or <a class="wikilink" href="../../input_variables/files/#prtwant">prtwant</a>==3<br />
Test list:</p>
<ul>
<li>tutoplugs:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutoplugs/Input/tw90_1.in" title="Test interface with Wannier90 (NC pseudos)">tests/tutoplugs/Input/tw90_1.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutoplugs/Input/tw90_2.in" title="Test interface with Wannier90 (PAW calculation)">tests/tutoplugs/Input/tw90_2.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutoplugs/Input/tw90_3.in" title="Silane SiH4. Generation of Wannier functions via Wannier90 code.">tests/tutoplugs/Input/tw90_3.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/tutoplugs/Input/tw90_4.in" title="Test Wannier90 interface with NC pseudos">tests/tutoplugs/Input/tw90_4.in</a></li>
<li>wannier90:  <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t03.in" title="Cannot be executed in parallel (mlwfovl_qp) Si fcc,  in primitive cell (2 atoms/cell) Test of self-consistent model GW (2 iterations) following Faleev et al., [PRL 93,  126406 (2004)] followed by construction of quasiparticle maximally-localized wannier functions [Hamann &amp; Vanderbilt, arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test- acceptable speed,  and the results are poorly converged.  The input file is sufficiently annotated to serve as a model.  Note that well- converged GW calculations are extremely time consuming,  and in general it is advisable to run the SCGW part separately on a parallel system, and then run a separate serial job modeled on the last dataset, substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps, &quot; with appropriate links to the files produced in the serial run.  Note that the _DEN file from the first dataset is also needed as input,  although the discontinued &quot;irdden&quot; input variable is not needed or supported. Note that acceptable names for the secondary input file needed by the wannier90 library are wannier90.win,  w90.win,  abo_DSn_w90.win (ndtset &gt;0) and abo_w90.win (ndtset=0),  where abo is the 4th line of the .files file and n is the wannier dataset.">tests/wannier90/Input/t03.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t11.in" title="Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions.">tests/wannier90/Input/t11.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t12.in" title="Argon FCC Test the approach of Ambrosetti and Silvestrelli to assess van der Waals interactions.">tests/wannier90/Input/t12.in</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t13.in" title="Argon FCC Test the approach of Silvestrelli to assess van der Waals interactions,  combining the QHO model with Wannier functions.">tests/wannier90/Input/t13.in</a></li>
</ul>
<p>Defines whether or not the UNKp.s file will be printed.</p>
<ul>
<li>
<p><a class="wikilink" href="../../input_variables/w90/#w90prtunk">w90prtunk</a>=0: Do not print the UNKp.s files   </p>
</li>
<li>
<p><a class="wikilink" href="../../input_variables/w90/#w90prtunk">w90prtunk</a>=1: Print the UNKp.s files on a fine grid   </p>
</li>
<li>
<p><a class="wikilink" href="../../input_variables/w90/#w90prtunk">w90prtunk</a>&gt;1: Print the UNKp.s files on a coarse grid <br />
Instead of printing every record we will print every w90prtunk records. This
is useful to reduce the size of the UNKp.s files, but, the quality is also
reduced.</p>
</li>
</ul>
<p>These files contain the periodic part of the bloch states represented on a
regular real space grid. They are indexed by k-point <strong> p </strong> (from 1 to nkpt)
and spin <strong> s </strong> ('1' for 'up','2' for 'down').  </p>
<p>The name of the wavefunction file is assumed to have the form:  </p>
<p>write(wfnname,200) <strong> p </strong> , <strong> spin </strong><br />
200 format ('UNK',i5.5,'.',i1)  </p>
<p>These file are unformatted. The first line of each file contains 5 integers:
the number of grid points in each direction ( <strong> n1 </strong> , <strong> n2 </strong> and <strong> n3 </strong>
), the k-point number <strong> ikpt </strong> and the total number of bands mband in the
file. The following rows contain the wavefunctions in real space.</p>
<p>These files are written in the following way for the coarse grid:</p>
<pre><code> write(iun_plot) n1/w90prtunk,n2/w90prtunk,n3/w90prtunk,ikpt,nband
write(iun_plot) (((fofr(1,jj1,jj2,jj3),fofr(2,jj1,jj2,jj3),&amp;
&amp;      jj1=1,n1,w90prtunk),jj2=1,n2,w90prtunk),jj3=1,n3,w90prtunk)
</code></pre>
<p>Where <strong> fofr </strong> is a double precision variable which contains the
wavefunctions in real space. Note that in order to reduce the size of the UNK
files we are just including records in the wavefunctions for 1/(w90prtunk^3)
of the grid points. That is why we divide n1, n2 and n3 by prtunk. The output
.xsf files for plotting with XCrysDen will also be on the coarse grid. When
this does not produce an acceptable plot, prtunk can be set to 1 to output
every grid point. (You should try spline interpolation in XCrysDen first.)</p>
<hr />

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../anaddb/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../anaddb/" class="btn btn-xs btn-link">
        Anaddb
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../vdw/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../vdw/" class="btn btn-xs btn-link">
        VdW
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
<hr>

    <center>Abinit version 8.5.4</center>


    <center>Copyright &copy; 2017 The Abinit Group</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
</footer>

</body>
</html>