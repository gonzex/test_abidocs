
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Abinit documentation">
      
      
        <link rel="canonical" href="http://www.abinit.org/input_variables/varff/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.7.4">
    
    
      
        <title>Varff - abinit</title>
      
    
    
    
      <script src="../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 
    -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme
    -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript
    -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!-- MathJax support -->
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->


    
      <link rel="stylesheet" href="../../assets/stylesheets/application-769c285a91.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/codehilite.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="http://www.abinit.org" title="abinit" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Input Variables
                </span>
              
                <span class="md-header-nav__parent">
                  Abinit
                </span>
              
            
            Varff
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="Quick Start" class="md-tabs__link">
          Quick Start
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user-guide/help_what_ABINIT_does/" title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../varlist_abinit/" title="Input Variables" class="md-tabs__link md-tabs__link--active">
          Input Variables
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorials/welcome/" title="Tutorials" class="md-tabs__link">
          Tutorials
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/theory_mbt/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Quick Start
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Quick Start
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-3" type="checkbox" id="nav-1-3">
    
    <label class="md-nav__link" for="nav-1-3">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-1-3">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystalline Structure" class="md-nav__link">
      Crystalline Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/kpoints/" title="K-points" class="md-nav__link">
      K-points
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/help_what_ABINIT_does/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/help_abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/help_mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/help_optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Input Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Input Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1" checked>
    
    <label class="md-nav__link" for="nav-3-1">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../varlist_abinit/" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varbas/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varbse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vardev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vardmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vareph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Varff
      </label>
    
    <a href="./" title="Varff" class="md-nav__link md-nav__link--active">
      Varff
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#atvshift" title="atvshift" class="md-nav__link">
    atvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bdberry" title="bdberry" class="md-nav__link">
    bdberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berryopt" title="berryopt" class="md-nav__link">
    berryopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrysav" title="berrysav" class="md-nav__link">
    berrysav
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrystep" title="berrystep" class="md-nav__link">
    berrystep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bfield" title="bfield" class="md-nav__link">
    bfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddamp" title="ddamp" class="md-nav__link">
    ddamp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfield" title="dfield" class="md-nav__link">
    dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efield" title="efield" class="md-nav__link">
    efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jfielddir" title="jfielddir" class="md-nav__link">
    jfielddir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kberry" title="kberry" class="md-nav__link">
    kberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maxestep" title="maxestep" class="md-nav__link">
    maxestep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natvshift" title="natvshift" class="md-nav__link">
    natvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nberry" title="nberry" class="md-nav__link">
    nberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polcen" title="polcen" class="md-nav__link">
    polcen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qprtrb" title="qprtrb" class="md-nav__link">
    qprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_dfield" title="red_dfield" class="md-nav__link">
    red_dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efield" title="red_efield" class="md-nav__link">
    red_efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efieldbar" title="red_efieldbar" class="md-nav__link">
    red_efieldbar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spinmagntarget" title="spinmagntarget" class="md-nav__link">
    spinmagntarget
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vprtrb" title="vprtrb" class="md-nav__link">
    vprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeemanfield" title="zeemanfield" class="md-nav__link">
    zeemanfield
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varfil/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vargeo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vargs/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vargw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varint/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varpar/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varpaw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varrf/" title="RF" class="md-nav__link">
      RF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varrlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varvdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varw90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/welcome/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/eph/" title="EPH" class="md-nav__link">
      EPH
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/theory_mbt/" title="MBPT" class="md-nav__link">
      MBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/additional_material/" title="Additional Material" class="md-nav__link">
      Additional Material
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#atvshift" title="atvshift" class="md-nav__link">
    atvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bdberry" title="bdberry" class="md-nav__link">
    bdberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berryopt" title="berryopt" class="md-nav__link">
    berryopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrysav" title="berrysav" class="md-nav__link">
    berrysav
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrystep" title="berrystep" class="md-nav__link">
    berrystep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bfield" title="bfield" class="md-nav__link">
    bfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddamp" title="ddamp" class="md-nav__link">
    ddamp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfield" title="dfield" class="md-nav__link">
    dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efield" title="efield" class="md-nav__link">
    efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jfielddir" title="jfielddir" class="md-nav__link">
    jfielddir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kberry" title="kberry" class="md-nav__link">
    kberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maxestep" title="maxestep" class="md-nav__link">
    maxestep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natvshift" title="natvshift" class="md-nav__link">
    natvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nberry" title="nberry" class="md-nav__link">
    nberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polcen" title="polcen" class="md-nav__link">
    polcen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qprtrb" title="qprtrb" class="md-nav__link">
    qprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_dfield" title="red_dfield" class="md-nav__link">
    red_dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efield" title="red_efield" class="md-nav__link">
    red_efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efieldbar" title="red_efieldbar" class="md-nav__link">
    red_efieldbar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spinmagntarget" title="spinmagntarget" class="md-nav__link">
    spinmagntarget
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vprtrb" title="vprtrb" class="md-nav__link">
    vprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeemanfield" title="zeemanfield" class="md-nav__link">
    zeemanfield
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/abinit/abinit/edit/master/docs/input_variables/varff.md" title="Edit this page" class="md-icon md-content__icon">edit</a>
                
                
                  <h1>Varff</h1>
                
                <h2 id="atvshift"><strong>atvshift</strong><a class="headerlink" href="#atvshift" title="Permanent link">&para;</a></h2>
<p>Mnemonics: ATomic potential (V) energy SHIFTs<br />
Variable type: real<br />
Dimensions: (<a class="wikilink" href="../../input_variables/varff/#natvshift">natvshift</a>,<a class="wikilink" href="../../input_variables/varbas/#nsppol">nsppol</a>,<a class="wikilink" href="../../input_variables/varbas/#natom">natom</a>)<br />
Default value: *0.0d0<br />
Only relevant if <a class="wikilink" href="../../input_variables/varpaw/#usepawu">usepawu</a> /= 0 and <a class="wikilink" href="../../input_variables/varff/#natvshift">natvshift</a> in [5,7]  </p>
<p>Defines for each atom and each spin channel (at present, can only be used with
<a class="wikilink" href="../../input_variables/varbas/#nsppol">nsppol</a>=1 or 2, like the +U scheme), a possible potential shift, for the d
(with <a class="wikilink" href="../../input_variables/varpaw/#lpawu">lpawu</a>=2, <a class="wikilink" href="../../input_variables/varff/#natvshift">natvshift</a>=5), or f states (with <a class="wikilink" href="../../input_variables/varpaw/#lpawu">lpawu</a>=3,
<a class="wikilink" href="../../input_variables/varff/#natvshift">natvshift</a>=7). In the case of d states, and 2 spin channels, a set of 10
numbers for each atom must be defined. The first set of 5 numbers corresponds
to real spherical harmonics m=-2 to m=+2 for the spin-up channel, the second
set of 5 numbers corresponds to real spherical harmonics m=-2 to m=+2 for the
spin-down channel. In the case of f states, the same ordering applies, for
sets of 7 numbers, corresponding to m=-3 to m=+3.<br />
<a class="wikilink" href="../../input_variables/varpaw/#usepawu">usepawu</a> should be non-zero, <a class="wikilink" href="../../input_variables/varpaw/#lpawu">lpawu</a> should be 2 or 3.</p>
<h2 id="bdberry"><strong>bdberry</strong><a class="headerlink" href="#bdberry" title="Permanent link">&para;</a></h2>
<p>Mnemonics: BanD limits for BERRY phase<br />
Variable type: integer<br />
Dimensions: (4)<br />
Default value: 4*0<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> in [1, 2, 3] and <a class="wikilink" href="../../input_variables/varff/#nberry">nberry</a> &gt; 0  </p>
<p>Give the lower band and the upper band of the set of bands for which the Berry
phase must be computed. Irrelevant if <a class="wikilink" href="../../input_variables/varff/#nberry">nberry</a> is not positive. When
<a class="wikilink" href="../../input_variables/varbas/#nsppol">nsppol</a> is 1 (no spin-polarisation), only the two first numbers, giving the
lower and highest bands, are significant. Their occupation number is assumed
to be 2. When <a class="wikilink" href="../../input_variables/varbas/#nsppol">nsppol</a> is 2 (spin-polarized calculation), the two first
numbers give the lowest and highest bands for spin up, and the third and
fourth numbers give the lowest and highest bands for spin down. Their
occupation number is assumed to be 1 .</p>
<p>Presently, <a class="wikilink" href="../../input_variables/varff/#bdberry">bdberry</a> MUST be initialized by the user in case of a Berry
phase calculation with <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 1, 2, or 3: the above-mentioned default
will cause an early exit.</p>
<h2 id="berryopt"><strong>berryopt</strong><a class="headerlink" href="#berryopt" title="Permanent link">&para;</a></h2>
<p>Mnemonics: BERRY phase OPTions<br />
Variable type: integer<br />
Dimensions: scalar<br />
Default value: 0  </p>
<p>Specifies the use of Berry phase for the computation of either the
polarization, the derivatives with respect to the wavevector, or finite
electric field calculations.</p>
<ul>
<li>0 =&gt; no computation of expressions relying on a Berry phase (default) </li>
<li>1 =&gt; the computation of Berry phases is activated (berryphase routine) </li>
<li>2 =&gt; the computation of derivatives with respect to the wavevector, thanks to the Berry phase finite-difference formula, is activated (uderiv routine) </li>
<li>3 =&gt; same as option 1 and 2 together 
<strong>Note that options 1 to 3 require the use of a serial build of Abinit.</strong></li>
<li>-1 =&gt; alternative computation of Berry phases (berryphase_new routine) </li>
<li>-2 =&gt; alternative computation of derivatives with respect to the wavevector, thanks to the Berry phase finite-difference formula (berryphase_new routine) </li>
<li>-3 =&gt; same as option -1 and -2 together 
<strong>Options -1 to -3 permit use of a parallel build and will be preferred by most users.</strong></li>
<li>4 =&gt; finite electric field calculation (unreduced E-field) </li>
<li>6 =&gt; finite electric displacement field calculation (unreduced D-field) </li>
<li>14 =&gt; finite reduced electric field calculation </li>
<li>16 =&gt; finite electric displacement field calculation </li>
<li>17 =&gt; mixed electric boundary condition: finite reduced electric field in some directions, finite reduced electric displacement field along other directions. See variable <a class="wikilink" href="../../input_variables/varff/#jfielddir">jfielddir</a> for more details. </li>
</ul>
<p>Other related input variables are :</p>
<ul>
<li>in case of <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=1,2, or 3 : <a class="wikilink" href="../../input_variables/varff/#bdberry">bdberry</a> and <a class="wikilink" href="../../input_variables/varff/#kberry">kberry</a>; also, <a class="wikilink" href="../../input_variables/varff/#nberry">nberry</a> must be larger than 0; </li>
<li>in case of <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=-1,-2, or -3 : the variable <a class="wikilink" href="../../input_variables/varrf/#rfdir">rfdir</a> must be used to specify the primitive vector along which the projection of the polarization or the ddk will be computed. For example if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=-1 and <a class="wikilink" href="../../input_variables/varrf/#rfdir">rfdir</a>=1 0 0, the projection of the polarization along the reciprocal lattice vector G_1 is computed. In case <a class="wikilink" href="../../input_variables/varrf/#rfdir">rfdir</a>=1 1 1, ABINIT computes the projection of P along G_1, G_2 and G_3 and transforms the results to cartesian coordinates; </li>
<li>in cases where <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> is negative, <a class="wikilink" href="../../input_variables/varff/#berrystep">berrystep</a> allow a computation of multiple-step Berry phase in order to accelerate the convergence. </li>
<li><a class="wikilink" href="../../input_variables/varff/#efield">efield</a> and <a class="wikilink" href="../../input_variables/varrf/#rfdir">rfdir</a> in case of <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=4 ; </li>
</ul>
<p>The cases <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=-1,-2,-3, 4, 6, 7, 14, 16, and 17 have to be used with
<a class="wikilink" href="../../input_variables/varbas/#occopt">occopt</a>=1.</p>
<p>The cases <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=-1 and 4, 6, 7, 14, 16, 17 are compatible with PAW,
howevever, if in these cases one uses <a class="wikilink" href="../../input_variables/varbas/#kptopt">kptopt</a>/=3, one must also use only
symmorphic symmetries (either because the space group is symmorphic or the
variable <a class="wikilink" href="../../input_variables/vardev/#symmorphi">symmorphi</a> is set to zero).</p>
<p>For a phonon calculation under a finite electric field, respect the following
procedure.</p>
<ul>
<li>1. Run a scf ground-state calculation at zero electric field to get wavefunctions to initialize the ground-state calculation in finite electric fields. </li>
<li>2. Run a scf ground-state calculation in finite electric field. The electric field is controlled by the input variable <a class="wikilink" href="../../input_variables/varff/#efield">efield</a>. <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> should be 4. The input variable <a class="wikilink" href="../../input_variables/varbas/#kptopt">kptopt</a> should be set to be 2. </li>
<li>3. Based on the wave functions obtained in step (2), perform phonon calculation by setting <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=4, <a class="wikilink" href="../../input_variables/varbas/#kptopt">kptopt</a>=3 and The same value of <a class="wikilink" href="../../input_variables/varff/#efield">efield</a> than in step 2. <a class="wikilink" href="../../input_variables/varbas/#nsym">nsym</a> should be set to 1 currently but this restriction may be removed later . The other parameters are the same as phonon calculation at zero electric field. </li>
<li>Note : the choice of k-point sampling N x N x N should be the same in the three runs and N should be an even number. </li>
</ul>
<p>In case of finite electric and displacement field calculations
(<a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=4,6,7,14,16,17), see also the input variables <a class="wikilink" href="../../input_variables/varff/#berrysav">berrysav</a>,
<a class="wikilink" href="../../input_variables/varff/#dfield">dfield</a>, <a class="wikilink" href="../../input_variables/varff/#red_dfield">red_dfield</a>, <a class="wikilink" href="../../input_variables/varff/#red_efield">red_efield</a>, <a class="wikilink" href="../../input_variables/varff/#ddamp">ddamp</a></p>
<h2 id="berrysav"><strong>berrysav</strong><a class="headerlink" href="#berrysav" title="Permanent link">&para;</a></h2>
<p>Mnemonics: BERRY SAVe<br />
Variable type: integer<br />
Dimensions: scalar<br />
Default value: 0  </p>
<ul>
<li>0 =&gt; for finite electric field calculation (<a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=4/14), the polarization branch will be chosen on each iteration from (-pi, pi); for finite electric displacement field calculation(<a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=6/7/16/17), the polarization will be chosen to minimize the internal energy. </li>
<li>1 =&gt; the polarization will be kept in the same branch on each iteration. At the end of the run, a file &ldquo;POLSAVE&rdquo; will be saved containing the reduced polarization in atomic units. Note: Make sure that &ldquo;POLSAVE&rdquo; is empty or it does not exist before the calculation, or else that it specifies the desired polarization branch. </li>
</ul>
<h2 id="berrystep"><strong>berrystep</strong><a class="headerlink" href="#berrystep" title="Permanent link">&para;</a></h2>
<p>Mnemonics: BERRY phase : multiple STEP<br />
Variable type: integer<br />
Dimensions: scalar<br />
Default value: 1<br />
Only relevant if 0 &gt; <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>  </p>
<p>If <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> is negative, this variable is used to compute berry phases
using multiple discrete steps, in order to accelerate convergence. The single-
step berry phase is the standard calculation using strings of k-points based
on overlap of Bloch function separated by dk, while the two-step berry phase
use strings use overlaps based on dk and 2<em>dk, the three-step use overlaps
based on dk, 2</em>dk and 3*dk&hellip;</p>
<p>The default value of this variable is 1, meaning that only the single-step
berry phase calculation is done. If a larger value is set, ABINIT will compute
all the multiple-step berry phase from the single-step to the
<a class="wikilink" href="../../input_variables/varff/#berrystep">berrystep</a>-step, and use the large-step values of berry phase to correct
the single-step berry phase. Use with care: while experience is still to be
gained with this procedure, the outlook is promising.</p>
<h2 id="bfield"><strong>bfield</strong><a class="headerlink" href="#bfield" title="Permanent link">&para;</a></h2>
<p>Mnemonics: finite B FIELD calculation<br />
Variable type: real<br />
Dimensions: (3)<br />
Default value: 3*0.0  </p>
<p>Perform finite magnetic field calculation.<br />
<strong>THIS CODE IS UNDER DEVELOPMENT AND IS NOT READY FOR USE.</strong></p>
<h2 id="ddamp"><strong>ddamp</strong><a class="headerlink" href="#ddamp" title="Permanent link">&para;</a></h2>
<p>Mnemonics: electric Displacement field DAMPing parameter<br />
Variable type: real<br />
Dimensions: scalar<br />
Default value: 0.1<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 6 or 16  </p>
<p>In case <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=6, the electric field is updated after each SCF iteration
according to E_{n+1}= <a class="wikilink" href="../../input_variables/varff/#ddamp">ddamp</a><em>(D - 4</em>pi<em>P_{n}) + (1-<a class="wikilink" href="../../input_variables/varff/#ddamp">ddamp</a>)</em>E_{n} where
P_{n} and E_{n} are the polarization and electric field after nth SCF
iteration. <a class="wikilink" href="../../input_variables/varff/#ddamp">ddamp</a> is a damping parameter used to control the convergence
speed.<br />
In case <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=16, the electric field is updated after each SCF
iteration according to e_{n+1}= <a class="wikilink" href="../../input_variables/varff/#ddamp">ddamp</a><em>(d - p_{n}) + (1-<a class="wikilink" href="../../input_variables/varff/#ddamp">ddamp</a>)</em>e_{n}<br />
If you have difficulty getting convergence, try to reduce this value or reduce
maxestep. This parameter is used in finite electric displacement field
calculations (berryopt=6,16,17).</p>
<h2 id="dfield"><strong>dfield</strong><a class="headerlink" href="#dfield" title="Permanent link">&para;</a></h2>
<p>Mnemonics: Displacement FIELD<br />
Variable type: real<br />
Dimensions: (3)<br />
Default value: 3*0.0<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 6, <a class="wikilink" href="../../input_variables/varff/#efield">efield</a>  </p>
<p>In case <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=6, <a class="wikilink" href="../../input_variables/varff/#dfield">dfield</a> specifies the (unreduced) finite electric
displacement field vector, in atomic units, that is to be imposed as a
constraint during the calculation.</p>
<h2 id="efield"><strong>efield</strong><a class="headerlink" href="#efield" title="Permanent link">&para;</a></h2>
<p>Mnemonics: Electric FIELD<br />
Variable type: real<br />
Dimensions: (3)<br />
Default value: 3*0.0<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 4 or 6  </p>
<p>In case <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=4, a finite electric field calculation is performed. The
value of this electric field, and its direction is determined by <a class="wikilink" href="../../input_variables/varff/#efield">efield</a>.
It must be given in atomic units (1 a.u. of electric field= 514220624373.482
V/m, see note below), in cartesian coordinates.</p>
<p>References for the calculation under electric field (based on multi k point
Berry phase) :</p>
<ul>
<li>Nunes and Vanderbilt, PRL 73, 712 (1994) : real-space version of the finite-field Hamiltonian </li>
<li>Nunes and Gonze, PRB 63, 155107 (2001) : reciprocal-space version of the finite-field Hamiltonian (the one presently implemented), and extensive theoretical analysis </li>
<li>Souza, Iniguez and Vanderbilt, PRL 89, 117602 (2003) : implementation of the finite-field Hamiltonian (reciprocal-space version) </li>
<li>Zwanziger, Galbraith, Kipouros, Torrent, Giantomassi and Gonze, Comp. Mater. Sci. 58, 113 (2012) : extension to PAW formalism </li>
</ul>
<p>See also Umari, Gonze, Pasquarello, PRL 90, 027401 (2003).</p>
<p>The atomic unit of electric field strength is : e_Cb/(4 pi eps0 a0**2), where
e_Cb is the electronic charge in Coulomb (1.60217653e-19), eps0 is the
electric constant (8.854187817d-12 F/m), and a0 is the Bohr radius in meter
(0.5291772108e-10).</p>
<h2 id="jfielddir"><strong>jfielddir</strong><a class="headerlink" href="#jfielddir" title="Permanent link">&para;</a></h2>
<p>Mnemonics: electric/displacement FIELD DIRection<br />
Variable type: integer<br />
Dimensions: (3)<br />
Default value: 3*0<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 17  </p>
<p>When specifying mixed electric field boundary conditions ( <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=17),
jfielddir controls whether reduced electric field (<a class="wikilink" href="../../input_variables/varff/#jfielddir">jfielddir</a>=1) or reduced
electric displacement field (<a class="wikilink" href="../../input_variables/varff/#jfielddir">jfielddir</a>=2) is chosen to be fixed, in each
of the three lattice directions (i.e., in the reduced, not the Cartesian,
frame). For example, <a class="wikilink" href="../../input_variables/varff/#jfielddir">jfielddir</a>=(1 1 2) tells the code to use fixed ebar_1
and ebar_2 along the first two lattice directions and fixed d_3 along the
third.<br />
For the case of mixed electric field boundary conditions, <a class="wikilink" href="../../input_variables/varff/#red_efieldbar">red_efieldbar</a>
and <a class="wikilink" href="../../input_variables/varff/#red_dfield">red_dfield</a> are used to control ebar and d, respectively. For example,
for electric boundary conditions corresponding to a material in a parallel-
plate capacitor, if you want to control d_3=d0, while fixing ebar_1=ebar_2=0,
then the input files should have <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=17, <a class="wikilink" href="../../input_variables/varff/#jfielddir">jfielddir</a>=(1 1 2),
<a class="wikilink" href="../../input_variables/varff/#red_efieldbar">red_efieldbar</a>=(0.0 0.0 a), and <a class="wikilink" href="../../input_variables/varff/#red_dfield">red_dfield</a>=(b c d0). Here a, b, and c
are the starting values. They can be chosen in this way: do a single run for
fixed d calculation (<a class="wikilink" href="../../input_variables/varff/#red_dfield">red_dfield</a>=0,0,d0), from the final results you will
have ebar_3, which is a good guess for a. Then do another single run for fixed
ebar calculation (<a class="wikilink" href="../../input_variables/varff/#red_efieldbar">red_efieldbar</a>=(0 0 0)), from the final results you will
have d_1,d_2, these are good guesses for b, c.</p>
<h2 id="kberry"><strong>kberry</strong><a class="headerlink" href="#kberry" title="Permanent link">&para;</a></h2>
<p>Mnemonics: K wavevectors for BERRY phase computation<br />
Variable type: integer<br />
Dimensions: (3,<a class="wikilink" href="../../input_variables/varff/#nberry">nberry</a>)<br />
Default value: *0<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 1, 2, or 3  </p>
<p>Used for values of <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 1, 2, or 3.</p>
<p>This array defines, for each Berry phase calculation (the number of such
calculations is defined by <a class="wikilink" href="../../input_variables/varff/#nberry">nberry</a>), the difference of wavevector between k
points for which the overlap matrix must be computed. The polarisation vector
will be projected on the direction of that wavevector, and the result of the
computation will be the magnitude of this projection. Doing more than one
wavevector, with different independent direction, allows to find the full
polarisation vector. However, note that converged results need oriented grids,
denser along the difference wavevector than usual Monkhorst-Pack grids.</p>
<p>The difference of wavevector is computed in the coordinate system defined by
the k-points grid (see <a class="wikilink" href="../../input_variables/varbas/#ngkpt">ngkpt</a> and <a class="wikilink" href="../../input_variables/vargs/#kptrlatt">kptrlatt</a>), so that the values of
<a class="wikilink" href="../../input_variables/varff/#kberry">kberry</a> are integers. Of course, such a k point grid must exist, and all
the corresponding wavefunctions must be available, so that the computation is
allowed only when <a class="wikilink" href="../../input_variables/varbas/#kptopt">kptopt</a> is equal to 3. In order to save computing time,
it is suggested to make a preliminary calculation of the wavefunctions on the
irreducible part of the grid, with <a class="wikilink" href="../../input_variables/varbas/#kptopt">kptopt</a> equal to 1, and then use these
converged wavefunctions in the entire Brillouin zone, by reading them to
initialize the <a class="wikilink" href="../../input_variables/varbas/#kptopt">kptopt</a>=3 computation.</p>
<h2 id="maxestep"><strong>maxestep</strong><a class="headerlink" href="#maxestep" title="Permanent link">&para;</a></h2>
<p>Mnemonics: MAXimum Electric field STEP<br />
Variable type: real<br />
Dimensions: scalar<br />
Default value: 0.005<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 6, 16, or 17  </p>
<p>This variable controls the maximum change of electric field when updating the
electric field after each SCF iteration. When the calculation is difficult to
converge, try reducing this value or reducing <a class="wikilink" href="../../input_variables/varff/#ddamp">ddamp</a>. This variable is used
in finite electric displacement field calculations (<a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=6,16,17).</p>
<h2 id="natvshift"><strong>natvshift</strong><a class="headerlink" href="#natvshift" title="Permanent link">&para;</a></h2>
<p>Mnemonics: Number of ATomic potential (V) energy SHIFTs (per atom)<br />
Variable type: integer<br />
Dimensions: scalar<br />
Default value: 0<br />
Only relevant if <a class="wikilink" href="../../input_variables/varpaw/#usepawu">usepawu</a> /= 0, <a class="wikilink" href="../../input_variables/varff/#atvshift">atvshift</a>  </p>
<p>Number of atomic potential energy shifts (per atom), to be used to define the
array <a class="wikilink" href="../../input_variables/varff/#atvshift">atvshift</a>. If non-zero, only two possibilities exist : 5 for d states
(with <a class="wikilink" href="../../input_variables/varpaw/#lpawu">lpawu</a>=2), and 7 for f states (with <a class="wikilink" href="../../input_variables/varpaw/#lpawu">lpawu</a>=3). If non-zero, one
should define <a class="wikilink" href="../../input_variables/varpaw/#usepawu">usepawu</a>, <a class="wikilink" href="../../input_variables/varpaw/#lpawu">lpawu</a> and <a class="wikilink" href="../../input_variables/varff/#atvshift">atvshift</a>.</p>
<h2 id="nberry"><strong>nberry</strong><a class="headerlink" href="#nberry" title="Permanent link">&para;</a></h2>
<p>Mnemonics: Number of BERRY phase computations<br />
Variable type: integer<br />
Dimensions: scalar<br />
Default value: 1<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 1, 2, or 3  </p>
<p>Gives the number of Berry phase computations of polarisation, or finite-
difference estimations of the derivative of wavefunctions with respect to the
wavevector, each of which might be characterized by a different change of
wavevector <a class="wikilink" href="../../input_variables/varff/#kberry">kberry</a>.</p>
<p>When equal to 0, no Berry phase calculation of polarisation is performed. The
maximal value of <a class="wikilink" href="../../input_variables/varff/#nberry">nberry</a> is 20.</p>
<p>Note that the computation of the polarisation for a set of bands having
different occupation numbers is meaningless (although in the case of spin-
polarized calculations, the spin up bands might have an identical occupation
number, that might differ from the identical occupation number of spin down
bands). Although meaningless, ABINIT will perform such computation, if
required by the user. The input variable <a class="wikilink" href="../../input_variables/varff/#bdberry">bdberry</a> governs the set of bands
for which a Berry phase is computed.</p>
<p>For the <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 1, 2, and 3 cases, spinor wavefunctions are not
allowed, nor are parallel computations.</p>
<h2 id="polcen"><strong>polcen</strong><a class="headerlink" href="#polcen" title="Permanent link">&para;</a></h2>
<p>Mnemonics: POLarization for CENtrosymmetric geometry<br />
Variable type: real<br />
Dimensions: (3)<br />
Default value: 3*0  </p>
<p>When doing a finite electric displacement field calculation, if the structure
is centrosymmetric but the polarization is non-zero (such as for AlAs), this
non-zero polarization should be specified as <a class="wikilink" href="../../input_variables/varff/#polcen">polcen</a> (in REDUCED
coordinates, in atomic units) in the input file. See Eq.(24) in the Suppl. of
Nat. Phys. (M. Stengel, N.A. Spaldin and D. Vanderbilt, Nat. Phys. 5,304
(2009))</p>
<h2 id="qprtrb"><strong>qprtrb</strong><a class="headerlink" href="#qprtrb" title="Permanent link">&para;</a></h2>
<p>Mnemonics: Q-wavevector of the PERTurbation<br />
Variable type: integer<br />
Dimensions: (3)<br />
Default value: [0, 0, 0]<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#vprtrb">vprtrb</a>  </p>
<p>Gives the wavevector, in units of reciprocal lattice primitive translations,
of a perturbing potential of strength <a class="wikilink" href="../../input_variables/varff/#vprtrb">vprtrb</a>. See <a class="wikilink" href="../../input_variables/varff/#vprtrb">vprtrb</a> for more
explanation.</p>
<h2 id="red_dfield"><strong>red_dfield</strong><a class="headerlink" href="#red_dfield" title="Permanent link">&para;</a></h2>
<p>Mnemonics: REDuced Displacement FIELD<br />
Variable type: real<br />
Dimensions: (3)<br />
Default value: 3*0.0<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 16, <a class="wikilink" href="../../input_variables/varff/#red_efield">red_efield</a>  </p>
<p>In case <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=16, a reduced finite electric displacement field
calculation is performed. The value of this displacement field, and its
direction is determined by <a class="wikilink" href="../../input_variables/varff/#red_dfield">red_dfield</a>. It must be given in atomic units.</p>
<p><a class="wikilink" href="../../input_variables/varff/#red_dfield">red_dfield</a> is defined via Eq.(26) in the Supplement of M. Stengel, N.A.
Spaldin and D. Vanderbilt, Nat. Phys. 5,304 (2009).</p>
<h2 id="red_efield"><strong>red_efield</strong><a class="headerlink" href="#red_efield" title="Permanent link">&para;</a></h2>
<p>Mnemonics: REDuced Electric FIELD<br />
Variable type: real<br />
Dimensions: (3)<br />
Default value: 3*0.0<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 16  </p>
<p>In case <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=16, a reduced finite electric displacement field
calculation is performed. In this case, the parameter red_efield specifies the
initial electric field used on the first iteration, in atomic units.</p>
<p><a class="wikilink" href="../../input_variables/varff/#red_efield">red_efield</a> is defined via Eq.(25) in the Supplement of M. Stengel, N.A.
Spaldin and D. Vanderbilt, Nat. Phys. 5,304 (2009).</p>
<h2 id="red_efieldbar"><strong>red_efieldbar</strong><a class="headerlink" href="#red_efieldbar" title="Permanent link">&para;</a></h2>
<p>Mnemonics: REDuced Electric FIELD BAR<br />
Variable type: real<br />
Dimensions: (3)<br />
Default value: 3*0.0<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a> = 14  </p>
<p>In case <a class="wikilink" href="../../input_variables/varff/#berryopt">berryopt</a>=14, a reduced finite electric field calculation is
performed. The magnitude and direction of this electric field are determined
by red_efieldbar. It must be given in atomic units.</p>
<p><a class="wikilink" href="../../input_variables/varff/#red_efieldbar">red_efieldbar</a> is defined via Eq.(28) in the Supplement of M. Stengel, N.A.
Spaldin and D. Vanderbilt, Nat. Phys. 5,304 (2009).</p>
<h2 id="spinmagntarget"><strong>spinmagntarget</strong><a class="headerlink" href="#spinmagntarget" title="Permanent link">&para;</a></h2>
<p>Mnemonics: SPIN-MAGNetization TARGET<br />
Variable type: real<br />
Dimensions: scalar<br />
Default value: -99.99  </p>
<p>This input variable is active only in the <a class="wikilink" href="../../input_variables/varbas/#nsppol">nsppol</a>=2 case. If
<a class="wikilink" href="../../input_variables/varff/#spinmagntarget">spinmagntarget</a> is not the &ldquo;magic&rdquo; value of -99.99d0, the spin-
magnetization of the primitive cell will be fixed (or optimized, if it is not
possible to impose it) to the value of <a class="wikilink" href="../../input_variables/varff/#spinmagntarget">spinmagntarget</a>, in Bohr magneton
units, e.g. for an Hydrogen atom, it is 1.<br />
If <a class="wikilink" href="../../input_variables/varbas/#occopt">occopt</a> is a metallic one, the Fermi energies for spin up and spin down
are adjusted to give the target spin-polarisation (this is equivalent to an
exchange splitting). If <a class="wikilink" href="../../input_variables/varbas/#occopt">occopt</a>=1 and <a class="wikilink" href="../../input_variables/varbas/#nsppol">nsppol</a>=2, the occupation numbers
for spin up and spin down will be adjusted to give the required spin-
magnetization (occupation numbers are identical for all k-points, with
<a class="wikilink" href="../../input_variables/varbas/#occopt">occopt</a>=1). The definition of <a class="wikilink" href="../../input_variables/varff/#spinmagntarget">spinmagntarget</a> is actually requested in
this case, except for the single isolated Hydrogen atom.<br />
If <a class="wikilink" href="../../input_variables/varff/#spinmagntarget">spinmagntarget</a> is the default one, the spin-magnetization will not be
constrained, and will be determined self-consistently, by having the same spin
up and spin down Fermi energy in the metallic case, while for the other cases,
there will be no spin-magnetization, except for an odd number of electrons if
<a class="wikilink" href="../../input_variables/varbas/#occopt">occopt</a>=1 and <a class="wikilink" href="../../input_variables/varbas/#nsppol">nsppol</a>=2.</p>
<p>Note : for the time being, only the spin down Fermi energy is written out in
the main output file. In the fixed magnetic moment case, it differs from the
spin up Fermi energy.</p>
<h2 id="vprtrb"><strong>vprtrb</strong><a class="headerlink" href="#vprtrb" title="Permanent link">&para;</a></h2>
<p>Mnemonics: potential -V- for the PeRTuRBation<br />
Variable type: real<br />
Dimensions: (2)<br />
Default value: [0.0, 0.0]<br />
Only relevant if <a class="wikilink" href="../../input_variables/varff/#qprtrb">qprtrb</a>  </p>
<p>Gives the real and imaginary parts of a scalar potential perturbation. Can be
specified in Ha (the default), Ry, eV or Kelvin, since <a class="wikilink" href="../../input_variables/varff/#vprtrb">vprtrb</a> has the
&lsquo;<a class="wikilink" href="../../ENERGY/">ENERGY</a>&lsquo; characteristics.<br />
This is made available for testing responses to such perturbations. The form
of the perturbation, which is added to the local potential, is:</p>
<ul>
<li>(<a href="../1">[vprtrb]</a>+I*<a href="../2">[vprtrb]</a>)/2 at G=<a class="wikilink" href="../../input_variables/varff/#qprtrb">qprtrb</a> and </li>
<li>(<a href="../1">[vprtrb]</a>-I*<a href="../2">[vprtrb]</a>)/2 at G=-<a class="wikilink" href="../../input_variables/varff/#qprtrb">qprtrb</a> (see <a class="wikilink" href="../../input_variables/varff/#qprtrb">qprtrb</a> also). </li>
</ul>
<h2 id="zeemanfield"><strong>zeemanfield</strong><a class="headerlink" href="#zeemanfield" title="Permanent link">&para;</a></h2>
<p>Mnemonics: ZEEMAN FIELD<br />
Variable type: real<br />
Dimensions: (3)<br />
Default value: 0  </p>
<p>Give the value of the Zeeman field, H, acting on the spinorial wavefunctions.
Note that Tesla are admitted. This sets the magnitude of mu_0*H, in Tesla,
with H in Amperes/metre.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
<hr>

    <center>Abinit version 8.5.4</center>


    <center>Copyright &copy; 2017 The Abinit Group</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
    </div>
    
      <script src="../../assets/javascripts/application-c35428f87f.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
    
  </body>
</html>