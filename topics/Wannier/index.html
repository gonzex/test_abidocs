<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="The Abinit group">
    <link rel="canonical" href="http://www.abinit.org/topics/Wannier/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Wannier - abinit</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../css/codehilite.css" rel="stylesheet">
    <link href="../../css/extra.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->


    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Introduction", url: "#introduction", children: [
          ]},
          {title: "Related Input Variables", url: "#related-input-variables", children: [
          ]},
          {title: "Selected Input Files", url: "#selected-input-files", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      <script src="../../extra_javascript/abidocs.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Wavelets/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Wavelets/" class="btn btn-xs btn-link">
        Wavelets
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../vdw/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../vdw/" class="btn btn-xs btn-link">
        Vdw
      </a>
    </div>
    
  </div>

    

    <h2 id="introduction"><strong> Introduction </strong><a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>There are two ways to obtain Wannier functions with ABINIT:</p>
<ul>
<li>The first one is to use an internal implementation of Projected Local Orbital Wannier functions <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Amadon2008" title="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals">Amadon2008</a>, <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Amadon2015" title="Comparative analysis of models for the $\alpha$-$\gamma$ phase transition in cerium: A DFT+DMFT study using Wannier orbitals">Amadon2015</a> that can be activated with the input variable <a class="wikilink" href="../../input_variables/dev/#plowan_compute">plowan_compute</a>. The variables <a class="wikilink" href="../../input_variables/dev/#plowan_bandi">plowan_bandi</a> and <a class="wikilink" href="../../input_variables/dev/#plowan_bandf">plowan_bandf</a> specifies the Kohn Sham bands that are used to built Wannier functions, whereas variables <a class="wikilink" href="../../input_variables/dev/#plowan_natom">plowan_natom</a>,<a class="wikilink" href="../../input_variables/dev/#plowan_iatom">plowan_iatom</a>,<a class="wikilink" href="../../input_variables/dev/#plowan_nbl">plowan_nbl</a>, <a class="wikilink" href="../../input_variables/dev/#plowan_lcalc">plowan_lcalc</a>, and <a class="wikilink" href="../../input_variables/dev/#plowan_projcalc">plowan_projcalc</a> specify the atoms, angular momentum and projectors corresponding to the projected local Orbital Wannier functions. </li>
</ul>
<p>In order to do Wannier interpolation or analysis of hopping integrals, real
space Wannier functions can be built using the variables <a class="wikilink" href="../../input_variables/dev/#plowan_realspace">plowan_realspace</a>
and <a class="wikilink" href="../../input_variables/dev/#plowan_nt">plowan_nt</a> as well as <a class="wikilink" href="../../input_variables/dev/#plowan_it">plowan_it</a>. Real space Hamiltonian for
analysis is given in latex file whose name ending is "wanniereigen" and the
band structure is given in the output and log file.</p>
<ul>
<li>
<p>The second one is to use the external code wannier90 (<a href="http://www.wannier.org"><strong>www.wannier.org</strong></a>) that calculates Maximally Localized Wannier Functions (MLWF). After a ground state calculation the Wannier90 code will obtain the MLWFs requiring just two ingredients: </p>
</li>
<li>
<p>The overlaps between the cell periodic part of the Bloch states.</p>
</li>
<li>As a starting guess the projection of the Bloch states onto trial localized orbitals.</li>
</ul>
<p>What ABINIT do is to take the Bloch functions from a ground state calculation
and compute these two ingredients. Then, Wannier90 is run. Wannier90 is
included as a library and ABINIT and the process is automatic, so that in a
single run you can do both the ground state calculation and the computation of
MLWFs. The input variables <a class="wikilink" href="../../input_variables/files/#prtwant">prtwant</a>, <a class="wikilink" href="../../input_variables/w90/#w90iniprj">w90iniprj</a> and <a class="wikilink" href="../../input_variables/w90/#w90prtunk">w90prtunk</a> are
related to the use of the wannier90 librairy.</p>
<h2 id="related-input-variables"><strong> Related Input Variables </strong><a class="headerlink" href="#related-input-variables" title="Permanent link">&para;</a></h2>
<p><em>basic:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/w90/#w90iniprj">w90iniprj</a>  Wannier90- INItial PROJections</li>
<li><a class="wikilink" href="../../input_variables/w90/#w90prtunk">w90prtunk</a>  Wannier90- PRINT UNKp.s file</li>
</ul>
<p><em>compulsory:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_bandf">plowan_bandf</a>  Projected Local Orbital WANnier functions BAND Final</li>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_bandi">plowan_bandi</a>  Projected Local Orbital WANnier functions BAND Initial</li>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_compute">plowan_compute</a>  Projected Local Orbital WANnier functions COMPUTATION</li>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_iatom">plowan_iatom</a>  Projected Local Orbital WANnier functions, Index of ATOM</li>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_lcalc">plowan_lcalc</a>  Projected Local Orbital WANnier functions,  L values to use for CALCulation</li>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_natom">plowan_natom</a>  Projected Local Orbital WANnier functions, Number of ATOMs</li>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_nbl">plowan_nbl</a>  Projected Local Orbital WANnier functions,  NumBer of L values</li>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_projcalc">plowan_projcalc</a>  Projected Local Orbital WANnier functions,  PROJectors values to use for CALCulation</li>
<li><a class="wikilink" href="../../input_variables/files/#prtwant">prtwant</a>  PRinT WANT file</li>
</ul>
<p><em>useful:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_it">plowan_it</a>  Projected Local Orbital WANnier functions,  Index of Translation.</li>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_nt">plowan_nt</a>  Projected Local Orbital WANnier functions,  Number of Translation on which the real space values of
energy are computed</li>
<li><a class="wikilink" href="../../input_variables/dev/#plowan_realspace">plowan_realspace</a>  Projected Local Orbital WANnier functions,  activate REAL SPACE calculation.</li>
</ul>
<h2 id="selected-input-files"><strong> Selected Input Files </strong><a class="headerlink" href="#selected-input-files" title="Permanent link">&para;</a></h2>
<p><em>v7:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t71.in" title="Calculation of Projected Wannier functions and compute band structure in the d orbital Wannier basis">tests/v7/Input/t71.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t72.in" title="Calculation of Projected Wannier functions and compute a simplified interpolated band structure">tests/v7/Input/t72.in</a></li>
</ul>
<p><em>wannier90:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t01.in" title="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use...">tests/wannier90/Input/t01.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t02.in" title="The same as in 01 but using PAW.">tests/wannier90/Input/t02.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t03.in" title="Cannot be executed in parallel (mlwfovl_qp) Si fcc,  in primitive cell (2 atoms/cell) Test of self-consistent model GW (2 iterations) following Faleev et al., [PRL 93,  126406 (2004)] followed by construction of quasiparticle maximally-localized wannier functions [Hamann &amp; Vanderbilt, arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test- acceptable speed,  and the results are poorly converged.  The input file is sufficiently annotated to serve as a model.  Note that well- converged GW calculations are extremely time consuming,  and in general it is advisable to run the SCGW part separately on a parallel system, and then run a separate serial job modeled on the last dataset, substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps, &quot; with appropriate links to the files produced in the serial run.  Note that the _DEN file from the first dataset is also needed as input,  although the discontinued &quot;irdden&quot; input variable is not needed or supported. Note that acceptable names for the secondary input file needed by the wannier90 library are wannier90.win,  w90.win,  abo_DSn_w90.win (ndtset &gt;0) and abo_w90.win (ndtset=0),  where abo is the 4th line of the .files file and n is the wannier dataset.">tests/wannier90/Input/t03.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t11.in" title="Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions.">tests/wannier90/Input/t11.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t12.in" title="Argon FCC Test the approach of Ambrosetti and Silvestrelli to assess van der Waals interactions.">tests/wannier90/Input/t12.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t13.in" title="Argon FCC Test the approach of Silvestrelli to assess van der Waals interactions,  combining the QHO model with Wannier functions.">tests/wannier90/Input/t13.in</a></li>
</ul>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Wavelets/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Wavelets/" class="btn btn-xs btn-link">
        Wavelets
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../vdw/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../vdw/" class="btn btn-xs btn-link">
        Vdw
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
<hr>

    <center>Abinit version 8.5.4</center>


<center>Copyright &copy; 2017 The Abinit Group (BAmadon)</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
</footer>

</body>
</html>