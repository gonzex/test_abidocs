<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="The Abinit group">
    <link rel="canonical" href="http://www.abinit.org/topics/Bader/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Bader - abinit</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../css/codehilite.css" rel="stylesheet">
    <link href="../../css/extra.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->


    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Introduction", url: "#introduction", children: [
          ]},
          {title: "Related Input Variables", url: "#related-input-variables", children: [
          ]},
          {title: "Selected Input Files", url: "#selected-input-files", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      <script src="../../extra_javascript/abidocs.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../BandOcc/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../BandOcc/" class="btn btn-xs btn-link">
        BandOcc
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../AtomTypes/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../AtomTypes/" class="btn btn-xs btn-link">
        AtomTypes
      </a>
    </div>
    
  </div>

    

    <h2 id="introduction"><strong> Introduction </strong><a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The postprocessor of ABINIT, called AIM (Atom-In-Molecule), performs the Bader
analysis on the basis of the charge density, norm-conserving pseudopotential
cases only, complemented by the core charge densities provided in
<a class="wikilink" href="http://www.abinit.org/downloads/core_electron">http://www.abinit.org/downloads/core_electron</a>. There is a specific
<a class="wikilink" href="../../help_aim/">help_aim</a> for this ABINIT postprocessor.</p>
<h2 id="related-input-variables"><strong> Related Input Variables </strong><a class="headerlink" href="#related-input-variables" title="Permanent link">&para;</a></h2>
<p><em>basic:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/aim/#atom">atom</a>  index of ATOM</li>
<li><a class="wikilink" href="../../input_variables/aim/#nphi">nphi</a>  Number of PHI angle</li>
<li><a class="wikilink" href="../../input_variables/aim/#ntheta">ntheta</a>  Number of THETA angles</li>
<li><a class="wikilink" href="../../input_variables/aim/#phimax">phimax</a>  PHI MAXimal angle</li>
<li><a class="wikilink" href="../../input_variables/aim/#thetamax">thetamax</a>  THETA MAXimal angle</li>
</ul>
<p><em>compulsory:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/aim/#crit">crit</a>  computation of CRITical points</li>
<li><a class="wikilink" href="../../input_variables/aim/#denout">denout</a>  electronic DENsity OUTput</li>
<li><a class="wikilink" href="../../input_variables/aim/#dltyp">dltyp</a>  Density or Laplacian TYP output</li>
<li><a class="wikilink" href="../../input_variables/aim/#follow">follow</a>  FOLLOW the gradient path</li>
<li><a class="wikilink" href="../../input_variables/aim/#gpsurf">gpsurf</a>  GraPhic output for the bader SURFace</li>
<li><a class="wikilink" href="../../input_variables/aim/#irho">irho</a>  Integration of the charge density RHO</li>
<li><a class="wikilink" href="../../input_variables/aim/#ivol">ivol</a>  Integration of the VOLume</li>
<li><a class="wikilink" href="../../input_variables/aim/#lapout">lapout</a>  electronic density LAPlacian OUTput</li>
<li><a class="wikilink" href="../../input_variables/aim/#rsurf">rsurf</a>  computation of the Radius bader SURFace</li>
<li><a class="wikilink" href="../../input_variables/aim/#surf">surf</a>  computation of the bader SURFace</li>
</ul>
<p><em>expert:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/aim/#atrad">atrad</a>  bader ATomic RADius</li>
<li><a class="wikilink" href="../../input_variables/aim/#coff1">coff1</a>  COeFFicient 1</li>
<li><a class="wikilink" href="../../input_variables/aim/#coff2">coff2</a>  COeFFicient 2</li>
<li><a class="wikilink" href="../../input_variables/aim/#foldep">foldep</a>  FOLlow DEParture</li>
<li><a class="wikilink" href="../../input_variables/aim/#folstp">folstp</a>  FOLlow STeP</li>
<li><a class="wikilink" href="../../input_variables/aim/#inpt">inpt</a>  numer of INtegration PoinTs</li>
<li><a class="wikilink" href="../../input_variables/aim/#ngrid">ngrid</a>  Number of GRID points</li>
<li><a class="wikilink" href="../../input_variables/aim/#nsa">nsa</a>  Number of Supercell points in direction A</li>
<li><a class="wikilink" href="../../input_variables/aim/#nsb">nsb</a>  Number of Supercell points in direction B</li>
<li><a class="wikilink" href="../../input_variables/aim/#nsc">nsc</a>  Number of Supercell points in direction C</li>
<li><a class="wikilink" href="../../input_variables/aim/#phimin">phimin</a>  PHI MINimal angle</li>
<li><a class="wikilink" href="../../input_variables/aim/#radstp">radstp</a>  RADial STeP</li>
<li><a class="wikilink" href="../../input_variables/aim/#ratmin">ratmin</a>  Radius Atomic MINimal</li>
<li><a class="wikilink" href="../../input_variables/aim/#rsurdir">rsurdir</a>  Radius SURface DIRection</li>
<li><a class="wikilink" href="../../input_variables/aim/#scal">scal</a>  SCALing of the cartesian coordinates</li>
<li><a class="wikilink" href="../../input_variables/aim/#thetamin">thetamin</a>  THETA MINimal angle</li>
</ul>
<p><em>useful:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/aim/#dpclim">dpclim</a>  DPCLIM</li>
<li><a class="wikilink" href="../../input_variables/aim/#lgrad">lgrad</a>  Low GRADient criterion</li>
<li><a class="wikilink" href="../../input_variables/aim/#lgrad2">lgrad2</a>  Low GRADient criterion 2</li>
<li><a class="wikilink" href="../../input_variables/aim/#lstep">lstep</a>  Length of the planned search STEP</li>
<li><a class="wikilink" href="../../input_variables/aim/#lstep2">lstep2</a>  Length of the planned search STEP 2</li>
<li><a class="wikilink" href="../../input_variables/aim/#maxatd">maxatd</a>  MAXimal ATomic Distance</li>
<li><a class="wikilink" href="../../input_variables/aim/#maxcpd">maxcpd</a>  MAXimal CP Distance</li>
<li><a class="wikilink" href="../../input_variables/aim/#vpts">vpts</a>  Vectors defining the PoinTS of the surface</li>
</ul>
<h2 id="selected-input-files"><strong> Selected Input Files </strong><a class="headerlink" href="#selected-input-files" title="Permanent link">&para;</a></h2>
<p><em>v3:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t56.in" title="MgO FCC crystal,  with low cut-off,  and 32 k points. Pseudopotentials WITHOUT a non-linear core correction. Prepare the Bader density analysis">tests/v3/Input/t56.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t57.in" title="MgO FCC crystal,  Bader analysis. Examine the Oxygen atom only. Determine correctly 18 bonding critical points, 24 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The bonding critical points are quite accurate, while for the ring critical points,  the criteria defined by the input variables lstep and lgrad are not fulfilled for all the CP. The coordinates are rather inaccurate. In particular,  the symmetry between RCP is broken. This is seen the most clearly at the level of the laplacian eigenvalues. This breaking of symmetry naturally originates from the fact that the FFT grid is not symmetric (the lattice was chosen primitive FCC), so that the finite elements used for the interpolation are also not symmetric. This cannot be improved by just tuning the numerical parameters. Instead,  one should consider the Bader analysis in a FCC conventional cell,  instead of the primitive one. Get 2 core electrons,  7.6796 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -1.6796.">tests/v3/Input/t57.in</a></li>
</ul>
<p><em>v4:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t30.in" title="Simple cubic lattice of Mg atoms,  with low cut-off. Pseudopotentials WITHOUT a non-linear core correction. Prepare the Bader density analysis">tests/v4/Input/t30.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t31.in" title="Simple cubic lattice of Mg atoms,  Bader analysis. Determine correctly 6 bonding critical points, 12 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The positions are very accurate (and fully coherent with symmetries). The eigenvalues of laplacian also fulfill the requirements symmetry. Bader charge is 12.0357,  while it should be exactly 12 (10 core electrons and 2 valence electrons). The error is mostly due to insufficient angular sampling (only 5 theta and 5 phi in an octant). Going to (10, 10) gives 11.9928, and (20, 20) gives 11.9980. But in the latter case, the CPU time required is multiplied by about 10 when compared to the present setting.">tests/v4/Input/t31.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t32.in" title="MgO molecule,  with low cut-off,  in a big box,  and one k point. Pseudopotentials WITHOUT a non-linear core correction. Prepare the Bader density analysis">tests/v4/Input/t32.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t33.in" title="MgO molecule,  Bader analysis. Examine the Oxygen atom only. Determine 2 bonding critical points (only !), 8 ring critical points,  and 8 cage critical points. (In agreement with Euler's relation : #BCP-#RCP+#CCP=2) The ecut that was used in test case 32 is quite low,  so that the accuracy of the critical points is not too good. Especially,  symmetries are broken at the level of 0.0003. Get 2 core electrons,  6.8043 valence electrons. The nucleus charge is +8. The Oxygen atom-in-molecule has a net charge of -0.8043. Additional explanation about the weak number of BCP for oxygen. One might expect the O atom to be connected through the other O atoms in neighbouring cells (x and y directions - hence 4 BCPs in these directions),  but one sees that the only existing BCPs are towards the Mg atoms. This is surprising,  but correct ! Indeed, the density at the middle of the segment between two O atoms along x (or y) is LOWER than the density at the middle of the segment between two Mg atoms along x (or y). Indeed,  although the O atoms attract electrons from the Mg atoms,  they become negatively charged,  and the potential, in DISTANT regions of the molecule,  is lower (so more attractive) on the side of the Mg atoms than on the side of the O atoms ! This means that the tail of the density extends further in the x-y plane containing the Mg atoms,  than in the x-y plane containing the O atoms. So,  the middle of the segment connecting the O atoms actually belongs to the Mg basin of attraction,  and is close to a Cage Critical Point shared by Oxygen and Magnesium atoms. By contrast,  the middle of the segment connecting the Mg atoms is,  as expected, close to a Bond Critical Point.">tests/v4/Input/t33.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t34.in" title="MgO molecule,  Bader analysis. Examine the Magnesium atom only. This is a pathological case for the currently implemented algorithm : the Bader volume is not convex ! Determine correctly 6 bonding critical points, but only finds 4 ring critical points,  and not even one cage critical point ! (Euler's relation #BCP-#RCP+#CCP=2 is fulfilled,  but the number of RCP or CCP is not right) Despite that fact that the critical points are not all found,  one can proceed with the other steps of the Bader approach : the CP are only used to get an estimation of the minimal and maximal radii of the Bader surface ! Get 9.8533 core electrons,  1.3388 valence electrons, for a total of 11.1922 electrons. The nucleus charge is +12. The Magnesium atom-in-molecule has a net charge of -0.8078 . Comparing with case 33,  one sees that the charge neutrality is violated at the level of 0.0035 electron charge. This is quite good,  but a bit lucky. For a better charge neutrality,  one has to integrate better on the angles phi and theta (increase nphi and ntheta),  and also to increase the ecut of the preliminary abinit run. In any case,  with the pathology of the Mg Bader volume (being not convex),  one will miss some charge. It should be pretty small,  and might even be neglected for all practical purposes (the Bader analysis is just a trend analysis,  anyhow) Nevertheless,  in this particular case of the MgO molecule,  there is a fundamental limit of this algorithm...">tests/v4/Input/t34.in</a></li>
</ul>
<p><em>v6:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t18.in" title="HI 8 molecule per cell,  the cell is triclinic. Prepare the density for the next Bader analysis.">tests/v6/Input/t18.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t19.in" title="HI 8 molecule per cell,  the cell is triclinic. Bader analysis for the first atom. Previously,  there was a bug,  not active when the cell has symmetric axes.">tests/v6/Input/t19.in</a></li>
</ul>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../BandOcc/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../BandOcc/" class="btn btn-xs btn-link">
        BandOcc
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../AtomTypes/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../AtomTypes/" class="btn btn-xs btn-link">
        AtomTypes
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
<hr>

    <center>Abinit version 8.5.4</center>


<center>Copyright &copy; 2017 The Abinit Group (PCasek,FF,XG)</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
</footer>

</body>
</html>