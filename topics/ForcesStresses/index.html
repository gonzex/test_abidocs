<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="The Abinit group">
        <link rel="canonical" href="http://www.abinit.org/topics/ForcesStresses/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>ForcesStresses - abinit</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/codehilite.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">
    
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">abinit</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../..">Introduction</a>
</li>
                            
<li >
    <a href="../../installation/">Installation</a>
</li>
                            
<li >
    <a href="../../user-guide/help_what_ABINIT_does/">Overview</a>
</li>
                            
<li >
    <a href="../../user-guide/help_abinit/">Abinit</a>
</li>
                            
<li >
    <a href="../../user-guide/help_mrgddb/">Mrgddb</a>
</li>
                            
<li >
    <a href="../../user-guide/help_optic/">Optic</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topics <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../">Complete List</a>
</li>
                            
<li >
    <a href="../Artificial/">Artificial</a>
</li>
                            
<li >
    <a href="../AtomManipulator/">AtomManipulator</a>
</li>
                            
<li >
    <a href="../AtomTypes/">AtomTypes</a>
</li>
                            
<li >
    <a href="../Bader/">Bader</a>
</li>
                            
<li >
    <a href="../BandOcc/">BandOcc</a>
</li>
                            
<li >
    <a href="../Berry/">Berry</a>
</li>
                            
<li >
    <a href="../BSE/">BSE</a>
</li>
                            
<li >
    <a href="../ConstrainedPol/">ConstrainedPol</a>
</li>
                            
<li >
    <a href="../Control/">Control</a>
</li>
                            
<li >
    <a href="../Coulomb/">Coulomb</a>
</li>
                            
<li >
    <a href="../CRPA/">CRPA</a>
</li>
                            
<li >
    <a href="../crystal/">Crystal</a>
</li>
                            
<li >
    <a href="../Dev/">Dev</a>
</li>
                            
<li >
    <a href="../DFPT/">DFPT</a>
</li>
                            
<li >
    <a href="../DFT+U/">DFT+U</a>
</li>
                            
<li >
    <a href="../DMFT/">DMFT</a>
</li>
                            
<li >
    <a href="../EffMass/">EffMass</a>
</li>
                            
<li >
    <a href="../EFG/">EFG</a>
</li>
                            
<li >
    <a href="../Elastic/">Elastic</a>
</li>
                            
<li >
    <a href="../ElecBandStructure/">ElecBandStructure</a>
</li>
                            
<li >
    <a href="../ElecDOS/">ElecDOS</a>
</li>
                            
<li >
    <a href="../ElPhonInt/">ElPhonInt</a>
</li>
                            
<li >
    <a href="../ElPhonTransport/">ElPhonTransport</a>
</li>
                            
<li class="active">
    <a href="./">ForcesStresses</a>
</li>
                            
<li >
    <a href="../FrequencyMeshMBPT/">FrequencyMeshMBPT</a>
</li>
                            
<li >
    <a href="../GeoConstraints/">GeoConstraints</a>
</li>
                            
<li >
    <a href="../GeoOpt/">GeoOpt</a>
</li>
                            
<li >
    <a href="../GW/">GW</a>
</li>
                            
<li >
    <a href="../GWls/">GWls</a>
</li>
                            
<li >
    <a href="../Hybrids/">Hybrids</a>
</li>
                            
<li >
    <a href="../">Home</a>
</li>
                            
<li >
    <a href="../k-points/">K points</a>
</li>
                            
<li >
    <a href="../LOTF/">LOTF</a>
</li>
                            
<li >
    <a href="../MagField/">MagField</a>
</li>
                            
<li >
    <a href="../MagMom/">MagMom</a>
</li>
                            
<li >
    <a href="../MolecularDynamics/">MolecularDynamics</a>
</li>
                            
<li >
    <a href="../multidtset/">Multidtset</a>
</li>
                            
<li >
    <a href="../nonlinear/">Nonlinear</a>
</li>
                            
<li >
    <a href="../Optic/">Optic</a>
</li>
                            
<li >
    <a href="../Output/">Output</a>
</li>
                            
<li >
    <a href="../parallelism/">Parallelism</a>
</li>
                            
<li >
    <a href="../PAW/">PAW</a>
</li>
                            
<li >
    <a href="../PhononBands/">PhononBands</a>
</li>
                            
<li >
    <a href="../Phonons/">Phonons</a>
</li>
                            
<li >
    <a href="../PhononWidth/">PhononWidth</a>
</li>
                            
<li >
    <a href="../PIMD/">PIMD</a>
</li>
                            
<li >
    <a href="../Planewaves/">Planewaves</a>
</li>
                            
<li >
    <a href="../positron/">Positron</a>
</li>
                            
<li >
    <a href="../printing/">Printing</a>
</li>
                            
<li >
    <a href="../PseudosPAW/">PseudosPAW</a>
</li>
                            
<li >
    <a href="../q-points/">Q points</a>
</li>
                            
<li >
    <a href="../RandStopPow/">RandStopPow</a>
</li>
                            
<li >
    <a href="../Recursion/">Recursion</a>
</li>
                            
<li >
    <a href="../RPACorrEn/">RPACorrEn</a>
</li>
                            
<li >
    <a href="../SCFAlgorithms/">SCFAlgorithms</a>
</li>
                            
<li >
    <a href="../SCFControl/">SCFControl</a>
</li>
                            
<li >
    <a href="../SelfEnergy/">SelfEnergy</a>
</li>
                            
<li >
    <a href="../SmartSymm/">SmartSymm</a>
</li>
                            
<li >
    <a href="../spinpolarisation/">Spinpolarisation</a>
</li>
                            
<li >
    <a href="../STM/">STM</a>
</li>
                            
<li >
    <a href="../Susceptibility/">Susceptibility</a>
</li>
                            
<li >
    <a href="../TDDFT/">TDDFT</a>
</li>
                            
<li >
    <a href="../TDepES/">TDepES</a>
</li>
                            
<li >
    <a href="../Temperature/">Temperature</a>
</li>
                            
<li >
    <a href="../TransPath/">TransPath</a>
</li>
                            
<li >
    <a href="../TuningSpeed/">TuningSpeed</a>
</li>
                            
<li >
    <a href="../UnitCell/">UnitCell</a>
</li>
                            
<li >
    <a href="../vdw/">Vdw</a>
</li>
                            
<li >
    <a href="../Wannier/">Wannier</a>
</li>
                            
<li >
    <a href="../Wavelets/">Wavelets</a>
</li>
                            
<li >
    <a href="../xc/">Xc</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Input Variables <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Abinit</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../input_variables/varlist_abinit/">All Variables</a>
</li>
            
<li >
    <a href="../../input_variables/basic/">Basic</a>
</li>
            
<li >
    <a href="../../input_variables/bse/">Bethe-Salpeter</a>
</li>
            
<li >
    <a href="../../input_variables/dev/">Developers</a>
</li>
            
<li >
    <a href="../../input_variables/dmft/">DMFT</a>
</li>
            
<li >
    <a href="../../input_variables/eph/">Electron-Phonon</a>
</li>
            
<li >
    <a href="../../input_variables/ffield/">Varff</a>
</li>
            
<li >
    <a href="../../input_variables/files/">File-handling</a>
</li>
            
<li >
    <a href="../../input_variables/geo/">Geometry</a>
</li>
            
<li >
    <a href="../../input_variables/gstate/">Ground-State</a>
</li>
            
<li >
    <a href="../../input_variables/gw/">GW</a>
</li>
            
<li >
    <a href="../../input_variables/internal/">Internal</a>
</li>
            
<li >
    <a href="../../input_variables/paral/">Parallelism</a>
</li>
            
<li >
    <a href="../../input_variables/paw/">PAW</a>
</li>
            
<li >
    <a href="../../input_variables/dfpt/">DFPT</a>
</li>
            
<li >
    <a href="../../input_variables/rlx/">Relaxation</a>
</li>
            
<li >
    <a href="../../input_variables/vdw/">VdW</a>
</li>
            
<li >
    <a href="../../input_variables/w90/">Wannier90</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../input_variables/anaddb/">Anaddb</a>
</li>
                            
<li >
    <a href="../../input_variables/optic/">Optic</a>
</li>
                            
<li >
    <a href="../../input_variables/aim/">Aim</a>
</li>
                            
<li >
    <a href="../../input_variables/varset_stats/">Statistics</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Lessons <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../tutorials/welcome/">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Base Tutorials</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/base1/">Base1</a>
</li>
            
<li >
    <a href="../../tutorials/base2/">Base2</a>
</li>
            
<li >
    <a href="../../tutorials/base3/">Base3</a>
</li>
            
<li >
    <a href="../../tutorials/base4/">Base4</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">DFPT</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/rf1/">RF1</a>
</li>
            
<li >
    <a href="../../tutorials/rf2/">RF2</a>
</li>
            
<li >
    <a href="../../tutorials/elastic/">Elastic</a>
</li>
            
<li >
    <a href="../../tutorials/eph/">EPH</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../tutorials/dmft/">DMFT</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Many-Body</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/gw1/">GW1</a>
</li>
            
<li >
    <a href="../../tutorials/gw2/">GW2</a>
</li>
            
<li >
    <a href="../../tutorials/bse/">Bethe-Salpeter</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Parallelism</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../tutorials/basepar/">Base</a>
</li>
            
<li >
    <a href="../../tutorials/paral_mbt/">Many-Body</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Theory <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../theory/theory_mbt/">MBPT</a>
</li>
                            
<li >
    <a href="../../theory/additional_material/">Additional Material</a>
</li>
                            
<li >
    <a href="../../bibliography/">Bibliography</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../developers/README/">How to write docs</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../about/release-notes/">Release Notes</a>
</li>
                            
<li >
    <a href="../../about/contributing/">Contributing</a>
</li>
                            
<li >
    <a href="../../about/license/">License</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../ElPhonTransport/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../FrequencyMeshMBPT/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/abinit/abinit/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#introduction">Introduction</a></li>
        <li class="main "><a href="#related-input-variables">Related Input Variables</a></li>
        <li class="main "><a href="#selected-input-files">Selected Input Files</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h2 id="introduction"><strong> Introduction </strong><a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Hellman-Feynman forces are computed from an analytical formula, and
corresponds exactly to the limit of finite differences of energy for
infinitesimally small atomic displacements when the ground-state calculation
is at convergence. This feature is available for all the cases where the total
energy can be computed. A correction for non-converged cases allows to get
accurate forces with less converged wavefunctions than without it. The
decomposition of the forces in their different components can be provided.</p>
<p>Stress can also be computed. This feature is available for all the cases where
the total energy can be computed (except wavelets). The decomposition of the
stresses in their different components can be provided. A smearing scheme
applied to the kinetic energy <a class="wikilink" href="../../input_variables/rlx/#ecutsm">ecutsm</a> allows one to get smooth energy
curves as a function of lattice parameters and angles. A target stress can be
given by the user (<a class="wikilink" href="../../input_variables/rlx/#strtarget">strtarget</a>), the geometry optimization algorithm will
try to find the primitive cell and atomic positions that deliver that target
stress.</p>
<p>The computation of forces and stresses is optional, see <a class="wikilink" href="../../input_variables/dev/#optforces">optforces</a> and
<a class="wikilink" href="../../input_variables/gstate/#optstress">optstress</a>. They are used to define SCF stopping criteria (<a class="wikilink" href="../../input_variables/basic/#toldff">toldff</a>,
<a class="wikilink" href="../../input_variables/basic/#tolrff">tolrff</a>) or geometry optimization stopping criteria (<a class="wikilink" href="../../input_variables/rlx/#tolmxf">tolmxf</a>). For the
geometry optimization, combined cell shape and atomic position optimization
need a conversion scale, set by <a class="wikilink" href="../../input_variables/rlx/#strprecon">strprecon</a>.</p>
<h2 id="related-input-variables"><strong> Related Input Variables </strong><a class="headerlink" href="#related-input-variables" title="Permanent link">&para;</a></h2>
<p><em>basic:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/dev/#optforces">optforces</a>  OPTions for the calculation of FORCES</li>
<li><a class="wikilink" href="../../input_variables/gstate/#optstress">optstress</a>  OPTion for the computation of STRESS</li>
<li><a class="wikilink" href="../../input_variables/basic/#toldff">toldff</a>  TOLerance on the DiFference of Forces</li>
<li><a class="wikilink" href="../../input_variables/basic/#tolrff">tolrff</a>  TOLerance on the Relative diFference of Forces</li>
</ul>
<p><em>useful:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/rlx/#strprecon">strprecon</a>  STRess PRECONditioner</li>
<li><a class="wikilink" href="../../input_variables/rlx/#strtarget">strtarget</a>  STRess TARGET</li>
</ul>
<h2 id="selected-input-files"><strong> Selected Input Files </strong><a class="headerlink" href="#selected-input-files" title="Permanent link">&para;</a></h2>
<p><em>v2:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t50.in" title="O2 (nsppol=2,  non-linear XC core correction,  GGA) Some similarities with test 41,  except that nsppol=2 instead of 1. Computation of uniaxial stresses in the GGA, and comparison with a finite difference of energy. The estimation of sigma(zz) stress  at acell(3)=9.0 from acell(3)=8.9991 and 9.0009 gives 1.62867d-3 Ha/Bohr**3 A simple finite-difference estimation gives a difference in total energy of 0.123861d-3 Ha, for a difference of volume of 0.07605 Bohr**3 leading to a stress estimation of 1.62867d-3 Ha/Bohr**3">tests/v2/Input/t50.in</a></li>
</ul></div>
        </div>

        <footer class="col-md-12">
<hr>

    <center>Abinit version 8.5.4</center>


<center>Copyright &copy; 2017 The Abinit Group (FJ)</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>
        <script>var base_url = '../..';</script>
        <!--
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        -->
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
        <script src="../../extra_javascript/abidocs.js"></script>

    <!--<script>var base_url = '../..';</script>
<script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>

<h1 id="search">Search Results</h1>

<form action="search.html">
  <input name="q" id="mkdocs-search-query" type="text" >
</form>

<div id="mkdocs-search-results">
  Sorry, page not found.
</div>
    -->

    </body>
</html>
