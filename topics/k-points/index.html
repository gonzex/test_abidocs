<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="The Abinit group">
    <link rel="canonical" href="http://www.abinit.org/topics/k-points/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>K points - abinit</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../css/codehilite.css" rel="stylesheet">
    <link href="../../css/extra.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->


    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Introduction", url: "#introduction", children: [
          ]},
          {title: "Related Input Variables", url: "#related-input-variables", children: [
          ]},
          {title: "Selected Input Files", url: "#selected-input-files", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      <script src="../../extra_javascript/abidocs.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../LOTF/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../LOTF/" class="btn btn-xs btn-link">
        LOTF
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../" class="btn btn-xs btn-link">
        Home
      </a>
    </div>
    
  </div>

    

    <!-- Return to Top -->

<h2 id="_1"><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h2 id="introduction"><strong> Introduction </strong><a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Since ABINIT is based on periodic boundary conditions, every wavefunction is
characterized by a wavevector, usually denoted k-point.</p>
<p>Any list of k-point can be specified, thanks to the keywords <a class="wikilink" href="../../input_variables/basic/#nkpt">nkpt</a> and
<a class="wikilink" href="../../input_variables/basic/#kpt">kpt</a>.</p>
<p>Still, k-points are used in two different contexts in the vast majority of
cases:</p>
<ul>
<li>the sampling of the Brillouin Zone, with the goal to produce integrated quantities (e.g. the charge density, the electronic energy, the electronic DOS ...) that are numerically precise;</li>
<li>or the specific computation of wavefunctions and eigenenergies e.g. to get an electronic band structure. 
In the first case, please complete the present topic by reading
<a class="wikilink" href="../../topic_BandOcc/">topic_BandOcc</a>, while in the second case, please read
<a class="wikilink" href="../../topic_ElecBandStructure/">topic_ElecBandStructure</a>.</li>
</ul>
<p>In the first case, the Brillouin zone must be sampled adequately, with grids
that, in general will be homogeneous distributions of k-points throughout the
Brillouin Zone (e.g. Monkhorst-Pack grids, or their generalisations).. For
such grids, see <a class="wikilink" href="../../input_variables/basic/#ngkpt">ngkpt</a>, <a class="wikilink" href="../../input_variables/basic/#nshiftk">nshiftk</a>, <a class="wikilink" href="../../input_variables/basic/#shiftk">shiftk</a> or even the more general
<a class="wikilink" href="../../input_variables/gstate/#kptrlatt">kptrlatt</a>. A list of interesting k point sets can be generated
automatically, including a measure of their accuracy in term of integration
within the Brillouin Zone, see <a class="wikilink" href="../../input_variables/files/#prtkpt">prtkpt</a>, <a class="wikilink" href="../../input_variables/gstate/#kptrlen">kptrlen</a>. For metals, a joint
convergenc study on <a class="wikilink" href="../../input_variables/gstate/#tsmear">tsmear</a> AND the k-point grid is important.</p>
<p>For the definition of a path of k-points, see <a class="wikilink" href="../../topic_ElecBandStructure/">topic_ElecBandStructure</a>.  </p>
<p>More detailed explanation concerning the convergence with respect to the
k-point sampling. The number of k-points to be used for this sampling, in the
full Brillouin zone, is inversely proportional to the unit cell volume, but
may also vary a lot from system to system. As a rule of thumb, a system with a
large band gap will need few k-points, while metals will need lot of k-points
to produce converged results. For large systems, the inverse scale with
respect to the unit cell volume is unfortunately stopped because at least one
k-point must be used. The effective number of k-points to be used will be
strongly influenced by the symmetries of the system, since only the
irreducible part of the Brillouin zone must be sampled. Moreover the time-
reversal symmetry (k equivalent to -k) can be used for ground-state
calculations, to reduce sometimes even further the portion of the brillouin
zone to be sampled. The number of k points to be used in a calculation is
named <a class="wikilink" href="../../input_variables/basic/#nkpt">nkpt</a>. There is another way to take advantage of the time-reversal
symmetry, in the specific case of k-points that are invariant under k =&gt; -k ,
or are sent to another vector distant of the original one by some vector of
the reciprocal lattice. See below for more explanation about the advantages of
using these k-points.<br />
As a rule of thumb, for homogeneous systems, a reasonable accuracy may be
reached when the product of the number of atoms by the number of k-points in
the full Brillouin zone is on the order of 50 or larger, for wide gap
insulators, on the order of 250 for small gap semiconductors like Si, and
beyond 500 for metals, depending on the value of the input variable tsmear. As
soon as there is some vacuum in the system, the product natom * nkpt can be
much smaller than this (for an isolated molecule in a sufficiently large
supercell, one k-point is enough).</p>
<h2 id="related-input-variables"><strong> Related Input Variables </strong><a class="headerlink" href="#related-input-variables" title="Permanent link">&para;</a></h2>
<p><em>basic:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/gstate/#chksymbreak">chksymbreak</a>  CHecK SYMmetry BREAKing</li>
<li><a class="wikilink" href="../../input_variables/basic/#kptopt">kptopt</a>  KPoinTs OPTion</li>
<li><a class="wikilink" href="../../input_variables/basic/#ngkpt">ngkpt</a>  Number of Grid points for K PoinTs generation</li>
</ul>
<p><em>expert:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/gstate/#vacuum">vacuum</a>  VACUUM identification</li>
<li><a class="wikilink" href="../../input_variables/gstate/#vacwidth">vacwidth</a>  VACuum WIDTH</li>
</ul>
<p><em>internal:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/internal/#kptns">kptns</a>  K-PoinTs re-Normalized and Shifted</li>
</ul>
<p><em>useful:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/dev/#istwfk">istwfk</a>  Integer for choice of STorage of WaveFunction at each k point</li>
<li><a class="wikilink" href="../../input_variables/basic/#kpt">kpt</a>  K - PoinTs</li>
<li><a class="wikilink" href="../../input_variables/gstate/#kptbounds">kptbounds</a>  K PoinT BOUNDarieS</li>
<li><a class="wikilink" href="../../input_variables/basic/#kptnrm">kptnrm</a>  K - PoinTs NoRMalization</li>
<li><a class="wikilink" href="../../input_variables/gstate/#kptrlatt">kptrlatt</a>  K - PoinTs grid : Real space LATTice</li>
<li><a class="wikilink" href="../../input_variables/gstate/#kptrlen">kptrlen</a>  K - PoinTs grid : Real space LENgth</li>
<li><a class="wikilink" href="../../input_variables/gstate/#ndivk">ndivk</a>  Number of DIVisions of K lines</li>
<li><a class="wikilink" href="../../input_variables/gstate/#ndivsm">ndivsm</a>  Number of DIVisions for the SMallest segment</li>
<li><a class="wikilink" href="../../input_variables/basic/#nkpath">nkpath</a>  Number of K-points defining the PATH</li>
<li><a class="wikilink" href="../../input_variables/basic/#nkpt">nkpt</a>  Number of K - Points</li>
<li><a class="wikilink" href="../../input_variables/basic/#nshiftk">nshiftk</a>  Number of SHIFTs for K point grids</li>
<li><a class="wikilink" href="../../input_variables/files/#prtkpt">prtkpt</a>  PRinT the K-PoinTs sets</li>
<li><a class="wikilink" href="../../input_variables/basic/#shiftk">shiftk</a>  SHIFT for K points</li>
<li><a class="wikilink" href="../../input_variables/basic/#wtk">wtk</a>  WeighTs for K points</li>
</ul>
<h2 id="selected-input-files"><strong> Selected Input Files </strong><a class="headerlink" href="#selected-input-files" title="Permanent link">&para;</a></h2>
<p><em>v2:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t43.in" title="BCC Molybdenum. Test the k point generator : Monkhorst-Pack grid,  then band structure.">tests/v2/Input/t43.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t44.in" title="Arsenic in rhombohedral structure. Optimization of unit cell size and shape. With 4x4x4 k point grid,  ecut 3.0,  occopt 4 and tsmear 0.06d0, one get acell 3*7.325  angdeg 3*57.36 and xred 0.2277 These input parameters are too small,  but still give a realistic geometry,  since with the much better parameters 12x12x12 k point grid,  ecut 12.0,  occopt 4 and tsmear 0.04d0, one gets acell 3*7.633  angdeg 3*54.95 and xred 0.2296,  while the experimental values are acell 3*7.751   angdeg 3*54.554 and xred 0.2276">tests/v2/Input/t44.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t61.in" title="2D hexagonal lattice: test the sets of k points generated automatically">tests/v2/Input/t61.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t62.in" title="2D square lattice: test the sets of k points generated automatically">tests/v2/Input/t62.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t63.in" title="2D 4 point symmetry: test the sets of k points generated automatically">tests/v2/Input/t63.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t64.in" title="2D rectangular lattice: test the sets of k points generated automatically">tests/v2/Input/t64.in</a></li>
</ul>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../LOTF/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../LOTF/" class="btn btn-xs btn-link">
        LOTF
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../" class="btn btn-xs btn-link">
        Home
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
<hr>

    <center>Abinit version 8.5.4</center>


<center>Copyright &copy; 2017 The Abinit Group (FJ)</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
</footer>

</body>
</html>