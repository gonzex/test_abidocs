<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="The Abinit group">
    <link rel="canonical" href="http://www.abinit.org/topics/Phonons/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Phonons - abinit</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../css/codehilite.css" rel="stylesheet">
    <link href="../../css/extra.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->


    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Introduction", url: "#introduction", children: [
          ]},
          {title: "Related Input Variables", url: "#related-input-variables", children: [
          ]},
          {title: "Selected Input Files", url: "#selected-input-files", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      <script src="../../extra_javascript/abidocs.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../PhononWidth/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../PhononWidth/" class="btn btn-xs btn-link">
        PhononWidth
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../PhononBands/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../PhononBands/" class="btn btn-xs btn-link">
        PhononBands
      </a>
    </div>
    
  </div>

    

    <h2 id="introduction"><strong> Introduction </strong><a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The computation of the second-order derivative of the total energy with
respect to atomic displacements at an arbitrary wavevector, using
<a class="wikilink" href="../../topics/DFPT">DFPT</a>, opens the possibility to compute the dynamical matrix at that
wavevector, and hence, to compute the phonon eigenfrequency and
eigendisplacements. When the wavevector is (0,0,0), usually denoted as the
Gamma point, the combination of the atomic displacements and electric field
type perturbations opens also the access to Born effective charges, electronic
(for frequencies lower than the electronic band gap) dielectric constants, and
then, to infra-red reflectivity of materials (in the infinite lifetime
approximation). See <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Gonze1997a" title="Dynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory">Gonze1997a</a> for the presentation of the theory with
DFPT.</p>
<p>In ABINIT, with one dataset for a fixed wavevector (see <a class="wikilink" href="../../topic_q-points/">topic_q-points</a>),
one can compute all such second-order derivatives. ABINIT will already perform
some post-processing treatment of the second-order derivatives (e.g.
computation of the dynamical matrix, and corresponding eigenenergies and
eigendisplacements), although the most extended post-processing treatment is
provided by ANADDB. Thus, there is some overlap of the two executables, with
some common input variables. Usually, the action of an input variable with the
same name in the two executables is very similar, although there are some
input variables that govern more options in ANADDB then in ABINIT, because of
the previously mentioned difference in capabilities. In the database of input
variables, the input variables related to ABINIT or ANADDB are clearly
distinguished.</p>
<p>The band-by-band decomposition of the Born effective charge tensors can be
computed thanks to <a class="wikilink" href="../../input_variables/dfpt/#prtbbb">prtbbb</a>. The related localization tensor (see
<a class="wikilink" href="../../Veithen2002/">Veithen2002</a> can also be computed.</p>
<p>Phonon calculations are arbitrary q-points can be done under finite electric
field (<a class="wikilink" href="../../topic_Berry/">topic_Berry</a>).</p>
<p>It will be the easiest to discover the capabilities of these two executables
through the <a class="wikilink" href="../../lesson_rf1/">lesson_rf1</a> of the tutorial.</p>
<p>See <a class="wikilink" href="../../topic_DFPT/">topic_DFPT</a> for the general information about DFPT, <a class="wikilink" href="../../topic_q-points/">topic_q-points</a>
for the specification of q-points, and <a class="wikilink" href="../../topic_PhononBands/">topic_PhononBands</a> for the
computation of full phonon bands.</p>
<h2 id="related-input-variables"><strong> Related Input Variables </strong><a class="headerlink" href="#related-input-variables" title="Permanent link">&para;</a></h2>
<p><em>basic:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/anaddb/#asr">asr</a>  Acoustic Sum Rule</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#dieflag">dieflag</a>  DIElectric FLAG</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#ngqpt">ngqpt</a>  Number of Grids points for Q PoinTs</li>
</ul>
<p><em>expert:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/anaddb/#rfmeth">rfmeth</a>  Response-Function METHod</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#selectz">selectz</a>  SeLECT Z</li>
</ul>
<p><em>useful:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/anaddb/#chneut">chneut</a>  Integer for CHarge NEUTrality treatment</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#eivec">eivec</a>  EIgenVECtors</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#enunit">enunit</a>  ENergy UNITs</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#frmax">frmax</a>  FRequency MAXimum</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#frmin">frmin</a>  FRequency MINimum</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#nfreq">nfreq</a>  Number of FREQuencies</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#prtvol">prtvol</a>  PRinT VOLume</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#q1shft">q1shft</a>  Q shifts for the grid number 1</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#symdynmat">symdynmat</a>  SYMmetrize the DYNamical MATrix</li>
</ul>
<h2 id="selected-input-files"><strong> Selected Input Files </strong><a class="headerlink" href="#selected-input-files" title="Permanent link">&para;</a></h2>
<p><em>v2:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t13.in" title="Analyze a simple DDB for quartz,  but do not test interatomic force constants (see test 15 for this). Compute phonon frequencies at gamma with and without LO-TO splitting.">tests/v2/Input/t13.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t15.in" title="Analyze the DDB for quartz build in test 14. Compute the interatomic force constants,  the phonon Density of States, different thermodynamical functions of temperature, phonon frequencies in the whole Brillouin zone, oscillator strengths and mode effective charges at q(0 0 0), the electronic dielectric tensor,  and the (full) dielectric tensor at zero frequency (so including atomic displacements and related polarization).">tests/v2/Input/t15.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t16.in" title="Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom. Here,  IFCs are obtained,  and can be compared to those published in Table I of Rignanese et al,  PRB53,  4488 (1996). For example,  the atoms numbers for NN=0, 1, 2, 5 in Table I are found as atoms 1, 5, 17, 20. The numbers are equal in the paper or in the output of the code. The frequencies at X and L points are also computed. They can be compared with those provided in TABLE II (TA(X) mode at 140.466 cm-1) and TABLE III (TA(L) mode at 108.626 cm-1) in the above-mentioned paper. The numbers are equal in the paper or in the output of the code. Thermodynamic quantities are also obtained. The input parameters of the code does not give particularly well converged quantities (one needs reasonable CPU time for testing !), but it is OK for comparison with the paper. In the output of the code,  a mole corresponds to the number of Avogadro times one CELL. As a Silicon cell contains 2 atoms,  caution must be taken in the comparison with experiment ! We will refer to the numbers given by the code as being given for a mole-cell (in short a mol-c). The distinction between the usual definition of a mole (Avogadro number times 1 Silicon atom) and a mole-cell (Avogadro number times 2 Silicon atom) was unfortunately the source of errors in the paper by Rignanese et al (our thanks to Steve Erwin for noticing this - an errata should be written). From the output of the code ( zero Kelvin is approximated by results at 1 Kelvin) : the zero point contribution to the Helmholtz free energy is 11.90 kJ/mol-c,  so 5.95 kJ/mole;  the entropy at 298.15K is 38.25 J/(mol-c.K),  so 19.12 J/(mole.K);  the constant-volume specific heat at 298.15K is 39.59 J/(mol-c.K),  so 19.80 J/(mole.K); the change in F (Helmholtz free energy) from 1 K to 298.15 K is -4.91 kJ/mol-c,  so -2.45 kJ/mole;  the change in E (internal energy) from 1 K to 298.15 K is 6.49 kJ/mol-c,  so 3.25 kJ/mole. Supposing that we take the usual definition of a mole (Avogadro number times 1 Silicon atom),  then,  in the above-mentioned paper,  the FIG. 3,  5 and 8 should be rescaled,  as well as the zero-point contribution to the Helmholtz free energy (5.95 kJ/mole,  and not 12 J/mole - the 'k' was also missing),  that is only 1.25% of the cohesive energy. The output of the code is now more clear than in 1995,  and this kind of error should not appear anymore.">tests/v2/Input/t16.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t17.in" title="Analyze a DDB for Silicon. Lattice parameter = 10.18 Angstrom. IFCs are computed as in test 16,  but by limiting artificially the number of allowed interacting shells to 2. The total number of atoms to be taken into account is 17 (1 for the shell 0, 4 for the shell 1,  and 12 for the shell 2). The frequencies at X and L points are again computed. They can be compared with those provided in TABLE II (TA(X) mode at 161.684 cm-1) and TABLE III (TA(L) mode at 127.508 cm-1) in the above-mentioned paper. The number are close,  with small differences at the level of 0.001 cm-1 .">tests/v2/Input/t17.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t18.in" title="Analyze a DDB for BaTiO3 (see also tests 19 and 20). Here, no use of IFCs is done. Phonon frequencies at the Gamma,  X,  M,  R and along the Gamma-R line are obtained directly from the DDB. They are to be compared with the data in the TABLE II of Ghosez et al,  Ferroelectrics, 206-207,  205 (1998),  as well as FIGURE I. At q(1/8 1/8 1/8),  the lowest frequency is  i 136.7 cm-1 .">tests/v2/Input/t18.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t19.in" title="Analyze a DDB for BaTiO3,  same as test18,  but IFCs are obtained from a 2x2x2 non-shifted grid (referred to as M1 in the above-mentioned paper by Ghosez et al). At q(1/8 1/8 1/8),  the lowest frequency is  i 178.8 cm-1 .">tests/v2/Input/t19.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t20.in" title="Analyze a DDB for BaTiO3,  same as test18,  but IFCs are obtained from a 2x2x2 BCC grid (referred to as M2 in the above-mentioned paper by Ghosez et al). At q(1/8 1/8 1/8),  the lowest mode is  i 153.5 cm-1 . The error,  compared with the reference result of test 18, is still 10%,  but much less than with the grid of test 19. Also,  the IFCs are obtained and can be compared with those provided in TABLE III-V of the Ghosez et al paper. Note the decomposition between dipole-dipole contribution and short-ranged contribution.">tests/v2/Input/t20.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t21.in" title="Analyze a DDB for BaTiO3,  same as test18. Compute the phonon frequencies at Gamma,  and also output the corresponing eigenvectors. These data can be compared with those published by Ghosez et al,  Ferroelectrics 194,  39 (1997), TABLE II,  although the normalisation factor is different. For example,  the z displacement of mode 1 given by the code is ( .25d-4,  .158d-2,  -.261d-2,  -.118d-2,  -.118d-2 ),  that multiplied by -60.54 and rounded to the third digit, gives values that appear in the first line of that TABLE II : ( -0.002,  -0.096,  0.158,  0.071,  0.071 )">tests/v2/Input/t21.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t39.in" title="BaSr(TiO3)2 FCC unit cell. Show how to use only the q Gamma point to obtain symmetric IFCs using Anaddb.">tests/v2/Input/t39.in</a></li>
</ul>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../PhononWidth/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../PhononWidth/" class="btn btn-xs btn-link">
        PhononWidth
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../PhononBands/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../PhononBands/" class="btn btn-xs btn-link">
        PhononBands
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
<hr>

    <center>Abinit version 8.5.4</center>


<center>Copyright &copy; 2017 The Abinit Group (MT)</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
</footer>

</body>
</html>