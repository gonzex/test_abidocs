<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="The Abinit group">
    <link rel="canonical" href="http://www.abinit.org/topics/vdw/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Vdw - abinit</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../css/codehilite.css" rel="stylesheet">
    <link href="../../css/extra.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->


    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Introduction", url: "#introduction", children: [
          ]},
          {title: "Related Input Variables", url: "#related-input-variables", children: [
          ]},
          {title: "Selected Input Files", url: "#selected-input-files", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      <script src="../../extra_javascript/abidocs.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Wannier/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Wannier/" class="btn btn-xs btn-link">
        Wannier
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../UnitCell/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../UnitCell/" class="btn btn-xs btn-link">
        UnitCell
      </a>
    </div>
    
  </div>

    

    <!-- Return to Top -->

<h2 id="_1"><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h2 id="introduction"><strong> Introduction </strong><a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>It is well known that long range correlations responsible of van der Waals
interactions are out of reach for both LDA and GGA approximations to the
exchange-correlation energy in DFT. In recent years several methods have been
devised to include such interactions, which can be grouped into two
strategies, namely <em>ad hoc</em> methods and self-consistent approaches. Currently
ABINIT can perform calculations based on either the DFT-D methods or the vdW-
WF methods, as described later, both belonging to the first group.</p>
<p>A fully customizable implementation of the vdW-DF method <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Dion2004" title="Van der Waals Density Functional for General Geometries">Dion2004</a>, a self-
consistent approach, and an adaptation of the strategy followed by G.Roman-
Perez <em>et al.</em> <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Romanperez2009" title="Efficient Implementation of a {V}an der {W}aals Density Functional: Application to Double-Wall Carbon Nanotubes">Romanperez2009</a> to the case of ABINIT are under development.
It will offer around 25 ajustable parameters and be delivered with graphical
tools to help users assess the quality of their kernels. It does not only aim
at performing production calculations with vdW-DF, but also at helping
researchers who develop new density functionals optimised for systems
requiring van-der-Waals interactions.</p>
<p>The DFT-D methods have been implemented inside ABINIT, namely DFT-D2
<a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Grimme2006" title="Semiempirical {GGA}-Type Density Functional Constructed with a Long-Range Dispersion Correction">Grimme2006</a>, DFT-D3 <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Grimme2010" title="A consistent and accurate ab initio parametrization of density functional dispersion correction (DFT-D) for the 94 elements H-Pu">Grimme2010</a> and DFT-D3(BJ) <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Grimme2010a" title="Effect of the Damping Function in Dispersion Corrected Density Functional Theory">Grimme2010a</a>. In these
cases, pair-wise terms (and 3-body corrections for DFT-D3 and DFT-D3(BJ)) are
added to the DFT energy, which are independent of the electronic density, in
order to mimic the vdW interactions. The implementation includes the
contributions of these methods to forces and stresses, in view of geometry
optimization, as well as to first-order response functions like dynamical
matrices, clamped elastic constants and internal strain coupling parameters.</p>
<p>To activate DFT-D dispersion correction, two keywords are in use: <a class="wikilink" href="../../input_variables/vdw/#vdw_xc">vdw_xc</a> =
5/6/7 to choose between DFT-D2, DFT-D3 and DFT-D3(BJ), and <a class="wikilink" href="../../input_variables/vdw/#vdw_tol">vdw_tol</a>, to
control the inclusion of largely distant pairs (those giving a contribution
below <a class="wikilink" href="../../input_variables/vdw/#vdw_tol">vdw_tol</a> are ignored). It is also possible to include 3-body
corrections <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Grimme2010" title="A consistent and accurate ab initio parametrization of density functional dispersion correction (DFT-D) for the 94 elements H-Pu">Grimme2010</a> (for ground-state only) with the keyword
<a class="wikilink" href="../../input_variables/vdw/#vdw_tol_3bt">vdw_tol_3bt</a>, which also controls the tolerance over this term.</p>
<p>Methods based on maximally localized Wannier functions (MLWFs) to calculate
vdW energy corrections have also been implemented in ABINIT. In this case the
pair-wise terms come from contributions of pairs of MLWFs rather than from
atoms. Among the implemented methods in ABINIT it is found vdW-WF1
<a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Silvestrelli2008" title="van der {W}aals Interactions in {DFT} Made Easy by {W}annier Functions">Silvestrelli2008</a>,<a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Silvestrelli2009" title="van der {W}aals Interactions in Density Functional Theory Using {W}annier Functions">Silvestrelli2009</a> vdW-WF2 <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Ambrosetti2012" title="van der {W}aals interactions in density functional theory using Wannier functions: Improved {C}6 and {C}3 coefficients by a different approach">Ambrosetti2012</a> and vdW-
QHO-WF <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Silvestrelli2013" title="van der {W}aals interactions in density functional theory by combining the quantum harmonic oscillator-model with localized {W}annier functions">Silvestrelli2013</a>. A full description of the implementation of vdW-
WF1 is reported in <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Espejo2012" title="Wannier functions approach to van der Waals interactions in {ABINIT}">Espejo2012</a>.</p>
<p>Selection of one of these 3 methods is achieved by using <a class="wikilink" href="../../input_variables/vdw/#vdw_xc">vdw_xc</a>=10/11/14
respectivelly. Since vdW-WF1 and vdW-WF2 methods are approximations for the
dispersion energy of non overlapping electronic densities, it is necessary to
define the interacting fragments of the system whose dispersion energy is
going to be calculated. The latter is achieved by using the input variables
<a class="wikilink" href="../../input_variables/vdw/#vdw_nfrag">vdw_nfrag</a> and <a class="wikilink" href="../../input_variables/vdw/#vdw_typfrag">vdw_typfrag</a> to define the number of interacting
fragments in the unit cell and to assign each atom to a fragment. A given MLWF
belongs to the same fragment as its closer atom. The need for defining the
interacting fragments is overridden in the vdW-QHO-WF, for which these input
variables are not used. When dealing with periodic systems the input variable
<a class="wikilink" href="../../input_variables/vdw/#vdw_supercell">vdw_supercell</a> controls the number of neighbor unit cells that will be
included in the calculation. Each one of the 3 components of <a class="wikilink" href="../../input_variables/vdw/#vdw_supercell">vdw_supercell</a>
indicates the maximum number of cells along both positive or negative
directions of the corresponding primitive vector. This is useful for studying
the spacial convergency of the vdW energy. It should be noticed that the user
must set the variables associated to the calculation of MLWFs and that the
resulting vdW energies strongly depend on the obtained Wannier functions.</p>
<h2 id="related-input-variables"><strong> Related Input Variables </strong><a class="headerlink" href="#related-input-variables" title="Permanent link">&para;</a></h2>
<p><em>basic:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_nfrag">vdw_nfrag</a>  Van Der Waals Number of interacting FRAGments</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_supercell">vdw_supercell</a>  Van Der Waals correction from Wannier functions in SUPERCELL</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_tol_3bt">vdw_tol_3bt</a>  Van Der Waals TOLerance for 3-Body Term</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_typfrag">vdw_typfrag</a>  Van Der Waals TYPe of FRAGment</li>
</ul>
<p><em>compulsory:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_tol">vdw_tol</a>  Van Der Waals TOLerance</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_xc">vdw_xc</a>  Van Der Waals eXchange-Correlation functional</li>
</ul>
<p><em>expert:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_acutmin">vdw_df_acutmin</a>  vdW-DF MINimum Angular CUT-off</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_aratio">vdw_df_aratio</a>  vdW-DF Angle RATIO between the highest and
lowest angles.</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_damax">vdw_df_damax</a>  vdW-DF Delta for Angles, MAXimum </li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_damin">vdw_df_damin</a>  vdW-DF Delta for Angles, MINimum</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_dcut">vdw_df_dcut</a>  vdW-DF D-mesh CUT-off</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_dratio">vdw_df_dratio</a>  vdW-DF, between the highest and
lowest D, RATIO.</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_dsoft">vdw_df_dsoft</a>  vdW-DF Distance for SOFTening.</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_gcut">vdw_df_gcut</a>  vdW-DF G-space CUT-off</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_ndpts">vdw_df_ndpts</a>  vdW-DF Number of D-mesh PoinTS</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_ngpts">vdw_df_ngpts</a>  vdW-DF Number of G-mesh PoinTS</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_nqpts">vdw_df_nqpts</a>  vdW-DF Number of Q-mesh PoinTS</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_nrpts">vdw_df_nrpts</a>  vdW-DF Number of R-PoinTS</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_nsmooth">vdw_df_nsmooth</a>  vdW-DF Number of SMOOTHening iterations</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_phisoft">vdw_df_phisoft</a>  vdW-DF PHI value SOFTening.</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_qcut">vdw_df_qcut</a>  vdW-DF Q-mesh CUT-off</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_qratio">vdw_df_qratio</a>  vdW-DF, between highest and lowest Q, RATIO .</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_rcut">vdw_df_rcut</a>  vdW-DF Real-space CUT-off</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_rsoft">vdw_df_rsoft</a>  vdW-DF radius SOFTening.</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_threshold">vdw_df_threshold</a>  vdW-DF energy calculation THRESHOLD</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_tolerance">vdw_df_tolerance</a>  vdW-DF global TOLERANCE.</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_tweaks">vdw_df_tweaks</a>  vdW-DF TWEAKS.</li>
<li><a class="wikilink" href="../../input_variables/vdw/#vdw_df_zab">vdw_df_zab</a>  vdW-DF ZAB parameter</li>
</ul>
<p><em>useful:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/vdw/#irdvdw">irdvdw</a>  Integer that governs the ReaDing of _VDW files</li>
<li><a class="wikilink" href="../../input_variables/files/#prtwf">prtwf</a>  PRinT the WaveFunction</li>
</ul>
<h2 id="selected-input-files"><strong> Selected Input Files </strong><a class="headerlink" href="#selected-input-files" title="Permanent link">&para;</a></h2>
<p><em>v7:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t97.in" title="Relaxation of FCC Argon crystal with DFT-D3 dispersion correction Both the pair-wise term and the 3-body term are included In this test the following properties are thus tested: contribution to the energy and to the stress of DFT-D3 including the 3-body term">tests/v7/Input/t97.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t98.in" title="Computation of the dynamical matrix at different q-vector including vdW-DFT-D3 corrections with Becke-Jonhson damping (DFT-D3(BJ)) Only the pair-wise is computed (3-body term not implemented) In this test the following properties are thus tested: contribution to the energy and to the stress of DFT-D3(BJ) as well as the contribution to the dynamical matrix">tests/v7/Input/t98.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t99.in" title="Computation of the elastic constants and internal strains for distorded h-BN (to get non-zero internal strains) vdW-DFT-D3 corrections with Becke-Jonhson damping (DFT-D3(BJ)) Only the pair-wise is computed (3-body term not implemented) In this test the following properties are thus tested: contribution to the energy and to the stress of DFT-D3(BJ) as well as the contribution to the elastic constants and internal strains">tests/v7/Input/t99.in</a></li>
</ul>
<p><em>vdwxc:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/vdwxc/Input/t10.in" title="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential.">tests/vdwxc/Input/t10.in</a></li>
</ul>
<p><em>wannier90:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t11.in" title="Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions.">tests/wannier90/Input/t11.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t12.in" title="Argon FCC Test the approach of Ambrosetti and Silvestrelli to assess van der Waals interactions.">tests/wannier90/Input/t12.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/wannier90/Input/t13.in" title="Argon FCC Test the approach of Silvestrelli to assess van der Waals interactions,  combining the QHO model with Wannier functions.">tests/wannier90/Input/t13.in</a></li>
</ul>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Wannier/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Wannier/" class="btn btn-xs btn-link">
        Wannier
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../UnitCell/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../UnitCell/" class="btn btn-xs btn-link">
        UnitCell
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
<hr>

    <center>Abinit version 8.5.4</center>


<center>Copyright &copy; 2017 The Abinit Group (YPouillon, BVanTroeye)</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
</footer>

</body>
</html>