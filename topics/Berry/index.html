<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="The Abinit group">
    <link rel="canonical" href="http://www.abinit.org/topics/Berry/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Berry - abinit</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../css/codehilite.css" rel="stylesheet">
    <link href="../../css/extra.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->


    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Introduction", url: "#introduction", children: [
          ]},
          {title: "Related Input Variables", url: "#related-input-variables", children: [
          ]},
          {title: "Selected Input Files", url: "#selected-input-files", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      <script src="../../extra_javascript/abidocs.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../BSE/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../BSE/" class="btn btn-xs btn-link">
        BSE
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../BandOcc/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../BandOcc/" class="btn btn-xs btn-link">
        BandOcc
      </a>
    </div>
    
  </div>

    

    <h2 id="introduction"><strong> Introduction </strong><a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The effect of an homogeneous static electric field on an insulator may be
treated in ABINIT from two perspectives. One is perturbative, and yields the
susceptibility in the form of the second derivative of the total energy with
respect to the electric field, at zero field strength (see <a class="wikilink" href="../../topics/DFPT">DFPT</a>).</p>
<p>ABINIT can also be used to compute the effect of an electric field of finite
amplitude, using techniques from the Modern Theory of Polarization
<a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Resta1994" title="Macroscopic polarization in crystalline dielectrics: the geometric phase approach">Resta1994</a>,<a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Nunes2001" title="Berry-phase treatment of the homogeneous electric field perturbation in insulators">Nunes2001</a>,<a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Souza2002" title="First-Principles Approach to Insulators in Finite Electric Fields">Souza2002</a>. The latter is based on the notion
of "Berry phase". In this approach, the total energy to minimize includes the
contribution due to the interaction of the external electric field with the
material polarization <strong>P</strong>Tot, as follows:</p>
<p>E = E0 - Ω<strong>P</strong>Tot<strong>.E</strong>, where E0 is the usual ground state energy obtained
from Kohn-Sham DFT in the absence of the external field <strong>E</strong>, <strong>P</strong>Tot is the
polarization, made up of an ionic contribution and an electronic contribution,
and Ω the volume of the unit cell.</p>
<p>Some details of the implementation of The Modern Theory of Polarization in
ABINIT are given in <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Gonze2016" title="Recent developments in the {ABINIT} software package">Gonze2016</a>.</p>
<p>In the NCPP case, the electric field has no additional contribution to the
Hellmann-Feynman forces, because the electronic states do not depend
explicitly on ionic position <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Souza2002" title="First-Principles Approach to Insulators in Finite Electric Fields">Souza2002</a>. In the PAW case however, as the
projectors do depend on ion location, an additional force and additional
stresses terms arise <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Zwanziger2012" title="Finite homogeneous electric fields in the projector augmented wave formalism: Applications to linear and nonlinear response">Zwanziger2012</a>.</p>
<p>The generalisation to fixed D-field or fixed reduced fields are also
available, as described in M. Stengel, N.A. Spaldin and D. Vanderbilt, Nat.
Phys. 5,304 (2009).</p>
<p>The polarization and finite electric field calculation in ABINIT is accessed
through the variables <a class="wikilink" href="../../input_variables/ffield/#berryopt">berryopt</a> and <a class="wikilink" href="../../input_variables/ffield/#efield">efield</a>. In addition, displacement
fields and mixed boundary conditions (a mix of electric field and displacement
field) can be computed as well.</p>
<h2 id="related-input-variables"><strong> Related Input Variables </strong><a class="headerlink" href="#related-input-variables" title="Permanent link">&para;</a></h2>
<p><em>basic:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/ffield/#bdberry">bdberry</a>  BanD limits for BERRY phase</li>
<li><a class="wikilink" href="../../input_variables/ffield/#dfield">dfield</a>  Displacement FIELD</li>
<li><a class="wikilink" href="../../input_variables/ffield/#efield">efield</a>  Electric FIELD</li>
<li><a class="wikilink" href="../../input_variables/ffield/#jfielddir">jfielddir</a>  electric/displacement FIELD DIRection</li>
<li><a class="wikilink" href="../../input_variables/ffield/#kberry">kberry</a>  K wavevectors for BERRY phase computation</li>
<li><a class="wikilink" href="../../input_variables/ffield/#nberry">nberry</a>  Number of BERRY phase computations</li>
</ul>
<p><em>compulsory:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/ffield/#berryopt">berryopt</a>  BERRY phase OPTions</li>
</ul>
<p><em>expert:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/ffield/#berrystep">berrystep</a>  BERRY phase : multiple STEP</li>
</ul>
<p><em>useful:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/ffield/#berrysav">berrysav</a>  BERRY SAVe</li>
<li><a class="wikilink" href="../../input_variables/ffield/#ddamp">ddamp</a>  electric Displacement field DAMPing parameter</li>
<li><a class="wikilink" href="../../input_variables/ffield/#maxestep">maxestep</a>  MAXimum Electric field STEP</li>
<li><a class="wikilink" href="../../input_variables/ffield/#polcen">polcen</a>  POLarization for CENtrosymmetric geometry</li>
<li><a class="wikilink" href="../../input_variables/ffield/#red_dfield">red_dfield</a>  REDuced Displacement FIELD</li>
<li><a class="wikilink" href="../../input_variables/ffield/#red_efield">red_efield</a>  REDuced Electric FIELD</li>
<li><a class="wikilink" href="../../input_variables/ffield/#red_efieldbar">red_efieldbar</a>  REDuced Electric FIELD BAR</li>
</ul>
<h2 id="selected-input-files"><strong> Selected Input Files </strong><a class="headerlink" href="#selected-input-files" title="Permanent link">&para;</a></h2>
<p><em>paral:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t07.in" title="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial). The need to have the number of points a multiple of the number of processor is not convenient ...">tests/paral/Input/t07.in</a></li>
</ul>
<p><em>v4:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t66.in" title="Test of the strain perturbation for the rigid-ion piezoelectric tensor.  Rhombohedrally distorted AlP as in the previous test,  but using a ground-state finite- difference calculation of the d/dk wave functions.  Such calculations were used extensively to test the response function piezoelectric tensor by comparison to numerical derivatives of the ground-state polarization.  Using the same k sample in the ground state and response function calculations,  excellent agreement has been obtained in a variety of cases (including a better-converged version of this one).  Results using the finite- diffrence d/dk and the analytic d/dk as in the preceeding test agree in the limit of large k sample. The analytic form converges much more rapidly,  and is consistent with the slowly converging polarization numerical derivatives. The present version of this calculation uses berryopt = -2 to utilize the routine berryphase_new.f The ground-state polarization calculations used to compute the numerical derivatives in such tests should also be computed using berryphase_new.f setting berryopt = -1 and rfdir = 1 1 1 so that the cartesian polarization is automatically generated. This eliminates several issues that needed special attention using berryopt = 1 and the original berryphase.f routine. The resulting cartesian polarization derivatives represent the &quot;improper&quot; piezoelectric tensor,  and have to be corrected to yield the &quot;proper&quot; tensor as described in D. Vanderbilt,  J. Phys. Chem. Solids 61,  147 (2000),  using Eq.(15).  The response-function calculation gives the proper piezoelectric tensor.  Only the electron response,  and not the strain-induced movement of the rigid ions contributes to the proper tensor.">tests/v4/Input/t66.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t72.in" title="AlAs,  zinc-blende structure Compute the polarization along strings of k-points parallel to the primitive vectors of the reciprocal lattice. The Berry phase calculations are performed in three different datasets. For each datatset,  ABINIT writes the polarization in reduced coordinates to a DDB.">tests/v4/Input/t72.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t75.in" title="AlAs,  zinc-blende structure (Test of Na Sai's technique) To compute the polarization,  the finite difference expression of the ddk and the second-order energy derivatives.">tests/v4/Input/t75.in</a></li>
</ul>
<p><em>v5:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t23.in" title="AlAs in Zincblende structure. Test calculation of the Born effective charge and dielectric constant tensor at finite electric fields. The first dataset is for normal ground-state calculation at zero electric field. The second dataset is for ground-state calculation at finite electric field. The final datasetis the linear-response calculation at finite electric field.">tests/v5/Input/t23.in</a></li>
</ul>
<p><em>v6:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t43.in" title="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial.) Cannot be executed with more than 1 MPI node.">tests/v6/Input/t43.in</a></li>
</ul>
<p><em>v7:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v7/Input/t03.in" title="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used.">tests/v7/Input/t03.in</a></li>
</ul>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../BSE/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../BSE/" class="btn btn-xs btn-link">
        BSE
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../BandOcc/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../BandOcc/" class="btn btn-xs btn-link">
        BandOcc
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
<hr>

    <center>Abinit version 8.5.4</center>


<center>Copyright &copy; 2017 The Abinit Group (JZ)</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
</footer>

</body>
</html>