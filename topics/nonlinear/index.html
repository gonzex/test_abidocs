<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="The Abinit group">
    <link rel="canonical" href="http://www.abinit.org/topics/nonlinear/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Nonlinear - abinit</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../css/codehilite.css" rel="stylesheet">
    <link href="../../css/extra.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->


    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Introduction", url: "#introduction", children: [
          ]},
          {title: "Related Input Variables", url: "#related-input-variables", children: [
          ]},
          {title: "Selected Input Files", url: "#selected-input-files", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      <script src="../../extra_javascript/abidocs.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Optic/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Optic/" class="btn btn-xs btn-link">
        Optic
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../multidtset/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../multidtset/" class="btn btn-xs btn-link">
        Multidtset
      </a>
    </div>
    
  </div>

    

    <!-- Return to Top -->

<h2 id="_1"><a href="javascript:" id="return-to-top"><i class="glyphicon glyphicon-chevron-up"></i></a><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h2 id="introduction"><strong> Introduction </strong><a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>In Raman experiments, the incident light, usually a polarized or unpolarized
laser, is scattered by the sample, and the energy as well as polarization of
the outgoing light is measured. A Raman spectrum, presenting the energy of the
outgoing photons, will consist of rather well-defined peaks, around an elastic
peak.</p>
<p>At the lowest order of the theory, the dominant mechanism is the absorption or
emission of a phonon by a photon. The energy of the absorbed or emitted phonon
corresponds to the energy difference between the outgoing and incident
photons. Thus, even more straightforwardly than the IR spectrum, a Raman
spectrum is directly related to the energy of phonons at the Brillouin-zone
center: when the zero of the energy scale is set at the incident light energy,
the absolute value of the energy of the peaks corresponds to the energy of the
phonons.</p>
<p>The computation of phonon energies is presented in <a class="wikilink" href="../../topic_Phonons/">topic_Phonons</a>. Raman
intensities due to one-phonon emission or absorption are not linked to second-
order derivatives of the total energy, but, within the adiabatic
approximation, to derivative of the dielectric phonon with respect to atomic
displacements. Moreover, when the frequency of the incident light (usually in
the 1.5 eV to 2.5 eV range) is small with respect to the band gap (e.g. for
gaps larger than 4 eV), the static approximation can be made, in which the
Raman intensity will be linked to the third-order derivative of the total
energy with respect (twice) to an homogeneous electric field and (once) with
respect to atomic displacements. Thus, DFPT can be used, see below. For the
case in which the incident light frequency is not negligible with respect to
the gap, the DFPT cannot be used, but, if the adiabatic approximation can be
used (the phonon frequency much smaller than the gap, and also features
smaller than the largest phonon frequency cannot be resolved in the Raman
spectrum), one can compute the Raman intensities thanks to finite differences
of dielectric function, see <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Gillet2013" title="First-principles study of excitonic effects in Raman intensities">Gillet2013</a>. For the two-phonon Raman spectrum,
see <a class="wikilink" href="../../Gillet2017/">Gillet2017</a>.</p>
<p>Both the derivatives of the linear electronic dielectric susceptibilities with
respect to atomic displacements and the non-linear electronic dielectric
susceptibilities required to evaluate the Raman intensities are thus non-
linear responses. In the ABINIT implementation, they are computed within the
density functional perturbation theory, as described in <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Veithen2005" title="Nonlinear optical susceptibilities, Raman efficiencies, and electrooptic tensors from first--principles density functional theory">Veithen2005</a>.
Thanks to the 2n+1 theorem, their formulation only requires the knowledge of
the ground-state and first-order changes in the wavefunctions.</p>
<p>This non-linear response formalism has been successfully applied to a large
variety of systems. We have so far studied the Raman spectra of ferroelectric
oxides ( BaTiO3 and PbTiO3 <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Hermet2009" title="Raman scattering intensities in BaTiO(3) and PbTiO(3) prototypical ferroelectrics from density functional theory.">Hermet2009</a>), different minerals under pressure
conditions characteristic to the interior of the Earth <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Caracas2007a" title="Post-perovskite phase in selected sesquioxides from density-functional calculations">Caracas2007a</a> or
molecular solids under extreme conditions <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Caracas2008" title="Dynamical Instabilities of Ice X">Caracas2008</a>. The computation of
the non-linear optical susceptibilities has also been applied to several polar
dielectrics <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Caracas2007" title="Prediction of polar ordered oxynitride perovskites">Caracas2007</a>.</p>
<p>As a by-product of the calculation of the Raman tensor and non-linear optical
coefficients, it is also possible to determine directly within ABINIT the
electro-optic (EO) coefficients rijγ (Pockels effect) which describe the
change of optical dielectric tensor in a (quasi-)static electric field through
the following expression <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Veithen2005" title="Nonlinear optical susceptibilities, Raman efficiencies, and electrooptic tensors from first--principles density functional theory">Veithen2005</a>: Δ(ε-1)ij=∑γ=1,3 rijγΕγ</p>
<p>The clamped (zero strain) EO coefficients include an electronic and an ionic
contribution directly accessible within ABINIT. The unclamped EO coefficients
include an additional piezoelectric contribution which must be computed
separately from the knowledge of the elasto-optic and piezoelectric strain
coefficients. This formalism was for instance applied to different
ferroelectric ABO3 compounds <a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../bibliography/#Veithen2005a" title="Temperature dependence of the electro-optic tensor and refractive indices of Ba Ti O 3 from first principles">Veithen2005a</a>.</p>
<p>The implementation is available for norm-conserving pseudopotentials, in the
LDA approximation. The extension to the PAW framework is in progress.</p>
<h2 id="related-input-variables"><strong> Related Input Variables </strong><a class="headerlink" href="#related-input-variables" title="Permanent link">&para;</a></h2>
<p><em>basic:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/anaddb/#alphon">alphon</a>  ALign PHONon mode eigendisplacements</li>
<li><a class="wikilink" href="../../input_variables/anaddb/#ramansr">ramansr</a>  RAMAN Sum-Rule</li>
</ul>
<p><em>compulsory:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/anaddb/#nlflag">nlflag</a>  Non-Linear FLAG</li>
</ul>
<p><em>useful:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/anaddb/#prtmbm">prtmbm</a>  PRinT Mode-By-Mode decomposition of the electrooptic tensor</li>
</ul>
<h2 id="selected-input-files"><strong> Selected Input Files </strong><a class="headerlink" href="#selected-input-files" title="Permanent link">&para;</a></h2>
<p><em>paral:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t54.in" title="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations.">tests/paral/Input/t54.in</a></li>
</ul>
<p><em>v3:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t83.in" title="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)">tests/v3/Input/t83.in</a></li>
</ul>
<p><em>v4:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t52.in" title="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54.">tests/v4/Input/t52.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v4/Input/t54.in" title="AlAs,  zinc-blende structure. Code anaddb Analyse the DDB from test 53,  for the generation of the electro-optic tensor,  and Raman susceptibility coefficients.">tests/v4/Input/t54.in</a></li>
</ul>
<p><em>v6:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t63.in" title="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &gt; 1">tests/v6/Input/t63.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t64.in" title="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63">tests/v6/Input/t64.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t65.in" title="NaCl Molecule in a big box 3DTE calculation with only one k-point">tests/v6/Input/t65.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t66.in" title="He dimer,  with bare pseudopotential ixc=0 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  giving DFPT: 0.039868 Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077 to be divided by 0.02 (the difference in xcart) and 4pi =&gt; 0.040439 Going to ngkpt 80 1 1,  gives: DFPT: 0.040052 Finite-differences: 0.040054 The DFPT with ngkpt 320 1 1 gives 0.040055.">tests/v6/Input/t66.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v6/Input/t67.in" title="Charged (He dimer)+,  with bare pseudopotential. ixc=7 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  like the previous one. Going to ngkpt 80 1 1 gives Finite-differences: 0.022275 The DFPT with ngkpt 320 1 1 gives 0.022279 . (To obtain the finite-difference results,  one has to reactivate the dtset 15 case) Cannot be executed on more that 1 MPI proc due to different values of nband_k">tests/v6/Input/t67.in</a></li>
</ul>
<p><em>v8:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v8/Input/t49.in" title="AlAs,  zinc-blende structure. Code anaddb Analyse the DDB from test t48,  for the generation of the nonlinear coefficients and the first order change of the dielectric tensor.">tests/v8/Input/t49.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v8/Input/t50.in" title="AlAs,  zinc-blende structure. Code anaddb Analyse the DDB from test 48,  for the generation of the nonlinear coefficients only.">tests/v8/Input/t50.in</a></li>
</ul>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Optic/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Optic/" class="btn btn-xs btn-link">
        Optic
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../multidtset/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../multidtset/" class="btn btn-xs btn-link">
        Multidtset
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
<hr>

    <center>Abinit version 8.5.4</center>


<center>Copyright &copy; 2017 The Abinit Group (RC, XG)</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
</footer>

</body>
</html>