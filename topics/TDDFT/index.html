<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="The Abinit group">
    <link rel="canonical" href="http://www.abinit.org/topics/TDDFT/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>TDDFT - abinit</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../css/codehilite.css" rel="stylesheet">
    <link href="../../css/extra.css" rel="stylesheet">
    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <!-- <script src="../../js/somelib.js"></script> -->

    <!-- Jquery from Google CDN 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    -->

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS 

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    -->
    <!-- Optional theme

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    -->
    <!-- Latest compiled and minified JavaScript

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->

    <!-- MathJax support -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    <!--
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 
    -->

    <!--
    Configure MathJax to produce automatic equation numbers
    http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->


    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Introduction", url: "#introduction", children: [
          ]},
          {title: "Related Input Variables", url: "#related-input-variables", children: [
          ]},
          {title: "Selected Input Files", url: "#selected-input-files", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      <script src="../../extra_javascript/abidocs.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../TDepES/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../TDepES/" class="btn btn-xs btn-link">
        TDepES
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Susceptibility/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Susceptibility/" class="btn btn-xs btn-link">
        Susceptibility
      </a>
    </div>
    
  </div>

    

    <h2 id="introduction"><strong> Introduction </strong><a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>For finite systems (atoms and molecules), excited states can be computed
within TDDFT (Casida approach - only norm-conserving pseudopotentials). See
the explanations given in the <a class="wikilink" href="../../tutorials/tddft">lesson:tddft</a> lesson of tutorial. The
<a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a> input variable must be set to -1.</p>
<p>In the non-spin-polarized case, spin-singlet as well as spin-triplet
excitations are computed. Spin-polarized case is also available.</p>
<h2 id="related-input-variables"><strong> Related Input Variables </strong><a class="headerlink" href="#related-input-variables" title="Permanent link">&para;</a></h2>
<p><em>basic:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/gstate/#boxcenter">boxcenter</a>  BOX CENTER</li>
</ul>
<p><em>compulsory:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/basic/#iscf">iscf</a>  Integer for Self-Consistent-Field cycles</li>
</ul>
<p><em>useful:</em></p>
<ul>
<li><a class="wikilink" href="../../input_variables/basic/#ixc">ixc</a>  Index of eXchange-Correlation functional</li>
<li><a class="wikilink" href="../../input_variables/dfpt/#td_maxene">td_maxene</a>  Time-Dependent dft : MAXimal kohn-sham ENErgy difference</li>
<li><a class="wikilink" href="../../input_variables/dfpt/#td_mexcit">td_mexcit</a>  Time-Dependent dft : Maximal number of EXCITations</li>
<li><a class="wikilink" href="../../input_variables/internal/#xclevel">xclevel</a>  eXchange Correlation functional LEVEL</li>
</ul>
<h2 id="selected-input-files"><strong> Selected Input Files </strong><a class="headerlink" href="#selected-input-files" title="Permanent link">&para;</a></h2>
<p><em>paral:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/paral/Input/t05.in" title="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized">tests/paral/Input/t05.in</a></li>
</ul>
<p><em>v1:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v1/Input/t69.in" title="Excited states of the Mg atom,  with (ixc=1,  spin-polarized Teter functional). Use the multi-dataset mode. Can be compared with the results in Vasiliev et al,  PRL 82,  1919 (1999). With the values acell 18,  ecut 3.5,  nband2 10,  the present test generates KS diff=3.46eV,  TDLDA(1S1P)=4.48eV,  TDLDA(1S3P)=2.81eV With the values acell 22,  ecut 3.5,  nband2 22,  ABINIT generates KS diff=3.40eV,  TDLDA(1S1P)=4.35eV,  TDLDA(1S3P)=2.77eV Vasiliev gets KS diff=3.39eV,  TDLDA(1S1P)=4.34eV,  TDLDA(1S3P)=2.79eV">tests/v1/Input/t69.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v1/Input/t70.in" title="Same as test 69,  but with another xc functional (ixc=7,  PW92 LSD) With the values acell 18,  ecut 3.5,  nband2 10,  the present test generates KS diff=3.46eV,  TDLDA(1S1P)=4.45eV,  TDLDA(1S3P)=2.84eV">tests/v1/Input/t70.in</a></li>
</ul>
<p><em>v2:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v2/Input/t42.in" title="(HeH)+ in a big box. Computation of excitation energies in TDDFT, in the following approximations : TDxOEP/xOEP,  TDLDA/xOEP, BPG hybrid/xOEP.">tests/v2/Input/t42.in</a></li>
</ul>
<p><em>v3:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v3/Input/t55.in" title="N2 molecule non-spin-polarized,  in a big box. Compute excitation energies,  as well as Cauchy coefficients. The Cauchy (-2) coefficient is the low-frequency optical polarisability. The present test uses a small box (6x5x5 Angstrom), a small energy cut-off (25 Ha),  and only 12 states. Two different exchange-correlation functionals are treated : ixc=1 (Teter93), and ixc=7 (PW92). Experimental values are taken from Goerling at al, J. Chem. Phys. 110,  2785 (1999)). Experimental values for the singlet excitation energies are : 1pi_g 9.31eV  1sig_u- 9.92eV  1del_u 10.27eV The present test gives 1pi_g 9.47eV  1sig_u- 9.91eV  1del_u 10.45eV With a larger box (8x7x7) 1pi_g 9.33eV  1sig_u- 9.84eV  1del_u 10.38eV With a larger cutoff (60Ha) 1pi_g 9.38eV  1sig_u- 9.77eV  1del_u 10.31eV With a larger number of states (30) 1pi_g 9.44eV  1sig_u- 9.91eV  1del_u 10.45eV Experimental values for the Cauchy coefficients are: (These values should be updated,  the real ones are smaller by a few percent,  because a buffer has been introduced in tddft.f) (-2) 11.74au,  (-4) 30.11au,  (-6) 101.8au The present test gives (-2) 8.012au,  (-4) 27.83au,  (-6) 108.4au With a larger box (8x7x7) (-2) 7.112au,  (-4) 25.51au,  (-6) 102.2au With a larger cutoff (60Ha) (-2) 7.717au,  (-4) 26.87au,  (-6) 104.6au With a larger number of states (30) (-2) 11.70au,  (-4) 34.56au,  (-6) 123.3au (The larger number of states is important to give reasonable values ...) Experimental values for the triplet excitation energies are : 3pi_g 7.75eV  3sig_u+ 8.04eV  3del_u 8.88eV 3sig_u- 9.67eV 3pi_u 11.19eV The present test gives 3pi_g 7.83eV  3sig_u+ 8.11eV  3del_u 9.06eV 3sig_u- 9.91eV 3pi_u 10.91eV With a larger box (8x7x7) 3pi_g 7.70eV  3sig_u+ 8.13eV  3del_u 9.04eV 3sig_u- 9.85eV 3pi_u 10.71eV With a larger cutoff (60Ha) 3pi_g 7.73eV  3sig_u+ 7.88eV  3del_u 8.88eV 3sig_u- 9.77eV 3pi_u 10.44eV With a larger number of states (30) 3pi_g 7.83eV  3sig_u+ 8.04eV  3del_u 9.04eV 3sig_u- 9.91eV 3pi_u 10.90eV Note that the use of the PW92 functional instead of the Teter93 functional does not affect the singlet values, but have some effects on the triplet values: they change from 3pi_g 7.83eV  3sig_u+ 8.11eV  3del_u 9.06eV 3sig_u- 9.91eV 3pi_u 10.91eV to 3pi_g 7.85eV  3sig_u+ 8.16eV  3del_u 9.08eV 3sig_u- 9.91eV 3pi_u 10.93eV In the Goerling paper,  still another functional was used, the Vosko-Wilk-Nussair one, whose spin dependence is not very accurate,  hence the large differences for the triplet states. When this functional will be coded in ABINIT,  it will be worth to complete the present test.">tests/v3/Input/t55.in</a></li>
</ul>
<p><em>v5:</em></p>
<ul>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t61.in" title="N2 molecule non-spin-polarized,  but treated with nsppol=2,  in a big box. Similar to test 55 of tests/v3. There should be only small numerical differences with respect to datasets 1 and 2 of this test, due to the fact that the tetragonal symmetry was here slightly broken for sake of portability of the automatic test. Note however that the singlet and triplet states cannot be disentagled, so one gets a big list of excitations,  the merge of singlet and triplet excitations.">tests/v5/Input/t61.in</a></li>
<li><a class="wikilink" data-placement="auto bottom" data-toggle="popover" data-trigger="hover" href="../../tests/v5/Input/t62.in" title="BeH spin-polarized,  in a supercell Test the spin-polarized TDDFT implementation. nband 20,  ecut 8,  acell 14 14 14 . For the first two excitations,  one finds : 2.40967E+00 eV,  doubly degenerate  (Pi excitation) 3.94165E+00 eV  (Sigma+ excitation) They come mainly from the 2nd occupied Kohn-Sham state,  spin up. The third excitation,  at 5.11592E+00 eV (Sigma+ excitation) comes mainly from the 1st occupied Kohn-Sham state,  spin down. Then,  come excitations that are in the continuum,  or close to it (depending on the parameters of the calculation),  so,  harder to converge, In order to have a calculation converged at the level of 0.1 eV,  one needs parameters like nband 40,  ecut 10,  acell 30. In that case,  the three above-mentioned excitations become 2.388 eV (Pi),  4.432 eV (Sigma+),  5.357 eV (Sigma+). In this case,  the latter is no more the third excitation,  as other ones, coupled to the vacuum have a lower energy. These numbers can be compared to the values given by J. Guan,  ME Casida,  DR Salahub,  J. of Mol. Structure - Theochem 527, 229,  Sp. Iss. SI (2000) : 2.391 eV (1Pi),  4.593 eV (2Sigma+),  5.418 eV (5Sigma+), and to the experimental values (see the above paper) 2.56 eV/2.484 eV,  5.51 eV,  6.71 eV.">tests/v5/Input/t62.in</a></li>
</ul>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../TDepES/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../TDepES/" class="btn btn-xs btn-link">
        TDepES
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Susceptibility/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Susceptibility/" class="btn btn-xs btn-link">
        Susceptibility
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
<hr>

    <center>Abinit version 8.5.4</center>


<center>Copyright &copy; 2017 The Abinit Group (FJ)</center>


<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
</footer>

</body>
</html>