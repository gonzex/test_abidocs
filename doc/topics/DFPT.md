---
!!python/unicode 'authors': MT
!!python/unicode 'rpath': !!python/unicode '/topics/DFPT.md'
---
<!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->

This page gives hints on how to generically perform DFPT calculations with the ABINIT package.

## Introduction

Density-Functional Perturbation Theory (DFPT) allows one to address a large
variety of physical observables. Many properties of interest can be computed
directly from the derivatives of the energy, without the use of finite
differences: phonons modes, elastic tensors, effective charges, dielectric
tensors, etc... Even non-linear properties can be computed, like the Raman
intensities (for the latter, see [[topic_nonlinear]])..

A DFPT calculation workflow is conducted as follows:

* Run a Ground-State calculation in order to extract the Kohn-Sham pseudo wave-functions; these must be extremely well converged.
* If necessary, e.g., for the application of the derivative of the Hamiltonian with respect to an electric field, determine the derivatives of the wave functions with respect to the wave vector **k**, and keep them in a file. The keyword [[rfddk]] is used to perform this type of calculation.
* Compute the 2nd-order derivative matrix (i.e., 2nd derivatives of the energy with respect to different perturbations λ). This can be done thanks to the keywords [[rfphon]] (λ=atomic displacement), [[rfstrs]] (λ=strain), [[rfelfd]] (λ=electric field) or [[rfmagn]] (λ=magnetic field). 
* Launch the anaddb tool (distributed with ABINIT) to analyse the derivative database and compute relaxed tensors and thermodynamical properties.

Note that for PAW calculation, when performing the post-processing with
anaddb, it is recommended to include all the keywords enforcing the sum rules
(acoustic sum and charge neutrality). Indeed the PAW formalism involves, for
each atom, the calculation of a large number of real space integrals, whose
numerical effect may be to break the translational invariance.

Thanks to the locality provided by PAW partial wave basis, it is possible to
perform response function calculations for correlated electron materials. The
LDA+U formalism is usable without any restriction for the PAW+DFPT
calculations.

All the tutorials dedicated to response functions can be followed both with
norm-conserving pseudopotentials and with PAW atomic datasets.

More detailed explanations to perform a response calculation are given in the
[help_respfn ](../../users/generated_files/help_respfn.html)file.



## Related Input Variables

*basic:*

- [[abinit:rfatpol]]  Response Function : ATomic POLarisation
- [[abinit:rfddk]]  Response Function with respect to Derivative with respect to K
- [[abinit:rfelfd]]  Response Function with respect to the ELectric FielD
- [[abinit:rfmagn]]  Response Function with respect to MAGNetic B-field perturbation
- [[abinit:rfphon]]  Response Function with respect to PHONons
- [[abinit:rfstrs]]  Response Function with respect to STRainS
 
*compulsory:*

- [[abinit:optdriver]]  OPTions for the DRIVER
- [[abinit:rfdir]]  Response Function : DIRections
 
*expert:*

- [[abinit:frzfermi]]  FReeZe FERMI energy
- [[abinit:pawcross]]  PAW - add CROSS term in oscillator strengths
- [[abinit:rf2_dkdk]]  Response Function : 2nd Derivative of wavefunctions with respect to K
- [[abinit:rfmeth]]  Response Function METHod
- [[abinit:rfuser]]  Response Function, USER-defined
- [[abinit:scphon_supercell]]  Self Consistent PHONon SUPERCELL
- [[abinit:scphon_temp]]  Self Consistent PHONon TEMPerature
 
*internal:*

- [[abinit:qptn]]  Q-PoinT re-Normalized
 
*useful:*

- [[abinit:asr]]  Acoustic Sum Rule
- [[abinit:dfpt_sciss]]  DFPT SCISSor operator
- [[abinit:getwfkfine]]  GET the fine grid wavefunctions from _WFK file
- [[abinit:ird1wf]]  Integer that governs the ReaDing of _1WF files 
- [[abinit:irdddk]]  Integer that governs the ReaDing of DDK wavefunctions, in _1WF files
- [[abinit:irdwfq]]  Integer that governs the ReaDing of _WFQ files
 

## Selected Input Files

*v4:*

- [[tests/v4/Input/t66.in]]
- [[tests/v4/Input/t63.in]]
 
*v5:*

- [[tests/v5/Input/t05.in]]
- [[tests/v5/Input/t30.in]]
 
*v6:*

- [[tests/v6/Input/t89.in]]
- [[tests/v6/Input/t62.in]]
- [[tests/v6/Input/t63.in]]
 
*v7:*

- [[tests/v7/Input/t43.in]]
- [[tests/v7/Input/t45.in]]
 
*v8:*

- [[tests/v8/Input/t07.in]]
- [[tests/v8/Input/t20.in]]
 

## Tutorials

* [[lesson_rf1|The lesson Response-Function 1 (RF1)]] presents the basics of DFPT calculations within ABINIT. The example given is the study of dynamical and dielectric properties of AlAs (an insulator): phonons at Gamma, dielectric constant, Born effective charges, LO-TO splitting, phonons in the whole Brillouin zone. The creation of the "Derivative Data Base" (DDB) is presented.
* [[lesson_rf2|The lesson Response-Function 2 (RF2)]] presents the analysis of the DDBs that have been introduced in the preceeding lesson RF1. The computation of the interatomic forces and the computation of thermodynamical properties is an outcome of this lesson.
* [[lesson_elastic|The lesson on the elastic properties]] presents the computation with respect to the strain perturbation and its responses: elastic constants, piezoelectricity.
* [[lesson_paral_dfpt|Parallelism of response-function calculations]]. Additional information to use the DFPT in parallel.
* [[lesson_nlo|Lesson on static non-linear properties]]. Electronic non-linear susceptibility, non-resonant Raman tensor, electro-optic effect.

