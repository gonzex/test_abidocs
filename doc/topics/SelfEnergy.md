---
authors: MG
description: SelfEnergy Abinit topic
rpath: /topics/SelfEnergy.md
---
<!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->

This page gives hints on how to compute the electronic self-energy (due to electron-electron interaction) with the ABINIT package.

## Introduction

In principle, the exact self-energy can be obtained by solving self-
consistently the set of coupled integro-differential equations proposed by
Hedin [[Hedin1965]]. The fundamental building blocks of Hedin's equations are,
besides Σ(1,2), the Green's function of the interacting many-body system,
G(1,2), the Green's function of an appropriate noninteracting system, G0(1,2),
and the irreducible polarizability, χ(1,2), which, through the inverse
dielectric matrix ε-1(1,2), re-normalizes the static Coulomb potential,
resulting in the dynamical screened interaction W(1,2). Finally, the vertex
function Γ(1,2,3) describes the interactions between virtual holes and
electrons.

A typical self-energy calculation combines a quasi-particle band structure
with a screened interaction and possibly a vertex correction to the QP
corrections ([[optdriver]]=4).

In the frequency domain, the GW self-energy Σ(ω) can be evaluated in ABINIT
with two different, more effective, techniques:

* integration with a plasmon-pole model (PPM)
* integration with contour deformation (CD).

In the former case, the frequency dependence of ε-1(ω) is modeled with a
simple analytic form, and the frequency convolution is carried out
analytically.

In the latter approach, the integral is evaluated numerically extending the
functions in the complex plane in order have a smoother integrand.

Four different plasmon pole models (PPMs) are available in ABINIT. The choice
of the particular PPM to be used is controlled by the variable [[ppmodel]].
The first two options ([[ppmodel]]=1,2) refer to approximations employed in
the pioneering implementations of the GW formalism: the plasmon-pole models of
Godby-Needs [[Godby1989]] (GN) and Hybertsen and Louie [[Hybertsen1986]] (HL).

The contour deformation technique is activated by setting the input variable
[[gwcalctyp]] to 2. The integration along the imaginary axis requires the
calculation of ε-1(ω) for purely imaginary frequencies. The frequency mesh for
the quadrature is governed by the input variable [[nfreqim]], and can be very
coarse since the integrands is very smooth in this region.

The evaluation of the residue of the poles requires the calculation of ε-1(ω)
on a fine mesh along the real axis. This regular mesh, sampling the interval
[0,+∞], is defined by the two input variables [[nfreqre]] and [[freqremax]].

The CD approach requires many evaluations of ε-1(ω) and can therefore be
computationally highly demanding. On the other hand, it is the preferred
approach for calculating the QP correction of low-lying states. Moreover, it
is the only technique available in ABINIT to compute the imaginary part of
Σ(ω) and the spectral function A(ω).

It is possible to disable the full computation, and actually do an Hartree-
Fock, screened exchange or COHSEX calculation.

As vertex corrections, the bootstrap kernel and others can be included in the
self-consistent W. The Faleev method, see PRL 93, 126406 (2004), is
implemented.

Convergence over the number of unoccupied band is much improved with respect
to usual implementations of GW, thanks to the "extrapolar" method.

The frequency meshes, used e.g. for integration along the real and imaginary
axes are described in [[topic_FrequencyMeshMBPT]].



## Related Input Variables

*basic:*

- [[abinit:bdgw]]  BanDs for GW calculation
- [[abinit:freqspmax]]  FREQuencies for the SPectral function MAXimum
- [[abinit:freqspmin]]  FREQuencies for the SPectral function MINimum
- [[abinit:gwcalctyp]]  GW CALCulation TYPe
- [[abinit:gwpara]]  GW PARAllelization level
- [[abinit:icutcoul]]  Integer that governs the CUT-off for COULomb interaction
- [[abinit:kptgw]]  K-PoinTs for GW calculations
- [[abinit:nfreqsp]]  Number of FREQuencies for the SPectral function
- [[abinit:nkptgw]]  Number of K-PoinTs for GW corrections
- [[abinit:nomegasi]]  Number of OMEGA(S) along the Imaginary axis
- [[abinit:omegasimax]]  OMEGA to evaluate Sigma along the Imaginary axis D: MAXimal value
- [[abinit:omegasrdmax]]  OMEGA to evaluate the Sigma Real axis Derivative : MAXimal value
- [[abinit:ppmfrq]]  Plasmon Pole Model FReQuency
- [[abinit:ppmodel]]  Plasmon Pole MODEL
- [[abinit:rcut]]  Radius of the CUT-off for coulomb interaction
- [[abinit:vcutgeo]]  V (potential) CUT-off GEOmetry
 
*compulsory:*

- [[abinit:ecutsigx]]  Energy CUT-off for SIGma eXchange
- [[abinit:ecutwfn]]  Energy CUT-off for WaveFunctioNs
- [[abinit:optdriver]]  OPTions for the DRIVER
 
*expert:*

- [[abinit:einterp]]  Electron bands INTERPolation
- [[abinit:fftgw]]  FFT for GW calculation
- [[abinit:freqim_alpha]]  FREQuencies along the IMaginary axis ALPHA parameter
- [[abinit:gw_invalid_freq]]  GW treatment of INVALID FREQuency for Hybertsen-Louie PPM
- [[abinit:gw_nqlwl]]  GW, Number of Q-points for the Long Wave-Length Limit
- [[abinit:gw_qlwl]]  GW, Q-points for the Long Wave-Length limit
- [[abinit:gw_sigxcore]]  GW, SIGma (self-energy) for the CORE contribution
- [[abinit:gwgamma]]  GW GAMMA
- [[abinit:gwmem]]  GW MEMory
- [[abinit:kssform]]  Kohn Sham Structure file FORMat
- [[abinit:npwkss]]  Number of PlaneWaves in the KSS file
- [[abinit:pawoptosc]]  PAW - OPTion for the computation of the OSCillator matrix elements
- [[abinit:symsigma]]  SYMmetrization of SIGMA matrix elements
- [[abinit:zcut]]  Z-CUT
 
*internal:*

- [[abinit:npwsigx]]  Number of PlaneWaves for SIGma eXchange
- [[abinit:npwwfn]]  Number of PlaneWaves for WaveFunctioNs
 
*useful:*

- [[abinit:getqps]]  GET QuasiParticle Structure
- [[abinit:getscr]]  GET SCReening (the inverse dielectric matrix) from ...
- [[abinit:getsuscep]]  GET SUSCEPtibility (the irreducible polarizability) from ...
- [[abinit:gw_qprange]]  GW QuasiParticle RANGE policy
- [[abinit:gwcomp]]  GW COMPleteness
- [[abinit:gwencomp]]  GW ENergy for COMPleteness
- [[abinit:irdqps]]  Integer that governs the ReaDing of QuasiParticle Structure
- [[abinit:irdscr]]  Integer that governs the ReaDing of the SCReening
- [[abinit:irdsuscep]]  Integer that governs the ReaDing of the SUSCEPtibility
- [[abinit:mbpt_sciss]]  Many Body Perturbation Theory SCISSor operator
- [[abinit:nbandkss]]  Number of BANDs in the KSS file
- [[abinit:nomegasrd]]  Number of OMEGA to evaluate the Sigma Real axis Derivative
- [[abinit:usepawu]]  USE PAW+U (spherical part)
 

## Selected Input Files

No input file associated to this topic.

## Tutorials

* [The first lesson on GW (GW1)](../../tutorial/generated_files/lesson_gw1.html) deals with the computation of the quasi-particle band gap of Silicon (semiconductor), in the GW approximation (much better than the Kohn-Sham LDA band structure), with a plasmon-pole model. 
* [The second lesson on GW (GW2)](../../tutorial/generated_files/lesson_gw2.html) deals with the computation of the quasi-particle band structure of Aluminum, in the GW approximation (so, much better than the Kohn-Sham LDA band structure) without using the plasmon-pole model. 
* [Parallelism of Many-Body Perturbation calculations (GW)](../../tutorial/generated_files/lesson_paral_mbt.html) allows to speed up the calculation of accurate electronic structures (quasi-particle band structure, including many-body effects).

