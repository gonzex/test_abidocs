---
authors: MG
rpath: /topics/GW.md
---
<!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->

This page gives hints on how to perform a GW calculation, including self-consistency with the ABINIT package.

## Introduction

DFT performs reasonably well for the determination of structural properties,
but fails to predict accurate band gaps. A more rigorous framework for the
description of excited states is provided by many-body perturbation theory
(MBPT) [[Fetter1971]],[[Abrikosov1975]], based on the Green's functions
formalism and the concept of quasi-particles [[Onida2002]].

Within MBPT, one can calculate the quasi-particle (QP) energies, E, and
amplitudes, Ψ, by solving a nonlinear equation involving the non-Hermitian,
nonlocal and frequency dependent self-energy operator Σ.

This equation goes beyond the mean-field approximation of independent KS
particles as it accounts for the dynamic many-body effects in the electron-
electron interaction.

Details about the GW implementation in ABINIT can be found
[here](../../theory/generated_files/theorydoc_mbt.html).

A typical GW calculation consists of two different steps (following a DFT
calculation): first the screened interaction ε-1 is calculated and stored on
disk ([[optdriver]]=3), then the KS band structure and W are used to evaluate
the matrix elements of Σ, finally obtaining the QP corrections
([[optdriver]]=4).

The computation of the screened interaction is described in
[[topic_Susceptibility]], while the computation of the self-energy is
described in [[topic_SelfEnergy]]. The frequency meshes, used e.g. for
integration along the real and imaginary axes are described in
[[topic_FrequencyMeshMBPT]].



## Related Input Variables

*basic:*

- [[abinit:bdgw]]  BanDs for GW calculation
- [[abinit:gw_nstep]]  GW Number of self-consistent STEPs
- [[abinit:gw_sctype]]  GW, Self-Consistency TYPE
- [[abinit:gw_toldfeig]]  GW TOLerance on the DiFference of the EIGenvalues
- [[abinit:gwcalctyp]]  GW CALCulation TYPe
- [[abinit:gwpara]]  GW PARAllelization level
 
*compulsory:*

- [[abinit:optdriver]]  OPTions for the DRIVER
 
*expert:*

- [[abinit:fftgw]]  FFT for GW calculation
- [[abinit:gw_nqlwl]]  GW, Number of Q-points for the Long Wave-Length Limit
 
*useful:*

- [[abinit:getqps]]  GET QuasiParticle Structure
- [[abinit:getscr]]  GET SCReening (the inverse dielectric matrix) from ...
- [[abinit:getsuscep]]  GET SUSCEPtibility (the irreducible polarizability) from ...
- [[abinit:gwfockmix]]  GW FOCK exchange MIXing parameter
- [[abinit:irdqps]]  Integer that governs the ReaDing of QuasiParticle Structure
- [[abinit:irdscr]]  Integer that governs the ReaDing of the SCReening
- [[abinit:irdsuscep]]  Integer that governs the ReaDing of the SUSCEPtibility
- [[abinit:mbpt_sciss]]  Many Body Perturbation Theory SCISSor operator
- [[abinit:nbandkss]]  Number of BANDs in the KSS file
- [[abinit:nsym]]  Number of SYMmetry operations
- [[abinit:rhoqpmix]]  RHO QuasiParticle MIXing
- [[abinit:symmorphi]]  SYMMORPHIc symmetry operation selection
- [[abinit:usepawu]]  USE PAW+U (spherical part)
 

## Selected Input Files

*v3:*

- [[tests/v3/Input/t30.in]]
- [[tests/v3/Input/t31.in]]
 
*v4:*

- [[tests/v4/Input/t84.in]]
- [[tests/v4/Input/t85.in]]
 
*v5:*

- [[tests/v5/Input/t65.in]]
- [[tests/v5/Input/t66.in]]
- [[tests/v5/Input/t69.in]]
 

## Tutorials

* [The first lesson on GW (GW1)](../../tutorial/generated_files/lesson_gw1.html) deals with the computation of the quasi-particle band gap of Silicon (semiconductor), in the GW approximation (much better than the Kohn-Sham LDA band structure), with a plasmon-pole model. 
* [The second lesson on GW (GW2)](../../tutorial/generated_files/lesson_gw2.html) deals with the computation of the quasi-particle band structure of Aluminum, in the GW approximation (so, much better than the Kohn-Sham LDA band structure) without using the plasmon-pole model. 
* [Parallelism of Many-Body Perturbation calculations (GW)](../../tutorial/generated_files/lesson_paral_mbt.html) allows to speed up the calculation of accurate electronic structures (quasi-particle band structure, including many-body effects).

