
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="'basic input variables'">
      
      
        <link rel="canonical" href="http://www.abinit.org/variables/basic/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="shortcut icon" href="../../images/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.10.1">
    
    
      
        <title>Basic - abinit</title>
      
    
    
    
      <script src="../../assets/javascripts/modernizr-e826f8942a.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}",
                  kq: "{\\kk + \\qq}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link rel="stylesheet" href="../../assets/stylesheets/application-a20f419c8e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-23f75ab9c7.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">

      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="http://www.abinit.org" title="abinit" class="md-logo md-header-nav__button">
            <img src="../../images/logo-abinit-2015.svg" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Variables
                </span>
              
                <span class="md-header-nav__parent">
                  Abinit
                </span>
              
            
            Basic
          
        </span>
      </div>
        
      <!-- Guided Tour with introjs. Add glow effect to button only if homepage -->
      <div class="md-flex__cell md-flex__cell--shrink">
           
          
          <a href="#" class="btn btn-xs btn-default  " id="guided-tour-button" title="Guided Tour" 
              onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>

      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      

      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.5.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
            <li><a href="#">8.2.0</a></li>
            
            <li><a href="#">8.1.0</a></li>
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user-guide/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Variables" class="md-tabs__link md-tabs__link--active">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorials/welcome/" title="Lessons" class="md-tabs__link">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/wavefunctions/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <div class="md-nav__button md-logo">
      
        
          <img src="../../images/logo-abinit-2015.svg">
        
      
    </div>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/help_what_ABINIT_does/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/new_user/" title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Basic
      </label>
    
    <a href="./" title="Basic" class="md-nav__link md-nav__link--active">
      Basic
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#accuracy" title="accuracy" class="md-nav__link">
    accuracy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acell" title="acell" class="md-nav__link">
    acell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#angdeg" title="angdeg" class="md-nav__link">
    angdeg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecut" title="ecut" class="md-nav__link">
    ecut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#einterp" title="einterp" class="md-nav__link">
    einterp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iscf" title="iscf" class="md-nav__link">
    iscf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ixc" title="ixc" class="md-nav__link">
    ixc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jdtset" title="jdtset" class="md-nav__link">
    jdtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kpt" title="kpt" class="md-nav__link">
    kpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptnrm" title="kptnrm" class="md-nav__link">
    kptnrm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptopt" title="kptopt" class="md-nav__link">
    kptopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natom" title="natom" class="md-nav__link">
    natom
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nband" title="nband" class="md-nav__link">
    nband
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nbandhf" title="nbandhf" class="md-nav__link">
    nbandhf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ndtset" title="ndtset" class="md-nav__link">
    ndtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngkpt" title="ngkpt" class="md-nav__link">
    ngkpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpath" title="nkpath" class="md-nav__link">
    nkpath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpt" title="nkpt" class="md-nav__link">
    nkpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpthf" title="nkpthf" class="md-nav__link">
    nkpthf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nshiftk" title="nshiftk" class="md-nav__link">
    nshiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nsppol" title="nsppol" class="md-nav__link">
    nsppol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nstep" title="nstep" class="md-nav__link">
    nstep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nsym" title="nsym" class="md-nav__link">
    nsym
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntypat" title="ntypat" class="md-nav__link">
    ntypat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#occopt" title="occopt" class="md-nav__link">
    occopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rprim" title="rprim" class="md-nav__link">
    rprim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rprimd" title="rprimd" class="md-nav__link">
    rprimd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scalecart" title="scalecart" class="md-nav__link">
    scalecart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shiftk" title="shiftk" class="md-nav__link">
    shiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symrel" title="symrel" class="md-nav__link">
    symrel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tnons" title="tnons" class="md-nav__link">
    tnons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toldfe" title="toldfe" class="md-nav__link">
    toldfe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toldff" title="toldff" class="md-nav__link">
    toldff
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolrff" title="tolrff" class="md-nav__link">
    tolrff
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolvrs" title="tolvrs" class="md-nav__link">
    tolvrs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolwfr" title="tolwfr" class="md-nav__link">
    tolwfr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typat" title="typat" class="md-nav__link">
    typat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#udtset" title="udtset" class="md-nav__link">
    udtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usewvl" title="usewvl" class="md-nav__link">
    usewvl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wtk" title="wtk" class="md-nav__link">
    wtk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_hgrid" title="wvl_hgrid" class="md-nav__link">
    wvl_hgrid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xangst" title="xangst" class="md-nav__link">
    xangst
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xcart" title="xcart" class="md-nav__link">
    xcart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xred" title="xred" class="md-nav__link">
    xred
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#znucl" title="znucl" class="md-nav__link">
    znucl
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connections/" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/welcome/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#accuracy" title="accuracy" class="md-nav__link">
    accuracy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acell" title="acell" class="md-nav__link">
    acell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#angdeg" title="angdeg" class="md-nav__link">
    angdeg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecut" title="ecut" class="md-nav__link">
    ecut
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#einterp" title="einterp" class="md-nav__link">
    einterp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iscf" title="iscf" class="md-nav__link">
    iscf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ixc" title="ixc" class="md-nav__link">
    ixc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jdtset" title="jdtset" class="md-nav__link">
    jdtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kpt" title="kpt" class="md-nav__link">
    kpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptnrm" title="kptnrm" class="md-nav__link">
    kptnrm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kptopt" title="kptopt" class="md-nav__link">
    kptopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natom" title="natom" class="md-nav__link">
    natom
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nband" title="nband" class="md-nav__link">
    nband
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nbandhf" title="nbandhf" class="md-nav__link">
    nbandhf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ndtset" title="ndtset" class="md-nav__link">
    ndtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ngkpt" title="ngkpt" class="md-nav__link">
    ngkpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpath" title="nkpath" class="md-nav__link">
    nkpath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpt" title="nkpt" class="md-nav__link">
    nkpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nkpthf" title="nkpthf" class="md-nav__link">
    nkpthf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nshiftk" title="nshiftk" class="md-nav__link">
    nshiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nsppol" title="nsppol" class="md-nav__link">
    nsppol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nstep" title="nstep" class="md-nav__link">
    nstep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nsym" title="nsym" class="md-nav__link">
    nsym
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ntypat" title="ntypat" class="md-nav__link">
    ntypat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#occopt" title="occopt" class="md-nav__link">
    occopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rprim" title="rprim" class="md-nav__link">
    rprim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rprimd" title="rprimd" class="md-nav__link">
    rprimd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scalecart" title="scalecart" class="md-nav__link">
    scalecart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shiftk" title="shiftk" class="md-nav__link">
    shiftk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symrel" title="symrel" class="md-nav__link">
    symrel
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tnons" title="tnons" class="md-nav__link">
    tnons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toldfe" title="toldfe" class="md-nav__link">
    toldfe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toldff" title="toldff" class="md-nav__link">
    toldff
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolrff" title="tolrff" class="md-nav__link">
    tolrff
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolvrs" title="tolvrs" class="md-nav__link">
    tolvrs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolwfr" title="tolwfr" class="md-nav__link">
    tolwfr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typat" title="typat" class="md-nav__link">
    typat
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#udtset" title="udtset" class="md-nav__link">
    udtset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usewvl" title="usewvl" class="md-nav__link">
    usewvl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wtk" title="wtk" class="md-nav__link">
    wtk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wvl_hgrid" title="wvl_hgrid" class="md-nav__link">
    wvl_hgrid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xangst" title="xangst" class="md-nav__link">
    xangst
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xcart" title="xcart" class="md-nav__link">
    xcart
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xred" title="xred" class="md-nav__link">
    xred
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#znucl" title="znucl" class="md-nav__link">
    znucl
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                
                <!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->

<h1 id="basic-input-variables">basic input variables<a class="headerlink" href="#basic-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
basic input variables to be used in the input file for the abinit executable.</p>
<h2 id="accuracy"><strong>accuracy</strong><a class="headerlink" href="#accuracy" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ACCURACY<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform numerically precise calculations with planewaves or projector-
augmented waves and pseudopotentials" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Planewaves">topic_Planewaves</a>, <a class="wikilink topic-wikilink" data-content="How to control the SCF cycle" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [16/920] in all abinit tests, [3/116] in abinit tutorials</summary><ul><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Structural optimization run" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_1.in" target="_blank">telast_1.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Response function calculation for: * rigid-atom elastic tensor * rigid-atom piezoelectric tensor * interatomic force constants at gamma * Born effective charges" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_2.in" target="_blank">telast_2.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Alternative response function calculation for some rigid-atom piezoelectric tensor elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_5.in" target="_blank">telast_5.in</a></li><li>v1:  <a class="wikilink abifile-wikilink" data-content="O2 molecule,  treated like a metal (there is a degeneracy at the Fermi level), occopt=4 and tsmear=0.04,  with nsppol=2 . Use spinat to polarize the molecule at start. Gives total energy of -32.09317 Hartree This test can be used to check the accuracy of stresses in the spin-polarized case. Setting acell(1:2) to 7.005 and 6.995 gives ETOT -32.090846193972 and -32.095501753750, ucvol  441.63023 and 440.37023 so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03, to be compared with sigma(1)=3.6949713786E-03 and sigma(2)=3.6949681083E-03 from the present test (the degeneracy is slightly lifted because of incomplete convergence, using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both sigma values)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="Helium FCC solid,  using bare potential,  but a relatively low cut-off. Cell parameter is 6.505 Bohr,  2 k points are used.  PBE GGA. Combined with test 29,  it is used to test the accuracy of the stress calculation. Output of the code are as follows : Energy=-2.835212586 Ha,  volume=68.814809 Bohr^3, stress=6.03381838E-04 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t28.in" target="_blank">t28.in</a></li><li>v2:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box : compute VERY accurately the derivatives of the energy,  by both symmetric finite-differences and direct computation of forces and 2DTE. Also test the interplay between istwfk/=1 in the GS calculation and istwfk==1 in the RF calculation (istwfk/=1 is not yet-991020- allowed for RF,  which is a shame) 1) Computation of the first-order derivative of the total energy With delta(xred)=0.0002,  one gets delta(etot)/delta(xred)=-3.145846551 With delta(xred)=0.0001,  one gets delta(etot)/delta(xred)=-3.145836932 The combination of both results,  in a higher-order finite difference formula gives -3.145833726 . The direct computation of forces at the target geometry gives -3.145833725869 . The agreement is perfect, taking into account the &amp;quot;limited&amp;quot; number of digits (10) of the finite-difference result. 2) Computation of the second-order derivative of the total energy With delta(xred)=0.0002,  one gets delta(dedt)/delta(xred)=188.73875 With delta(xred)=0.0001,  one gets delta(dedt)/delta(xred)=188.73837 The combination of both results,  in a higher-order finite difference formula gives 188.73824613 . The direct computation of 2DTE at the target geometry gives 188.73824613046 . The agreement at the level of 11 digits is also perfect." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t33.in" target="_blank">t33.in</a>, <a class="wikilink abifile-wikilink" data-content="Again H2 molecule in a big box (like test 33). With the same configuration and parameters as test 33, investigate the treatment of unoccupied states : use nband 2 and occopt 1,  causing occ 2.0 1.0 . The same results as with test 33 are obtained." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t34.in" target="_blank">t34.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box. Comparison of the modified Broyden algorithm (ionmov=3) with the original one (ionmov=2). Start with different values of xcart,  from 0.6 to 1.1,  by step of 0.1 . The number of Broyden steps needed to reach acceptable residual forces with the ionmov=3 algorithm are : 3,  2,  2,  3,  3,  4,  while with the ionmov=2 algorithms,  one get : 4,  3,  2,  5,  and then, either the algorithm does not converge within 8 steps,  or it converges to a saddle point of the energy ! This test was hard to make portable. This is why the tolerance for fldiff is very large." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t48.in" target="_blank">t48.in</a>, <a class="wikilink abifile-wikilink" data-content="Tin in the diamond structure,  with 2 special points Test the effect of spin-orbit coupling,  especially the electronic structure. Degeneracies at Gamma are correct ! (note that ecut and nkpt are too low for quantitative accuracy) Without spin-orbit (in eV),  dataset 4: -8.82682  1.26955 (x3) 1.30262 3.45296 (x3) With spin-orbit (in eV),  dataset 6: -8.82682  0.75225      1.30262 1.50965 (x2) 3.07128 3.62556 (x2)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t74.in" target="_blank">t74.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2. Use the x-only PBE functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.10691 Ha while finite differences gives : with delta(xred)=0.0002,  189.10790 Ha with delta(xred)=0.0001,  189.10703 Ha . Combining the results gives 189.10675 Ha. The agreement is quite good,  and might likely be improved by increasing tolvrs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2,  and preceeding test, but use the full XC PBE functional. Also,  tolvrs is better. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 188.81162533 Ha while finite differences gives : with delta(xred)=0.0002,  188.81213804 Ha with delta(xred)=0.0001,  188.81175352 Ha . Combining the results gives 188.81162525 Ha." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 8 of v3 but use the revPBE XC functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 188.66748730880 Ha while finite differences gives : with delta(xred)=0.0002,  188.66799915 Ha with delta(xred)=0.0001,  188.66761529 Ha . Combining the results gives 188.66748734 Ha. Excellent." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t70.in" target="_blank">t70.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 8 of v3 but use the RPBE XC functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 188.92567363225 Ha while finite differences gives : with delta(xred)=0.0002,  188.92618485 Ha with delta(xred)=0.0001,  188.92580145 Ha Combining the results gives 188.92567365 Ha Excellent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t71.in" target="_blank">t71.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="Test of Ca,  simple cubic,  2  k-point. Testing GS  energy and lobpcg algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t93.in" target="_blank">t93.in</a></li><li>v5:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and Wu-Cohen GGA. Similar to test v3#08 Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.49410411 Ha while finite differences gives : with delta(xred)=0.0002,  189.4945677  Ha with delta(xred)=0.0001,  189.49422003  Ha . Combining the results gives 189.4941041 Ha. Perfect !" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t29.in" target="_blank">t29.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test of input variable &amp;quot;accuracy&amp;quot; (F. Jollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t64.in" target="_blank">t64.in</a></li></ul></details><p>Allows to tune the accuracy of a calculation by setting automatically the
variables <a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a>, <a class="wikilink codevar-wikilink" href="../gstate#boxcutmin">boxcutmin</a>, <a class="wikilink codevar-wikilink" href="../gstate#fband">fband</a>, <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a>, <a class="wikilink codevar-wikilink" href="../rlx#tolmxf">tolmxf</a>,
<a class="wikilink codevar-wikilink" href="../dev#optforces">optforces</a>, <a class="wikilink codevar-wikilink" href="../gstate#timopt">timopt</a>, <a class="wikilink codevar-wikilink" href="../dev#npulayit">npulayit</a>, <a class="wikilink codevar-wikilink" href="../basic#nstep">nstep</a>, <a class="wikilink codevar-wikilink" href="../files#prteig">prteig</a>, <a class="wikilink codevar-wikilink" href="../files#prtden">prtden</a>,
and if <a class="wikilink codevar-wikilink" href="../internal#usepaw">%usepaw</a>=1, <a class="wikilink codevar-wikilink" href="../paw#pawecutdg">pawecutdg</a>, <a class="wikilink codevar-wikilink" href="../paw#bxctmindg">bxctmindg</a>, <a class="wikilink codevar-wikilink" href="../paw#pawxcdev">pawxcdev</a>, <a class="wikilink codevar-wikilink" href="../paw#pawmixdg">pawmixdg</a>,
<a class="wikilink codevar-wikilink" href="../paw#pawovlp">pawovlp</a>, <a class="wikilink codevar-wikilink" href="../paw#pawnhatxc">pawnhatxc</a>, according to the following table:</p>
<p>accuracy</p>
<p>|</p>
<p>1</p>
<p>|</p>
<p>2</p>
<p>|</p>
<p>3</p>
<p>|</p>
<p>4</p>
<p>|</p>
<p>5</p>
<p>|</p>
<p>6  </p>
<p>&mdash;|&mdash;|&mdash;|&mdash;|&mdash;|&mdash;|&mdash;  </p>
<p>ecut</p>
<p>|</p>
<p>E_min</p>
<p>|</p>
<p>E_med</p>
<p>|</p>
<p>E_med</p>
<p>|</p>
<p><strong>E_max</strong></p>
<p>|</p>
<p><strong>E_max</strong></p>
<p>|</p>
<p><strong>E_max</strong>  </p>
<p>pawecutdg</p>
<p>|</p>
<p>ecut</p>
<p>|</p>
<p>ecut</p>
<p>|</p>
<p>1.2*ecut</p>
<p>|</p>
<p><strong>1.5*ecut</strong></p>
<p>|</p>
<p>2*ecut</p>
<p>|</p>
<p>2*ecut  </p>
<p>fband</p>
<p>|</p>
<p><strong>0.5</strong></p>
<p>|</p>
<p><strong>0.5</strong></p>
<p>|</p>
<p><strong>0.5</strong></p>
<p>|</p>
<p><strong>0.5</strong></p>
<p>|</p>
<p>0.75</p>
<p>|</p>
<p>0.75  </p>
<p>boxcutmin</p>
<p>|</p>
<p>1.5</p>
<p>|</p>
<p>1.8</p>
<p>|</p>
<p>1.8</p>
<p>|</p>
<p><strong>2.0</strong></p>
<p>|</p>
<p><strong>2.0</strong></p>
<p>|</p>
<p><strong>2.0</strong>  </p>
<p>bxctmindg</p>
<p>|</p>
<p>1.5</p>
<p>|</p>
<p>1.8</p>
<p>|</p>
<p>1.8</p>
<p>|</p>
<p><strong>2.0</strong></p>
<p>|</p>
<p><strong>2.0</strong></p>
<p>|</p>
<p><strong>2.0</strong>  </p>
<p>pawxcdev</p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p>2</p>
<p>|</p>
<p>2  </p>
<p>pawmixdg</p>
<p>|</p>
<p><strong>0</strong></p>
<p>|</p>
<p><strong>0</strong></p>
<p>|</p>
<p><strong>0</strong></p>
<p>|</p>
<p><strong>0</strong></p>
<p>|</p>
<p>1</p>
<p>|</p>
<p>1  </p>
<p>pawovlp</p>
<p>|</p>
<p>10</p>
<p>|</p>
<p>7</p>
<p>|</p>
<p>7</p>
<p>|</p>
<p><strong>5</strong></p>
<p>|</p>
<p><strong>5</strong></p>
<p>|</p>
<p><strong>5</strong>  </p>
<p>pawnhatxc</p>
<p>|</p>
<p>0</p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong>  </p>
<p>tolvrs</p>
<p>|</p>
<p>1.0d-3</p>
<p>|</p>
<p>1.0d-5</p>
<p>|</p>
<p>1.0d-7</p>
<p>|</p>
<p>1.0d-9</p>
<p>|</p>
<p>1.0d-10</p>
<p>|</p>
<p>1.0d-12  </p>
<p>tolmxf</p>
<p>|</p>
<p>1.0d-3</p>
<p>|</p>
<p>5.0d-4</p>
<p>|</p>
<p>1.0d-4</p>
<p>|</p>
<p><strong>5.0d-5</strong></p>
<p>|</p>
<p>1.0d-6</p>
<p>|</p>
<p>1.0d-6  </p>
<p>optforces</p>
<p>|</p>
<p>1</p>
<p>|</p>
<p>1</p>
<p>|</p>
<p><strong>2</strong></p>
<p>|</p>
<p><strong>2</strong></p>
<p>|</p>
<p><strong>2</strong></p>
<p>|</p>
<p><strong>2</strong>  </p>
<p>timopt</p>
<p>|</p>
<p>0</p>
<p>|</p>
<p>0</p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong>  </p>
<p>npulayit</p>
<p>|</p>
<p>4</p>
<p>|</p>
<p><strong>7</strong></p>
<p>|</p>
<p><strong>7</strong></p>
<p>|</p>
<p><strong>7</strong></p>
<p>|</p>
<p>15</p>
<p>|</p>
<p>15  </p>
<p>nstep</p>
<p>|</p>
<p><strong>30</strong></p>
<p>|</p>
<p><strong>30</strong></p>
<p>|</p>
<p><strong>30</strong></p>
<p>|</p>
<p><strong>30</strong></p>
<p>|</p>
<p>50</p>
<p>|</p>
<p>50  </p>
<p>prteig</p>
<p>|</p>
<p>0</p>
<p>|</p>
<p>0</p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong>  </p>
<p>prtden</p>
<p>|</p>
<p>0</p>
<p>|</p>
<p>0</p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong></p>
<p>|</p>
<p><strong>1</strong>  </p>
<p>For a parallel calculation, <a class="wikilink codevar-wikilink" href="../gstate#timopt">timopt</a> is enforced to be 0.<br />
E_min, E_med and E_max may be read from the pseudopotential file (available
only for XML PAW atomic data files). If E_min, E_med and E_max are not given
in the pseudopotential file, <a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a> must be given in the input file and
E_max=E_med=E_max=ecut.<br />
The values in bold font are the default values of ABINIT. <a class="wikilink codevar-wikilink" href="../basic#accuracy">accuracy</a>=4
corresponds to the default tuning of ABINIT. It is already a very accurate
tuning.<br />
If the user wants to modify one of the input variable automatically tuned by
<a class="wikilink codevar-wikilink" href="../basic#accuracy">accuracy</a>, he must put it in the input file. The other input variables
automatically tuned by <a class="wikilink codevar-wikilink" href="../basic#accuracy">accuracy</a> will not be affected.<br />
<a class="wikilink codevar-wikilink" href="../basic#accuracy">accuracy</a>=0 means that this input variable is desactivated.</p>
<h2 id="acell"><strong>acell</strong><a class="headerlink" href="#acell" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> CELL lattice vector scaling<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">EVOLVING</a>, <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify the unit cell" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Commentdims:</em> represented internally as acell(3,<a class="wikilink codevar-wikilink" href="../rlx#nimage">nimage</a>)<br />
<em>Default value:</em> 3*1  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [919/920] in all abinit tests, [116/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Gives the length scales by which dimensionless primitive translations (in
<a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>) are to be multiplied. By default, given in Bohr atomic units (1
Bohr=0.5291772108 Angstroms), although Angstrom can be specified, if
preferred, since <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a> has the &lsquo;<a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">LENGTH</a>&lsquo; characteristics. See further
description of <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a> related to the <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a> input variable, the
<a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a> input variable, and the associated internal <a class="wikilink codevar-wikilink" href="../basic#rprimd">%rprimd</a> input
variable.</p>
<p>Note that <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a> is NOT the length of the conventional orthogonal basis
vectors, but the scaling factors of the primitive vectors. Use <a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>
to scale the cartesian coordinates.</p>
<h2 id="angdeg"><strong>angdeg</strong><a class="headerlink" href="#angdeg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ANGles in DEGrees<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify the unit cell" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> None<br />
<em>Comment:</em> deduced from &lsquo;<a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>&lsquo;  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [58/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  rhombohedral. Test finite electric field Check the corectness of the symmetry operations with non-zero tnons." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_55.in" target="_blank">tsv4_55.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Al2O3 cell in rhombohedric cell with different axes. Dataset 1 : Rhombohedral axes;  full set of symmetries and full set of atoms Dataset 2 : Rhombohedral axes;  irreducible unit cell and space group Dataset 3 : Hexagonal axes;  irreducible unit cell and space group Dataset 4 : Hexagonal axes;  full unit cell and space group The results are equivalent for Dataset 1 and 2 and Dataset 3 and 4." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t96.in" target="_blank">t96.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Arsenic in rhombohedral structure. Optimization of unit cell size and shape. With 4x4x4 k point grid,  ecut 3.0,  occopt 4 and tsmear 0.06d0, one get acell 3*7.325  angdeg 3*57.36 and xred 0.2277 These input parameters are too small,  but still give a realistic geometry,  since with the much better parameters 12x12x12 k point grid,  ecut 12.0,  occopt 4 and tsmear 0.04d0, one gets acell 3*7.633  angdeg 3*54.95 and xred 0.2296,  while the experimental values are acell 3*7.751   angdeg 3*54.554 and xred 0.2276" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t44.in" target="_blank">t44.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the symmetry finder for all the Bravais lattices, with different input formats (rprim or angdeg),  and for non-conventional choices of axes as well. Uses only one atom,  placed at (0 0 0)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t52.in" target="_blank">t52.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the symmetry finder for all the Bravais lattices, with different input formats (rprim or angdeg),  and for non-conventional choices of axes as well. Uses two different atoms,  placed at (0 0 0) and (0.1 0 0),  thus breaking many symmetries." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t53.in" target="_blank">t53.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor First dataset : compute the density Second dataset : compute the spinor wfs at one k point, non-self consistently Third dataset : use the spinor wfs of the previous dataset to restart computations at symmetric k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t13.in" target="_blank">t13.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with spin-orbit. Should give the same answer than test 2,  except that the k point grid is now defined automatically. Dataset 8 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . Warning : the output file of this test is machine-dependent,  although the final result is not. This is because the degeneracy of the GS wavefunctions with different spin orientation has not been broken." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t14.in" target="_blank">t14.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="H based fake crystals : magnetic groups,  Shubnikov type III Test the generation and recognition of the orthorhombic space groups (part I : spgroup 16 to 46)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="H based fake crystals : magnetic groups,  Shubnikov type III Test the generation and recognition of the orthorhombic space groups (part II : spgroup 47 to 62)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="H based fake crystals : magnetic groups,  Shubnikov type III Test the generation and recognition of the orthorhombic space groups (part III : spgroup 63 to 74)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t23.in" target="_blank">t23.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using PAW,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the spin-orbit coupling - with zero magnetization      (nspden=1,  nspinor=2) - with non-collinear magnetism (nspden=4,  nspinor=2) Also tests spnorbscl and pawcpxocc variables reserved to exp. users." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t17.in" target="_blank">t17.in</a>, <a class="wikilink abifile-wikilink" data-content="GeTe in rhombohedral structure Test the computation of phonons,  dielectric tensor and Born effective charges,  with and without spin-orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t24.in" target="_blank">t24.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="Print out CIF file for simple cubic Ti crystal,  for reference purposes (conventional = primitive unit cell for symmetry ops)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the symmetry finder for all the Bravais lattices, with different input formats (rprim or angdeg),  and for non-conventional choices of axes as well. Uses only one atom,  placed at (0.6 0 0) Similar to test v2#52,  except for the choice of the location" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t15.in" target="_blank">t15.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test natsph_extra,  ratsph_extra,  and xredsph_extra for STS calculation. Al (111) surface slab with very low ecut and ngkpt in the plane." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Fake body-centered tetragonal crystal This test checks the capability of ABINIT to identify and correct inaccurate primitive vectors using the tolsym input variable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t13.in" target="_blank">t13.in</a>, <a class="wikilink abifile-wikilink" data-content="Computation of the elastic constants and internal strains for distorded h-BN (to get non-zero internal strains) vdW-DFT-D3 corrections with Becke-Jonhson damping (DFT-D3(BJ)) Only the pair-wise is computed (3-body term not implemented) In this test the following properties are thus tested: contribution to the energy and to the stress of DFT-D3(BJ) as well as the contribution to the elastic constants and internal strains" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t99.in" target="_blank">t99.in</a> &hellip;</li></ul></details><p>Gives the angles between directions of primitive vectors of the unit cell (in
degrees), as an alternative to the input array <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a> . Will be used to set
up <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>, that, together with the array <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>, will be used to define
the primitive vectors.</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="../basic#angdeg">angdeg</a>(1) is the angle between the 2<sup>nd</sup> and 3<sup>rd</sup> vectors, </li>
<li><a class="wikilink codevar-wikilink" href="../basic#angdeg">angdeg</a>(2) is the angle between the 1<sup>st</sup> and 3<sup>rd</sup> vectors, </li>
<li><a class="wikilink codevar-wikilink" href="../basic#angdeg">angdeg</a>(3) is the angle between the 1<sup>st</sup> and 2<sup>nd</sup> vectors, </li>
</ul>
<p>If the three angles are equal within 1.0d-12 (except if they are exactly 90
degrees), the three primitive vectors are chosen so that the trigonal symmetry
that exchange them is along the z cartesian axis :</p>
<div class="codehilite"><pre><span></span>R1=( a , 0,c)
R2=(-a/2, sqrt(3)/2*a,c)
R3=(-a/2,-sqrt(3)/2*a,c)
</pre></div>


<p>where a  2  +c  2  =1.0d0<br />
If the angles are not all equal (or if they are all 90 degrees), one will have
the following generic form :</p>
<ul>
<li>R1=(1,0,0) </li>
<li>R2=(a,b,0) </li>
<li>R3=(c,d,e) </li>
</ul>
<p>where each of the vectors is normalized, and form the desired angles with the
others.</p>
<h2 id="ecut"><strong>ecut</strong><a class="headerlink" href="#ecut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Energy CUToff<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform numerically precise calculations with planewaves or projector-
augmented waves and pseudopotentials" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Planewaves">topic_Planewaves</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> None  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [920/920] in all abinit tests, [116/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Used for kinetic energy cutoff which controls number of planewaves at given k
point by:<br />
(&frac12;)[(2 Pi)*(k+Gmax)]  2  =<a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a> for Gmax.<br />
All planewaves inside this &ldquo;basis sphere&rdquo; centered at k are included in the
basis (except if <a class="wikilink codevar-wikilink" href="../rlx#dilatmx">dilatmx</a> is defined).<br />
Can be specified in Ha (the default), Ry, eV or Kelvin, since <a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a> has the
&lsquo;<a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a>&lsquo; characteristics. (1 Ha=27.2113845 eV)<br />
This is the single parameter which can have an enormous effect on the quality
of a calculation; basically the larger <a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a> is, the better converged the
calculation is. For fixed geometry, the total energy MUST always decrease as
<a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a> is raised because of the variational nature of the problem.</p>
<p>_ Usually one runs at least several calculations at various <a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a> to
investigate the convergence needed for reliable results. _</p>
<p>For k-points whose coordinates are build from 0 or &frac12;, the implementation of
time-reversal symmetry that links coefficients of the wavefunctions in
reciprocal space has been realized. See the input variable <a class="wikilink codevar-wikilink" href="../dev#istwfk">istwfk</a>. If
activated (which corresponds to the Default mode), this input variable
<a class="wikilink codevar-wikilink" href="../dev#istwfk">istwfk</a> will allow to divide the number of plane wave (npw) treated
explicitly by a factor of two. Still, the final result should be identical
with the &lsquo;full&rsquo; set of plane waves.</p>
<p>See the input variable <a class="wikilink codevar-wikilink" href="../rlx#ecutsm">ecutsm</a>, for the smoothing of the kinetic energy,
needed to optimize unit cell parameters.</p>
<h2 id="einterp"><strong>einterp</strong><a class="headerlink" href="#einterp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron bands INTERPolation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generate the electronic band structure related topics" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/ElecBandStructure">topic_ElecBandStructure</a>, <a class="wikilink topic-wikilink" data-content="How to compute the electronic self-energy (due to electron-electron interaction)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SelfEnergy">topic_SelfEnergy</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (4)<br />
<em>Default value:</em> [0, 0, 0, 0]  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v8:  <a class="wikilink abifile-wikilink" data-content="Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t04.in" target="_blank">t04.in</a></li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Diamond: hybrid functional calculation with the GW code Self-consistent approach to the HSE06 band structure based on a unitary transform of a subset of LDA wavefunctions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t42.in" target="_blank">t42.in</a></li></ul></details><p>This variable activates the interpolation of the electronic eigenvalues. It
can be used to interpolate KS eigenvalues at the end of the GS run or to
interpolate GW energies in sigma calculations (<a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a> = 4). The k-path
can be specified with <a class="wikilink codevar-wikilink" href="../gstate#kptbounds">kptbounds</a> and <a class="wikilink codevar-wikilink" href="../basic#nkpath">nkpath</a>. einterp consists of 4
entries. The first element specificies the interpolation method.</p>
<ul>
<li>0 &rarr; No interpolation (default) </li>
<li>1 &rarr; Star-function interpolation (Shankland-Koelling-Wood Fourier interpolation scheme, see <a class="wikilink citation-wikilink" data-content="Smooth Fourier interpolation of periodic functions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#pickett1988">[Pickett1988]</a> </li>
<li>2 &rarr; B-spline interpolation. </li>
</ul>
<p>The meaning of the other entries depend on the interpolation technique
selected.<br />
In the case of star-function interpolation:</p>
<ul>
<li>einterp(2): Number of star-functions per ab-initio k-point </li>
<li>einterp(3): If non-zero, activate Fourier filtering according to Eq 9 of <a class="wikilink citation-wikilink" data-content="Calculations of transport properties with the linearized augmented plane-wave method" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#uehara2000">[Uehara2000]</a>. In this case, rcut is given by einterp(2) * Rmax where Rmax is the maximum length of the lattice vectors included in the star expansion </li>
<li>einterp(4): Used if einterp(2) /= 0. It defines rsigma in Eq 9</li>
</ul>
<p>For B-spline interpolation: einterp(2:4): Order of B-spline for the three
reduced directions. Cubic spline (3) is the recommended value.</p>
<h2 id="iscf"><strong>iscf</strong><a class="headerlink" href="#iscf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for Self-Consistent-Field cycles<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to select the SCF algorithm" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SCFAlgorithms">topic_SCFAlgorithms</a>, <a class="wikilink topic-wikilink" data-content="How to perform time-dependent density-functional theory calculations of neutral
excitation energies" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/TDDFT">topic_TDDFT</a>, <a class="wikilink topic-wikilink" data-content="How to generate the electronic band structure related topics" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/ElecBandStructure">topic_ElecBandStructure</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0 if <a class="wikilink codevar-wikilink" href="../basic#usewvl">usewvl</a>==1,
17 if <a class="wikilink codevar-wikilink" href="../internal#usepaw">%usepaw</a>==1,
7 otherwise.</p>
<details class="note"><summary>Test list (click to open). Moderately used, [277/920] in all abinit tests, [41/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_bigdft.in" target="_blank">testin_bigdft.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_1.in" target="_blank">tmbt_1.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="Crystalline silicon Computation of the band structure. First,  a SCF density computation,  then a non-SCF band structure calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_5.in" target="_blank">tbase3_5.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon Preparatory run for BS calculations There are four datasets specified in this input: 1) Ground-state calculation to get the density. 2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4,  gamma-centered) 3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling 4) SCR calculation with the WFK file generated in the second dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_1.in" target="_blank">tbs_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon Calculation of the GW corrections Dataset 1: ground state calculation and calculation of the WFK file for 10 k-points in IBZ Dataset 2: calculation of the screening (epsilon^-1 matrix for W) Dataset 3: calculation of the Self-Energy matrix elements (GW corrections)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_1.in" target="_blank">tgw1_1.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Carbon atom Test the mGGA functionals generating directly XC potentials. Similar to test 08,  but with smaller acell and ecut. Without the use of a &amp;quot;large&amp;quot; xc_denpos,  Tran-Blaha is hard to converge. Hypothesis : there is a strong non-linear region,  preventing the Anderson method to work effectively. Note that the default iscf (=7) does not allow to converge with the default xc_denpos ! By contrast,  things are much better behaved with xc_denpos on the order of 1.0e-7 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t13.in" target="_blank">t13.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon solid,  experimental lattice parameter. Realistic parameters are used (ecut=20,  ngkpt=2x2x2 shifted 4 times,  but centered on Gamma). Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson). The LDA gap is observed at Gamma : 8.071 eV,  is in reasonable agreement with the gap from the TB paper PRL 102,  226401 (2009), where it is mentioned to be 8.16 eV. The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV. The reading of the kinetic energy density,  to start a non-SCF calculation is not yet implemented, as of ABINITv6.12.0 . This test was used to examine the speed of the convergence in case of elongated cells,  up to 16 atoms. The mGGA convergence was found to be similar to the LDA convergence. Also,  test non-self-consistent mGGA calculation,  with reading of the previously produced _DEN and _KDEN files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t19.in" target="_blank">t19.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of various XC functionals for the response functions (thus,  the XC kernel is also tested). The test includes 3 different functionals: 1) Perdew-Zunger: ixc=2 and ixc=-001009 2) PBE: ixc=11 and ixc=-101130 3) Perdew-Wang92: ixc=7,  ixc=-001012,  and ixc=-001013 The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting some lines indicated by GMR. Note that the underlying FFT grid does not have the symmetry of the lattice." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t81.in" target="_blank">t81.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. Forces are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="Run non-scf (iscf=-2) on 2 special points by reading t5o_DEN. Eigenvalues should now agree among 05,  06,  and 08,  except that 08 will include some unoccupied bands." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Run non-scf (iscf=-2) for Gamma,  X,  L band structure for Si." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="Same as 11 but with mkmem = 0,  mffmem=0 (out-of-core)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Test the option ionmov=4. 8-atom Si cube,  non spin-polarized. Same test as number 22a of fast,  except for the change of ionmov,  no reading of wavefunctions,  iscf to 2,  and different tolerance criteria." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t44.in" target="_blank">t44.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the option ionmov=4. Si2 molecule,  spin-polarized. Same test as number 16 of fast,  except for the change of ionmov,  no reading of wavefunctions,  iscf to 2,  and different tolerance criteria. Cannot be executed in parallel: --- !ERROR message: | the number of bands in the spin up case must be equal to the number of bands in the spin down case. This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3 Action : change nband,  or use the sequential version of ABINIT. src_file: chkinp.F90 src_line: 1181 ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t45.in" target="_blank">t45.in</a>, <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  spin-polarized. Take the wavefunctions from test 45, and converge them further for initialisation of test 47. Cannot be executed in parallel: --- !ERROR message: | the number of bands in the spin up case must be equal to the number of bands in the spin down case. This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3 Action : change nband,  or use the sequential version of ABINIT. src_file: chkinp.F90 src_line: 1181 ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t46.in" target="_blank">t46.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Si2 molecules (2 atoms per unit cell), using a separable pseudopotential,  with ixc=3. Computation of the second derivative of the total energy with respect to a atomic displacement perpendicular to the chain,  with q(0 0 1/2) wavevector. (see test.si.chain of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Si crystal (diamond structure),  2 atoms per unit cell. Computation of responses to atomic displacements and homogeneous electric field at Gamma, giving access to the dynamical matrix at q(0 0 0),  including its non-analytical behaviour (effective charges do not vanish completely due to lack of convergence), the associated phonon frequencies,  and the macroscopic dielectric constant. (see test.si.gamma of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs crystal (zinc-blende structure),  2 atoms per unit cell. Computation of responses to atomic displacements with X-point wavevector,  giving the dynamical matrix and the associated phonon frequencies. Can be compared to the test gaas.x of RESPFN,  provided the cut-off energy is changed (here 3Ha,  in RESPFN,  6Ha)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="FCC Yb (1 atom per unit cell), using a l=3 psp with s local part. Crazy cut-off and number of k points. Shows that the derivative of the eigenenergies with respect to the wavevector can be obtained both by finite differences and analytical means (from a preliminary computation in the treatment of the ddk perturbation). For the (0.25, 0.25, 0.25) k point, the tenth band eigenvalue is -3.01209 eV. Going to the (0.251, 0.251, 0.251) k point it becomes -3.00562 eV,  with finite-difference estimation of the derivative with respect to ONE wavevector change (all three components changed) being 0.00647 eV/0.001/3=2.157 eV This value is unchanged when using the data at the (0.253, 0.253, 0.253) k point. The analytical value is 2.15566 eV." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor First dataset : compute the density Second dataset : compute the spinor wfs at one k point, non-self consistently Third dataset : use the spinor wfs of the previous dataset to restart computations at symmetric k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t13.in" target="_blank">t13.in</a>, <a class="wikilink abifile-wikilink" data-content="Si crystal. GGA + non-linear XC core correction. Compute the interatomic force constant for the displacement of the second atom along (111). RF calculation of the 2DTE gives 7.51663417 Ha while finite differences gives: with delta(xred)=0.0001,  7.15663267 Ha. The agreement is quite good,  and might likely be improved by combining finite differences. Also compute the ddk and electric field responses. The number of k points is much too small to obtain physical values,  but are quite comparable to the result of test v2 #6" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t16.in" target="_blank">t16.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="O in arbitrary structure. 1 k point,  low ecut. Experimental PAW pseudopotential. The aim of this test is to test the differents mixing scheme in PAW formalism. Different values of iscf,  pawmixdg and pawoptmix are choosen. Features tested: - mixing on density or potential (mod(iscf, 10)) - different mixing schemes (iscf) - inclusion of spherical part in residual (pawoptmix) - mixing on coarse or fine grid (pawmixdg) - mixing factor for spherical part (pawsphmix) All mixing schemes give the same total energy." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the pspcod=8 input format (contributed by D.R. Hamann) This format is primarily intended to offer a flexible platform for those who wish to experiment with their own features in norm-conserving pseudopotentials.  A full description and discussion is given in Infos/Psp_infos/psp8.info.  This test case,  CaO,  is an example of self-interaction-corrected pseudopotentials in the style of D. Vogel,  P. Krueger,  and J. Pollmann,  Phys. Rev. B 52, 14 316 (1995).  The bandgap (direct) in the test example,  11.2eV, is in excellent agreement with experiment,  but is rather strongly dependent on the radius at which the self-interaction-correction of Ca is (smoothly) cut off.  The sic pseudopotentials used in this test should not be considered anything but early-stage experiments and should not be used for any other purpose." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t20.in" target="_blank">t20.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Carbon in diamond structure. Chained GW calculation: The first run produces the WFK,  the SCR,  the SUSC and the QPS file. These file are subsequently read and used in t537 using irdwfk,  irdscr,  irdsuscep and irdqps In the second dataset of t85,  the screened interaction W is approximated using the test-electron expression with the TDDFT ALDA kernel (gwgamma==1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials. W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV. First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian,  then the Haydock iterative method is employed to calculate the macroscopic dielectric function. The last dataset solves the BSE problem including the coupling between resonant and anti-resonant transition via brute force diagonalization. Shiva is disabled because the coupling part is unstable on this machine" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="LiF. Optical properties within BSE and PAW (Haydock method)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t14.in" target="_blank">t14.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Print out geometry and eigenvalue files for analysis by the BoltzTraP code,  for transport coefficients, Seebeck,  etc... Tests the prtbltztrp input variable" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="MgB2,  space group P6/m m m (#191);  Bravais hP (primitive hexag.) GS calculation followed by a band structure calculation in which the k-path is automatically defined via the ndivsm input variable. The third dataset tests the calculation and the output of the Fermi surface (prtfsurf=1) in the Xcrysden format." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t14.in" target="_blank">t14.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of berrystep Al-As cristal,  zinc-blende structure Compute the polarization along strings of k-points parallel to the primitive vectors of the reciprocal lattice,  and using multiple step berry phase calculation. (Tests 21-30 are related to geometry optimization,  molecular dynamics,  etc) Cannot be executed in parallel: chkint_prt: ERROR - Context : the value of the variable nproc is 2. The value of the input variable berrystep is 5,  while it must be equal to 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t20.in" target="_blank">t20.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test of the extension of the pspcod=8 input format to include spin-orbit coupling with multiple non-local projectors.  The band structure of fcc Pt is computed at Gamma,  X,  and L. The pseudopotential used in the test is generated by the open-source ONCVPSP code,  which is available at www.mat-simresearch.com,  and described in D. R. Hamann,  Phys. Rev. B 88,  085177 (2013). The relativistic extension is documented in the code package. The Pt 5s and 5p semi-cores are treated as valence,  and the band structure is well-converged at the ecut used in the test (20 Ha). A complete description of the input format is avaiable in doc/psp_infos/psp8_info.txt." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon,  DDK computation to prepare 'optic'" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t41.in" target="_blank">t41.in</a>, <a class="wikilink abifile-wikilink" data-content="EuO rock salt structure. 20-electron PAW pseudo (4f in the core,  but 4d10 as semi-core : 4d10 5s2 5p6 (5d0) 6s2 ) Test of computation of dielectric tensor,  Born effective charges,  dynamical matrix. To keep the CPU time to a reasonable level,  the responses are computed with minimal parameters (nstep and the kpoint grid are too small, ecut might be increased,  and also pawecutdg). Note: Charge neutrality is not achieved with the present dataset for Born Effective Charges, but can be easily reached by increasing some parameters;  for instance: (ngkpt 6 6 6,   ecut 40. pawecutdg 40.) gives Z(Eu)=2.5085,  Z(O)=-2.4982" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t43.in" target="_blank">t43.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple test of velocity verlet integrator" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="Cannot be executed in parallel (mlwfovl_qp) Si fcc,  in primitive cell (2 atoms/cell) Test of self-consistent model GW (2 iterations) following Faleev et al., [PRL 93,  126406 (2004)] followed by construction of quasiparticle maximally-localized wannier functions [Hamann &amp;amp; Vanderbilt, arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test- acceptable speed,  and the results are poorly converged.  The input file is sufficiently annotated to serve as a model.  Note that well- converged GW calculations are extremely time consuming,  and in general it is advisable to run the SCGW part separately on a parallel system, and then run a separate serial job modeled on the last dataset, substituting &amp;quot;irdwfk&amp;quot; and &amp;quot;irdqps&amp;quot; for &amp;quot;getwfk&amp;quot; and &amp;quot;getqps, &amp;quot; with appropriate links to the files produced in the serial run.  Note that the _DEN file from the first dataset is also needed as input,  although the discontinued &amp;quot;irdden&amp;quot; input variable is not needed or supported. Note that acceptable names for the secondary input file needed by the wannier90 library are wannier90.win,  w90.win,  abo_DSn_w90.win (ndtset &amp;gt;0) and abo_w90.win (ndtset=0),  where abo is the 4th line of the .files file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon FCC Test the approach of Ambrosetti and Silvestrelli to assess van der Waals interactions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW response function calculation of derivative of wavefunction (DDK) Si with PAW dataset generated from uspp code. Computes derivative with DFPT formalism,  and also computes energies with displaced k+q so that energies can be checked by finite differences." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple test for LDA+U implementation. no forces,  2 Ni and 2 O atoms in an fcc supercell. The cut-off is unrealistic. This test tests the following part of the code : * paw LDA+U (pawpupot,  pawpuenergy,  pawpuinit)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t08.in" target="_blank">t08.in</a> &hellip;</li></ul></details><p>Controls the self-consistency.<br />
Positive values =&gt; this is the usual choice for doing the usual ground
state (GS) calculations or for structural relaxation, where the potential has
to be determined self-consistently. The choice between different algorithms
for SCF is possible :</p>
<ul>
<li>=0 =&gt; SCF cycle, direct minimization scheme on the gradient of the wavefunctions. This algorithm is faster than diagonalisation and mixing but is working only for systems with a gap. It is implemented only on the wavelet basis set, when <a class="wikilink codevar-wikilink" href="../basic#usewvl">usewvl</a>=1. </li>
<li>
<p>=1 =&gt; get the largest eigenvalue of the SCF cycle <br />
(<a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">DEVELOP</a> option, used with <a class="wikilink codevar-wikilink" href="../files#irdwfk">irdwfk</a>=1 or <a class="wikilink codevar-wikilink" href="../files#irdwfq">irdwfq</a>=1)</p>
</li>
<li>
<p>=2 =&gt; SCF cycle, simple mixing of the potential </p>
</li>
<li>=3 =&gt; SCF cycle, Anderson mixing of the potential </li>
<li>=4 =&gt; SCF cycle, Anderson mixing of the potential based on the two previous iterations </li>
<li>=5 =&gt; SCF cycle, CG based on the minim. of the energy with respect to the potential </li>
<li>=7 =&gt; SCF cycle, Pulay mixing of the potential based on the <a class="wikilink codevar-wikilink" href="../dev#npulayit">npulayit</a> previous iterations </li>
<li>=12 =&gt; SCF cycle, simple mixing of the density </li>
<li>=13 =&gt; SCF cycle, Anderson mixing of the density </li>
<li>=14 =&gt; SCF cycle, Anderson mixing of the density based on the two previous iterations </li>
<li>=15 =&gt; SCF cycle, CG based on the minim. of the energy with respect to the density </li>
<li>=17 =&gt; SCF cycle, Pulay mixing of the density based on the <a class="wikilink codevar-wikilink" href="../dev#npulayit">npulayit</a> previous iterations </li>
<li>Other positive values, including zero ones, are not allowed. </li>
</ul>
<p>Such algorithms for treating the &ldquo;SCF iteration history&rdquo; should be coupled
with accompanying algorithms for the SCF &ldquo;preconditioning&rdquo;. See the input
variable <a class="wikilink codevar-wikilink" href="../gstate#iprcel">iprcel</a>. The default value <a class="wikilink codevar-wikilink" href="../gstate#iprcel">iprcel</a>=0 is often a good choice,
but for inhomogeneous systems, you might gain a lot with <a class="wikilink codevar-wikilink" href="../gstate#iprcel">iprcel</a>=45.</p>
<p>(Warning : if <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>&gt;10, at present (v4.6), the energy printed at each
SCF cycle is not variational - this should not affect the other properties,
and at convergence, all values are OK)</p>
<p>- In the norm-conserving case, the default option is <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>=7, which is a
compromise between speed and reliability. The value <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>= 2 is safer but
slower.<br />
- In the PAW case, default option is <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>=17. In PAW you have the
possibility to mix density/potential on the fine or coarse FFT grid (see
<a class="wikilink codevar-wikilink" href="../paw#pawmixdg">pawmixdg</a>).<br />
- Note that a Pulay mixing (<a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>=7 or 17) with <a class="wikilink codevar-wikilink" href="../dev#npulayit">npulayit</a> =1 (resp. 2)
is equivalent to an Anderson mixing with <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>=3 or 13 (resp. 4 or 14).<br />
- Also note that:<br />
* when mixing is done on potential (iscf &lt;10), total energy is computed by &ldquo;direct&rdquo; decomposition. <br />
* when mixing is done on density (iscf &gt;=10), total energy is computed by &ldquo;double counting&rdquo; decomposition. <br />
&ldquo;Direct&rdquo; and &ldquo;double counting&rdquo; decomposition of energy are equal when SCF
cycle is converged. Note that, when using GGA XC functionals, these
decompositions of energy can be slightly different due to imprecise
computation of density gradients on FFT grid (difference decreases as size of
FFT grid increases - see <a class="wikilink codevar-wikilink" href="../basic#ecut">ecut</a> for NC pseudopotentials, <a class="wikilink codevar-wikilink" href="../paw#pawecutdg">pawecutdg</a> for
PAW).  </p>
<p>Other (negative) options:</p>
<ul>
<li>
<p>= -2 =&gt; a non-self-consistent calculation is to be done; in this case an electron density rho(r) on a real space grid (produced in a previous calculation) will be read from a disk file (automatically if <a class="wikilink codevar-wikilink" href="../basic#ndtset">ndtset</a>=0, or according to the value of <a class="wikilink codevar-wikilink" href="../files#getden">getden</a> if <a class="wikilink codevar-wikilink" href="../basic#ndtset">ndtset</a>/=0). <br />
The name of the density file must be given as indicated in the <a href="../../../users/generated_files/help_abinit.html#4"> section 4
</a> of <a class="wikilink user-guide-wikilink" href="../../user-guide/abinit">abinit help file</a>.
<a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>=-2 would be used for band structure calculations, to permit
computation of the eigenvalues of occupied and unoccupied states at arbitrary
k points in the fixed self consistent potential produced by some integration
grid of k points. Due to this typical use, ABINIT insist that either
<a class="wikilink codevar-wikilink" href="../files#prtvol">prtvol</a>&gt;2 or <a class="wikilink codevar-wikilink" href="../files#prteig">prteig</a> does not vanish when there are more than 50 k
points.<br />
To compute the eigenvalues (and wavefunctions) of unoccupied states in a
separate (non-selfconsistent) run, the user should save the self-consistent
rho(r) and then run <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>=-2 for the intended set of k-points and bands.<br />
To prepare a run with <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>=-2, a density file can be produced using the
parameter <a class="wikilink codevar-wikilink" href="../files#prtden">prtden</a> (see its description). When a self-consistent set of
wavefunctions is already available, abinit can be used with <a class="wikilink codevar-wikilink" href="../basic#nstep">nstep</a>=0 (see
Test_v2/t47.in), and the adequate value of <a class="wikilink codevar-wikilink" href="../files#prtden">prtden</a>.</p>
</li>
<li>
<p>= -3 =&gt; like -2, but initialize <a class="wikilink codevar-wikilink" href="../gstate#occ">occ</a> and <a class="wikilink codevar-wikilink" href="../basic#wtk">wtk</a>, directly or indirectly (using <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>) depending on the value of <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>. <br />
For GS, this option might be used to generate Density-of-states (thanks to
<a class="wikilink codevar-wikilink" href="../files#prtdos">prtdos</a>), or to produce STM charge density map (thanks to <a class="wikilink codevar-wikilink" href="../files#prtstm">prtstm</a>).<br />
For RF, this option is needed to compute the response to ddk perturbation.</p>
</li>
<li>
<p>= -1 =&gt; like -2, but the non-self-consistent calculation is followed by the determination of excited states within TDDFT. This is only possible for <a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>=1, with <a class="wikilink codevar-wikilink" href="../basic#kpt">kpt</a>=0 0 0. Note that the oscillator strength needs to be defined with respect to an origin of coordinate, thanks to the input variable <a class="wikilink codevar-wikilink" href="../gstate#boxcenter">boxcenter</a>. The maximal number of Kohn-Sham excitations to be used to build the excited state TDDFT matrix can be defined by <a class="wikilink codevar-wikilink" href="../dfpt#td_mexcit">td_mexcit</a>, or indirectly by the maximum Kohn-Sham excitation energy <a class="wikilink codevar-wikilink" href="../dfpt#td_maxene">td_maxene</a>. </p>
</li>
</ul>
<h2 id="ixc"><strong>ixc</strong><a class="headerlink" href="#ixc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Index of eXchange-Correlation functional<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the exchange and correlation functionals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/xc">topic_xc</a>, <a class="wikilink topic-wikilink" data-content="How to use hybrid functionals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Hybrids">topic_Hybrids</a>, <a class="wikilink topic-wikilink" data-content="How to perform time-dependent density-functional theory calculations of neutral
excitation energies" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/TDDFT">topic_TDDFT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Comment:</em> Default corresponds to Teter parametrization. However, if all the pseudopotentials have the same value of pspxc, the initial value of ixc will be that common value  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [331/920] in all abinit tests, [45/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using old,  rather inaccurate psps. Computation of the Berry phase. Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_04.in" target="_blank">tsv3_04.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_bigdft.in" target="_blank">testin_bigdft.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_etsf_io.in" target="_blank">testin_etsf_io.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_libxc.in" target="_blank">testin_libxc.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si,  Bulk,  2 atoms,  paral_kgb. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test the triple parallelisation. We cannot check the distribution npband*npfft*npkpt=2*2*2=8 processors, this number being not allowed in the test procedure. Here,  we only test the parallelisation over FFT and kpoints: npband*npfft*npkpt=1*2*2=4 processors. In test tY.in we check other distributions for guarantee." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t24.in" target="_blank">t24.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="Hydronium ion + NH3 molecule Ground state calculation keeping O and H atoms fixed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tstring_01.in" target="_blank">tstring_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box Like t24.in,  except that GGA is used instead of LDA." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_5.in" target="_blank">tbase2_5.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline aluminum : optimization of the lattice parameter at fixed number of k points and broadening." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase4_1.in" target="_blank">tbase4_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline aluminum : optimization of the lattice parameter Convergence with respect to k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase4_2.in" target="_blank">tbase4_2.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Water molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Graphene. Test wavelet run on surface" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Molybdenum slab (5 atoms+3 vacuum),  with ixc=1. 4 k-points,  in core. Use iprcel=45 for SCF cycle." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Molybdenum slab (5 atoms+3 vacuum),  with ixc=1. 4 k-points,  in core. Use iprcel=45 for SCF cycle." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Molybdenum slab (5 atoms+3 vacuum),  with ixc=1. 4 k-points,  in core. Use iprcel=45 for SCF cycle." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO. Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Finite difference calculation of the Born effective charges of AlAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_1.in" target="_blank">tffield_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear response calculation for AlAs Perturbation: atomic displacements &amp;amp; strains Finite difference calculation of the ddk" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_2.in" target="_blank">tffield_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Finite difference calculation of the clamped-ion piezoelectric constants of AlAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_4.in" target="_blank">tffield_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom (see below). Treated without any XC energy (ixc=0). The total energy is -1.9442 Ha. 10.-20. Isolated Helium atom tests. These tests exercise different xc functionals,  in the spin-unpolarized case. The helium atom is isolated in a box of size 5x5x5,  with one special point (1/4 1/4 1/4),  200 Ha cut-off,  used with a potential close to the bare He potential (erfc with 0.001 bohr decay length). Errors due to the smallness of the supercell size are on the order of 1 mHa,  as well as those due to the representation of the Coulomb potential by a erfc function. The remaining is due to finiteness of the basis set. The estimation of the latter errors is presented in the test_cases 17 and 18. In all these tests,  intxc=0." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t10.in" target="_blank">t10.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom. Treated with LDA,  Teter rational polynomial parametrization (4/93) (ixc=1). The total energy is -2.8275 Ha." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom. Treated with LDA,  Perdew-Zunger-Ceperley-Alder (ixc=2). The total energy is -2.8278 Ha. For speed-up,  it begins with the wavefunctions from test 11." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2. Use the x-only PBE functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.10691 Ha while finite differences gives : with delta(xred)=0.0002,  189.10790 Ha with delta(xred)=0.0001,  189.10703 Ha . Combining the results gives 189.10675 Ha. The agreement is quite good,  and might likely be improved by increasing tolvrs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Silicon: Solution of the Bethe-Salpeter equation (BSE) with temperature-dependent renormalization WARNING: This feature is still under testing,  files and variables could change in the next versions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t50.in" target="_blank">t50.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon: Solution of the Bethe-Salpeter equation (BSE) with temperature-dependent renormalization WARNING: This feature is still under testing,  files and variables could change in the next versions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon: Solution of optic with temperature-dependent renormalization WARNING: This feature is still under testing,  files and variables could change in the next versions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t52.in" target="_blank">t52.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Hydrogen atom. Treated with GGA C09x exchange functional (ixc=24). The total energy is -0.429523 Ha. Also additional tests concerning the kinetic energy density calculation, the gradient of electronic density calculation and the Laplacian of electronic density calculation are performed. Test taken from v1/t21.in." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Boron,  32 atoms - Thomas-Fermi method (without orbitals) Test the temperature-dependent XC functional (ixc=50) (Ichimaru et al Phys. Rep. 149,  91-205 (1987) Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="EuO rock salt structure. 27-electron PAW pseudo (4f and 5d are explicitly treated : 4d10 4f7 5s2 5p6 (5d0) 6s2 ) Test of initialisation using occopt=1 (the default) with non-zero spinmagntarget, and also metallic occopt. Also test pawxcdev=0" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="LiH rocksalt structure with a negative lithium vacancy test thee potential alignement usepotzero=0, 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t26.in" target="_blank">t26.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="Test of the computation of the positron lifetime (using the two-component DFT) within PAW. A cubic box with 4 Al atoms at experimental volume. Low cut-offs,  few k-points. Datasets 2 to 3 use ixcpositron=2 i.e. LDA electron-positron correlation provided by Puska, Seitsonen,  and Nieminen (PRB 52,  10947). Datasets 4 to 5 use ixcpositron=11 i.e. LDA zero positron density limit parametrized by Arponen and Pajanne and fitted by Sterne and Kaiser (PRB 43,  13892). Dataset 1 performs a simple electronic GS calculation and store the density. Dataset 2 performs a positronic GS calculation in presence of the electronic density computed by dataset 1 (positron=1). Dataset 3 performs an electronic GS calculation in presence of the positronic density computed by dataset 2 (positron=2). Dataset 4 performs an automatic electronic/positronic GS calculation without storage of the wave-functions (positron=-1). Dataset 5 performs an automatic electronic/positronic GS calculation with storage of the wave-functions (positron=-10). Each dataset computes the positron lifetime and annihilation rate after the SCF iterations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="PbFCl in the matlockite structure P4/nmm. 6 atoms per cell. Compute a set of matrix elements of the dynamical matrix, for q wavevector 0.5 0.5 0.5 . In this test case,  the symmetry operations have an important non-symmorphic character. There was a bug in the treatment of this material,  prior to v5.2.4 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in Zincblende structure. Test calculation of the Born effective charge and dielectric constant tensor at finite electric fields. The first dataset is for normal ground-state calculation at zero electric field. The second dataset is for ground-state calculation at finite electric field. The final datasetis the linear-response calculation at finite electric field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t23.in" target="_blank">t23.in</a> &hellip;</li></ul></details><p>Controls the choice of exchange and correlation (xc). The list of XC
functionals is given below. Positive values are for ABINIT native library of
XC functionals, while negative values are for calling the much wider set of
functionals from the ETSF LibXC library (by M. Marques), also available at the
<a href="http://www.etsf.eu/resources/software/libraries_and_tools"> ETSF library Web page
</a><br />
Note that the choice made here should agree with the choice made in generating
the original pseudopotential, except for <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=0 (usually only used for
debugging). A warning is issued if this is not the case. However, the choices
<a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=1, 2, 3 and 7 are fits to the same data, from Ceperley-Alder, and are
rather similar, at least for spin-unpolarized systems.<br />
The choice between the non-spin-polarized and spin-polarized case is governed
by the value of <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a> (see below).</p>
<p>** Native ABINIT XC functionals **</p>
<p>NOTE : in the implementation of the spin-dependence of these functionals, and
in order to avoid divergences in their derivatives, the interpolating function
between spin-unpolarized and fully-spin-polarized function has been slightly
modified, by including a zeta rescaled by 1.d0-1.d-6. This should affect total
energy at the level of 1.d-6Ha, and should have an even smaller effect on
differences of energies, or derivatives.<br />
The value <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=10 is used internally : gives the difference between
<a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=7 and <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=9, for use with an accurate RPA correlation energy.</p>
<ul>
<li>
<p>0=&gt; NO xc; </p>
</li>
<li>
<p>1=&gt; LDA or LSD, Teter Pade parametrization (4/93, published in <a class="wikilink citation-wikilink" data-content="Separable dual-space Gaussian pseudopotentials" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#goedecker1996">[Goedecker1996]</a>, which reproduces Perdew-Wang (which reproduces Ceperley-Alder!). </p>
</li>
<li>2=&gt; LDA, Perdew-Zunger-Ceperley-Alder (no spin-polarization) <a class="wikilink citation-wikilink" data-content="Self-interaction correction to density-functional approximations for many-electron systems" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#perdew1981">[Perdew1981]</a> </li>
<li>3=&gt; LDA, old Teter rational polynomial parametrization (4/91) fit to Ceperley-Alder data (no spin-polarization) </li>
<li>4=&gt; LDA, Wigner functional (no spin-polarization) </li>
<li>5=&gt; LDA, Hedin-Lundqvist functional (no spin-polarization) </li>
<li>6=&gt; LDA, &ldquo;X-alpha&rdquo; functional (no spin-polarization) </li>
<li>7=&gt; LDA or LSD, Perdew-Wang 92 functional </li>
<li>8=&gt; LDA or LSD, x-only part of the Perdew-Wang 92 functional </li>
<li>
<p>9=&gt; LDA or LSD, x- and RPA correlation part of the Perdew-Wang 92 functional </p>
</li>
<li>
<p>11=&gt; GGA, Perdew-Burke-Ernzerhof GGA functional </p>
</li>
<li>12=&gt; GGA, x-only part of Perdew-Burke-Ernzerhof GGA functional </li>
<li>13=&gt; GGA potential of van Leeuwen-Baerends, while for energy, Perdew-Wang 92 functional </li>
<li>14=&gt; GGA, revPBE of Y. Zhang and W. Yang, Phys. Rev. Lett. 80, 890 (1998) </li>
<li>15=&gt; GGA, RPBE of B. Hammer, L.B. Hansen and J.K. Norskov, Phys. Rev. B 59, 7413 (1999) </li>
<li>16=&gt; GGA, HTCH93 of F.A. Hamprecht, A.J. Cohen, D.J. Tozer, N.C. Handy, J. Chem. Phys. 109, 6264 (1998) </li>
<li>17=&gt; GGA, HTCH120 of A.D. Boese, N.L. Doltsinis, N.C. Handy, and M. Sprik, J. Chem. Phys 112, 1670 (1998) - The usual HCTH functional. </li>
<li>18=&gt; (NOT AVAILABLE : used internally for GGA BLYP pseudopotentials from M. Krack, see Theor. Chem. Acc. 114, 145 (2005), available from the <a href="https://github.com/cp2k/cp2k/tree/master/potentials/Goedecker/abinit/blyp"> CP2K repository </a> - use the LibXC instead, with <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=-106131. </li>
<li>
<p>19=&gt; (NOT AVAILABLE : used internally for GGA BP86 pseudopotentials from M. Krack, see Theor. Chem. Acc. 114, 145 (2005), available from the <a href="https://github.com/cp2k/cp2k/tree/master/potentials/Goedecker/abinit/bp"> CP2K repository </a> - use the LibXC instead, with <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=-106132. </p>
</li>
<li>
<p>20=&gt; Fermi-Amaldi xc ( -1/N Hartree energy, where N is the number of electrons per cell ; G=0 is not taken into account however), for TDDFT tests. No spin-pol. Does not work for RF. </p>
</li>
<li>21=&gt; same as 20, except that the xc-kernel is the LDA (<a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=1) one, for TDDFT tests. </li>
<li>22=&gt; same as 20, except that the xc-kernel is the Burke-Petersilka-Gross hybrid, for TDDFT tests. </li>
<li>23=&gt; GGA of Z. Wu and R.E. Cohen, Phys. Rev. 73, 235116 (2006). </li>
<li>24=&gt; GGA, C09x exchange of V. R. Cooper, PRB 81, 161104(R) (2010). </li>
<li>26=&gt; GGA, HTCH147 of A.D. Boese, N.L. Doltsinis, N.C. Handy, and M. Sprik, J. Chem. Phys 112, 1670 (1998). </li>
<li>27=&gt; GGA, HTCH407 of A.D. Boese, and N.C. Handy, J. Chem. Phys 114, 5497 (2001). </li>
<li>
<p>28=&gt; (NOT AVAILABLE : used internally for GGA OLYP pseudopotentials from M. Krack, see Theor. Chem. Acc. 114, 145 (2005), available from the <a href="https://github.com/cp2k/cp2k/tree/master/potentials/Goedecker/abinit/olyp"> CP2K repository </a> - use the LibXC instead, with <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=-110131. </p>
</li>
<li>
<p>40=&gt; Hartree-Fock </p>
</li>
<li>41=&gt; PBE0, J.P. Perdew, M. Ernzerhof and K. Burke, J. Chem. Phys. 105, 9982 (1996) </li>
<li>42=&gt; PBE0-&#8531;, C.A. Guido, E. Bremond, C. Adamo and P. Cortona, J. Chem. Phys. 138, 021104 (2013) </li>
</ul>
<p>** ETSF Lib XC functionals **</p>
<p>Note that you must compile ABINIT with the LibXC plug-in in order to be able
to access these functionals.<br />
The LibXC functionals are accessed by ** negative values ** of <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>. The
LibXC contains functional forms for either exchange-only functionals,
correlation-only functionals, or combined exchange and correlation
functionals. Each of them is to be specified by a three-digit number. In case
of a combined exchange and correlation functional, only one such three-digit
number has to be specified as value of <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>, with a minus sign (to indicate
that it comes from the LibXC). In the case of separate exchange functional
(let us represent its identifier by XXX) and correlation functional (let us
represent its identified by CCC), a six-digit number will have to be specified
for <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>, by concatenation, be it XXXCCC or CCCXXX. As an example,
<a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=-020 gives access to the Teter93 LDA, while <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>=-101130 gives
access to the PBE GGA. In version 0.9 of LibXC (December 2008), there are 16
three-dimensional (S)LDA functionals (1 for X, 14 for C, 1 for combined XC),
and there are 41 three-dimensional GGA (23 for X, 8 for C, 10 for combined
XC). Note that for a meta-GGA, the kinetic energy density is needed. This
means having <a class="wikilink codevar-wikilink" href="../gstate#usekden">usekden</a>=1 .</p>
<p>(S)LDA functionals (do not forget to add a minus sign, as discussed above)</p>
<ul>
<li>001=&gt; XC_LDA_X [PAM Dirac, Proceedings of the Cambridge Philosophical Society 26, 376 (1930); F Bloch, Zeitschrift fuer Physik 57, 545 (1929) ] </li>
<li>002=&gt; XC_LDA_C_WIGNER Wigner parametrization [EP Wigner, Trans. Faraday Soc. 34, 678 (1938) ] </li>
<li>003=&gt; XC_LDA_C_RPA Random Phase Approximation [M Gell-Mann and KA Brueckner, Phys. Rev. 106, 364 (1957) ] </li>
<li>004=&gt; XC_LDA_C_HL Hedin &amp; Lundqvist [L Hedin and BI Lundqvist, J. Phys. C 4, 2064 (1971) ] </li>
<li>005=&gt; XC_LDA_C_GL ! Gunnarson &amp; Lundqvist [O Gunnarsson and BI Lundqvist, PRB 13, 4274 (1976) ] </li>
<li>006=&gt; XC_LDA_C_XALPHA ! Slater&rsquo;s Xalpha ] </li>
<li>007=&gt; XC_LDA_C_VWN ! Vosko, Wilk, &amp; Nussair [SH Vosko, L Wilk, and M Nusair, Can. J. Phys. 58, 1200 (1980) ] </li>
<li>008=&gt; XC_LDA_C_VWN_RPA ! Vosko, Wilk, &amp; Nussair (RPA) [SH Vosko, L Wilk, and M Nusair, Can. J. Phys. 58, 1200 (1980) ] </li>
<li>009=&gt; XC_LDA_C_PZ ! Perdew &amp; Zunger <a class="wikilink citation-wikilink" data-content="Self-interaction correction to density-functional approximations for many-electron systems" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#perdew1981">[Perdew1981]</a> </li>
<li>010=&gt; XC_LDA_C_PZ_MOD ! Perdew &amp; Zunger (Modified) <a class="wikilink citation-wikilink" data-content="Self-interaction correction to density-functional approximations for many-electron systems" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#perdew1981">[Perdew1981]</a> Modified to improve the matching between the low and high rs part ] </li>
<li>011=&gt; XC_LDA_C_OB_PZ ! Ortiz &amp; Ballone (PZ) [G Ortiz and P Ballone, Phys. Rev. B 50, 1391 (1994) ; G Ortiz and P Ballone, Phys. Rev. B 56, 9970(E) (1997) ; <a class="wikilink citation-wikilink" data-content="Self-interaction correction to density-functional approximations for many-electron systems" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#perdew1981">[Perdew1981]</a> ] </li>
<li>012=&gt; XC_LDA_C_PW ! Perdew &amp; Wang [JP Perdew and Y Wang, Phys. Rev. B 45, 13244 (1992) ] </li>
<li>013=&gt; XC_LDA_C_PW_MOD ! Perdew &amp; Wang (Modified) [JP Perdew and Y Wang, Phys. Rev. B 45, 13244 (1992) ; Added extra digits to some constants as in the PBE routine see <a href="https://www.chem.uci.edu/~kieron/dftold2/pbe.php"> https://www.chem.uci.edu/~kieron/dftold2/pbe.php </a> (at some point it was available at http://dft.uci.edu/pbe.php) ] </li>
<li>014=&gt; XC_LDA_C_OB_PW ! Ortiz &amp; Ballone (PW) [G Ortiz and P Ballone, Phys. Rev. B 50, 1391 (1994) ; G Ortiz and P Ballone, Phys. Rev. B 56, 9970(E) (1997) ; JP Perdew and Y Wang, Phys. Rev. B 45, 13244 (1992) ] </li>
<li>017=&gt; XC_LDA_C_vBH ! von Barth &amp; Hedin [U von Barth and L Hedin, J. Phys. C: Solid State Phys. 5, 1629 (1972) ] </li>
<li>020=&gt; XC_LDA_XC_TETER93 ! Teter 93 parametrization [S Goedecker, M Teter, J Hutter, PRB 54, 1703 (1996) ] </li>
<li>022=&gt; XC_LDA_C_ML1 ! Modified LSD (version 1) of Proynov and Salahub [EI Proynov and D Salahub, Phys. Rev. B 49, 7874 (1994) ] </li>
<li>023=&gt; XC_LDA_C_ML2 ! Modified LSD (version 2) of Proynov and Salahub [EI Proynov and D Salahub, Phys. Rev. B 49, 7874 (1994) ] </li>
<li>024=&gt; XC_LDA_C_GOMBAS ! Gombas parametrization [P. Gombas, Pseudopotentials (Springer-Verlag, New York, 1967) ] </li>
<li>025=&gt; XC_LDA_C_PW_RPA ! Perdew &amp; Wang fit of the RPA [JP Perdew and Y Wang, Phys. Rev. B 45, 13244 (1992) ] </li>
<li>027=&gt; XC_LDA_C_RC04 ! Ragot-Cortona [S Ragot and P Cortona, J. Chem. Phys. 121, 7671 (2004) ] </li>
<li>028=&gt; XC_LDA_C_VWN_1 ! Vosko, Wilk, &amp; Nussair (1) [SH Vosko, L Wilk, and M Nusair, Can. J. Phys. 58, 1200 (1980) ] </li>
<li>029=&gt; XC_LDA_C_VWN_2 ! Vosko, Wilk, &amp; Nussair (2) [SH Vosko, L Wilk, and M Nusair, Can. J. Phys. 58, 1200 (1980) ] </li>
<li>030=&gt; XC_LDA_C_VWN_3 ! Vosko, Wilk, &amp; Nussair (3) [SH Vosko, L Wilk, and M Nusair, Can. J. Phys. 58, 1200 (1980) ] </li>
<li>031=&gt; XC_LDA_C_VWN_4 ! Vosko, Wilk, &amp; Nussair (4) [SH Vosko, L Wilk, and M Nusair, Can. J. Phys. 58, 1200 (1980) ] </li>
</ul>
<p>GGA functionals (do not forget to add a minus sign, as discussed above)</p>
<ul>
<li>84=&gt; XC_GGA_C_OP_XALPHA ! one-parameter progressive functional (G96 version) [T Tsuneda, T Suzumura, and K Hirao, J. Chem. Phys. 111, 5656 (1999) ] </li>
<li>85=&gt; XC_GGA_C_OP_G96 ! one-parameter progressive functional (G96 version) [T Tsuneda, T Suzumura, and K Hirao, J. Chem. Phys. 111, 5656 (1999) ] </li>
<li>86=&gt; XC_GGA_C_OP_PBE ! one-parameter progressive functional (PBE version) [T Tsuneda, T Suzumura, and K Hirao, J. Chem. Phys. 111, 5656 (1999) ] </li>
<li>87=&gt; XC_GGA_C_OP_B88 ! one-parameter progressive functional (B88 version) [T Tsuneda, T Suzumura, and K Hirao, J. Chem. Phys. 111, 5656 (1999) ] </li>
<li>88=&gt; XC_GGA_C_FT97 ! Filatov &amp; Thiel correlation [M Filatov &amp; W Thiel, Int. J. Quant. Chem. 62, 603-616 (1997) ; M Filatov &amp; W Thiel, Mol Phys 91, 847 (1997) ] WARNING : this functional is not tested. Use at your own risks. </li>
<li>89=&gt; XC_GGA_C_SPBE ! PBE correlation to be used with the SSB exchange [M Swart, M Sola, and FM Bickelhaupt, J. Chem. Phys. 131, 094103 (2009) ] </li>
<li>90=&gt; XC_GGA_X_SSB_SW ! Swarta, Sola and Bickelhaupt correction to PBE [M Swart, M Sola, and FM Bickelhaupt, J. Comp. Meth. Sci. Engin. 9, 69 (2009) ] </li>
<li>91=&gt; XC_GGA_X_SSB ! WARNING : This functional gives NaN on IBM (XG20130608). Swarta, Sola and Bickelhaupt [M Swart, M Sola, and FM Bickelhaupt, J. Chem. Phys. 131, 094103 (2009) ] </li>
<li>92=&gt; XC_GGA_X_SSB_D ! WARNING : This functional gives NaN on IBM (XG20130608). Swarta, Sola and Bickelhaupt dispersion [M Swart, M Sola, and FM Bickelhaupt, J. Chem. Phys. 131, 094103 (2009) ] </li>
<li>93=&gt; XC_GGA_XC_HCTH_407P ! HCTH/407+ [AD Boese, A Chandra, JML Martin, and Dominik Marx, J. Chem. Phys. 119, 5965 (2003) ] </li>
<li>94=&gt; XC_GGA_XC_HCTH_P76 ! HCTH p=7/6 [G Menconi, PJ Wilson, and DJ Tozer, J. Chem. Phys. 114, 3958 (2001) ] </li>
<li>95=&gt; XC_GGA_XC_HCTH_P14 ! HCTH p=&frac14; [G Menconi, PJ Wilson, and DJ Tozer, J. Chem. Phys. 114, 3958 (2001) ] </li>
<li>96=&gt; XC_GGA_XC_B97_GGA1 ! Becke 97 GGA-1 [AJ Cohen and NC Handy, Chem. Phys. Lett. 316, 160-166 (2000) ] </li>
<li>97=&gt; XC_GGA_XC_HCTH_A ! HCTH-A [FA Hamprecht, AJ Cohen, DJ Tozer, and NC Handy, J. Chem. Phys. 109, 6264 (1998) ] </li>
<li>98=&gt; XC_GGA_X_BPCCAC ! BPCCAC (GRAC for the energy) [E Bremond, D Pilard, I Ciofini, H Chermette, C Adamo, and P Cortona, Theor Chem Acc 131, 1184 (2012) ] </li>
<li>99=&gt; XC_GGA_C_REVTCA ! Tognetti, Cortona, Adamo (revised) [V Tognetti, P Cortona, and C Adamo, Chem. Phys. Lett. 460, 536-539 (2008) ] </li>
<li>100=&gt; XC_GGA_C_TCA ! Tognetti, Cortona, Adamo [V Tognetti, P Cortona, and C Adamo, J. Chem. Phys. 128, 034101 (2008) ] </li>
<li>101=&gt; XC_GGA_X_PBE ! Perdew, Burke &amp; Ernzerhof exchange [JP Perdew, K Burke, and M Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996) ; JP Perdew, K Burke, and M Ernzerhof, Phys. Rev. Lett. 78, 1396(E) (1997) ] </li>
<li>102=&gt; XC_GGA_X_PBE_R ! Perdew, Burke &amp; Ernzerhof exchange (revised) [Y Zhang and W Yang, Phys. Rev. Lett 80, 890 (1998) ] </li>
<li>103=&gt; XC_GGA_X_B86 ! Becke 86 Xalfa,beta,gamma [AD Becke, J. Chem. Phys 84, 4524 (1986) ] </li>
<li>104=&gt; XC_GGA_X_HERMAN ! Herman Xalphabeta GGA [F Herman, JP Van Dyke, and IB Ortenburger, Phys. Rev. Lett. 22, 807 (1969) ; F Herman, IB Ortenburger, and JP Van Dyke, Int. J. Quantum Chem. Symp. 3, 827 (1970) ] </li>
<li>105=&gt; XC_GGA_X_B86_MGC ! Becke 86 Xalfa,beta,gamma (with mod. grad. correction) [AD Becke, J. Chem. Phys 84, 4524 (1986) ; AD Becke, J. Chem. Phys 85, 7184 (1986) ] </li>
<li>106=&gt; XC_GGA_X_B88 ! Becke 88 [AD Becke, Phys. Rev. A 38, 3098 (1988) ] </li>
<li>107=&gt; XC_GGA_X_G96 ! Gill 96 [PMW Gill, Mol. Phys. 89, 433 (1996) ] </li>
<li>108=&gt; XC_GGA_X_PW86 ! Perdew &amp; Wang 86 [JP Perdew and Y Wang, Phys. Rev. B 33, 8800 (1986) ] </li>
<li>109=&gt; XC_GGA_X_PW91 ! Perdew &amp; Wang 91 [JP Perdew, in Proceedings of the 21<sup>st</sup> Annual International Symposium on the Electronic Structure of Solids, ed. by P Ziesche and H Eschrig (Akademie Verlag, Berlin, 1991), p. 11. ; JP Perdew, JA Chevary, SH Vosko, KA Jackson, MR Pederson, DJ Singh, and C Fiolhais, Phys. Rev. B 46, 6671 (1992) ; JP Perdew, JA Chevary, SH Vosko, KA Jackson, MR Pederson, DJ Singh, and C Fiolhais, Phys. Rev. B 48, 4978(E) (1993) ] </li>
<li>110=&gt; XC_GGA_X_OPTX ! Handy &amp; Cohen OPTX 01 [NC Handy and AJ Cohen, Mol. Phys. 99, 403 (2001) ] </li>
<li>111=&gt; XC_GGA_X_DK87_R1 ! dePristo &amp; Kress 87 (version R1) [AE DePristo and JD Kress, J. Chem. Phys. 86, 1425 (1987) ] </li>
<li>112=&gt; XC_GGA_X_DK87_R2 ! dePristo &amp; Kress 87 (version R2) [AE DePristo and JD Kress, J. Chem. Phys. 86, 1425 (1987) ] </li>
<li>113=&gt; XC_GGA_X_LG93 ! Lacks &amp; Gordon 93 [DJ Lacks and RG Gordon, Phys. Rev. A 47, 4681 (1993) ] </li>
<li>114=&gt; XC_GGA_X_FT97_A ! Filatov &amp; Thiel 97 (version A) [M Filatov and W Thiel, Mol. Phys 91, 847 (1997) ] </li>
<li>115=&gt; XC_GGA_X_FT97_B ! Filatov &amp; Thiel 97 (version B) [M Filatov and W Thiel, Mol. Phys 91, 847 (1997) ] </li>
<li>116=&gt; XC_GGA_X_PBE_SOL ! Perdew, Burke &amp; Ernzerhof exchange (solids) [JP Perdew, et al, Phys. Rev. Lett. 100, 136406 (2008) ] </li>
<li>117=&gt; XC_GGA_X_RPBE ! Hammer, Hansen &amp; Norskov (PBE-like) [B Hammer, LB Hansen and JK Norskov, Phys. Rev. B 59, 7413 (1999) ] </li>
<li>118=&gt; XC_GGA_X_WC ! Wu &amp; Cohen [Z Wu and RE Cohen, Phys. Rev. B 73, 235116 (2006) ] </li>
<li>119=&gt; XC_GGA_X_mPW91 ! Modified form of PW91 by Adamo &amp; Barone [C Adamo and V Barone, J. Chem. Phys. 108, 664 (1998) ] </li>
<li>120=&gt; XC_GGA_X_AM05 ! Armiento &amp; Mattsson 05 exchange [R Armiento and AE Mattsson, Phys. Rev. B 72, 085108 (2005) ; AE Mattsson, R Armiento, J Paier, G Kresse, JM Wills, and TR Mattsson, J. Chem. Phys. 128, 084714 (2008) ] </li>
<li>121=&gt; XC_GGA_X_PBEA ! Madsen (PBE-like) [G Madsen, Phys. Rev. B 75, 195108 (2007) ] </li>
<li>122=&gt; XC_GGA_X_MPBE ! Adamo &amp; Barone modification to PBE [C Adamo and V Barone, J. Chem. Phys. 116, 5933 (2002) ] </li>
<li>123=&gt; XC_GGA_X_XPBE ! xPBE reparametrization by Xu &amp; Goddard [X Xu and WA Goddard III, J. Chem. Phys. 121, 4068 (2004) ] </li>
<li>125=&gt; XC_GGA_X_BAYESIAN ! Bayesian best fit for the enhancement factor [JJ Mortensen, K Kaasbjerg, SL Frederiksen, JK Norskov, JP Sethna, and KW Jacobsen, Phys. Rev. Lett. 95, 216401 (2005) ] </li>
<li>126=&gt; XC_GGA_X_PBE_JSJR ! PBE JSJR reparametrization by Pedroza, Silva &amp; Capelle [LS Pedroza, AJR da Silva, and K. Capelle, Phys. Rev. B 79, 201106(R) (2009) ] </li>
<li>130=&gt; XC_GGA_C_PBE ! Perdew, Burke &amp; Ernzerhof correlation [JP Perdew, K Burke, and M Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996) ; JP Perdew, K Burke, and M Ernzerhof, Phys. Rev. Lett. 78, 1396(E) (1997) ] </li>
<li>131=&gt; XC_GGA_C_LYP ! Lee, Yang &amp; Parr [C Lee, W Yang and RG Parr, Phys. Rev. B 37, 785 (1988) B Miehlich, A Savin, H Stoll and H Preuss, Chem. Phys. Lett. 157, 200 (1989) ] </li>
<li>132=&gt; XC_GGA_C_P86 ! Perdew 86 [JP Perdew, Phys. Rev. B 33, 8822 (1986) ] </li>
<li>133=&gt; XC_GGA_C_PBE_SOL ! Perdew, Burke &amp; Ernzerhof correlation SOL [JP Perdew, et al, Phys. Rev. Lett. 100, 136406 (2008) ] </li>
<li>134=&gt; XC_GGA_C_PW91 ! Perdew &amp; Wang 91 [JP Perdew, JA Chevary, SH Vosko, KA Jackson, MR Pederson, DJ Singh, and C Fiolhais, Phys. Rev. B 46, 6671 (1992) ] </li>
<li>135=&gt; XC_GGA_C_AM05 ! Armiento &amp; Mattsson 05 correlation [ R Armiento and AE Mattsson, Phys. Rev. B 72, 085108 (2005) ; AE Mattsson, R Armiento, J Paier, G Kresse, JM Wills, and TR Mattsson, J. Chem. Phys. 128, 084714 (2008) ] </li>
<li>136=&gt; XC_GGA_C_XPBE ! xPBE reparametrization by Xu &amp; Goddard [X Xu and WA Goddard III, J. Chem. Phys. 121, 4068 (2004) ] </li>
<li>137=&gt; XC_GGA_C_LM ! Langreth and Mehl correlation [DC Langreth and MJ Mehl, Phys. Rev. Lett. 47, 446 (1981) ] </li>
<li>138=&gt; XC_GGA_C_PBE_JRGX ! JRGX reparametrization by Pedroza, Silva &amp; Capelle [LS Pedroza, AJR da Silva, and K. Capelle, Phys. Rev. B 79, 201106(R) (2009) ] </li>
<li>139=&gt; XC_GGA_X_OPTB88_VDW ! Becke 88 reoptimized to be used with vdW functional of Dion et al [J Klimes, DR Bowler, and A Michaelides, J. Phys.: Condens. Matter 22, 022201 (2010) ] </li>
<li>140=&gt; XC_GGA_X_PBEK1_VDW ! PBE reparametrization for vdW [J Klimes, DR Bowler, and A Michaelides, J. Phys.: Condens. Matter 22, 022201 (2010) ] </li>
<li>141=&gt; XC_GGA_X_OPTPBE_VDW ! PBE reparametrization for vdW [J Klimes, DR Bowler, and A Michaelides, J. Phys.: Condens. Matter 22, 022201 (2010) ] </li>
<li>142=&gt; XC_GGA_X_RGE2 ! Regularized PBE [A Ruzsinszky, GI Csonka, and G Scuseria, J. Chem. Theory Comput. 5, 763 (2009) ] </li>
<li>143=&gt; XC_GGA_C_RGE2 ! Regularized PBE [A Ruzsinszky, GI Csonka, and G Scuseria, J. Chem. Theory Comput. 5, 763 (2009) ] </li>
<li>144=&gt; XC_GGA_X_RPW86 ! refitted Perdew &amp; Wang 86 [ED Murray, K Lee and DC Langreth, J. Chem. Theory Comput. 5, 2754-2762 (2009) ] </li>
<li>145=&gt; XC_GGA_X_KT1 ! Keal and Tozer version 1 [TW Keal and DJ Tozer, J. Chem. Phys. 119, 3015 (2003) ] </li>
<li>146=&gt; XC_GGA_XC_KT2 ! WARNING : This functional gives NaN on IBM (XG20130608). Keal and Tozer version 2 [TW Keal and DJ Tozer, J. Chem. Phys. 119, 3015 (2003) ] </li>
<li>147=&gt; XC_GGA_C_WL ! Wilson &amp; Levy [LC Wilson and M Levy, Phys. Rev. B 41, 12930 (1990) ] </li>
<li>148=&gt; XC_GGA_C_WI ! Wilson &amp; Ivanov [LC Wilson &amp; S Ivanov, Int. J. Quantum Chem. 69, 523-532 (1998) ] </li>
<li>149=&gt; XC_GGA_X_MB88 ! Modified Becke 88 for proton transfer [V Tognetti and C Adamo, J. Phys. Chem. A 113, 14415-14419 (2009) ] </li>
<li>150=&gt; XC_GGA_X_SOGGA ! Second-order generalized gradient approximation [Y Zhao and DG Truhlar, J. Chem. Phys. 128, 184109 (2008) ; http://comp.chem.umn.edu/mfm/index.html ] </li>
<li>151=&gt; XC_GGA_X_SOGGA11 ! Second-order generalized gradient approximation 2011 [R Peverati, Y Zhao, and DG Truhlar, J. Phys. Chem. Lett. 2, 1911-1997 (2011); http://comp.chem.umn.edu/mfm/index.html ] </li>
<li>152=&gt; XC_GGA_C_SOGGA11 ! Second-order generalized gradient approximation 2011 [R Peverati, Y Zhao, and DG Truhlar, J. Phys. Chem. Lett. 2, 1911-1997 (2011); http://comp.chem.umn.edu/mfm/index.html ] </li>
<li>153=&gt; XC_GGA_C_WI0 ! Wilson &amp; Ivanov initial version [LC Wilson &amp; S Ivanov, Int. J. Quantum Chem. 69, 523-532 (1998) ] </li>
<li>154=&gt; XC_GGA_XC_TH1 ! Tozer and Handy v. 1 [DJ Tozer and NC Handy, J. Chem. Phys. 108, 2545 (1998) ] WARNING : this functional is not tested. Use at your own risks. </li>
<li>155=&gt; XC_GGA_XC_TH2 ! Tozer and Handy v. 2 [DJ Tozer and NC Handy, J. Phys. Chem. A 102, 3162 (1998) ] </li>
<li>156=&gt; XC_GGA_XC_TH3 ! Tozer and Handy v. 3 [DJ Tozer and NC Handy, Mol. Phys. 94, 707 (1998) ] </li>
<li>157=&gt; XC_GGA_XC_TH4 ! Tozer and Handy v. 4 [DJ Tozer and NC Handy, Mol. Phys. 94, 707 (1998) ] </li>
<li>158=&gt; XC_GGA_X_C09X ! C09x to be used with the VdW of Rutgers-Chalmers [VR Cooper, PRB 81, 161104(R) (2010) ] </li>
<li>159=&gt; XC_GGA_C_SOGGA11_X ! To be used with hyb_gga_x_SOGGA11-X [R Peverati and DG Truhlar, J. Chem. Phys. 135, 191102 (2011); http://comp.chem.umn.edu/mfm/index.html ] </li>
<li>161=&gt; XC_GGA_XC_HCTH_93 ! HCTH functional fitted to 93 molecules [FA Hamprecht, AJ Cohen, DJ Tozer, and NC Handy, J. Chem. Phys. 109, 6264 (1998) ] </li>
<li>162=&gt; XC_GGA_XC_HCTH_120 ! HCTH functional fitted to 120 molecules [AD Boese, NL Doltsinis, NC Handy, and M Sprik, J. Chem. Phys. 112, 1670 (2000) ] </li>
<li>163=&gt; XC_GGA_XC_HCTH_147 ! HCTH functional fitted to 147 molecules [AD Boese, NL Doltsinis, NC Handy, and M Sprik, J. Chem. Phys. 112, 1670 (2000) ] </li>
<li>164=&gt; XC_GGA_XC_HCTH_407 ! HCTH functional fitted to 407 molecules [AD Boese, and NC Handy, J. Chem. Phys. 114, 5497 (2001) ] </li>
<li>165=&gt; XC_GGA_XC_EDF1 ! Empirical functionals from Adamson, Gill, and Pople [RD Adamson, PMW Gill, and JA Pople, Chem. Phys. Lett. 284 6 (1998) ] </li>
<li>166=&gt; XC_GGA_XC_XLYP ! XLYP functional [X Xu and WA Goddard, III, PNAS 101, 2673 (2004) ] </li>
<li>167=&gt; XC_GGA_XC_B97 ! Becke 97 [AD Becke, J. Chem. Phys. 107, 8554-8560 (1997) ] </li>
<li>168=&gt; XC_GGA_XC_B97_1 ! Becke 97-1 [FA Hamprecht, AJ Cohen, DJ Tozer, and NC Handy, J. Chem. Phys. 109, 6264 (1998); AD Becke, J. Chem. Phys. 107, 8554-8560 (1997) ] </li>
<li>169=&gt; XC_GGA_XC_B97_2 ! Becke 97-2 [AD Becke, J. Chem. Phys. 107, 8554-8560 (1997) ] </li>
<li>170=&gt; XC_GGA_XC_B97_D ! Grimme functional to be used with C6 vdW term [S Grimme, J. Comput. Chem. 27, 1787 (2006) ] </li>
<li>171=&gt; XC_GGA_XC_B97_K ! Boese-Martin for Kinetics [AD Boese and JML Martin, J. Chem. Phys., Vol. 121, 3405 (2004) ] </li>
<li>172=&gt; XC_GGA_XC_B97_3 ! Becke 97-3 [TW Keal and DJ Tozer, J. Chem. Phys. 123, 121103 (2005) ] </li>
<li>173=&gt; XC_GGA_XC_PBE1W ! Functionals fitted for water [EE Dahlke and DG Truhlar, J. Phys. Chem. B 109, 15677 (2005) ] </li>
<li>174=&gt; XC_GGA_XC_MPWLYP1W ! Functionals fitted for water [EE Dahlke and DG Truhlar, J. Phys. Chem. B 109, 15677 (2005) ] </li>
<li>175=&gt; XC_GGA_XC_PBELYP1W ! Functionals fitted for water [EE Dahlke and DG Truhlar, J. Phys. Chem. B 109, 15677 (2005) ] </li>
<li>176=&gt; XC_GGA_XC_SB98_1a ! Schmider-Becke 98 parameterization 1a [HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998) ] </li>
<li>177=&gt; XC_GGA_XC_SB98_1b ! Schmider-Becke 98 parameterization 1b [HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998) ] </li>
<li>178=&gt; XC_GGA_XC_SB98_1c ! Schmider-Becke 98 parameterization 1c [HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998) ] </li>
<li>179=&gt; XC_GGA_XC_SB98_2a ! Schmider-Becke 98 parameterization 2a [HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998) ] </li>
<li>180=&gt; XC_GGA_XC_SB98_2b ! Schmider-Becke 98 parameterization 2b [HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998) ] </li>
<li>181=&gt; XC_GGA_XC_SB98_2c ! Schmider-Becke 98 parameterization 2c [HL Schmider and AD Becke, J. Chem. Phys. 108, 9624 (1998) ] </li>
<li>183=&gt; XC_GGA_X_OL2 ! Exchange form based on Ou-Yang and Levy v.2 [P Fuentealba and O Reyes, Chem. Phys. Lett. 232, 31-34 (1995) ; H Ou-Yang, M Levy, Int. J. of Quant. Chem. 40, 379-388 (1991) ] </li>
<li>184=&gt; XC_GGA_X_APBE ! mu fixed from the semiclassical neutral atom [LA Constantin, E Fabiano, S Laricchia, and F Della Sala, Phys. Rev. Lett. 106, 186406 (2011) ] </li>
<li>186=&gt; XC_GGA_C_APBE ! mu fixed from the semiclassical neutral atom [LA Constantin, E Fabiano, S Laricchia, and F Della Sala, Phys. Rev. Lett. 106, 186406 (2011) ] </li>
<li>191=&gt; XC_GGA_X_HTBS! Haas, Tran, Blaha, and Schwarz [P Haas, F Tran, P Blaha, and K Schwarz, Phys. Rev. B 83, 205117 (2011) ] </li>
<li>192=&gt; XC_GGA_X_AIRY ! Constantin et al based on the Airy gas [LA Constantin, A Ruzsinszky, and JP Perdew, Phys. Rev. B 80, 035125 (2009) ] </li>
<li>193=&gt; XC_GGA_X_LAG ! Local Airy Gas [L Vitos, B Johansson, J Kollar, and HL Skriver, Phys. Rev. B 62, 10046-10050 (2000) ] </li>
<li>194=&gt; XC_GGA_XC_MOHLYP ! Functional for organometallic chemistry [NE Schultz, Y Zhao, DGJ Truhlar, Phys. Chem. A, 109, 11127 (2005) ] </li>
<li>195=&gt; XC_GGA_XC_MOHLYP2 ! Functional for barrier heights [J Zheng, Y Zhao, DGJ Truhlar, Chem. Theory. Comput. 5, 808 (2009) ] </li>
<li>196=&gt; XC_GGA_XC_TH_FL ! Tozer and Handy v. FL [DJ Tozer, NC Handy, amd WH Green, Chem. Phys. Lett. 273, 183-194 (1997) ] </li>
<li>197=&gt; XC_GGA_XC_TH_FC ! Tozer and Handy v. FC [DJ Tozer, NC Handy, amd WH Green, Chem. Phys. Lett. 273, 183-194 (1997) ] </li>
<li>198=&gt; XC_GGA_XC_TH_FCFO ! Tozer and Handy v. FCFO [DJ Tozer, NC Handy, amd WH Green, Chem. Phys. Lett. 273, 183-194 (1997) ] </li>
<li>199=&gt; XC_GGA_XC_TH_FCO ! Tozer and Handy v. FCO [DJ Tozer, NC Handy, amd WH Green, Chem. Phys. Lett. 273, 183-194 (1997) ] </li>
<li>200=&gt; XC_GGA_C_OPTC ! Optimized correlation functional of Cohen and Handy [AJ Cohen and NC Handy, Mol. Phys. 99, 607-615 (2001) ] </li>
<li>524=&gt; XC_GGA_X_WPBEH ! short-range version of the PBE [J Heyd, GE Scuseria, and M Ernzerhof, J. Chem. Phys. 118, 8207 (2003) ] </li>
<li>525=&gt; XC_GGA_X_HJS_PBE ! HJS screened exchange PBE version [TM Henderson, BG Janesko, and GE Scuseria, J. Chem. Phys. 128, 194105 (2008) ] </li>
<li>526=&gt; XC_GGA_X_HJS_PBE_SOL ! HJS screened exchange PBE_SOL version [TM Henderson, BG Janesko, and GE Scuseria, J. Chem. Phys. 128, 194105 (2008) ] </li>
<li>527=&gt; XC_GGA_X_HJS_B88 ! HJS screened exchange B88 version [TM Henderson, BG Janesko, and GE Scuseria, J. Chem. Phys. 128, 194105 (2008) ] WARNING : this functional is not tested. Use at your own risks. </li>
<li>528=&gt; XC_GGA_X_HJS_B97X ! HJS screened exchange B97x version [TM Henderson, BG Janesko, and GE Scuseria, J. Chem. Phys. 128, 194105 (2008) ] </li>
<li>529=&gt; XC_GGA_X_ITYH ! short-range recipe for exchange GGA functionals [H Iikura, T Tsuneda, T Yanai, and K Hirao, J. Chem. Phys. 115, 3540 (2001) ] WARNING : this functional is not tested. Use at your own risks. </li>
</ul>
<p>MetaGGA functionals (do not forget to add a minus sign, as discussed above).
See Sun et al, PRB 84, 035117 (2011) for the formulas.</p>
<ul>
<li>202=&gt; XC_MGGA_X_TPSS ! Tao, Perdew, Staroverov &amp; Scuseria [J Tao, JP Perdew, VN Staroverov, and G Scuseria, Phys. Rev. Lett. 91, 146401 (2003) ; JP Perdew, J Tao, VN Staroverov, and G Scuseria, J. Chem. Phys. 120, 6898 (2004) ] </li>
<li>203=&gt; XC_MGGA_X_M06L ! Zhao, Truhlar exchange [Y Zhao and DG Truhlar, JCP 125, 194101 (2006); Y Zhao and DG Truhlar, Theor. Chem. Account 120, 215 (2008) ] </li>
<li>204=&gt; XC_MGGA_X_GVT4 ! GVT4 (X part of VSXC) from van Voorhis and Scuseria [T Van Voorhis and GE Scuseria, JCP 109, 400 (1998) ] </li>
<li>205=&gt; XC_MGGA_X_TAU_HCTH ! tau-HCTH from Boese and Handy [AD Boese and NC Handy, JCP 116, 9559 (2002) ] </li>
<li>207=&gt; XC_MGGA_X_BJ06 ! Becke &amp; Johnson correction to Becke-Roussel 89 [AD Becke and ER Johnson, J. Chem. Phys. 124, 221101 (2006) ] WARNING : this Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92. </li>
<li>208=&gt; XC_MGGA_X_TB09 ! Tran-blaha - correction to Becke &amp; Johnson correction to Becke-Roussel 89 [F Tran and P Blaha, Phys. Rev. Lett. 102, 226401 (2009) ] WARNING : this Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92. </li>
<li>209=&gt; XC_MGGA_X_RPP09 ! Rasanen, Pittalis, and Proetto correction to Becke &amp; Johnson [E Rasanen, S Pittalis &amp; C Proetto, arXiv:0909.1477 (2009) ] WARNING : this Vxc-only mGGA can only be used with a LDA correlation, typically Perdew-Wang 92. </li>
<li>232=&gt; XC_MGGA_C_VSXC ! VSxc from Van Voorhis and Scuseria (correlation part) [T Van Voorhis and GE Scuseria, JCP 109, 400 (1998) ] </li>
</ul>
<p>Hybrid functionals (do not forget to add a minus sign, as discussed above).</p>
<ul>
<li>402=&gt; XC_HYB_GGA_XC_B3LYP ! The (in)famous B3LYP [PJ Stephens, FJ Devlin, CF Chabalowski, MJ Frisch, J. Phys. Chem. 98 11623 (1994) ] </li>
<li>406=&gt; XC_HYB_GGA_XC_PBEH ! PBEH (PBE0) [C Adamo and V Barone, J. Chem. Phys. 110, 6158 (1999); M. Ernzerhof, G. E. Scuseria, J. Chem. Phys. 110, 5029 (1999) ] </li>
<li>
<p>427=&gt; XC_HYB_GGA_XC_HSE03 ! The 2003 version of the screened hybrid HSE (in this case one should use omega^HF = 0.15/sqrt(2) and omega^PBE = 0.15*(2.0)**&#8531;) <br />
428=&gt; XC_HYB_GGA_XC_HSE06 ! The 2006 version of the screened hybrid HSE (in
this case one should use omega^HF = omega^PBE = 0.11)<br />
(The following section is taken from the LibXC sources. In ABINIT, we stick to
the LibXC choice.) Note that there is an enormous mess in the literature
concerning the values of omega in HSE. This is due to an error in the original
paper that stated that they had used omega=0.15. This was in fact not true,
and the real value used was omega^HF = 0.15/sqrt(2) ~ 0.1061 and omega^PBE =
0.15*(2.0)**&#8531; ~ 0.1890. In 2006 Krukau et al [JCP 125, 224106 (2006)] tried
to clarify the situation, and called HSE03 to the above choice of parameters,
and called HSE06 to the functional where omega<sup>HF=omega</sup>PBE. By testing
several properties for atoms they reached the conclusion that the best value
for omega=0.11. Of course, codes are just as messy as the papers. In espresso
HSE06 has the value omega=0.106. VASP, on the other hand, uses for HSE03 the
same value omega^HF = omega^PBE = 0.3 (A^-1) ~ 0.1587 and for HSE06 omega^HF =
omega^PBE = 0.2 (A^-1) ~ 0.1058. [J Heyd, GE Scuseria, and M Ernzerhof, J.
Chem. Phys. 118, 8207 (2003); J Heyd, GE Scuseria, and M Ernzerhof, J. Chem.
Phys. 124, 219906 (2006); AV Krukau, OA Vydrov, AF Izmaylov, and GE Scuseria,
J. Chem. Phys. 125, 224106 (2006) ]</p>
</li>
<li>
<p>456=&gt; XC_HYB_GGA_XC_PBE0_13 ! PBE0-&#8531; [P Cortona, J. Chem. Phys. 136, 086101 (2012) ] </p>
</li>
</ul>
<h2 id="jdtset"><strong>jdtset</strong><a class="headerlink" href="#jdtset" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> index -J- for DaTaSETs<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters for a multi dataset calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/multidtset">topic_multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="../basic#ndtset">ndtset</a>)<br />
<em>Default value:</em> [ 1 &hellip; <a class="wikilink codevar-wikilink" href="../basic#ndtset">ndtset</a> ]  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [85/920] in all abinit tests, [11/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Test functionals from libXC that have been added in ABINITv6 or were untested in ABINITv5 (LDAs and GGAs). This is to check the portability for different platform. Extremely quick (nstep=1,  nline=1). Less than 15 secs to test 22 functionals ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Test functionals from libXC that have been added in ABINITv6 or were untested in ABINITv5 (LDAs and GGAs). Spin-polarized case. This is to check the portability for different platform. Extremely quick (nstep=1,  nline=1). Less than 20 secs to test 22 functionals ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>seq:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  rhombohedral. Test finite electric field Check the corectness of the symmetry operations with non-zero tnons." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_55.in" target="_blank">tsv4_55.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Finite electric field calculation In order to perform a first-principles calculation in an electric field,  the wavefunctions must be initialized properly. Therefore, I do first a GS calculation to obtain the WF in the whole BZ under zero electric field. Then,  I increase the electric field slowly in successive datasets. The calculation for each dataset is initialized using the WF of a previous one. I consider both positive and negative electric fields. WARNING : HAS BEEN TRANSFERRED TO tests/seq" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_78.in" target="_blank">tsv4_78.in</a>, <a class="wikilink abifile-wikilink" data-content="CrystallIne AlAs first three runs are for calculation of ground state at finite electric field the fourth run gets the gs wavefunction and then do response calculation the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_80.in" target="_blank">tsv4_80.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO with 4 atoms in DMFT low cutoff,  low number of k-points DMFT with hubbard I tested with self-consistency over density Test of paral_kgb with DMFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t99.in" target="_blank">t99.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Finite difference calculation of the Born effective charges of AlAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_1.in" target="_blank">tffield_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Finite electric field calculation of alas at clamped atomic positions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_6.in" target="_blank">tffield_6.in</a>, <a class="wikilink abifile-wikilink" data-content="Structural optimisation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_1.in" target="_blank">tnlo_1.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Test multi-dataset mode. Si diamond. 2 datasets,  with index 2 and 57 (!). No advanced features like get variables. Rather fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Test multi-dataset mode. Al metal,  10 k points. Start from the output wfs of the previous dataset. Compute tsmear=0.01. Test the idea of using one input file for different runs. The input file is the same as for test 63,  except for the addition of one dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="H atom,  similar to test 87,  except that the box is not cubic, but only parallelipipedic (not even a rectangle parallelipiped). However,  the primitive vectors describe the same lattice as in case 87,  so that the results must be identical to those of test 87,  even if a different FFT grid is used. That is what is observed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t88.in" target="_blank">t88.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 28. The chosen grid (too coarse,  though) is (0 0 0),  (1/4 1/4 0),  (1/2 1/2 0),  (1/2 0 0), (1/2 1/4 1/4),  (1/2 -1/4 1/4)  (in reduced coordinates). The ecut and nkpt parameters are really too low (see test 28), but parameters suitable for physical results (see test 29) are also provided in the input files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t26.in" target="_blank">t26.in</a>, <a class="wikilink abifile-wikilink" data-content="Bismuth,  treated as a metal,  with 2 special points Test the effect of spin-orbit coupling,  especially the forces. The dataset 1 to 3 are related to the nspinor=1 case. The forces are computed from finite differences of energy : abs(etotal3-etotal1)=0.00090461 Ha abs(xcart3-xcart1)=0.089970092 (taking into account both atoms) Their ratio is 0.01005456 Ha/Bohr,  to be compared with fcart2=1.0049850156E-02 Ha/Bohr The dataset 4 checks the case nspinor=2,  pspso=1 (no spin-orbit yet) The dataset 5 to 7 try to reproduce the comparison of forces with spin-orbit : abs(etotal7-etotal5)=0.000445155 Ha abs(xcart7-xcart5)=0.089970092 (taking into account both atoms) Their ratio is 3.83633E-03 Ha/Bohr ... A better finite-difference scheme incorporating also data from half-displacement,  lead to 3.81832E-03 Ha/Bohr. This is in excellent agreement with fcart6=3.8183150850E-03 Ha/Bohr" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t75.in" target="_blank">t75.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Si2 diatomic molecule. Spin-polarized (ferromagnetic). Test phonon RF for spin-polarized case. ixc=1 (Teter LSDA) From dataset 2 and 3,  one gets the derivatives with respect to the atomic displacement along x. The simple finite-difference formula gives the 2DTE 10.88934274 Ha,  while the direct computation, in dataset 4 gives 10.88933963 Ha . Cannot be executed in parallel chkinp: Checking input parameters for consistency,  jdtset= 3. --- !ERROR message: | the number of bands in the spin up case must be equal to the number of bands in the spin down case. This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3 Action : change nband,  or use the sequential version of ABINIT. src_file: chkinp.F90 src_line: 1181 ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t10.in" target="_blank">t10.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with spin-orbit. Should give the same answer than test 2,  except that the k point grid is now defined automatically. Dataset 8 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . Warning : the output file of this test is machine-dependent,  although the final result is not. This is because the degeneracy of the GS wavefunctions with different spin orientation has not been broken." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t14.in" target="_blank">t14.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure Compute the polarization along strings of k-points parallel to the primitive vectors of the reciprocal lattice. The Berry phase calculations are performed in three different datasets. For each datatset,  ABINIT writes the polarization in reduced coordinates to a DDB." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t72.in" target="_blank">t72.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure (Test of Na Sai's technique) To compute the polarization,  the finite difference expression of the ddk and the second-order energy derivatives." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t75.in" target="_blank">t75.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="PbFCl in the matlockite structure P4/nmm. 6 atoms per cell. Compute a set of matrix elements of the dynamical matrix, for q wavevector 0.5 0.5 0.5 . In this test case,  the symmetry operations have an important non-symmorphic character. There was a bug in the treatment of this material,  prior to v5.2.4 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline rhombohedral Antimonium. CP2K PBE pseudopotential. Optimization of the atomic positions with ionmov 2. In the input file several datasets are defined but actually only one of them is chosen for the calculation. The provided xred (one for each dataset) are already the equilibrium position,  so the calculation should use only one optimization step per dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t55.in" target="_blank">t55.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Test of berrystep Al-As cristal,  zinc-blende structure Compute the polarization along strings of k-points parallel to the primitive vectors of the reciprocal lattice,  and using multiple step berry phase calculation. (Tests 21-30 are related to geometry optimization,  molecular dynamics,  etc) Cannot be executed in parallel: chkint_prt: ERROR - Context : the value of the variable nproc is 2. The value of the input variable berrystep is 5,  while it must be equal to 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t20.in" target="_blank">t20.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial.) Cannot be executed with more than 1 MPI node." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t43.in" target="_blank">t43.in</a>, <a class="wikilink abifile-wikilink" data-content="DMFT tests on ferromagnetic NiO (2 atoms),  check DMFT for several values of dmft_solv : computes occupations and energy." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t45.in" target="_blank">t45.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="(Apparently the documentation section of this test has been lost)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3,  compute density,  WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.in" target="_blank">t23.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t24.in" target="_blank">t24.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Crystalline alpha-quartz Calculation of the GW corrections with non-symmorphic operations,  PAW case. but with a set of translated atoms. PAW case. Ordered set of atoms; non-ordered set of atoms; translated atoms. Similar to v5#64,  for PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Test new integration method and grid options for the integral along the imaginary axis in contour deformation calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond: GW band gap with vertex corrections in W;  Gygi-Baldereschi aux function" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t36.in" target="_blank">t36.in</a> &hellip;</li></ul></details><p>Gives the dataset index of each of the datasets. This index will be used :</p>
<ul>
<li>to determine which input variables are specific to each dataset, since the variable names for this dataset will be made from the bare variable name concatenated with this index, and only if such a composite variable name does not exist, the code will consider the bare variable name, or even, the Default; </li>
<li>to characterize output variable names, if their content differs from dataset to dataset; </li>
<li>to characterize output files ( root names appended with _DSx where &lsquo;x&rsquo; is the dataset index ). </li>
</ul>
<p>The allowed index values are between 1 and 9999.<br />
An input variable name appended with 0 is not allowed.<br />
When <a class="wikilink codevar-wikilink" href="../basic#ndtset">ndtset</a>==0, this array is not used, and moreover, no input variable
name appended with a digit is allowed. This array might be initialized thanks
to the use of the input variable <a class="wikilink codevar-wikilink" href="../basic#udtset">udtset</a>. In this case, <a class="wikilink codevar-wikilink" href="../basic#jdtset">jdtset</a> cannot
be used.</p>
<h2 id="kpt"><strong>kpt</strong><a class="headerlink" href="#kpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K - PoinTs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the electronic wavevectors (k-points)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Comment:</em> Adequate for one molecule in a supercell  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [916/920] in all abinit tests, [116/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Test natsph_extra,  ratsph_extra,  and xredsph_extra for STS calculation. Al (111) surface slab with very low ecut and ngkpt in the plane." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Contains the k points in terms of reciprocal space primitive translations (NOT
in cartesian coordinates!).<br />
Needed ONLY if <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>=0, otherwise deduced from other input variables.</p>
<p>It contains dimensionless numbers in terms of which the cartesian coordinates
would be:<br />
k_cartesian = k1*G1+k2*G2+k3*G3<br />
where  (k1,k2,k3)  represent the dimensionless &ldquo;reduced coordinates&rdquo; and  G1,
G2, G3  are the cartesian coordinates of the primitive translation vectors.
G1,G2,G3 are related to the choice of direct space primitive translation
vectors made in <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>. Note that an overall norm for the k points is
supplied by <a class="wikilink codevar-wikilink" href="../basic#kptnrm">kptnrm</a>. This allows one to avoid supplying many digits for the
k points to represent such points as (1,1,1)/3.<br />
Note: one of the algorithms used to set up the sphere of G vectors for the
basis needs components of k-points in the range [-1,1], so the remapping is
easily done by adding or subtracting 1 from each component until it is in the
range [-1,1]. That is, given the k point normalization <a class="wikilink codevar-wikilink" href="../basic#kptnrm">kptnrm</a> described
below, each component must lie in [ -<a class="wikilink codevar-wikilink" href="../basic#kptnrm">kptnrm</a>, <a class="wikilink codevar-wikilink" href="../basic#kptnrm">kptnrm</a> ].<br />
Note: a global shift can be provided by <a class="wikilink codevar-wikilink" href="../internal#qptn">%qptn</a><br />
Not read if <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>/=0 .</p>
<h2 id="kptnrm"><strong>kptnrm</strong><a class="headerlink" href="#kptnrm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K - PoinTs NoRMalization<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the electronic wavevectors (k-points)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [109/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Oxygen atom Test a few functionals for which HGH pseudopotentials are available (from M. Krack), that are present also in the lib XC,  but not in the native ABINIT set of functionals." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>seq:  <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : print the pwfn.data file, for use in a subsequent run of the CASINO code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_90.in" target="_blank">tsv4_90.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_etsf_io.in" target="_blank">testin_etsf_io.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="2 special k point Si in 2-atom diamond unit cell.  Uses symmetry. mkmem=mkpt,  mffmem=1 (&amp;quot;in core&amp;quot; solution), This calculation is also iterated to convergence.  ecut too small. Uses original Teter extended norm conserving psp 14si.psp." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Same as 03 but run with newer Troullier-Martins psp with core density 14si.pspnc.  Start from wf.03 and run irdwfk=1. Also iterated to convergence." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="Restart 05 with wf.05 (irdwfk=1).  Instant convergence." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="MgO FCC crystal,  with very low cut-off,  and 32 k points. Pseudopotentials WITHOUT a non-linear core correction. Compute the dynamical matrices at q(0.25 0.5 0.498) and q(0.25 0.5 0.5). The results should be very close to each other,  but were not in pre v2.1 versions,  because the symmetry was not treated correctly for the highest-symmetry q vector q(0.25 0.5 0.5) (test case found by PTepesch)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t37.in" target="_blank">t37.in</a>, <a class="wikilink abifile-wikilink" data-content="(HeH)+ in a big box. Computation of excitation energies in TDDFT, in the following approximations : TDxOEP/xOEP,  TDLDA/xOEP, BPG hybrid/xOEP." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t42.in" target="_blank">t42.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Output the SCF density,  then partial densities that correspond to the 1st,  2nd,  3rd and 4th valence bands, then the density that corresponds to the 1st conduction band, then the density of the lowest conduction state at 1/4 1/4 1/4,  then the density of the highest valence state at 0 0 0 . Also test the symmetry finder." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t47.in" target="_blank">t47.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Same as test v1 #1,  except use different energy and length units. Test the use of dimensional input variables." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t52.in" target="_blank">t52.in</a>, <a class="wikilink abifile-wikilink" data-content="(HeH)+ in a big box. Computation of oscillator strengths, in the TDxOEP/xOEP approximation. Use a different geometry than in test 42 of test/v2. The Thomas-Reiche-Kuhn sum rule (sum of oscillator strengths should be the number of electrons,  that is,  two in this case) should be valid,  since we are using local pseudopotentials. However,  the number of bands needed to get it is huge : nbands     sum rule 20         1.34   (present case) 30         1.45 40         1.61 60         1.68 80         1.74 100        1.77 120        1.82 160        1.88 200        1.90 240        1.92" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t54.in" target="_blank">t54.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO. Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="Make a simple geometry relaxation and validate the XML output (testing prtxml)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t79.in" target="_blank">t79.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with and without PAW XML data (FJollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t60.in" target="_blank">t60.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with PAW XML data designed for PWPAW (F Jollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t61.in" target="_blank">t61.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with PAW XML data designed for GPAW (F Jollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t62.in" target="_blank">t62.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca in orthorhombic structure. 1 k point,  low ecut. Perform a test of GS total energy computation,  using an experimental PAW pseudopotential (pspcod=7)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t04.in" target="_blank">t04.in</a> &hellip;</li></ul></details><p>Establishes a normalizing denominator for each k point. Needed only if
<a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>&lt;=0, otherwise deduced from other input variables.<br />
The k point coordinates as fractions of reciprocal lattice translations are
therefore <a class="wikilink codevar-wikilink" href="../basic#kpt">kpt</a>(mu,ikpt)/<a class="wikilink codevar-wikilink" href="../basic#kptnrm">kptnrm</a>. <a class="wikilink codevar-wikilink" href="../basic#kptnrm">kptnrm</a> defaults to 1 and can be
ignored by the user. It is introduced to avoid the need for many digits in
representing numbers such as &#8531;.<br />
It cannot be smaller than 1.0d0</p>
<h2 id="kptopt"><strong>kptopt</strong><a class="headerlink" href="#kptopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> KPoinTs OPTion<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the electronic wavevectors (k-points)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/k-points">topic_k-points</a>, <a class="wikilink topic-wikilink" data-content="How to generate the electronic band structure related topics" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/ElecBandStructure">topic_ElecBandStructure</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 4 if <a class="wikilink codevar-wikilink" href="../gstate#nspden">nspden</a>==4,
1 otherwise.</p>
<details class="note"><summary>Test list (click to open). Very frequently used, [758/920] in all abinit tests, [66/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff and kpts,  non collinear spin case with nspden=4 imposed. First normal case then constrain direction only (DS2) and full value of vector (DS3)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_1.in" target="_blank">tmbt_1.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. Forces are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO. Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Response function calculation for: * rigid-atom elastic tensor * rigid-atom piezoelectric tensor * interatomic force constants at gamma * Born effective charges" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_2.in" target="_blank">telast_2.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Finite-difference calculation for c-axis strain increment +/- 0.0001" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_4.in" target="_blank">telast_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Controls the set up of the k-points list. The aim will be to initialize, by
straight reading or by a preprocessing approach based on other input
variables, the following input variables, giving the k points, their number,
and their weight: <a class="wikilink codevar-wikilink" href="../basic#kpt">kpt</a>, <a class="wikilink codevar-wikilink" href="../basic#kptnrm">kptnrm</a>, <a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>, and, for <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>/=-2,
<a class="wikilink codevar-wikilink" href="../basic#wtk">wtk</a>.</p>
<p>Often, the k points will form a lattice in reciprocal space. In this case, one
will also aim at initializing input variables that give the reciprocal of this
k-point lattice, as well as its shift with respect to the origin: <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> or
<a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>, as well as on <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a>.</p>
<p>A global additional shift can be provided by <a class="wikilink codevar-wikilink" href="../internal#qptn">%qptn</a></p>
<ul>
<li>0=&gt; read directly <a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>, <a class="wikilink codevar-wikilink" href="../basic#kpt">kpt</a>, <a class="wikilink codevar-wikilink" href="../basic#kptnrm">kptnrm</a> and <a class="wikilink codevar-wikilink" href="../basic#wtk">wtk</a>. </li>
<li>
<p>1=&gt; rely on <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>, as well as on <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a> to set up the k points. Take fully into account the symmetry to generate the k points in the Irreducible Brillouin Zone only, with the appropriate weights. <br />
(This is the usual mode for GS calculations)</p>
</li>
<li>
<p>2=&gt; rely on <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>, as well as on <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a> to set up the k points. Take into account only the time-reversal symmetry : k points will be generated in half the Brillouin zone, with the appropriate weights. <br />
(This is to be used when preparing or executing a RF calculation at q=(0 0 0)
)</p>
</li>
<li>
<p>3=&gt; rely on <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>, as well as on <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a> to set up the k points. Do not take into account any symmetry : k points will be generated in the full Brillouin zone, with the appropriate weights. <br />
(This is to be used when preparing or executing a RF calculation at non-zero q
)</p>
</li>
<li>
<p>4=&gt; rely on <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>, as well as on <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a> to set up the k points. Take into account all the symmetries EXCEPT the time-reversal symmetry to generate the k points in the Irreducible Brillouin Zone, with the appropriate weights. <br />
This has to be used when performing calculations with non-collinear magnetism
allowed (<a class="wikilink codevar-wikilink" href="../gstate#nspden">nspden</a>=4)</p>
</li>
<li>
<p>A negative value =&gt; rely on <a class="wikilink codevar-wikilink" href="../gstate#kptbounds">kptbounds</a>, and <a class="wikilink codevar-wikilink" href="../gstate#ndivk">ndivk</a> to set up a band structure calculation along different lines (allowed only for <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>==-2). The absolute value of <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> gives the number of segments of the band structure. Weights are usually irrelevant with this option, and will be left to their default value. </p>
</li>
</ul>
<p>In the case of a grid of k points, the auxiliary variables <a class="wikilink codevar-wikilink" href="../gstate#kptrlen">kptrlen</a>,
<a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> and <a class="wikilink codevar-wikilink" href="../files#prtkpt">prtkpt</a> might help you to select the optimal grid.</p>
<h2 id="natom"><strong>natom</strong><a class="headerlink" href="#natom" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of ATOMs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify a crystal, with atomic positions and symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/crystal">topic_crystal</a>, <a class="wikilink topic-wikilink" data-content="How to use the symetry information to build the system from the irreducible part of
the primitive cell" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SmartSymm">topic_SmartSymm</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [920/920] in all abinit tests, [116/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Gives the total number of atoms in the unit cell. Default is 1 but you will
obviously want to input this value explicitly.<br />
Note that <a class="wikilink codevar-wikilink" href="../basic#natom">natom</a> refers to all atoms in the unit cell, not only to the
irreducible set of atoms in the unit cell (using symmetry operations, this set
allows to recover all atoms). If you want to specify only the irreducible set
of atoms, use the symmetriser, see the input variable <a class="wikilink codevar-wikilink" href="../geo#natrd">natrd</a>.</p>
<h2 id="nband"><strong>nband</strong><a class="headerlink" href="#nband" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of BANDs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify bands and occupation numbers, for metals or insulators" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/BandOcc">topic_BandOcc</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> None<br />
<em>Comment:</em>  the estimated number of occupied bands +1 (TODO provide the mathematical formulation)  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [806/920] in all abinit tests, [99/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff and kpts,  non collinear spin case with nspden=4 imposed. First normal case then constrain direction only (DS2) and full value of vector (DS3)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a>, <a class="wikilink abifile-wikilink" data-content="H atom in a big box Same file as t11.in,  except that natom,  typat,  and xcart were changed, and that the input variables nband,  nsppol,  occ and occopt are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_5.in" target="_blank">tbase1_5.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="KSS file generation for silicon with a different number of bands in the KSS computation compared to ground-state." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Gives number of bands, occupied plus possibly unoccupied, for which
wavefunctions are being computed along with eigenvalues.<br />
Note : if the parameter <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a> (see below) is not set to 2, <a class="wikilink codevar-wikilink" href="../basic#nband">nband</a> is a
scalar integer, but if the parameter <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a> is set to 2, then <a class="wikilink codevar-wikilink" href="../basic#nband">nband</a>
must be an array <a class="wikilink codevar-wikilink" href="../basic#nband">nband</a>(<a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>* <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>) giving the number of bands
explicitly for each k point. This option is provided in order to allow the
number of bands treated to vary from k point to k point.<br />
For the values of <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a> not equal to 0 or 2, <a class="wikilink codevar-wikilink" href="../basic#nband">nband</a> can be omitted.
The number of bands will be set up thanks to the use of the variable
<a class="wikilink codevar-wikilink" href="../gstate#fband">fband</a>. The present Default will not be used.</p>
<p>If <a class="wikilink codevar-wikilink" href="../gstate#nspinor">nspinor</a> is 2, nband must be even for each k point.</p>
<p>In the case of a GW calculation (<a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>=3 or 4), <a class="wikilink codevar-wikilink" href="../basic#nband">nband</a> gives the
number of bands to be treated to generate the screening (susceptibility and
dielectric matrix), as well as the self-energy. However, to generate the _KSS
file (see <a class="wikilink codevar-wikilink" href="../files#kssform">kssform</a>) the relevant number of bands is given by <a class="wikilink codevar-wikilink" href="../gw#nbandkss">nbandkss</a>.</p>
<h2 id="nbandhf"><strong>nbandhf</strong><a class="headerlink" href="#nbandhf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of BANDs for (Hartree)-Fock exact exchange<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to use hybrid functionals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> None<br />
<em>Comment:</em> the estimated number of occupied bands (TODO : provide the mathematical formulation)  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Test of PBE0 in sequential case,  norm conserving,  from LibXC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of HSE06 and HSE03 in sequential case,  norm conserving,  from LibXC XG170501 : I would have expected HSE06 and HSE03 total energies to be quite close to each other,  which is not true, as LDA gives -7.867332Ha,  HSE06 gives -7.887495 Ha and HSE03 gives -7.963222 Ha . Might be a problem ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t52.in" target="_blank">t52.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test of PBE0 in sequential case" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of PBE0 in sequential case" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t66.in" target="_blank">t66.in</a></li></ul></details><p>Gives the maximum number of occupied bands with which Fock exact exchange is
being computed for the wavefunctions.</p>
<h2 id="ndtset"><strong>ndtset</strong><a class="headerlink" href="#ndtset" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of DaTaSETs<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters for a multi dataset calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/multidtset">topic_multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [621/920] in all abinit tests, [74/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si,  Bulk,  2 atoms,  paral_kgb. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  with PAW. Test the IO routines with paral_kgb in [1,  0] and different combinations of parameters (npfft,  npband,  npkpt). Test the plane wave load balancing procedure (pw_unbal_thresh). Test also the computation of PJDOS." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t26.in" target="_blank">t26.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_1.in" target="_blank">tmbt_1.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_1.in" target="_blank">tbase2_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom. Here,  a double loop has been used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_2.in" target="_blank">tbase2_2.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Oxygen atom Test a few functionals for which HGH pseudopotentials are available (from M. Krack), that are present also in the lib XC,  but not in the native ABINIT set of functionals." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="Si single atom with fractional occupation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="CO molecule to test the ETSF restart inside several datasets,  also test the reformating of wavelets after wvl_hgrid changed (need compilation with --enable-bigdft)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t18.in" target="_blank">t18.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple test for real space computation (using a wavelet based poisson solver), no forces,  just an H atom in an empty box. The cut-off is unrealistic. This test tests the following part of the code : * psp spline generation for real space; * local part of potential from pseudo; * ion-ion interaction computation (instead of Ewald); * Hartree potential with Poisson's solver." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t20.in" target="_blank">t20.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  static,  spin-polarized. Same system as test 49 of v2,  except that nctime is non-zero. Test ionmov=6 (Verlet) as well as ionmov=7." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t21.in" target="_blank">t21.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Isolated Hydrogen atom. Treated with the Fermi-Amaldi correction (ixc=20),  so that this corresponds to exact cancellation of the Hartree and XC contributions, as it should for Hydrogen atom. Examine the 1s-2s splitting,  that should be equal to 0.375 Ha, and is obtained at 0.368 Ha (so within 2%),  with the chosen ecut and acell. This quantity converges much faster to the correct value than either the total energy or the 1s eigenenergy. Also test effmass_free. A value 10 times bigger than the usual electron mass leads to a 10-fold contraction of the system. The 1s-2s splitting is multiplied by 10 exactly,  provided ecut,  acell and the smearing of the potential at origin are scaled appropriately." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t25.in" target="_blank">t25.in</a>, <a class="wikilink abifile-wikilink" data-content="3H2 molecule with distant atoms : probe the use of the spinat variable Use spin-polarized mode,  spinor mode,  as well as antiferromagnetic mode. Even consider an initialization with reather crazy,  nearly ferromagnetic spinat. Use 01h.pspgth,  in a 8 8 16 box,  with 15 Ha cut-off. Separation is 4 bohr. Consider anti-parallel spin configuration,   which is the favoured one for this distance. Get total energy of -0.981 839  Ha . Note that the spin-polarization is not complete. Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t39.in" target="_blank">t39.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the geometry builder,  and the non-ordering of atoms  : Same thing as test 42,  but with an other order for the input of atoms. Also permutes objects a and b,  to check whether everything is OK." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t43.in" target="_blank">t43.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Si2 molecules (2 atoms per unit cell), using a separable pseudopotential,  with ixc=3. Computation of the second derivative of the total energy with respect to a atomic displacement perpendicular to the chain,  with q(0 0 1/2) wavevector. (see test.si.chain of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Si2 molecules (2 atoms per unit cell), using a separable pseudopotential,  with ixc=3. Computation of the second derivatives of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector,  as well as to an homogeneous electric field. The computed derivatives include the mixed derivative wrt the two perturbations. (see test.si.elfd of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff and kpts,  non collinear spin case with nspden=4 imposed. First normal case then constrain direction only (DS2) and full value of vector (DS3)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="test partial dos calculation with spinors (previously not enabled) and spin polarization while we are at it" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="Cannot be executed in parallel (mlwfovl_qp) Si fcc,  in primitive cell (2 atoms/cell) Test of self-consistent model GW (2 iterations) following Faleev et al., [PRL 93,  126406 (2004)] followed by construction of quasiparticle maximally-localized wannier functions [Hamann &amp;amp; Vanderbilt, arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test- acceptable speed,  and the results are poorly converged.  The input file is sufficiently annotated to serve as a model.  Note that well- converged GW calculations are extremely time consuming,  and in general it is advisable to run the SCGW part separately on a parallel system, and then run a separate serial job modeled on the last dataset, substituting &amp;quot;irdwfk&amp;quot; and &amp;quot;irdqps&amp;quot; for &amp;quot;getwfk&amp;quot; and &amp;quot;getqps, &amp;quot; with appropriate links to the files produced in the serial run.  Note that the _DEN file from the first dataset is also needed as input,  although the discontinued &amp;quot;irdden&amp;quot; input variable is not needed or supported. Note that acceptable names for the secondary input file needed by the wannier90 library are wannier90.win,  w90.win,  abo_DSn_w90.win (ndtset &amp;gt;0) and abo_w90.win (ndtset=0),  where abo is the 4th line of the .files file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon FCC Test the approach of Ambrosetti and Silvestrelli to assess van der Waals interactions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Gives the number of data sets to be treated.<br />
If 0, means that the multi-data set treatment is not used, so that the root
filenames will not be appended with _DSx, where &lsquo;x&rsquo; is the dataset index
defined by the input variable <a class="wikilink codevar-wikilink" href="../basic#jdtset">jdtset</a>, and also that input names with a
dataset index are not allowed. Otherwise, <a class="wikilink codevar-wikilink" href="../basic#ndtset">ndtset</a>=0 is equivalent to
<a class="wikilink codevar-wikilink" href="../basic#ndtset">ndtset</a>=1.</p>
<h2 id="ngkpt"><strong>ngkpt</strong><a class="headerlink" href="#ngkpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Grid points for K PoinTs generation<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the electronic wavevectors (k-points)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> &gt;=0, <br />
<em>The use of this variable forbids the use of:</em> specified(<a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>)  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [497/920] in all abinit tests, [97/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_bigdft.in" target="_blank">testin_bigdft.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si,  Bulk,  2 atoms,  parallel IO. Test of ground state Only with 4 procs,  no sequential version (tests accesswf 1)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t49.in" target="_blank">t49.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_1.in" target="_blank">tmbt_1.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="Crystalline silicon: computation of the total energy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_1.in" target="_blank">tbase3_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : computation of the total energy This input file will NOT work : nkpt does not agree with ngkpt and shiftk. The error message will be given in the &amp;quot;log&amp;quot; file." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_2.in" target="_blank">tbase3_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : computation of the total energy Convergence with respect to the number of k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_3.in" target="_blank">tbase3_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Stishovite (a polymorph of SiO2) Test PBEsol in the PAW formalism,  using PAW datasets created with atompaw linked with libxc. Note that the value of ixc is not present in the input file,  but it is present in the ATOMPAW dataset (pspxc = -116133)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t10.in" target="_blank">t10.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon solid,  experimental lattice parameter. Realistic parameters are used (ecut=20,  ngkpt=2x2x2 shifted 4 times,  but centered on Gamma). Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson). The LDA gap is observed at Gamma : 8.071 eV,  is in reasonable agreement with the gap from the TB paper PRL 102,  226401 (2009), where it is mentioned to be 8.16 eV. The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV. The reading of the kinetic energy density,  to start a non-SCF calculation is not yet implemented, as of ABINITv6.12.0 . This test was used to examine the speed of the convergence in case of elongated cells,  up to 16 atoms. The mGGA convergence was found to be similar to the LDA convergence. Also,  test non-self-consistent mGGA calculation,  with reading of the previously produced _DEN and _KDEN files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t19.in" target="_blank">t19.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Graphene. Test wavelet run on surface" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t14.in" target="_blank">t14.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="KSS file generation for silicon with a different number of bands in the KSS computation compared to ground-state." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon - diamond structure - PAW - volume relaxation Test the use of GPU within Projector Augmented-Wave formalism. Test structure relaxation (multiple calls to gstate routine)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Al2O3 cell in rhombohedric cell with different axes. Dataset 1 : Rhombohedral axes;  full set of symmetries and full set of atoms Dataset 2 : Rhombohedral axes;  irreducible unit cell and space group Dataset 3 : Hexagonal axes;  irreducible unit cell and space group Dataset 4 : Hexagonal axes;  full unit cell and space group The results are equivalent for Dataset 1 and 2 and Dataset 3 and 4." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t96.in" target="_blank">t96.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Orthorhombic Al system,  q(1/2 0 0),  partial occupation numbers. Compares with frozen-phonon calculations. Examine two cases: varying occupation numbers,  and fixed occupation numbers. A. Varying occupation numbers (occopt=4): RF calculation in dataset 5 gives 2DE equal to -3.812577 Ha,  while finite difference of &amp;quot;TOTAL&amp;quot; energy (datasets 6 and 7,  including entropy term) gives -3.812230 Ha (the agreement could be better with better finite difference) B. Fixed occupation numbers (occopt=2): RF calculation in dataset 8 gives 2DE equal to +5.431807 Ha,  while finite difference of total energy (no entropy term is present with occopt=2) gives +5.431857 Ha (the agreement could be better with better finite difference)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 28. The chosen grid (too coarse,  though) is (0 0 0),  (1/4 1/4 0),  (1/2 1/2 0),  (1/2 0 0), (1/2 1/4 1/4),  (1/2 -1/4 1/4)  (in reduced coordinates). The ecut and nkpt parameters are really too low (see test 28), but parameters suitable for physical results (see test 29) are also provided in the input files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t26.in" target="_blank">t26.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for GaAs (zinc-blende). Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 32. The chosen grid (too coarse,  though) has only two special q points : 1/4 1/4 1/4 and 1/4 1/2 1/2 (in reduced coordinates). The Gamma point is also needed,  especially for the computation of dielectric matric and effective charges,  needed to get the asymptotic behaviour of the interatomic force constants. To generate the different responses,  the following steps are followed, with each of them corresponding to a different dataset (the multi-dataset mode allows to have only one input file) : 1) ground state calculation,  with a k-point sampling in the irreducible Brillouin zone only; 2) using the density of 1),  computation of the wavefunctions for the grid of k-points in the full Brillouin zone;  (not really needed in v3.0) 3) computation of the ddk response,  in preparation to the electric field response; 4) computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; 5) using the density of 1),  computation of the GS wavefunctions at k+q where q is 1/4 1/4 1/4; 6) computation of the dynamical matrix at 1/4 1/4 1/4; 7) using the density of 1),  computation of the GS wavefunctions at k+q where q is 1/4 1/2 1/2; 8) computation of the dynamical matrix at 1/4 1/2 1/2 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t30.in" target="_blank">t30.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor First dataset : compute the density Second dataset : compute the spinor wfs at one k point, non-self consistently Third dataset : use the spinor wfs of the previous dataset to restart computations at symmetric k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t13.in" target="_blank">t13.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with spin-orbit. Should give the same answer than test 2,  except that the k point grid is now defined automatically. Dataset 8 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . Warning : the output file of this test is machine-dependent,  although the final result is not. This is because the degeneracy of the GS wavefunctions with different spin orientation has not been broken." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t14.in" target="_blank">t14.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Fe in BCC structure. Low cut-offs and few k-points. This test is done within GGA and (ferro-)magnetism in PAW formalism. The same job is done twice with two differents PAW datasets. First PAW dataset is Fe with a &amp;quot;Bessel&amp;quot; compensation charge shape function expressed analytically. SecondPAW dataset is Fe with a &amp;quot;Bessel&amp;quot; compensation charge shape function expressed numerically." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="Fe in HCP structure. Low cut-offs and few k-points. This test is done within GGA and no magnetism in PAW formalism. The same job is done twice with two differents values of mkmem." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Hydrogen dimer in a big cell. Produce different files (_DEN,  _POT,  _VHXC,  _VHA),  for subsequent analysis by CUT3D (see next run). Note the following values,  that will allow to check the correctness of the subsequent analysis : Kinetic energy  =  1.02998395409183E+00 Hartree energy  =  8.05073794254872E-01 Loc. psp. energy= -2.53949740885919E+00 Band energy (Ha)=  -7.2732761066E-01 Also,  the mean of the Vxc potential is announced to be Average Vxc (hartree)=  -0.05293" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl molecule in a big box. Test of the computation of the polarisation with the routine berryphase_new, for different k-point grids : only 1 k-point,  a line of k-points,  and a full mesh of k-points. Results with acell 20 10 10 are : -9.727 C/m^2,  -9.975 C/m^2,  -9.503 C/m^2 multiplied by the volume (in a.u.),  gives -19454,  -19950,  -19006 Test provided by S. Leroux Going to bigger cells make these results converge to the same value : Results with acell 30 20 20 are : -1.771 C/m^2,  -1.746 C/m^2,  -1.747 C/m^2 multiplied by the volume (in a.u.),  gives -21252,  -20952,  -20964 Results with acell 40 20 20 are : -1.3167C/m^2,  -1.3057C/m^2,  -1.3062C/m^2 multiplied by the volume (in a.u.),  gives -21067,  -20891,  -20899 Results with acell 50 20 20 are : -1.0502C/m^2,  -1.0444C/m^2,  -1.0450C/m^2 multiplied by the volume (in a.u.),  gives -21004,  -20888,  -20900" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t08.in" target="_blank">t08.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test natsph_extra,  ratsph_extra,  and xredsph_extra for STS calculation. Al (111) surface slab with very low ecut and ngkpt in the plane." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff and kpts,  non collinear spin case with nspden=4 imposed. First normal case then constrain direction only (DS2) and full value of vector (DS3)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW response function calculation of derivative of wavefunction (DDK) Si with PAW dataset generated from uspp code. Computes derivative with DFPT formalism,  and also computes energies with displaced k+q so that energies can be checked by finite differences." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t05.in" target="_blank">t05.in</a> &hellip;</li></ul></details><p>Used when <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>&gt;=0, if <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a> has not been defined (<a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>
and <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> are exclusive of each other).<br />
Its three positive components give the number of k points of Monkhorst-Pack
grids (defined with respect to primitive axis in reciprocal space) in each of
the three dimensions. <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> will be used to generate the corresponding
<a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a> input variable. The use of <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a>, allows to
generate shifted grids, or Monkhorst-Pack grids defined with respect to
conventional unit cells.</p>
<p>When <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>=1, <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a> is initialized as a diagonal (3x3) matrix,
whose diagonal elements are the three values <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a>(1:3). When <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>
is greater than 1, ABINIT will try to generate <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a> on the basis of
the primitive vectors of the k-lattice: the number of shifts might be reduced,
in which case <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a> will not be diagonal anymore.</p>
<p>Monkhorst-Pack grids are usually the most efficient when their defining
integer numbers are even. For a measure of the efficiency, see the input
variable <a class="wikilink codevar-wikilink" href="../gstate#kptrlen">kptrlen</a>.</p>
<h2 id="nkpath"><strong>nkpath</strong><a class="headerlink" href="#nkpath" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of K-points defining the PATH<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the electronic wavevectors (k-points)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v8:  <a class="wikilink abifile-wikilink" data-content="Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t04.in" target="_blank">t04.in</a></li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Diamond: hybrid functional calculation with the GW code Self-consistent approach to the HSE06 band structure based on a unitary transform of a subset of LDA wavefunctions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t42.in" target="_blank">t42.in</a></li></ul></details><p>This variable is used to define the number of high-symmetry k-points in the
<a class="wikilink codevar-wikilink" href="../gstate#kptbounds">kptbounds</a> array when <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> &gt; 0. Historically, <a class="wikilink codevar-wikilink" href="../gstate#kptbounds">kptbounds</a> is used
in conjuction with a negative value of <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> when performing a NSCF band
structure calculation. In this case, the number of k-points in kptbounds is
given by abs(kptopt) + 1. There are, however, other cases in which one has to
specify a k-path in the input file in order to activate some kind of post-
processing tool. Typical examples are the interpolation of the GW corrections
at the end of the sigma run or the interpolation of the KS eigenvalues along a
path at the end of the SCF run (see also <a class="wikilink codevar-wikilink" href="../basic#einterp">einterp</a>) In a nutshell, nkpath
replaces <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> when we are not performing a NSCF calculation. Note that,
unlike <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>, nkpath represents the total number of points in the
<a class="wikilink codevar-wikilink" href="../gstate#kptbounds">kptbounds</a> array.</p>
<h2 id="nkpt"><strong>nkpt</strong><a class="headerlink" href="#nkpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of K - Points<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the electronic wavevectors (k-points)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>==0,
0 otherwise.</p>
<details class="note"><summary>Test list (click to open). Very frequently used, [488/920] in all abinit tests, [29/116] in abinit tutorials</summary><ul><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. Forces are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test of the extension of the pspcod=8 input format to include spin-orbit coupling with multiple non-local projectors.  The band structure of fcc Pt is computed at Gamma,  X,  and L. The pseudopotential used in the test is generated by the open-source ONCVPSP code,  which is available at www.mat-simresearch.com,  and described in D. R. Hamann,  Phys. Rev. B 88,  085177 (2013). The relativistic extension is documented in the code package. The Pt 5s and 5p semi-cores are treated as valence,  and the band structure is well-converged at the ecut used in the test (20 Ha). A complete description of the input format is avaiable in doc/psp_infos/psp8_info.txt." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Boron,  32 atoms - Thomas-Fermi method (without orbitals) Test the temperature-dependent XC functional (ixc=50) (Ichimaru et al Phys. Rep. 149,  91-205 (1987) Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3,  compute density,  WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.in" target="_blank">t23.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="KSS file generation for silicon with a different number of bands in the KSS computation compared to ground-state." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO. Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a>, <a class="wikilink abifile-wikilink" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_02.in" target="_blank">tgspw_02.in</a>, <a class="wikilink abifile-wikilink" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_03.in" target="_blank">tgspw_03.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="WARNING: This code is still under development. Use at your own risk. Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.in" target="_blank">t44.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a> &hellip;</li></ul></details><p>If non-zero, <a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a> gives the number of k points in the k point array
<a class="wikilink codevar-wikilink" href="../basic#kpt">kpt</a>. These points are used either to sample the Brillouin zone, or to
build a band structure along specified lines.</p>
<p>If <a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a> is zero, the code deduces from other input variables (see the list
in the description of <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>) the number of k points, which is possible
only when <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>/=0. If <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>/=0 and the input value of <a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>/=0,
then ABINIT will check that the number of k points generated from the other
input variables is exactly the same than <a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>.</p>
<p>If <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> is positive, <a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a> must be coherent with the values of
<a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>, <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a>.<br />
For ground state calculations, one should select the k point in the
irreducible Brillouin Zone (obtained by taking into account point symmetries
and the time-reversal symmetry).<br />
For response function calculations, one should select k points in the full
Brillouin zone, if the wavevector of the perturbation does not vanish, or in a
half of the Brillouin Zone if q=0. The code will automatically decrease the
number of k points to the minimal set needed for each particular perturbation.</p>
<p>If <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a> is negative, <a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a> will be the sum of the number of points on
the different lines of the band structure. For example, if <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>=-3, one
will have three segments; supposing <a class="wikilink codevar-wikilink" href="../gstate#ndivk">ndivk</a> is 10 12 17, the total number of
k points of the circuit will be 10+12+17+1(for the final point)=40.</p>
<h2 id="nkpthf"><strong>nkpthf</strong><a class="headerlink" href="#nkpthf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of K - Points for (Hartree) Fock exact exchange<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to use hybrid functionals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> None<br />
<em>Comment:</em>  the total number of k-point in the full Brillouin zone (TODO : provide the mathematical formulation)  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Test of PBE0 in sequential case,  norm conserving,  from LibXC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of HSE06 and HSE03 in sequential case,  norm conserving,  from LibXC XG170501 : I would have expected HSE06 and HSE03 total energies to be quite close to each other,  which is not true, as LDA gives -7.867332Ha,  HSE06 gives -7.887495 Ha and HSE03 gives -7.963222 Ha . Might be a problem ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t52.in" target="_blank">t52.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test of PBE0 in sequential case" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of PBE0 in sequential case" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t66.in" target="_blank">t66.in</a></li></ul></details><p><a class="wikilink codevar-wikilink" href="../basic#nkpthf">nkpthf</a> gives the number of k points used to sample the full Brillouin zone
for the Fock exact exchange contribution.</p>
<h2 id="nshiftk"><strong>nshiftk</strong><a class="headerlink" href="#nshiftk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of SHIFTs for K point grids<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the electronic wavevectors (k-points)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [437/920] in all abinit tests, [90/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using old,  rather inaccurate psps. Computation of the Berry phase. Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_04.in" target="_blank">tsv3_04.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  rhombohedral. Test finite electric field Check the corectness of the symmetry operations with non-zero tnons." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_55.in" target="_blank">tsv4_55.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_bigdft.in" target="_blank">testin_bigdft.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_wannier90.in" target="_blank">testin_wannier90.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si,  Bulk,  2 atoms,  paral_kgb. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test the triple parallelisation. We cannot check the distribution npband*npfft*npkpt=2*2*2=8 processors, this number being not allowed in the test procedure. Here,  we only test the parallelisation over FFT and kpoints: npband*npfft*npkpt=1*2*2=4 processors. In test tY.in we check other distributions for guarantee." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t24.in" target="_blank">t24.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_1.in" target="_blank">tmbt_1.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Screening calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_2.in" target="_blank">tmbt_2.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.in" target="_blank">tmbt_3.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="Crystalline silicon: computation of the total energy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_1.in" target="_blank">tbase3_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : computation of the total energy This input file will NOT work : nkpt does not agree with ngkpt and shiftk. The error message will be given in the &amp;quot;log&amp;quot; file." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_2.in" target="_blank">tbase3_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : computation of the total energy Convergence with respect to the number of k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_3.in" target="_blank">tbase3_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon solid,  experimental lattice parameter. Realistic parameters are used (ecut=20,  ngkpt=2x2x2 shifted 4 times,  but centered on Gamma). Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson). The LDA gap is observed at Gamma : 8.071 eV,  is in reasonable agreement with the gap from the TB paper PRL 102,  226401 (2009), where it is mentioned to be 8.16 eV. The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV. The reading of the kinetic energy density,  to start a non-SCF calculation is not yet implemented, as of ABINITv6.12.0 . This test was used to examine the speed of the convergence in case of elongated cells,  up to 16 atoms. The mGGA convergence was found to be similar to the LDA convergence. Also,  test non-self-consistent mGGA calculation,  with reading of the previously produced _DEN and _KDEN files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t19.in" target="_blank">t19.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond: hybrid functional calculation with the GW code Perturbative approach to the HSE06,  PBE0,  and B3LYP band gaps HSE06 and PBE0 tests temporarily disabled,  waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.in" target="_blank">t41.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Graphene. Test wavelet run on surface" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t14.in" target="_blank">t14.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="KSS file generation for silicon with a different number of bands in the KSS computation compared to ground-state." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="BCC Helium q close to Gamma,  along Gamma-H There is a problem with kptopt=1 or 3 for the NSC step." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t12.in" target="_blank">t12.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 28. The chosen grid (too coarse,  though) is (0 0 0),  (1/4 1/4 0),  (1/2 1/2 0),  (1/2 0 0), (1/2 1/4 1/4),  (1/2 -1/4 1/4)  (in reduced coordinates). The ecut and nkpt parameters are really too low (see test 28), but parameters suitable for physical results (see test 29) are also provided in the input files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t26.in" target="_blank">t26.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for GaAs (zinc-blende). Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 32. The chosen grid (too coarse,  though) has only two special q points : 1/4 1/4 1/4 and 1/4 1/2 1/2 (in reduced coordinates). The Gamma point is also needed,  especially for the computation of dielectric matric and effective charges,  needed to get the asymptotic behaviour of the interatomic force constants. To generate the different responses,  the following steps are followed, with each of them corresponding to a different dataset (the multi-dataset mode allows to have only one input file) : 1) ground state calculation,  with a k-point sampling in the irreducible Brillouin zone only; 2) using the density of 1),  computation of the wavefunctions for the grid of k-points in the full Brillouin zone;  (not really needed in v3.0) 3) computation of the ddk response,  in preparation to the electric field response; 4) computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; 5) using the density of 1),  computation of the GS wavefunctions at k+q where q is 1/4 1/4 1/4; 6) computation of the dynamical matrix at 1/4 1/4 1/4; 7) using the density of 1),  computation of the GS wavefunctions at k+q where q is 1/4 1/2 1/2; 8) computation of the dynamical matrix at 1/4 1/2 1/2 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t30.in" target="_blank">t30.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Si crystal. GGA + non-linear XC core correction. Compute the interatomic force constant for the displacement of the second atom along (111). RF calculation of the 2DTE gives 7.51663417 Ha while finite differences gives: with delta(xred)=0.0001,  7.15663267 Ha. The agreement is quite good,  and might likely be improved by combining finite differences. Also compute the ddk and electric field responses. The number of k points is much too small to obtain physical values,  but are quite comparable to the result of test v2 #6" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t16.in" target="_blank">t16.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in 2-atom diamond unit cell (nkpt 2;  ecut 6) In dataset 1,  ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16). the eigenvectors necessary for the GW calculation being stored in _WFK. In dataset 2,  ABINIT computes the eps^-1 matrix (optdriver 3) nband 10) for the GW calculation and stores it in _SCR. In dataset 3-6,  ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.in" target="_blank">t30.in</a>, <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure (nkpt 2;  ecut 6) In dataset 1,  ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16) the eigenvectors necessary for the GW calculation being stored in _WFK. In dataset 2,  ABINIT computes the eps^-1 matrix (optdriver 3,  nband 10) for the GW calculation and stores it in _SCR. In dataset 3,  ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.in" target="_blank">t31.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Fe in BCC structure. Low cut-offs and few k-points. This test is done within GGA and (ferro-)magnetism in PAW formalism. The same job is done twice with two differents PAW datasets. First PAW dataset is Fe with a &amp;quot;Bessel&amp;quot; compensation charge shape function expressed analytically. SecondPAW dataset is Fe with a &amp;quot;Bessel&amp;quot; compensation charge shape function expressed numerically." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="Fe in HCP structure. Low cut-offs and few k-points. This test is done within GGA and no magnetism in PAW formalism. The same job is done twice with two differents values of mkmem." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="NaCl molecule in a big box. Test of the computation of the polarisation with the routine berryphase_new, for different k-point grids : only 1 k-point,  a line of k-points,  and a full mesh of k-points. Results with acell 20 10 10 are : -9.727 C/m^2,  -9.975 C/m^2,  -9.503 C/m^2 multiplied by the volume (in a.u.),  gives -19454,  -19950,  -19006 Test provided by S. Leroux Going to bigger cells make these results converge to the same value : Results with acell 30 20 20 are : -1.771 C/m^2,  -1.746 C/m^2,  -1.747 C/m^2 multiplied by the volume (in a.u.),  gives -21252,  -20952,  -20964 Results with acell 40 20 20 are : -1.3167C/m^2,  -1.3057C/m^2,  -1.3062C/m^2 multiplied by the volume (in a.u.),  gives -21067,  -20891,  -20899 Results with acell 50 20 20 are : -1.0502C/m^2,  -1.0444C/m^2,  -1.0450C/m^2 multiplied by the volume (in a.u.),  gives -21004,  -20888,  -20900" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="Print out CIF file for simple cubic Ti crystal,  for reference purposes (conventional = primitive unit cell for symmetry ops)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the extension of the pspcod=8 input format to include spin-orbit coupling with multiple non-local projectors.  The band structure of fcc Pt is computed at Gamma,  X,  and L. The pseudopotential used in the test is generated by the open-source ONCVPSP code,  which is available at www.mat-simresearch.com,  and described in D. R. Hamann,  Phys. Rev. B 88,  085177 (2013). The relativistic extension is documented in the code package. The Pt 5s and 5p semi-cores are treated as valence,  and the band structure is well-converged at the ecut used in the test (20 Ha). A complete description of the input format is avaiable in doc/psp_infos/psp8_info.txt." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation in (N, V, T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested together with the three coordinate systems (primitive,  normal mode,  staging). NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with --- Pseudopotential description --" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t08.in" target="_blank">t08.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="PAW response function calculation of derivative of wavefunction (DDK) Si with PAW dataset generated from uspp code. Computes derivative with DFPT formalism,  and also computes energies with displaced k+q so that energies can be checked by finite differences." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW: test of some variables reserved to experienced users or developers BCC iron,  ferromagnetic,  GGA,  PAW. Also tests maxnsym keyword." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate both DEN and PAWDEN files for silicon. Note that in the PAW case,  DEN files include the valence density and compensation charge,  while PAWDEN files include the valence and on-site corrections,  but not the compensation charge. Therefore,  DEN files are needed for further computations,  while PAWDEN files are useful for visualization,  AIM,  and other post-processing of the density. PAW AE DEN not compatible with parallelization over atoms." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t11.in" target="_blank">t11.in</a> &hellip;</li></ul></details><p>This parameter gives the number of shifted grids to be used concurrently to
generate the full grid of k points. It can be used with primitive grids
defined either from <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>. The maximum allowed value of
<a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a> is 8. The values of the shifts are given by <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a>.</p>
<h2 id="nsppol"><strong>nsppol</strong><a class="headerlink" href="#nsppol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of SPin POLarization<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters for a spin-polarized calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [160/920] in all abinit tests, [18/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Test functionals from libXC that were present in ABINITv5 (LDAs and GGAs). This is to check the portability for different platform. Extremely quick (nstep=1,  nline=1). Less than 20 secs to test 45 functionals ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="Fe in BCC structure. Low cut-offs and few k-points. This test is done within GGA and (ferro-)magnetism in PAW formalism. The same job is done twice with two differents PAW datasets. First PAW dataset is Fe with a &amp;quot;Bessel&amp;quot; compensation charge shape function expressed analytically. SecondPAW dataset is Fe with a &amp;quot;Bessel&amp;quot; compensation charge shape function expressed numerically." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the strain perturbation with GGA  and spin polarization This is the same as t79,  bcc Fe, but with the PBE GGA.  This calculation is restricted to one unaxial strain,  which adequately tests the polarization-dependent parts of the strain GGA code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the strain perturbation with spin polarization and metallic occupation of states Fe in the bcc structure.  This tests both the introduction of spin polarization into strain response function calculations and an improved treatment of the first-order fermi energy for Q=0 metallic calculations.  Similar data (with much larger cutoffs,  tighter convergence tolerances,  and larger k sample) was used test the elastic tensor in comparison with numerical derivatives of the stress from GS calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t79.in" target="_blank">t79.in</a> &hellip;</li><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : print the pwfn.data file, for use in a subsequent run of the CASINO code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_90.in" target="_blank">tsv4_90.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Isolated hydrogen atom Calculation of the HF levels with different ways to integrate the Coulomb divergence" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon: Solution of the Bethe-Salpeter equation (BSE) with PAW and nsppol = 2. Use model dielectric function computed from AE PAW density (denfgr.F90)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t29.in" target="_blank">t29.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="Pt single atom with semi-core electrons,  Krack pseudopotentials (pspcod = 10), and colinear spin polarisation (GGA functional)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_libxc.in" target="_blank">testin_libxc.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test the triple parallelisation. We cannot check the distribution npband*npfft*npkpt=2*2*2=8 processors, this number being not allowed in the test procedure. Here,  we only test the parallelisation over bands and spins: npband*npfft*npkpt=2*1*2=4 processors. In addition,  we also test here various features of bandfft-kpt parallelisation In particular,  the bandpp,  istwfk=2 and wfoptalg=14 variables." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t25.in" target="_blank">t25.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO with 4 atoms in DMFT low cutoff,  low number of k-points DMFT with hubbard I tested with self-consistency over density Test of paral_kgb with DMFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t99.in" target="_blank">t99.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  static,  spin-polarized.  Write t17o_DEN (prtden=1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t17.in" target="_blank">t17.in</a>, <a class="wikilink abifile-wikilink" data-content="Re-run 17 but in slightly larger box,  same ecut,  larger ng. (Box is still too small for proper model of Si2.)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t19.in" target="_blank">t19.in</a>, <a class="wikilink abifile-wikilink" data-content="Conduct relaxation of molecule starting from wf.19,  using ionmov=2. (Broyden method)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t20.in" target="_blank">t20.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="O2 molecule,  treated like a metal (there is a degeneracy at the Fermi level), occopt=4 and tsmear=0.04,  with nsppol=2 . Use spinat to polarize the molecule at start. Gives total energy of -32.09317 Hartree This test can be used to check the accuracy of stresses in the spin-polarized case. Setting acell(1:2) to 7.005 and 6.995 gives ETOT -32.090846193972 and -32.095501753750, ucvol  441.63023 and 440.37023 so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03, to be compared with sigma(1)=3.6949713786E-03 and sigma(2)=3.6949681083E-03 from the present test (the degeneracy is slightly lifted because of incomplete convergence, using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both sigma values)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 molecule,  treated as a spin-polarized molecule,  with fixed occupation numbers (occopt=2),  with nsppol=2 . Gives total energy of -32.09792 Hartree" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Hydrogen atom (see above) Treated with LSD,  Teter rational polynomial parametrization (4/93) (ixc=1). The total energy is -0.4792 Ha. Also additional tests concerning the kinetic energy density calculation, the gradient of electronic density calculation and the Laplacian of electronic density calculation are performed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t21.in" target="_blank">t21.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="O2 (non-spin-polarized,  non-linear XC core correction,  GGA) Computation of forces in the GGA,  and comparison with a finite difference of energy. The direct computation of force (dataset 2) gives 0.627251486 Ha/Bohr A simple finite-difference estimation (dataset 1 and 3) gives 0.627251265 Ha/Bohr. The agreement can be improved if a better finite-difference estimation is used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t40.in" target="_blank">t40.in</a>, <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  static,  spin-polarized. Same system as test 17 of fast,  except lower ecut. Test ionmov=6 (Verlet) as well as ionmov=7. Cannote be executed in parallel: --- !ERROR message: | the number of bands in the spin up case must be equal to the number of bands in the spin down case. This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3 Action : change nband,  or use the sequential version of ABINIT. src_file: chkinp.F90 src_line: 1181" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t49.in" target="_blank">t49.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 (nsppol=2,  non-linear XC core correction,  GGA) Some similarities with test 41,  except that nsppol=2 instead of 1. Computation of uniaxial stresses in the GGA, and comparison with a finite difference of energy. The estimation of sigma(zz) stress  at acell(3)=9.0 from acell(3)=8.9991 and 9.0009 gives 1.62867d-3 Ha/Bohr**3 A simple finite-difference estimation gives a difference in total energy of 0.123861d-3 Ha, for a difference of volume of 0.07605 Bohr**3 leading to a stress estimation of 1.62867d-3 Ha/Bohr**3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t50.in" target="_blank">t50.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Si2 diatomic molecule. Spin-polarized (ferromagnetic). Test phonon RF for spin-polarized case. ixc=1 (Teter LSDA) From dataset 2 and 3,  one gets the derivatives with respect to the atomic displacement along x. The simple finite-difference formula gives the 2DTE 10.88934274 Ha,  while the direct computation, in dataset 4 gives 10.88933963 Ha . Cannot be executed in parallel chkinp: Checking input parameters for consistency,  jdtset= 3. --- !ERROR message: | the number of bands in the spin up case must be equal to the number of bands in the spin down case. This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3 Action : change nband,  or use the sequential version of ABINIT. src_file: chkinp.F90 src_line: 1181 ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t10.in" target="_blank">t10.in</a>, <a class="wikilink abifile-wikilink" data-content="Si2 diatomic molecule. Spin-polarized (ferromagnetic). Test phonon RF for spin-polarized case. ixc=7 (Perdew-Wang 92 LSDA) From dataset 2 and 3,  one gets the derivatives with respect to the atomic displacement along x. The simple finite-difference formula gives the 2DTE 10.88283478 Ha,  while the direct computation, in dataset 4 gives 10.882832 Ha . Cannot be executed in parallel --- !ERROR message: | the number of bands in the spin up case must be equal to the number of bands in the spin down case. This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3 Action : change nband,  or use the sequential version of ABINIT. src_file: chkinp.F90 src_line: 1181 ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule. Spin-polarized (anti-ferromagnetic). Test phonon RF for spin-polarized case. ixc=1 (Teter LSDA) From datasets 3 and 4,  one gets the derivatives with respect to the atomic displacement along x. The simple finite-difference formula gives the 2DTE 6.283100652 Ha,  while the direct computation, without using Shubnikov symmetries,  gives 6.282967527 Ha." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  static,  spin-polarized. Same system as test 49 of v2,  except that nctime is non-zero. Test ionmov=6 (Verlet) as well as ionmov=7." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t21.in" target="_blank">t21.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H atom in a big box Same file as t11.in,  except that natom,  typat,  and xcart were changed, and that the input variables nband,  nsppol,  occ and occopt are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_5.in" target="_blank">tbase1_5.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_1.in" target="_blank">tbase2_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom. Here,  a double loop has been used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_2.in" target="_blank">tbase2_2.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi atom in a big supercell. Test the application of a Zeeman field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t17.in" target="_blank">t17.in</a>, <a class="wikilink abifile-wikilink" data-content="Tests series for the mGGA implementation (from 31 to 33) Silicon bulk. Two datasets are run. One (classic) LDA calculation with ixc 7. One with a fake native mGGA (fake1,  i.e. ixc 31) and using effmass_free=1.01. Both calculation should give the same total energy (change in kinetic energy due to effmass_free is compensated by the fake mGGA using kinetic energy density: taur). (Two other datasets are also run for spin polarized case)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t31.in" target="_blank">t31.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff and kpts,  non collinear spin case with nspden=4 imposed. First normal case then constrain direction only (DS2) and full value of vector (DS3)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="test partial dos calculation with spinors (previously not enabled) and spin polarization while we are at it" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the extension of the pspcod=8 input format to include spin-orbit coupling with multiple non-local projectors.  The band structure of fcc Pt is computed at Gamma,  X,  and L. The pseudopotential used in the test is generated by the open-source ONCVPSP code,  which is available at www.mat-simresearch.com,  and described in D. R. Hamann,  Phys. Rev. B 88,  085177 (2013). The relativistic extension is documented in the code package. The Pt 5s and 5p semi-cores are treated as valence,  and the band structure is well-converged at the ecut used in the test (20 Ha). A complete description of the input format is avaiable in doc/psp_infos/psp8_info.txt." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Response of magnetic metal to external magnetic field. First,  ground state wf is computed,  then dfpt calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t20.in" target="_blank">t20.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure - anitferro - PAW Test the use of MPI+GPU" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure - anitferro - PAW Test the use of MPI+GPU" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW: test of some variables reserved to experienced users or developers BCC iron,  ferromagnetic,  GGA,  PAW. Also tests maxnsym keyword." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple test for LDA+U implementation. no forces,  2 Ni and 2 O atoms in an fcc supercell. The cut-off is unrealistic. This test tests the following part of the code : * paw LDA+U (pawpupot,  pawpuenergy,  pawpuinit)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t08.in" target="_blank">t08.in</a> &hellip;</li></ul></details><p>Give the number of INDEPENDENT spin polarisations, for which there are non-
related wavefunctions. Can take the values 1 or 2.</p>
<p>If <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>=1, one has an unpolarized calculation (<a class="wikilink codevar-wikilink" href="../gstate#nspinor">nspinor</a>=1,
<a class="wikilink codevar-wikilink" href="../gstate#nspden">nspden</a>=1) or an antiferromagnetic system (<a class="wikilink codevar-wikilink" href="../gstate#nspinor">nspinor</a>=1, <a class="wikilink codevar-wikilink" href="../gstate#nspden">nspden</a>=2), or
a calculation in which spin up and spin down cannot be disentangled
(<a class="wikilink codevar-wikilink" href="../gstate#nspinor">nspinor</a>=2), that is, either non-collinear magnetism or presence of spin-
orbit coupling, for which one needs spinor wavefunctions.</p>
<p>If <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>=2, one has a spin-polarized (collinear) calculation with
separate and different wavefunctions for up and down spin electrons for each
band and k point. Compatible only with <a class="wikilink codevar-wikilink" href="../gstate#nspinor">nspinor</a>=1, <a class="wikilink codevar-wikilink" href="../gstate#nspden">nspden</a>=2. If
<a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>=2, one usually uses a metallic value for <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>, in order to
let ABINIT find the magnetization. On the contrary, if <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>==1 is used,
the user has to impose the magnetization, using <a class="wikilink codevar-wikilink" href="../ffield#spinmagntarget">spinmagntarget</a>, except for
the case of a single isolated Hydrogen atom.</p>
<p>In the present status of development, with <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>=1, all values of <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a>
are allowed, while with <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>=2, some values of <a class="wikilink codevar-wikilink" href="../basic#ixc">ixc</a> might not be
allowed (e.g. 2, 3, 4, 5, 6, 20, 21, 22 are not allowed).</p>
<p>See also the input variable <a class="wikilink codevar-wikilink" href="../gstate#nspden">nspden</a> for the components of the density
matrix with respect to the spin-polarization.</p>
<h2 id="nstep"><strong>nstep</strong><a class="headerlink" href="#nstep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of (non-)self-consistent field STEPS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to control the SCF cycle" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 30  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [877/920] in all abinit tests, [108/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Gives the maximum number of cycles (or &ldquo;iterations&rdquo;) in a SCF or non-SCF run.<br />
Full convergence from random numbers is usually achieved in 12-20 SCF
iterations. Each can take from minutes to hours. In certain difficult cases,
usually related to a small or zero bandgap or magnetism, convergence
performance may be much worse. When the convergence tolerance <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a> on
the wavefunctions is satisfied, iterations will stop, so for well converged
calculations you should set <a class="wikilink codevar-wikilink" href="../basic#nstep">nstep</a> to a value larger than you think will be
needed for full convergence, e.g. if using 20 steps usually converges the
system, set <a class="wikilink codevar-wikilink" href="../basic#nstep">nstep</a> to 30.<br />
For non-self-consistent runs ( <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a> &lt; 0) nstep governs the number of
cycles of convergence for the wavefunctions for a fixed density and
Hamiltonian.</p>
<p>NOTE that a choice of <a class="wikilink codevar-wikilink" href="../basic#nstep">nstep</a>=0 is permitted; this will either read
wavefunctions from disk (with <a class="wikilink codevar-wikilink" href="../files#irdwfk">irdwfk</a>=1 or <a class="wikilink codevar-wikilink" href="../files#irdwfq">irdwfq</a>=1, or non-zero
<a class="wikilink codevar-wikilink" href="../files#getwfk">getwfk</a> or <a class="wikilink codevar-wikilink" href="../files#getwfq">getwfq</a> in the case of multi-dataset) and compute the
density, the total energy and stop, or else (with all of the above vanishing)
will initialize randomly the wavefunctions and compute the resulting density
and total energy. This is provided for testing purposes.<br />
Also NOTE that <a class="wikilink codevar-wikilink" href="../basic#nstep">nstep</a>=0 with <a class="wikilink codevar-wikilink" href="../files#irdwfk">irdwfk</a>=1 will exactly give the same result
as the previous run only if the latter is done with <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>&lt;10 (potential
mixing).<br />
One can output the density by using <a class="wikilink codevar-wikilink" href="../files#prtden">prtden</a>.<br />
The forces and stress tensor are computed with <a class="wikilink codevar-wikilink" href="../basic#nstep">nstep</a>=0.</p>
<h2 id="nsym"><strong>nsym</strong><a class="headerlink" href="#nsym" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of SYMmetry operations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify a crystal, with atomic positions and symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/crystal">topic_crystal</a>, <a class="wikilink topic-wikilink" data-content="How to perform a GW calculation, including self-consistency" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/GW">topic_GW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [343/920] in all abinit tests, [11/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="CrystallIne AlAs first three runs are for calculation of ground state at finite electric field the fourth run gets the gs wavefunction and then do response calculation the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_80.in" target="_blank">tsv4_80.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_bigdft.in" target="_blank">testin_bigdft.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="Hydronium ion + NH3 molecule Ground state calculation keeping O and H atoms fixed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tstring_01.in" target="_blank">tstring_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="Input for PAW1 tutorial Diamond at experimental volume" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tpaw1_1.in" target="_blank">tpaw1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Input for PAW1 tutorial Diamond at experimental volume" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tpaw1_2.in" target="_blank">tpaw1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Input for PAW1 tutorial Diamond at experimental volume" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tpaw1_3.in" target="_blank">tpaw1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Carbon atom Test the mGGA functionals generating directly XC potentials. Similar to test 08,  but with smaller acell and ecut. Without the use of a &amp;quot;large&amp;quot; xc_denpos,  Tran-Blaha is hard to converge. Hypothesis : there is a strong non-linear region,  preventing the Anderson method to work effectively. Note that the default iscf (=7) does not allow to converge with the default xc_denpos ! By contrast,  things are much better behaved with xc_denpos on the order of 1.0e-7 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t13.in" target="_blank">t13.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO. Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  static,  spin-polarized. Same system as test 49 of v2,  except that nctime is non-zero. Test ionmov=6 (Verlet) as well as ionmov=7." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t21.in" target="_blank">t21.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon - diamond structure - PAW - volume relaxation Test the use of GPU within Projector Augmented-Wave formalism. Test structure relaxation (multiple calls to gstate routine)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca in orthorhombic structure. 1 k point,  low ecut. Perform a test of GS total energy computation,  using an experimental PAW pseudopotential (pspcod=7)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW: test of some variables reserved to experienced users or developers BCC iron,  ferromagnetic,  GGA,  PAW. Also tests maxnsym keyword." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Test to prepare a conductivity calculation (test v5#t10) Ground state calculation for 4 Al atoms The number of bands is unrealistic. This test produces files that are inputs for test 10. It tests the following parts of the code: optic_paw,  optic_paw_core Note that,  in addition to the psp file,  the core wave functions file is needed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation in (N, V, T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested together with the three coordinate systems (primitive,  normal mode,  staging). NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with --- Pseudopotential description --" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the extrapolation of then wave functions from one structural relaxation (time) step to the other: extrapwf=1 WARNING: this feature is stil experimental and probably buggy. Si,  Bulk,  2 atoms" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="For SrVO3,  compute density,  WFC and KSS files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t23.in" target="_blank">t23.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li></ul></details><p>Gives number of space group symmetries to be applied in this problem.
Symmetries will be input in array &ldquo;<a class="wikilink codevar-wikilink" href="../basic#symrel">symrel</a>&rdquo; and (nonsymmorphic)
translations vectors will be input in array &ldquo;<a class="wikilink codevar-wikilink" href="../basic#tnons">tnons</a>&rdquo;. If there is no
symmetry in the problem then set <a class="wikilink codevar-wikilink" href="../basic#nsym">nsym</a> to 1, because the identity is still
a symmetry.<br />
In case of a RF calculation, the code is able to use the symmetries of the
system to decrease the number of perturbations to be calculated, and to
decrease of the number of special k points to be used for the sampling of the
Brillouin zone. After the response to the perturbations have been calculated,
the symmetries are used to generate as many as possible elements of the 2DTE
from those already computed.</p>
<p><strong>Symmetry finder mode</strong> (Default mode). <br />
If <a class="wikilink codevar-wikilink" href="../basic#nsym">nsym</a> is 0, all the atomic coordinates must be explicitely given (one
cannot use the atom manipulator neither the smart symmetrizer): the code will
then find automatically the symmetry operations that leave the lattice and
each atomic sublattice invariant. It also checks whether the cell is primitive
(see <a class="wikilink codevar-wikilink" href="../gstate#chkprim">chkprim</a>).<br />
Note that the tolerance on symmetric atomic positions and lattice is rather
stringent : for a symmetry operation to be admitted, the lattice and atomic
positions must map on themselves within 1.0e-8 .</p>
<p>The user is allowed to set up systems with non-primitive unit cells (i.e.
conventional FCC or BCC cells, or supercells without any distortion). In this
case, pure translations will be identified as symmetries of the system by the
symmetry finder. Then, the combined &ldquo;pure translation + usual rotation and
inversion&rdquo; symmetry operations can be very numerous. For example, a
conventional FCC cell has 192 symmetry operations, instead of the 48 ones of
the primitive cell. A maximum limit of 384 symmetry operations is hard-coded.
This corresponds to the maximum number of symmetry operations of a 2x2x2
undistorted supercell. Going beyond that number will make the code stop very
rapidly. If you want nevertheless, for testing purposes, to treat a larger
number of symmetries, change <a class="wikilink codevar-wikilink" href="../dev#maxnsym">maxnsym</a>.</p>
<p>For GW calculation, the user might want to select only the symmetry operations
whose non-symmorphic translation vector <a class="wikilink codevar-wikilink" href="../basic#tnons">tnons</a> is zero. This can be done
with the help of the input variable <a class="wikilink codevar-wikilink" href="../dev#symmorphi">symmorphi</a></p>
<h2 id="ntypat"><strong>ntypat</strong><a class="headerlink" href="#ntypat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of TYPes of AToms<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify the types of atoms that form the system" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/AtomTypes">topic_AtomTypes</a>, <a class="wikilink topic-wikilink" data-content="How to master the use of norm-conserving pseudopotentials and PAW atomic data, and
their consequences" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/PseudosPAW">topic_PseudosPAW</a>, <a class="wikilink topic-wikilink" data-content="How to specify a crystal, with atomic positions and symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [910/920] in all abinit tests, [116/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a>, <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_bigdft.in" target="_blank">testin_bigdft.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=6 and tsmear=0.05. Designed to test the treatment of metals, with the Gaussian-Hermite smearing of Methfessel and Paxton. Also test the use of fband instead of nband." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW response function calculation of derivative of wavefunction (DDK) Si with PAW dataset generated from uspp code. Computes derivative with DFPT formalism,  and also computes energies with displaced k+q so that energies can be checked by finite differences." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Gives the number of types of atoms.<br />
E.g. for a homopolar system (e.g. pure Si) <a class="wikilink codevar-wikilink" href="../basic#ntypat">ntypat</a> is 1.</p>
<p>The code tries to read the same number of pseudopotential files. The first
pseudopotential is assigned type number 1, and so on &hellip;</p>
<p>There is an exception in the case of alchemical mixing of potentials, for
which there is a different number of pseudopotentials atomic types. See
<a class="wikilink codevar-wikilink" href="../gstate#mixalch">mixalch</a>.</p>
<h2 id="occopt"><strong>occopt</strong><a class="headerlink" href="#occopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OCCupation OPTion<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify bands and occupation numbers, for metals or insulators" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/BandOcc">topic_BandOcc</a>, <a class="wikilink topic-wikilink" data-content="How to obtain a Scanning Tunneling Microscopy map" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/STM">topic_STM</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [504/920] in all abinit tests, [55/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test natsph_extra,  ratsph_extra,  and xredsph_extra for STS calculation. Al (111) surface slab with very low ecut and ngkpt in the plane." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si,  Bulk,  2 atoms,  paral_kgb. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test the triple parallelisation. We cannot check the distribution npband*npfft*npkpt=2*2*2=8 processors, this number being not allowed in the test procedure. Here,  we only test the parallelisation over FFT and kpoints: npband*npfft*npkpt=1*2*2=4 processors. In test tY.in we check other distributions for guarantee." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t24.in" target="_blank">t24.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a>, <a class="wikilink abifile-wikilink" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_02.in" target="_blank">tgspw_02.in</a>, <a class="wikilink abifile-wikilink" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_03.in" target="_blank">tgspw_03.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H atom in a big box Same file as t11.in,  except that natom,  typat,  and xcart were changed, and that the input variables nband,  nsppol,  occ and occopt are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_5.in" target="_blank">tbase1_5.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_1.in" target="_blank">tbase2_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom. Here,  a double loop has been used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_2.in" target="_blank">tbase2_2.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Oxygen atom Test a few functionals for which HGH pseudopotentials are available (from M. Krack), that are present also in the lib XC,  but not in the native ABINIT set of functionals." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="Si single atom with fractional occupation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="Pt single atom with semi-core electrons,  Krack pseudopotentials (pspcod = 10), and colinear spin polarisation (GGA functional)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t12.in" target="_blank">t12.in</a>, <a class="wikilink abifile-wikilink" data-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t14.in" target="_blank">t14.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="2 special k point Si in 2-atom diamond unit cell.  Uses symmetry. mkmem=mkpt,  mffmem=1 (&amp;quot;in core&amp;quot; solution), This calculation is also iterated to convergence.  ecut too small. Uses original Teter extended norm conserving psp 14si.psp." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Molybdenum slab (5 atoms+3 vacuum),  with ixc=1. 4 k-points,  in core. Use iprcel=45 for SCF cycle." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Molybdenum slab (5 atoms+3 vacuum),  with ixc=1. 4 k-points,  in core. Use iprcel=45 for SCF cycle." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Molybdenum slab (5 atoms+3 vacuum),  with ixc=1. 4 k-points,  in core. Use iprcel=45 for SCF cycle." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO. Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  static,  spin-polarized. Same system as test 49 of v2,  except that nctime is non-zero. Test ionmov=6 (Verlet) as well as ionmov=7." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t21.in" target="_blank">t21.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Al fcc metal - elastic constant calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_6.in" target="_blank">telast_6.in</a>, <a class="wikilink abifile-wikilink" data-content="the sequence of datasets makes the ground states and all of the explicit perturbations of the single Al atom in all directions,  for the irreducible qpoints in a 2x2x2 grid. Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph_1.in" target="_blank">teph_1.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="FCC Yb (1 atom per unit cell), using a l=3 psp with s local part. Crazy cut-off and number of k points. Shows that the derivative of the eigenenergies with respect to the wavevector can be obtained both by finite differences and analytical means (from a preliminary computation in the treatment of the ddk perturbation). For the (0.25, 0.25, 0.25) k point, the tenth band eigenvalue is -3.01209 eV. Going to the (0.251, 0.251, 0.251) k point it becomes -3.00562 eV,  with finite-difference estimation of the derivative with respect to ONE wavevector change (all three components changed) being 0.00647 eV/0.001/3=2.157 eV This value is unchanged when using the data at the (0.253, 0.253, 0.253) k point. The analytical value is 2.15566 eV." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline alpha-quartz Calculation of the GW corrections with non-symmorphic operations,  PAW case. but with a set of translated atoms. PAW case. Ordered set of atoms; non-ordered set of atoms; translated atoms. Similar to v5#64,  for PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Controls how input parameters <a class="wikilink codevar-wikilink" href="../basic#nband">nband</a>, <a class="wikilink codevar-wikilink" href="../gstate#occ">occ</a>, and <a class="wikilink codevar-wikilink" href="../basic#wtk">wtk</a> are handled.</p>
<ul>
<li>
<p><a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=0: <br />
All k points have the same number of bands and the same occupancies of bands.
<a class="wikilink codevar-wikilink" href="../basic#nband">nband</a> is given as a single number, and <a class="wikilink codevar-wikilink" href="../gstate#occ">occ</a>(<a class="wikilink codevar-wikilink" href="../basic#nband">nband</a>) is an array of
<a class="wikilink codevar-wikilink" href="../basic#nband">nband</a> elements, read in by the code.<br />
The k point weights in array <a class="wikilink codevar-wikilink" href="../basic#wtk">wtk</a>(<a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>) are automatically normalized by
the code to add to 1.</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=1: <br />
Same as <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=0, except that the array <a class="wikilink codevar-wikilink" href="../gstate#occ">occ</a> is automatically generated
by the code, to give a semiconductor.<br />
An error occurs when filling cannot be done with occupation numbers equal to 2
or 0 in each k-point (non-spin-polarized case), or with occupation numbers
equal to 1 or 0 in each k-point (spin-polarized case). If <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>=2 and
<a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>==1 is used, the user has to impose the magnetization, using
<a class="wikilink codevar-wikilink" href="../ffield#spinmagntarget">spinmagntarget</a>, except for the case of a single isolated Hydrogen atom.</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=2: <br />
k points may optionally have different numbers of bands and different
occupancies. <a class="wikilink codevar-wikilink" href="../basic#nband">nband</a>(<a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a><em><a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>) is given explicitly as an array of
<a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a></em><a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a> elements. <a class="wikilink codevar-wikilink" href="../gstate#occ">occ</a>() is given explicitly for all bands at
each k point, and eventually for each spin &ndash; the total number of elements is
the sum of <a class="wikilink codevar-wikilink" href="../basic#nband">nband</a>(ikpt) over all k points and spins. The k point weights
<a class="wikilink codevar-wikilink" href="../basic#wtk">wtk</a> (<a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>) are NOT automatically normalized under this option.</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=3, 4, 5, 6 and 7 <br />
Metallic occupation of levels, using different occupation schemes (see below).
The corresponding thermal broadening, or cold smearing, is defined by the
input variable <a class="wikilink codevar-wikilink" href="../gstate#tsmear">tsmear</a> (see below : the variable xx is the energy in Ha,
divided by <a class="wikilink codevar-wikilink" href="../gstate#tsmear">tsmear</a>)<br />
Like for <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=1, the variable <a class="wikilink codevar-wikilink" href="../gstate#occ">occ</a> is not read<br />
All k points have the same number of bands, <a class="wikilink codevar-wikilink" href="../basic#nband">nband</a> is given as a single
number, read by the code.<br />
The k point weights in array <a class="wikilink codevar-wikilink" href="../basic#wtk">wtk</a>(<a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>) are automatically normalized by
the code to add to 1.</p>
<ul>
<li>
<p><a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=3: <br />
Fermi-Dirac smearing (finite-temperature metal) Smeared delta function :
0.25d0/(cosh(xx/2.0d0)**2)</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=4: <br />
&ldquo;Cold smearing&rdquo; of N. Marzari (see his thesis work), with a=-.5634
(minimization of the bump)<br />
Smeared delta function :<br />
exp(-xx  2  )/sqrt(pi) * (1.5d0+xx*(-a*1.5d0+xx*(-1.0d0+a*xx)))</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=5: <br />
&ldquo;Cold smearing&rdquo; of N. Marzari (see his thesis work), with a=-.8165 (monotonic
function in the tail)<br />
Same smeared delta function as <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=4, with different a.</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=6: <br />
Smearing of Methfessel and Paxton <a class="wikilink citation-wikilink" data-content="High-precision sampling for Brillouin-Zone integration in metals" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../theory/bibliography#methfessel1989">[Methfessel1989]</a> with Hermite polynomial
of degree 2, corresponding to &ldquo;Cold smearing&rdquo; of N. Marzari with a=0 (so, same
smeared delta function as <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=4, with different a).</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=7: <br />
Gaussian smearing, corresponding to the 0 order Hermite polynomial of
Methfessel and Paxton.<br />
Smeared delta function : 1.0d0*exp(-xx**2)/sqrt(pi)</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=8: <br />
Uniform smearing (the delta function is replaced by a constant function of
value one over ]-&frac12;,&frac12;[ (with one-half value at the boundaries). Used for
testing purposes only.</p>
</li>
</ul>
</li>
</ul>
<p>WARNING : one can use metallic occupation of levels in the case of a molecule,
in order to avoid any problem with degenerate levels. However, it is advised
NOT to use <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=6 (and to a lesser extent <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=4 and 5), since the
associated number of electron versus the Fermi energy is NOT guaranteed to be
a monotonic function. For true metals, AND a sufficiently dense sampling of
the Brillouin zone, this should not happen, but be cautious ! As an indication
of this problem, a small variation of input parameters might lead to a jump of
total energy, because there might be two or even three possible values of the
Fermi energy, and the bissection algorithm find one or the other.</p>
<h2 id="rprim"><strong>rprim</strong><a class="headerlink" href="#rprim" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Real space PRIMitive translations<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">EVOLVING</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify the unit cell" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,3)<br />
<em>Commentdims:</em> Internally, it is represented as rprim(3,3,<a class="wikilink codevar-wikilink" href="../rlx#nimage">nimage</a>)<br />
<em>Default value:</em> [[1, 0, 0], [0, 1, 0], [0, 0, 1]]  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [751/920] in all abinit tests, [111/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a>, <a class="wikilink abifile-wikilink" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_02.in" target="_blank">tgspw_02.in</a>, <a class="wikilink abifile-wikilink" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_03.in" target="_blank">tgspw_03.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Carbon atom Test the Becke-Johnson mGGA functional,  generating directly XC potentials. Convergence parameters are quite high,  and the test is reasonably portable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="KSS file generation for silicon with a different number of bands in the KSS computation compared to ground-state." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2. Use the x-only PBE functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.10691 Ha while finite differences gives : with delta(xred)=0.0002,  189.10790 Ha with delta(xred)=0.0001,  189.10703 Ha . Combining the results gives 189.10675 Ha. The agreement is quite good,  and might likely be improved by increasing tolvrs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Give, in columnwise entry, the three dimensionless primitive translations in
real space, to be rescaled by <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a> and <a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>.<br />
It is <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">EVOLVING</a> only if <a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>==2 and <a class="wikilink codevar-wikilink" href="../rlx#optcell">optcell</a>/=0, otherwise it is
fixed.<br />
If the Default is used, that is, <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a> is the unity matrix, the three
dimensionless primitive vectors are three unit vectors in cartesian
coordinates. Each will be (possibly) multiplied by the corresponding <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>
value, then (possibly) stretched along the cartesian coordinates by the
corresponding <a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a> value, to give the dimensional primitive vectors,
called <a class="wikilink codevar-wikilink" href="../basic#rprimd">%rprimd</a>.<br />
In the general case, the dimensional cartesian coordinates of the crystal
primitive translations R1p, R2p and R3p, see <a class="wikilink codevar-wikilink" href="../basic#rprimd">%rprimd</a>, are</p>
<ul>
<li>R1p(i)=<a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>(i)<a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>(i,1)*<a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(1) </li>
<li>R2p(i)=<a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>(i)<a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>(i,2)*<a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(2) </li>
<li>R3p(i)=<a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>(i)<a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>(i,3)*<a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(3) </li>
</ul>
<p>where i=1,2,3 is the component of the primitive translation (i.e. x, y, and
z).  </p>
<p>The <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a> variable, scaled by <a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>, is thus used to define
directions of the primitive vectors, that will be multiplied (so keeping the
direction unchanged) by the appropriate length scale <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(1),
<a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(2), or <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(3), respectively to give the dimensional primitive
translations in real space in cartesian coordinates.<br />
Presently, it is requested that the mixed product (R1xR2).R3 is positive. If
this is not the case, simply exchange a pair of vectors.<br />
To be more specific, keeping the default value of <a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>=1 to simplify
the matter, <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a> 1 2 3 4 5 6 7 8 9 corresponds to input of the three
primitive translations R1=(1,2,3) (to be multiplied by <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(1)),
R2=(4,5,6) (to be multiplied by <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(2)), and R3=(7,8,9) (to be
multiplied by [<a href="../3">acell</a>).<br />
Note carefully that the first three numbers input are the first column of
<a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>, the next three are the second, and the final three are the third.
This corresponds with the usual Fortran order for arrays. The matrix whose
columns are the reciprocal space primitive translations is the inverse
transpose of the matrix whose columns are the direct space primitive
translations.</p>
<p>Alternatively to <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>, directions of dimensionless primitive vectors can
be specified by using the input variable <a class="wikilink codevar-wikilink" href="../basic#angdeg">angdeg</a>. This is especially useful
for hexagonal lattices (with 120 or 60 degrees angles). Indeed, in order for
symmetries to be recognized, rprim must be symmetric up to <a class="wikilink codevar-wikilink" href="../geo#tolsym">tolsym</a> (10
digits by default), inducing a specification such as</p>
<div class="codehilite"><pre><span></span>  rprim  0.86602540378  0.5  0.0
        -0.86602540378  0.5  0.0
         0.0            0.0  1.0
</pre></div>


<p>that can be avoided thanks to <a class="wikilink codevar-wikilink" href="../basic#angdeg">angdeg</a>:</p>
<div class="codehilite"><pre><span></span>  angdeg 90 90 120
</pre></div>


<p>Although the use of <a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a> or <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a> is rather equivalent when the
primitive vectors are aligned with the cartesian directions, it is not the
case for non-orthogonal primitive vectors. In particular, beginners often make
the error of trying to use <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a> to define primitive vectors in face-
centered tetragonal lattice, or body-centered tetragonal lattice, or similarly
in face or body-centered orthorhombic lattices. Let us take the example of a
body-centered tetragonal lattice, that might be defined using the following
(&ldquo;a&rdquo; and &ldquo;c&rdquo; have to be replaced by the appropriate conventional cell vector
length):</p>
<div class="codehilite"><pre><span></span>  rprim  &quot;a&quot;      0        0
          0      &quot;a&quot;       0
         &quot;a/2&quot;   &quot;a/2&quot;    &quot;c/2&quot;
acell 3*1     scalecart 3*1    !  ( These are default values)
</pre></div>


<p>The following is a valid, alternative way to define the same primitive vectors
:</p>
<div class="codehilite"><pre><span></span>  rprim   1        0       0
          0        1       0
          1/2      1/2     1/2
scalecart  &quot;a&quot;  &quot;a&quot;  &quot;c&quot;
acell 3*1    !  ( These are default values)
</pre></div>


<p>Indeed, the cell has been stretched along the cartesian coordinates, by &ldquo;a&rdquo;,
&ldquo;a&rdquo; and &ldquo;c&rdquo; factors.</p>
<p>At variance, the following is WRONG :</p>
<div class="codehilite"><pre><span></span>  rprim   1       0       0
          0       1       0
          1/2     1/2     1/2
acell  &quot;a&quot;  &quot;a&quot;  &quot;c&quot;    !   THIS IS WRONG
scalecart 3*1    !  ( These are default values)
</pre></div>


<p>Indeed, the latter would correspond to :</p>
<div class="codehilite"><pre><span></span>  rprim  &quot;a&quot;      0       0
          0      &quot;a&quot;      0
         &quot;c/2&quot;   &quot;c/2&quot;   &quot;c/2&quot;
acell 3*1     scalecart 3*1    !  ( These are default values)
</pre></div>


<p>Namely, the third vector has been rescaled by &ldquo;c&rdquo;. It is not at all in the
center of the tetragonal cell whose basis vectors are defined by the scaling
factor &ldquo;a&rdquo;.<br />
As another difference between <a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a> or <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>, note that
<a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a> is <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">INPUT_ONLY</a> : its content will be immediately applied to
rprim, at parsing time, and then scalecart will be set to the default values
(3*1). So, in case <a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a> is used, the echo of <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a> in the output
file is not the value contained in the input file, but the value rescaled by
<a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>.</p>
<h2 id="rprimd"><strong>rprimd</strong><a class="headerlink" href="#rprimd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Real space PRIMitive translations, Dimensional<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">INTERNAL_ONLY</a>, <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">EVOLVING</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify the unit cell" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,3)<br />
<em>Commentdims:</em> Internally, it is represented as rprimd(3,3,<a class="wikilink codevar-wikilink" href="../rlx#nimage">nimage</a>).<br />
<em>Default value:</em> None  </p>
<p>This internal variable gives the dimensional real space primitive vectors,
computed from <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>, <a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>, and <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>.</p>
<ul>
<li>R1p(i)=<a class="wikilink codevar-wikilink" href="../basic#rprimd">%rprimd</a>(i,1)=<a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>(i)<em><a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>(i,1)</em><a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(1) for i=1,2,3 (x,y,and z) </li>
<li>R2p(i)=<a class="wikilink codevar-wikilink" href="../basic#rprimd">%rprimd</a>(i,2)=<a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>(i)<em><a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>(i,2)</em><a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(2) for i=1,2,3 </li>
<li>R3p(i)=<a class="wikilink codevar-wikilink" href="../basic#rprimd">%rprimd</a>(i,3)=<a class="wikilink codevar-wikilink" href="../basic#scalecart">scalecart</a>(i)<em><a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>(i,3)</em><a class="wikilink codevar-wikilink" href="../basic#acell">acell</a>(3) for i=1,2,3 </li>
</ul>
<p>It is <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">EVOLVING</a> only if <a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>==2 and <a class="wikilink codevar-wikilink" href="../rlx#optcell">optcell</a>/=0, otherwise it is
fixed.  </p>
<h2 id="scalecart"><strong>scalecart</strong><a class="headerlink" href="#scalecart" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SCALE CARTesian coordinates<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify the unit cell" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/UnitCell">topic_UnitCell</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*1  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v6:  <a class="wikilink abifile-wikilink" data-content="Set of Hydrogen atoms in a body-centered,  or face-centered tetragonal,  of body-centered orthorhombic lattice. This is to test the scalecart input variable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t16.in" target="_blank">t16.in</a></li></ul></details><p>Gives the scaling factors of cartesian coordinates by which dimensionless
primitive translations (in &ldquo;<a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a>&rdquo;) are to be multiplied. <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a> input
variable, the <a class="wikilink codevar-wikilink" href="../basic#acell">acell</a> input variable, and the associated internal <a class="wikilink codevar-wikilink" href="../basic#rprimd">%rprimd</a>
internal variable.<br />
Especially useful for body-centered and face-centered tetragonal lattices, as
well as body-centered and face-centered orthorhombic lattices, see <a class="wikilink codevar-wikilink" href="../basic#rprimd">%rprimd</a>.<br />
Note that this input variable is <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">INPUT_ONLY</a> : its content will be
immediately applied to rprim, at parsing time, and then scalecart will be set
to the default values. So, it will not be echoed.</p>
<h2 id="shiftk"><strong>shiftk</strong><a class="headerlink" href="#shiftk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SHIFT for K points<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the electronic wavevectors (k-points)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>)<br />
<em>Default value:</em> None if <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>&gt;1,
[0.5, 0.5, 0.5] otherwise.</p>
<details class="note"><summary>Test list (click to open). Very frequently used, [471/920] in all abinit tests, [91/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_bigdft.in" target="_blank">testin_bigdft.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_wannier90.in" target="_blank">testin_wannier90.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si,  Bulk,  2 atoms,  paral_kgb. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test the triple parallelisation. We cannot check the distribution npband*npfft*npkpt=2*2*2=8 processors, this number being not allowed in the test procedure. Here,  we only test the parallelisation over FFT and kpoints: npband*npfft*npkpt=1*2*2=4 processors. In test tY.in we check other distributions for guarantee." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t24.in" target="_blank">t24.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_1.in" target="_blank">tmbt_1.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Screening calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_2.in" target="_blank">tmbt_2.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Screening calculation with Hilbert transform" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_3.in" target="_blank">tmbt_3.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="Crystalline silicon: computation of the total energy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_1.in" target="_blank">tbase3_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : computation of the total energy This input file will NOT work : nkpt does not agree with ngkpt and shiftk. The error message will be given in the &amp;quot;log&amp;quot; file." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_2.in" target="_blank">tbase3_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : computation of the total energy Convergence with respect to the number of k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_3.in" target="_blank">tbase3_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon solid,  experimental lattice parameter. Realistic parameters are used (ecut=20,  ngkpt=2x2x2 shifted 4 times,  but centered on Gamma). Test the mGGA functional from Tran and Blaha (correction to Becke-Johnson). The LDA gap is observed at Gamma : 8.071 eV,  is in reasonable agreement with the gap from the TB paper PRL 102,  226401 (2009), where it is mentioned to be 8.16 eV. The mGGa gap is 14.688 eV. The TB paper mentions 13.91 eV. The experimental value is 14.20 eV. The reading of the kinetic energy density,  to start a non-SCF calculation is not yet implemented, as of ABINITv6.12.0 . This test was used to examine the speed of the convergence in case of elongated cells,  up to 16 atoms. The mGGA convergence was found to be similar to the LDA convergence. Also,  test non-self-consistent mGGA calculation,  with reading of the previously produced _DEN and _KDEN files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t19.in" target="_blank">t19.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond: hybrid functional calculation with the GW code Perturbative approach to the HSE06,  PBE0,  and B3LYP band gaps HSE06 and PBE0 tests temporarily disabled,  waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.in" target="_blank">t41.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Graphene. Test wavelet run on surface" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t14.in" target="_blank">t14.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="KSS file generation for silicon with a different number of bands in the KSS computation compared to ground-state." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Al2O3 cell in rhombohedric cell with different axes. Dataset 1 : Rhombohedral axes;  full set of symmetries and full set of atoms Dataset 2 : Rhombohedral axes;  irreducible unit cell and space group Dataset 3 : Hexagonal axes;  irreducible unit cell and space group Dataset 4 : Hexagonal axes;  full unit cell and space group The results are equivalent for Dataset 1 and 2 and Dataset 3 and 4." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t96.in" target="_blank">t96.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="BCC Helium q close to Gamma,  along Gamma-H There is a problem with kptopt=1 or 3 for the NSC step." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t12.in" target="_blank">t12.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 28. The chosen grid (too coarse,  though) is (0 0 0),  (1/4 1/4 0),  (1/2 1/2 0),  (1/2 0 0), (1/2 1/4 1/4),  (1/2 -1/4 1/4)  (in reduced coordinates). The ecut and nkpt parameters are really too low (see test 28), but parameters suitable for physical results (see test 29) are also provided in the input files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t26.in" target="_blank">t26.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for GaAs (zinc-blende). Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 32. The chosen grid (too coarse,  though) has only two special q points : 1/4 1/4 1/4 and 1/4 1/2 1/2 (in reduced coordinates). The Gamma point is also needed,  especially for the computation of dielectric matric and effective charges,  needed to get the asymptotic behaviour of the interatomic force constants. To generate the different responses,  the following steps are followed, with each of them corresponding to a different dataset (the multi-dataset mode allows to have only one input file) : 1) ground state calculation,  with a k-point sampling in the irreducible Brillouin zone only; 2) using the density of 1),  computation of the wavefunctions for the grid of k-points in the full Brillouin zone;  (not really needed in v3.0) 3) computation of the ddk response,  in preparation to the electric field response; 4) computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; 5) using the density of 1),  computation of the GS wavefunctions at k+q where q is 1/4 1/4 1/4; 6) computation of the dynamical matrix at 1/4 1/4 1/4; 7) using the density of 1),  computation of the GS wavefunctions at k+q where q is 1/4 1/2 1/2; 8) computation of the dynamical matrix at 1/4 1/2 1/2 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t30.in" target="_blank">t30.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Si crystal. GGA + non-linear XC core correction. Compute the interatomic force constant for the displacement of the second atom along (111). RF calculation of the 2DTE gives 7.51663417 Ha while finite differences gives: with delta(xred)=0.0001,  7.15663267 Ha. The agreement is quite good,  and might likely be improved by combining finite differences. Also compute the ddk and electric field responses. The number of k points is much too small to obtain physical values,  but are quite comparable to the result of test v2 #6" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t16.in" target="_blank">t16.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in 2-atom diamond unit cell (nkpt 2;  ecut 6) In dataset 1,  ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16). the eigenvectors necessary for the GW calculation being stored in _WFK. In dataset 2,  ABINIT computes the eps^-1 matrix (optdriver 3) nband 10) for the GW calculation and stores it in _SCR. In dataset 3-6,  ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t30.in" target="_blank">t30.in</a>, <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure (nkpt 2;  ecut 6) In dataset 1,  ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16) the eigenvectors necessary for the GW calculation being stored in _WFK. In dataset 2,  ABINIT computes the eps^-1 matrix (optdriver 3,  nband 10) for the GW calculation and stores it in _SCR. In dataset 3,  ABINIT computes the GW correction for bands 4 and 5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t31.in" target="_blank">t31.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Fe in BCC structure. Low cut-offs and few k-points. This test is done within GGA and (ferro-)magnetism in PAW formalism. The same job is done twice with two differents PAW datasets. First PAW dataset is Fe with a &amp;quot;Bessel&amp;quot; compensation charge shape function expressed analytically. SecondPAW dataset is Fe with a &amp;quot;Bessel&amp;quot; compensation charge shape function expressed numerically." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="Fe in HCP structure. Low cut-offs and few k-points. This test is done within GGA and no magnetism in PAW formalism. The same job is done twice with two differents values of mkmem." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Hydrogen dimer in a big cell. Produce different files (_DEN,  _POT,  _VHXC,  _VHA),  for subsequent analysis by CUT3D (see next run). Note the following values,  that will allow to check the correctness of the subsequent analysis : Kinetic energy  =  1.02998395409183E+00 Hartree energy  =  8.05073794254872E-01 Loc. psp. energy= -2.53949740885919E+00 Band energy (Ha)=  -7.2732761066E-01 Also,  the mean of the Vxc potential is announced to be Average Vxc (hartree)=  -0.05293" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl molecule in a big box. Test of the computation of the polarisation with the routine berryphase_new, for different k-point grids : only 1 k-point,  a line of k-points,  and a full mesh of k-points. Results with acell 20 10 10 are : -9.727 C/m^2,  -9.975 C/m^2,  -9.503 C/m^2 multiplied by the volume (in a.u.),  gives -19454,  -19950,  -19006 Test provided by S. Leroux Going to bigger cells make these results converge to the same value : Results with acell 30 20 20 are : -1.771 C/m^2,  -1.746 C/m^2,  -1.747 C/m^2 multiplied by the volume (in a.u.),  gives -21252,  -20952,  -20964 Results with acell 40 20 20 are : -1.3167C/m^2,  -1.3057C/m^2,  -1.3062C/m^2 multiplied by the volume (in a.u.),  gives -21067,  -20891,  -20899 Results with acell 50 20 20 are : -1.0502C/m^2,  -1.0444C/m^2,  -1.0450C/m^2 multiplied by the volume (in a.u.),  gives -21004,  -20888,  -20900" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t08.in" target="_blank">t08.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test natsph_extra,  ratsph_extra,  and xredsph_extra for STS calculation. Al (111) surface slab with very low ecut and ngkpt in the plane." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff and kpts,  non collinear spin case with nspden=4 imposed. First normal case then constrain direction only (DS2) and full value of vector (DS3)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="PAW response function calculation of derivative of wavefunction (DDK) Si with PAW dataset generated from uspp code. Computes derivative with DFPT formalism,  and also computes energies with displaced k+q so that energies can be checked by finite differences." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW: test of some variables reserved to experienced users or developers BCC iron,  ferromagnetic,  GGA,  PAW. Also tests maxnsym keyword." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate both DEN and PAWDEN files for silicon. Note that in the PAW case,  DEN files include the valence density and compensation charge,  while PAWDEN files include the valence and on-site corrections,  but not the compensation charge. Therefore,  DEN files are needed for further computations,  while PAWDEN files are useful for visualization,  AIM,  and other post-processing of the density. PAW AE DEN not compatible with parallelization over atoms." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t11.in" target="_blank">t11.in</a> &hellip;</li></ul></details><p>It is used only when <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>&gt;=0, and must be defined if <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a> is
larger than 1.<br />
<a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a>(1:3,1:<a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>) defines <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a> shifts of the homogeneous
grid of k points based on <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a> or <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a>.<br />
The shifts induced by <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a> corresponds to the reduced coordinates in the
coordinate system defining the k-point lattice. For example, if the k point
lattice is defined using <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a>, the point whose reciprocal space reduced
coordinates are ( <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a>(1,ii)/<a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a>(1) <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a>(2,ii)/<a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a>(2)
<a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a>(3,ii)/<a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a>(3) ) belongs to the shifted grid number ii.</p>
<p>The user might rely on ABINIT to suggest suitable and efficient combinations
of <a class="wikilink codevar-wikilink" href="../gstate#kptrlatt">kptrlatt</a> and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a>. The procedure to be followed is described with
the input variables <a class="wikilink codevar-wikilink" href="../gstate#kptrlen">kptrlen</a>. In what follows, we suggest some interesting
values of the shifts, to be used with even values of <a class="wikilink codevar-wikilink" href="../basic#ngkpt">ngkpt</a>. This list is
much less exhaustive than the above-mentioned automatic procedure.</p>
<p>1) When the primitive vectors of the lattice do NOT form a FCC or a BCC
lattice, the default (shifted) Monkhorst-Pack grids are formed by using
<a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>=1 and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a> 0.5 0.5 0.5 . This is often the preferred k point
sampling, as the shift improves the sampling efficiency. However, it can also
break symmetry, if the 111 direction is not an axis of rotation, e.g. in
tetragonal or hexagonal systems. Abinit will complain about this breaking, and
you should adapt <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a>. For a non-shifted Monkhorst-Pack grid, use
<a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>=1 and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a> 0.0 0.0 0.0 , which will be compatible with all
symmetries, and is necessary for some features such as k-point interpolation.</p>
<p>2) When the primitive vectors of the lattice form a FCC lattice, with
<a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a></p>
<div class="codehilite"><pre><span></span>  0.0 0.5 0.5
  0.5 0.0 0.5
  0.5 0.5 0.0
</pre></div>


<p>the (very efficient) usual Monkhorst-Pack sampling will be generated by using
<a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>= 4 and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a></p>
<div class="codehilite"><pre><span></span>  0.5 0.5 0.5
  0.5 0.0 0.0
  0.0 0.5 0.0
  0.0 0.0 0.5
</pre></div>


<p>3) When the primitive vectors of the lattice form a BCC lattice, with
<a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a></p>
<div class="codehilite"><pre><span></span>  -0.5  0.5  0.5
   0.5 -0.5  0.5
   0.5  0.5 -0.5
</pre></div>


<p>the usual Monkhorst-Pack sampling will be generated by using <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>= 2
and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a></p>
<div class="codehilite"><pre><span></span>  0.25  0.25  0.25
 -0.25 -0.25 -0.25
</pre></div>


<p>However, the simple sampling <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>=1 and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a> 0.5 0.5 0.5 is
excellent.</p>
<p>4) For hexagonal lattices with hexagonal axes, e.g. <a class="wikilink codevar-wikilink" href="../basic#rprim">rprim</a></p>
<div class="codehilite"><pre><span></span>  1.0  0.0       0.0
 -0.5  sqrt(3)/2 0.0
  0.0  0.0       1.0
</pre></div>


<p>one can use <a class="wikilink codevar-wikilink" href="../basic#nshiftk">nshiftk</a>= 1 and <a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a> 0.0 0.0 0.5</p>
<p>In rhombohedral axes, e.g. using <a class="wikilink codevar-wikilink" href="../basic#angdeg">angdeg</a> 3*60., this corresponds to
<a class="wikilink codevar-wikilink" href="../basic#shiftk">shiftk</a> 0.5 0.5 0.5, to keep the shift along the symmetry axis.</p>
<h2 id="symrel"><strong>symrel</strong><a class="headerlink" href="#symrel" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SYMmetry in REaL space<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify a crystal, with atomic positions and symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,3,<a class="wikilink codevar-wikilink" href="../basic#nsym">nsym</a>)<br />
<em>Default value:</em> [[1, 0, 0], [0, 1, 0], [0, 0, 1]] if <a class="wikilink codevar-wikilink" href="../basic#nsym">nsym</a>==1,
None otherwise.</p>
<details class="note"><summary>Test list (click to open). Moderately used, [184/920] in all abinit tests, [1/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_bigdft.in" target="_blank">testin_bigdft.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="2 special k point Si in 2-atom diamond unit cell.  Uses symmetry. mkmem=mkpt,  mffmem=1 (&amp;quot;in core&amp;quot; solution), This calculation is also iterated to convergence.  ecut too small. Uses original Teter extended norm conserving psp 14si.psp." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Same as 03 but run with newer Troullier-Martins psp with core density 14si.pspnc.  Start from wf.03 and run irdwfk=1. Also iterated to convergence." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2. Use the x-only PBE functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.10691 Ha while finite differences gives : with delta(xred)=0.0002,  189.10790 Ha with delta(xred)=0.0001,  189.10703 Ha . Combining the results gives 189.10675 Ha. The agreement is quite good,  and might likely be improved by increasing tolvrs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and Wu-Cohen GGA. Similar to test v3#08 Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.49410411 Ha while finite differences gives : with delta(xred)=0.0002,  189.4945677  Ha with delta(xred)=0.0001,  189.49422003  Ha . Combining the results gives 189.4941041 Ha. Perfect !" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t29.in" target="_blank">t29.in</a>, <a class="wikilink abifile-wikilink" data-content="Compute U in bcc Fe in 2 atomic supercell." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t39.in" target="_blank">t39.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential, and the Wu-Cohen GGA. Similar to Test v3#48 Compute the total energy and force as a displacement of the second atom along x. Direct calculation of the gradient with respect to reduced coordinates gives -3.469435369425Ha while finite differences gives : with delta(xred)=0.0002,  -3.4694479488 Ha with delta(xred)=0.0001,  -3.4694385143 Ha . Combining the results gives -3.4694353695 Ha. Excellent." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t48.in" target="_blank">t48.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Hydrogen atom. Treated with GGA C09x exchange functional (ixc=24). The total energy is -0.429523 Ha. Also additional tests concerning the kinetic energy density calculation, the gradient of electronic density calculation and the Laplacian of electronic density calculation are performed. Test taken from v1/t21.in." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test presence of nuclear magnetic dipole moments on atomic sites" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t32.in" target="_blank">t32.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with and without PAW XML data (FJollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t60.in" target="_blank">t60.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with PAW XML data designed for PWPAW (F Jollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t61.in" target="_blank">t61.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="Fe bcc structure - ferromagnetic PAW determine U from change of occupation on atoms upon potential shift on atom 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tudet_2.in" target="_blank">tudet_2.in</a> &hellip;</li></ul></details><p>Gives &ldquo;<a class="wikilink codevar-wikilink" href="../basic#nsym">nsym</a>&rdquo; 3x3 matrices expressing space group symmetries in terms of
their action on the direct (or real) space primitive translations.<br />
It turns out that these can always be expressed as integers.<br />
Always give the identity matrix even if no other symmetries hold, e.g.
<a class="wikilink codevar-wikilink" href="../basic#symrel">symrel</a> 1 0 0 0 1 0 0 0 1<br />
Also note that for this array as for all others the array elements are filled
in a columnwise order as is usual for Fortran.<br />
The relation between the above symmetry matrices <a class="wikilink codevar-wikilink" href="../basic#symrel">symrel</a>, expressed in the
basis of primitive translations, and the same symmetry matrices expressed in
cartesian coordinates, is as follows. Denote the matrix whose columns are the
primitive translations as R, and denote the cartesian symmetry matrix as S.
Then<br />
<a class="wikilink codevar-wikilink" href="../basic#symrel">symrel</a> = R(inverse) * S * R<br />
where matrix multiplication is implied.<br />
When the symmetry finder is used (see <a class="wikilink codevar-wikilink" href="../basic#nsym">nsym</a>), <a class="wikilink codevar-wikilink" href="../basic#symrel">symrel</a> will be computed
automatically.</p>
<h2 id="tnons"><strong>tnons</strong><a class="headerlink" href="#tnons" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Translation NON-Symmorphic vectors<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify a crystal, with atomic positions and symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="../basic#nsym">nsym</a>)<br />
<em>Default value:</em> None  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [165/920] in all abinit tests, [2/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>seq:  <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  rhombohedral. Test finite electric field Check the corectness of the symmetry operations with non-zero tnons." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_55.in" target="_blank">tsv4_55.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="2 special k point Si in 2-atom diamond unit cell.  Uses symmetry. mkmem=mkpt,  mffmem=1 (&amp;quot;in core&amp;quot; solution), This calculation is also iterated to convergence.  ecut too small. Uses original Teter extended norm conserving psp 14si.psp." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Same as 03 but run with newer Troullier-Martins psp with core density 14si.pspnc.  Start from wf.03 and run irdwfk=1. Also iterated to convergence." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2. Use the x-only PBE functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.10691 Ha while finite differences gives : with delta(xred)=0.0002,  189.10790 Ha with delta(xred)=0.0001,  189.10703 Ha . Combining the results gives 189.10675 Ha. The agreement is quite good,  and might likely be improved by increasing tolvrs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2,  and preceeding test, but use the full XC PBE functional. Also,  tolvrs is better. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 188.81162533 Ha while finite differences gives : with delta(xred)=0.0002,  188.81213804 Ha with delta(xred)=0.0001,  188.81175352 Ha . Combining the results gives 188.81162525 Ha." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t08.in" target="_blank">t08.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Generate the data for optic (linear and non-linear coefficients). to be analysed in the test 57." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t56.in" target="_blank">t56.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Prepare the computation of linear and non-linear optic properties of GaAs crystal : ground-state with few bands, then non-SCF with a larger number of bands,  then ddk for different directions Note that the k point sampling shoud be finer for significant results. The cut-off energy is also too low." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/toptic_1.in" target="_blank">toptic_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Prepare the computation of linear optic properties (for the imaginary spectrum only) of GaAs crystal : ground-state with few bands, then non-SCF with a larger number of bands,  then ddk for different directions Note that the k point sampling shoud be finer for significant results. The cut-off energy is also too low." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/toptic_3.in" target="_blank">toptic_3.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Hydrogen atom. Treated with GGA C09x exchange functional (ixc=24). The total energy is -0.429523 Ha. Also additional tests concerning the kinetic energy density calculation, the gradient of electronic density calculation and the Laplacian of electronic density calculation are performed. Test taken from v1/t21.in." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with and without PAW XML data (FJollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t60.in" target="_blank">t60.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with PAW XML data designed for PWPAW (F Jollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t61.in" target="_blank">t61.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with PAW XML data designed for GPAW (F Jollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t62.in" target="_blank">t62.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and Wu-Cohen GGA. Similar to test v3#08 Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.49410411 Ha while finite differences gives : with delta(xred)=0.0002,  189.4945677  Ha with delta(xred)=0.0001,  189.49422003  Ha . Combining the results gives 189.4941041 Ha. Perfect !" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t29.in" target="_blank">t29.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential, and the Wu-Cohen GGA. Similar to Test v3#48 Compute the total energy and force as a displacement of the second atom along x. Direct calculation of the gradient with respect to reduced coordinates gives -3.469435369425Ha while finite differences gives : with delta(xred)=0.0002,  -3.4694479488 Ha with delta(xred)=0.0001,  -3.4694385143 Ha . Combining the results gives -3.4694353695 Ha. Excellent." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t48.in" target="_blank">t48.in</a>, <a class="wikilink abifile-wikilink" data-content="Make a simple geometry relaxation and validate the XML output (testing prtxml)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t79.in" target="_blank">t79.in</a> &hellip;</li></ul></details><p>Gives the (nonsymmorphic) translation vectors associated with the symmetries
expressed in &ldquo;<a class="wikilink codevar-wikilink" href="../basic#symrel">symrel</a>&rdquo;.<br />
These may all be 0, or may be fractional (nonprimitive) translations expressed
relative to the real space primitive translations (so, using the &ldquo;reduced&rdquo;
system of coordinates, see &ldquo;<a class="wikilink codevar-wikilink" href="../basic#xred">xred</a>&rdquo;). If all elements of the space group
leave 0 0 0 invariant, then these are all 0.<br />
When the symmetry finder is used (see <a class="wikilink codevar-wikilink" href="../basic#nsym">nsym</a>), <a class="wikilink codevar-wikilink" href="../basic#tnons">tnons</a> is computed
automatically.</p>
<h2 id="toldfe"><strong>toldfe</strong><a class="headerlink" href="#toldfe" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on the DiFference of total Energy<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to control the SCF cycle" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Comment:</em> The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a>, <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> must differ from zero.<br />
<em>The use of this variable forbids the use of:</em> specified(<a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a>)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [284/920] in all abinit tests, [48/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using old,  rather inaccurate psps. Computation of the Berry phase. Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_04.in" target="_blank">tsv3_04.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  rhombohedral. Test finite electric field Check the corectness of the symmetry operations with non-zero tnons." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_55.in" target="_blank">tsv4_55.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_bigdft.in" target="_blank">testin_bigdft.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_etsf_io.in" target="_blank">testin_etsf_io.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si,  Bulk,  2 atoms,  paral_kgb. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test the triple parallelisation. We cannot check the distribution npband*npfft*npkpt=2*2*2=8 processors, this number being not allowed in the test procedure. Here,  we only test the parallelisation over bands and spins: npband*npfft*npkpt=2*1*2=4 processors. In addition,  we also test here various features of bandfft-kpt parallelisation In particular,  the bandpp,  istwfk=2 and wfoptalg=14 variables." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t25.in" target="_blank">t25.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a>, <a class="wikilink abifile-wikilink" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_02.in" target="_blank">tgspw_02.in</a>, <a class="wikilink abifile-wikilink" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_03.in" target="_blank">tgspw_03.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Oxygen atom Test a few functionals for which HGH pseudopotentials are available (from M. Krack), that are present also in the lib XC,  but not in the native ABINIT set of functionals." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of PBE0 in sequential case,  norm conserving,  from LibXC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of HSE06 and HSE03 in sequential case,  norm conserving,  from LibXC XG170501 : I would have expected HSE06 and HSE03 total energies to be quite close to each other,  which is not true, as LDA gives -7.867332Ha,  HSE06 gives -7.887495 Ha and HSE03 gives -7.963222 Ha . Might be a problem ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t52.in" target="_blank">t52.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="KSS file generation for silicon with a different number of bands in the KSS computation compared to ground-state." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="Silicon - diamond structure - PAW - volume relaxation Test the use of GPU within Projector Augmented-Wave formalism. Test structure relaxation (multiple calls to gstate routine)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Finite difference calculation of the Born effective charges of AlAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_1.in" target="_blank">tffield_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear response calculation for AlAs Perturbation: atomic displacements &amp;amp; strains Finite difference calculation of the ddk" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_2.in" target="_blank">tffield_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Finite difference calculation of the clamped-ion piezoelectric constants of AlAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_4.in" target="_blank">tffield_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="O2 molecule,  treated like a metal (there is a degeneracy at the Fermi level), occopt=4 and tsmear=0.04,  with nsppol=2 . Use spinat to polarize the molecule at start. Gives total energy of -32.09317 Hartree This test can be used to check the accuracy of stresses in the spin-polarized case. Setting acell(1:2) to 7.005 and 6.995 gives ETOT -32.090846193972 and -32.095501753750, ucvol  441.63023 and 440.37023 so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03, to be compared with sigma(1)=3.6949713786E-03 and sigma(2)=3.6949681083E-03 from the present test (the degeneracy is slightly lifted because of incomplete convergence, using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both sigma values)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 molecule,  treated as a spin-polarized molecule,  with fixed occupation numbers (occopt=2),  with nsppol=2 . Gives total energy of -32.09792 Hartree" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond : vacancy. This test is for testing a large number of atoms (63 atoms),  with a large number of plane waves (unlike test42). Small number of line minimisations,  of course." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t40.in" target="_blank">t40.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Orthorhombic Al system,  q(1/2 0 0),  partial occupation numbers. Compares with frozen-phonon calculations. Examine two cases: varying occupation numbers,  and fixed occupation numbers. A. Varying occupation numbers (occopt=4): RF calculation in dataset 5 gives 2DE equal to -3.812577 Ha,  while finite difference of &amp;quot;TOTAL&amp;quot; energy (datasets 6 and 7,  including entropy term) gives -3.812230 Ha (the agreement could be better with better finite difference) B. Fixed occupation numbers (occopt=2): RF calculation in dataset 8 gives 2DE equal to +5.431807 Ha,  while finite difference of total energy (no entropy term is present with occopt=2) gives +5.431857 Ha (the agreement could be better with better finite difference)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="Al2 molecule in a big box. Treat 8 bands,  occupied using occopt=4. For a metallic occopt,  the frozen-phonon (finite-difference) approach is strictly equivalent to the RF approach only at q/=Gamma. Here,  computes the result at q=(0 0 1/2). With delta(xred)=0.0001 (DATASET 5),  one gets delta(etot)/delta(xred)=0.42807994 . The direct computation of 2DTE at the target geometry gives 0.428080350 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t36.in" target="_blank">t36.in</a>, <a class="wikilink abifile-wikilink" data-content="BCC Molybdenum. Test the k point generator : Monkhorst-Pack grid,  then band structure." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t43.in" target="_blank">t43.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with spin-orbit. Should give the same answer than test 2,  except that the k point grid is now defined automatically. Dataset 8 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . Warning : the output file of this test is machine-dependent,  although the final result is not. This is because the degeneracy of the GS wavefunctions with different spin orientation has not been broken." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t14.in" target="_blank">t14.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="Ca in orthorhombic structure. 1 k point,  low ecut. Perform a test of GS total energy computation,  using an experimental PAW pseudopotential (pspcod=7)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="O in orthorhombic structure. 1 k point,  low ecut. Experimental PAW pseudopotential. The aim of this test is to verify that different values of input variable 'ortalg' give the same results for total energy. 'ortalg' is use in the conjugate gradient algorithm which solves,  in the case of PAW calculations, a generalized eigenproblem (H.|Psi&amp;gt;=Lambda.S|Psi&amp;gt;). Three datasets are perfomed;  they must give the same total energies values (when converged)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="O in orthorhombic structure. 1 k point,  low ecut. Experimental PAW pseudopotential. The aim of this test is to mesure the convergence of the total energy versus the variable 'ecut'. 6 datasets are performed with ecut varying from 8 Ha to 18 Ha Cut-off for the fine grid (used to transfer data from spherical meshes to FFt meshes) remain constant." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Silicon: Solution of the Bethe-Salpeter equation (BSE) with norm-conserving pseudopotentials. W is calculated at the RPA level while the scissors operator is used to open the gap by 0.8 eV. First the BSE is solved with the direct diagonalization of the two-particle Hamiltonian,  then the Haydock iterative method is employed to calculate the macroscopic dielectric function. The last dataset solves the BSE problem including the coupling between resonant and anti-resonant transition via brute force diagonalization. Shiva is disabled because the coupling part is unstable on this machine" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.in" target="_blank">t15.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique In t31,  preparation,  BSE equation with Model dielectric function and Haydock (only resonant + W + v),  then full BSE In t32,  bs_interp_mode 1 In t33,  bs_interp_mode 2 In t34,  bs_interp_mode 3 In t35,  Rohlfing-Louie" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t31.in" target="_blank">t31.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Print out geometry and eigenvalue files for analysis by the BoltzTraP code,  for transport coefficients, Seebeck,  etc... Tests the prtbltztrp input variable" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="Set of Hydrogen atoms in a body-centered,  or face-centered tetragonal,  of body-centered orthorhombic lattice. This is to test the scalecart input variable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t16.in" target="_blank">t16.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi atom in a big supercell. Test the application of a Zeeman field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t17.in" target="_blank">t17.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test magnetic constraint code. Variables magconon and magcon_lambda. BCC iron with low cutoff and kpts,  non collinear spin case with nspden=4 imposed. First normal case then constrain direction only (DS2) and full value of vector (DS3)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="test partial dos calculation with spinors (previously not enabled) and spin polarization while we are at it" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the extrapolation of then wave functions from one structural relaxation (time) step to the other: extrapwf=1 WARNING: this feature is stil experimental and probably buggy. Si,  Bulk,  2 atoms" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t09.in" target="_blank">t09.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple test of velocity verlet integrator" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="Cannot be executed in parallel (mlwfovl_qp) Si fcc,  in primitive cell (2 atoms/cell) Test of self-consistent model GW (2 iterations) following Faleev et al., [PRL 93,  126406 (2004)] followed by construction of quasiparticle maximally-localized wannier functions [Hamann &amp;amp; Vanderbilt, arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test- acceptable speed,  and the results are poorly converged.  The input file is sufficiently annotated to serve as a model.  Note that well- converged GW calculations are extremely time consuming,  and in general it is advisable to run the SCGW part separately on a parallel system, and then run a separate serial job modeled on the last dataset, substituting &amp;quot;irdwfk&amp;quot; and &amp;quot;irdqps&amp;quot; for &amp;quot;getwfk&amp;quot; and &amp;quot;getqps, &amp;quot; with appropriate links to the files produced in the serial run.  Note that the _DEN file from the first dataset is also needed as input,  although the discontinued &amp;quot;irdden&amp;quot; input variable is not needed or supported. Note that acceptable names for the secondary input file needed by the wannier90 library are wannier90.win,  w90.win,  abo_DSn_w90.win (ndtset &amp;gt;0) and abo_w90.win (ndtset=0),  where abo is the 4th line of the .files file and n is the wannier dataset." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the computation of the positron lifetime (using the two-component DFT) within PAW. A cubic box with 4 Al atoms at experimental volume. Low cut-offs,  few k-points. Datasets 2 to 3 use ixcpositron=2 i.e. LDA electron-positron correlation provided by Puska, Seitsonen,  and Nieminen (PRB 52,  10947). Datasets 4 to 5 use ixcpositron=11 i.e. LDA zero positron density limit parametrized by Arponen and Pajanne and fitted by Sterne and Kaiser (PRB 43,  13892). Dataset 1 performs a simple electronic GS calculation and store the density. Dataset 2 performs a positronic GS calculation in presence of the electronic density computed by dataset 1 (positron=1). Dataset 3 performs an electronic GS calculation in presence of the positronic density computed by dataset 2 (positron=2). Dataset 4 performs an automatic electronic/positronic GS calculation without storage of the wave-functions (positron=-1). Dataset 5 performs an automatic electronic/positronic GS calculation with storage of the wave-functions (positron=-10). Each dataset computes the positron lifetime and annihilation rate after the SCF iterations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple test for LDA+U implementation. no forces,  2 Ni and 2 O atoms in an fcc supercell. The cut-off is unrealistic. This test tests the following part of the code : * paw LDA+U (pawpupot,  pawpuenergy,  pawpuinit)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t08.in" target="_blank">t08.in</a> &hellip;</li></ul></details><p>Sets a tolerance for absolute differences of total energy that, reached TWICE
successively, will cause one SCF cycle to stop (and ions to be moved).<br />
Can be specified in Ha (the default), Ry, eV or Kelvin, since <a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a> has
the &lsquo;<a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a>&lsquo; characteristics. (1 Ha=27.2113845 eV)<br />
If set to zero, this stopping condition is ignored.<br />
Effective only when SCF cycles are done (<a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>&gt;0).<br />
Because of machine precision, it is not worth to try to obtain differences in
energy that are smaller than about 1.0d-12 of the total energy. To get
accurate stresses may be quite demanding.<br />
When the geometry is optimized (relaxation of atomic positions or primitive
vectors), the use of <a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a> is to be avoided. The use of <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a> or
<a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a> is by far preferable, in order to have a handle on the geometry
characteristics. When all forces vanish by symmetry (e.g. optimization of the
lattice parameters of a high-symmetry crystal), then place <a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a> to
1.0d-12, or use (better) <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a>.<br />
Since <a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a>, <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> and <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a> are aimed
at the same goal (causing the SCF cycle to stop), they are seen as a unique
input variable at reading. Hence, it is forbidden that two of these input
variables have non-zero values for the same dataset, or generically (for all
datasets). However, a non-zero value for one such variable for one dataset
will have precedence on the non-zero value for another input variable defined
generically.</p>
<h2 id="toldff"><strong>toldff</strong><a class="headerlink" href="#toldff" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on the DiFference of Forces<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to control the SCF cycle" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SCFControl">topic_SCFControl</a>, <a class="wikilink topic-wikilink" data-content="How to tune the computation of forces and stresses" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/ForcesStresses">topic_ForcesStresses</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Comment:</em> The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a>, <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> must differ from zero.<br />
<em>The use of this variable forbids the use of:</em> specified(<a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a>)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [92/920] in all abinit tests, [10/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Stishovite (a polymorph of SiO2) Test PBEsol in the PAW formalism,  using PAW datasets created with atompaw linked with libxc. Note that the value of ixc is not present in the input file,  but it is present in the ATOMPAW dataset (pspxc = -116133)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>seq:  <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=14 (finite reduced electric field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_121.in" target="_blank">tsv6_121.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=16 (finite reduced electric displacement field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_122.in" target="_blank">tsv6_122.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=4 (finite electric field calculation,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv6_123.in" target="_blank">tsv6_123.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si,  Bulk,  2 atoms,  paral_kgb. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test the triple parallelisation. We cannot check the distribution npband*npfft*npkpt=2*2*2=8 processors, this number being not allowed in the test procedure. Here,  we only test the parallelisation over FFT and kpoints: npband*npfft*npkpt=1*2*2=4 processors. In test tY.in we check other distributions for guarantee." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t24.in" target="_blank">t24.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Molybdenum slab (5 atoms+3 vacuum),  with ixc=1. 4 k-points,  in core. Use iprcel=45 for SCF cycle." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Molybdenum slab (5 atoms+3 vacuum),  with ixc=1. 4 k-points,  in core. Use iprcel=45 for SCF cycle." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Molybdenum slab (5 atoms+3 vacuum),  with ixc=1. 4 k-points,  in core. Use iprcel=45 for SCF cycle." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Mo surface,  with 10 atom per cell. Not very large,  but the number of bands make it a medium-size problem : 36 bands." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t41.in" target="_blank">t41.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the option ionmov=4. 8-atom Si cube,  non spin-polarized. Same test as number 22a of fast,  except for the change of ionmov,  no reading of wavefunctions,  iscf to 2,  and different tolerance criteria." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t44.in" target="_blank">t44.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the option ionmov=4. Si2 molecule,  spin-polarized. Same test as number 16 of fast,  except for the change of ionmov,  no reading of wavefunctions,  iscf to 2,  and different tolerance criteria. Cannot be executed in parallel: --- !ERROR message: | the number of bands in the spin up case must be equal to the number of bands in the spin down case. This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3 Action : change nband,  or use the sequential version of ABINIT. src_file: chkinp.F90 src_line: 1181 ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t45.in" target="_blank">t45.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="O2 (non-spin-polarized,  non-linear XC core correction,  GGA) Computation of forces in the GGA,  and comparison with a finite difference of energy. The direct computation of force (dataset 2) gives 0.627251486 Ha/Bohr A simple finite-difference estimation (dataset 1 and 3) gives 0.627251265 Ha/Bohr. The agreement can be improved if a better finite-difference estimation is used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t40.in" target="_blank">t40.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 (non-spin-polarized,  non-linear XC core correction,  GGA) Computation of uniaxial stresses in the GGA, and comparison with a finite difference of energy. The direct computation of sigma(zz) stress (dataset 2) gives 0.964267876d-3 Ha/Bohr**3 A simple finite-difference estimation (dataset 1 and 3) gives a difference in total energy of 0.085048409d-3 Ha, for a difference of volume of 0.0882 Bohr**3 leading to a stress estimation of 0.96426768d-3 Ha/Bohr**3 The agreement can be improved if a better finite-difference estimation is used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t41.in" target="_blank">t41.in</a>, <a class="wikilink abifile-wikilink" data-content="Arsenic in rhombohedral structure. Optimization of unit cell size and shape. With 4x4x4 k point grid,  ecut 3.0,  occopt 4 and tsmear 0.06d0, one get acell 3*7.325  angdeg 3*57.36 and xred 0.2277 These input parameters are too small,  but still give a realistic geometry,  since with the much better parameters 12x12x12 k point grid,  ecut 12.0,  occopt 4 and tsmear 0.04d0, one gets acell 3*7.633  angdeg 3*54.95 and xred 0.2296,  while the experimental values are acell 3*7.751   angdeg 3*54.554 and xred 0.2276" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t44.in" target="_blank">t44.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="8 atoms of Si in an elongated box. 4 of them are fixed,  while atoms 5 and 6 and 7 and 8 are grouped by pair,  such as the sum of their relative separations along y is constrained to 8.0 . This is a crazy constraint,  just to show that it can be done !" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t40.in" target="_blank">t40.in</a>, <a class="wikilink abifile-wikilink" data-content="No description available" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t43.in" target="_blank">t43.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule : examine the rotational freedom. The present test produces the following vibrational frequencies (with degeneracies indicated): 56.89 i cm-1 (2) 0.41   cm-1 (2) 1.05   cm-1 3800    cm-1 The large frequency corresponds to the stretching mode,  and has the right order of magnitude. The frequencies close to 1 cm-1 corresponds to translation modes,  and are small enough for usual applications. The  56.89 i cm-1 mode corresponds to rotation of the H2 molecule. The magnitude of this frequency might seem quite large. Here are the results of tests made to understand this phenomenon. First,  note that ecut 12  acell 3*14 Increasing the value of ecut to 25 decreases the magnitude of the frequency to 36.8 cm-1 . However,  in order to continue to make it smaller, the cell size must be increased,  and an oscillatory behaviour is observed : 3*16   45.6 i cm-1 3*18   22.7   cm-1 3*20   19.1 i cm-1 3*22   15.7 i cm-1 3*24   13.7   cm-1 Many other tests have been set up. In particular, it was observed that the frequency of the oscillatory behaviour changes with the ecut,  and also that using the Gamma point,  instead of the 1/4 1/4 1/4 k point (used in this test) degrades the convergence. The overall picture is as follows. There are different reasons for the translation and rotation modes to acquire a non-zero frequency when plane waves and supercells are used. Still,  as concerns translations,  only the existence of a discretization of the XC grid is important. For rotations,  supercell effects are also present : - alignement of dipole or quadrupoles - interaction between tails of wavefunctions,  accross cells Since the convergence in supercell size is oscillatory,  we infer that the breaking of the rotational invariance is mostly due to interaction between wavefunction tails. This will be checked by confining the system in a spherical well,  in a forthcoming test." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t80.in" target="_blank">t80.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  static,  spin-polarized. Same system as test 49 of v2,  except that nctime is non-zero. Test ionmov=6 (Verlet) as well as ionmov=7." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t21.in" target="_blank">t21.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="Hydronium ion + NH3 molecule Ground state calculation keeping O and H atoms fixed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tstring_01.in" target="_blank">tstring_01.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="NaCl molecule in a big box. Test of the computation of the polarisation with the routine berryphase_new, for different k-point grids : only 1 k-point,  a line of k-points,  and a full mesh of k-points. Results with acell 20 10 10 are : -9.727 C/m^2,  -9.975 C/m^2,  -9.503 C/m^2 multiplied by the volume (in a.u.),  gives -19454,  -19950,  -19006 Test provided by S. Leroux Going to bigger cells make these results converge to the same value : Results with acell 30 20 20 are : -1.771 C/m^2,  -1.746 C/m^2,  -1.747 C/m^2 multiplied by the volume (in a.u.),  gives -21252,  -20952,  -20964 Results with acell 40 20 20 are : -1.3167C/m^2,  -1.3057C/m^2,  -1.3062C/m^2 multiplied by the volume (in a.u.),  gives -21067,  -20891,  -20899 Results with acell 50 20 20 are : -1.0502C/m^2,  -1.0444C/m^2,  -1.0450C/m^2 multiplied by the volume (in a.u.),  gives -21004,  -20888,  -20900" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the symmetry finder for all the Bravais lattices, with different input formats (rprim or angdeg),  and for non-conventional choices of axes as well. Uses only one atom,  placed at (0.6 0 0) Similar to test v2#52,  except for the choice of the location" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t15.in" target="_blank">t15.in</a>, <a class="wikilink abifile-wikilink" data-content="Bismuth,  rhombohedral,  two atoms per unit cell Scalar relativistic. Relax four different images,  using the steepest descent algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t21.in" target="_blank">t21.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation in (N, V, T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested together with the three coordinate systems (primitive,  normal mode,  staging). NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with --- Pseudopotential description --" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t08.in" target="_blank">t08.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="Si/Ge heterojunction : 4 layer each. Output the density and potential. Prepare the macroaverage analysis,  see next tests." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t42.in" target="_blank">t42.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_1.in" target="_blank">tbase2_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom. Here,  a double loop has been used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_2.in" target="_blank">tbase2_2.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the computation of the positron lifetime (using the two-component DFT) within PAW. A cubic box with 4 Al atoms at experimental volume. Low cut-offs,  few k-points. Datasets 2 to 3 use ixcpositron=2 i.e. LDA electron-positron correlation provided by Puska, Seitsonen,  and Nieminen (PRB 52,  10947). Datasets 4 to 5 use ixcpositron=11 i.e. LDA zero positron density limit parametrized by Arponen and Pajanne and fitted by Sterne and Kaiser (PRB 43,  13892). Dataset 1 performs a simple electronic GS calculation and store the density. Dataset 2 performs a positronic GS calculation in presence of the electronic density computed by dataset 1 (positron=1). Dataset 3 performs an electronic GS calculation in presence of the positronic density computed by dataset 2 (positron=2). Dataset 4 performs an automatic electronic/positronic GS calculation without storage of the wave-functions (positron=-1). Dataset 5 performs an automatic electronic/positronic GS calculation with storage of the wave-functions (positron=-10). Each dataset computes the positron lifetime and annihilation rate after the SCF iterations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t07.in" target="_blank">t07.in</a> &hellip;</li></ul></details><p>Sets a tolerance for differences of forces (in hartree/Bohr) that, reached
TWICE successively, will cause one SCF cycle to stop (and ions to be moved).<br />
If set to zero, this stopping condition is ignored.<br />
Effective only when SCF cycles are done (<a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>&gt;0). This tolerance
applies to any particular cartesian component of any atom, INCLUDING fixed
ones. This is to be used when trying to equilibrate a structure to its lowest
energy configuration (<a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>=2), or in case of molecular dynamics
(<a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>=1)<br />
A value ten times smaller than <a class="wikilink codevar-wikilink" href="../rlx#tolmxf">tolmxf</a> is suggested (for example 5.0d-6
hartree/Bohr).<br />
This stopping criterion is not allowed for RF calculations.<br />
Since ** toldfe ** , <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> and <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a> are
aimed at the same goal (causing the SCF cycle to stop), they are seen as a
unique input variable at reading. Hence, it is forbidden that two of these
input variables have non-zero values for the same dataset, or generically (for
all datasets). However, a non-zero value for one such variable for one dataset
will have precedence on the non-zero value for another input variable defined
generically.</p>
<h2 id="tolrff"><strong>tolrff</strong><a class="headerlink" href="#tolrff" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on the Relative diFference of Forces<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to control the SCF cycle" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SCFControl">topic_SCFControl</a>, <a class="wikilink topic-wikilink" data-content="How to tune the computation of forces and stresses" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/ForcesStresses">topic_ForcesStresses</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Comment:</em> The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a>, <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> must differ from zero.<br />
<em>The use of this variable forbids the use of:</em> specified(<a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a>)&rsquo;  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v8:  <a class="wikilink abifile-wikilink" data-content="LiH molecule test the use of spatial chemical potential. The molecule starts aligned along the x direction, while the Li chemical potential pulls the Li nucleus. The z coordinate of the molecule is changed from 0 to 5 Bohr. There is a linear part to the chemical potential. The energy and force should be the same in datasets 11 to 15 (without chemical potentiel). One sees that this is not completely the case. The force along z vanishes in these cases,  because the translational invariance is imposed by ABINIT. In datasets 21 to 23,  the energy should increase linearly,  and the force along z should be non-zero and constant. Small fluctuations are observed. Dataset 24 and 25 corresponds to the cubic part of the chemical potential. Dataset 26 places the molecule at a symmetric value of z. The total energy should be the same as with dataset 11,  16,  or 21." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t30.in" target="_blank">t30.in</a>, <a class="wikilink abifile-wikilink" data-content="LiH molecule test the use of spatial chemical potential. The molecule starts aligned along the x direction, while the Li chemical potential pulls the Li nucleus toward -z,  and the H chemical potential pushes the H nucleus toward +z. See whether the optimization runs properly." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t31.in" target="_blank">t31.in</a></li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H2O in isolated boundary conditions (plane waves,  NC),  try tu use Damiens Poisson cutoff. Water molecule with HGH pseudo-potentials. This checks that a negative value in rhor will not make the Poisson solver crashes on XC computation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t22.in" target="_blank">t22.in</a></li><li>v5:  <a class="wikilink abifile-wikilink" data-content="Al2 molecule in a big box. Treat 8 bands,  occupied using occopt=4. Compare tolrff and toldff stopping criteria" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t41.in" target="_blank">t41.in</a></li></ul></details><p>Sets a tolerance for the ratio of differences of forces (in hartree/Bohr) to
maximum force, that, reached TWICE successively, will cause one SCF cycle to
stop (and ions to be moved) : diffor &lt; tolrff * maxfor.<br />
If set to zero, this stopping condition is ignored.<br />
Effective only when SCF cycles are done (<a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>&gt;0). This tolerance
applies to any particular cartesian component of any atom, INCLUDING fixed
ones. This is to be used when trying to equilibrate a structure to its lowest
energy configuration (<a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>=2), or in case of molecular dynamics
(<a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>=1)<br />
A value of 0.02 is suggested.<br />
This stopping criterion is not allowed for RF calculations.<br />
Since ** toldfe ** , <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> and <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a> are
aimed at the same goal (causing the SCF cycle to stop), they are seen as a
unique input variable at reading. Hence, it is forbidden that two of these
input variables have non-zero values for the same dataset, or generically (for
all datasets). However, a non-zero value for one such variable for one dataset
will have precedence on the non-zero value for another input variable defined
generically.</p>
<h2 id="tolvrs"><strong>tolvrs</strong><a class="headerlink" href="#tolvrs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on the potential V(r) ReSidual<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to control the SCF cycle" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Comment:</em> The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a>, <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> must differ from zero.<br />
<em>The use of this variable forbids the use of:</em> specified(<a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>)&rsquo;  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [290/920] in all abinit tests, [51/116] in abinit tutorials</summary><ul><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the approach of Silvestrelli to access van der Waals interactions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon FCC Test the approach of Ambrosetti and Silvestrelli to assess van der Waals interactions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t12.in" target="_blank">t12.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon FCC Test the approach of Silvestrelli to assess van der Waals interactions,  combining the QHO model with Wannier functions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t13.in" target="_blank">t13.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Carbon atom Test the mGGA functionals generating directly XC potentials. Similar to test 08,  but with smaller acell and ecut. Without the use of a &amp;quot;large&amp;quot; xc_denpos,  Tran-Blaha is hard to converge. Hypothesis : there is a strong non-linear region,  preventing the Anderson method to work effectively. Note that the default iscf (=7) does not allow to converge with the default xc_denpos ! By contrast,  things are much better behaved with xc_denpos on the order of 1.0e-7 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t13.in" target="_blank">t13.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond: hybrid functional calculation with the GW code Perturbative approach to the HSE06,  PBE0,  and B3LYP band gaps HSE06 and PBE0 tests temporarily disabled,  waiting for the next version of the libxc)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t41.in" target="_blank">t41.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond: hybrid functional calculation with the GW code Self-consistent approach to the HSE06 band structure based on a unitary transform of a subset of LDA wavefunctions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t42.in" target="_blank">t42.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Carbon in diamond structure. Chained GW calculation: The first run produces the WFK,  the SCR,  the SUSC and the QPS file. These file are subsequently read and used in t537 using irdwfk,  irdscr,  irdsuscep and irdqps In the second dataset of t85,  the screened interaction W is approximated using the test-electron expression with the TDDFT ALDA kernel (gwgamma==1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline alpha-quartz Calculation of the GW corrections with non-symmorphic operations,  PAW case. but with a set of translated atoms. PAW case. Ordered set of atoms; non-ordered set of atoms; translated atoms. Similar to v5#64,  for PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline alpha-quartz Calculation of the GW corrections with non-symmorphic operations, but with a non-ordered set of atoms. Norm-conserving case. Similar to v6#97." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H in isolated boundary conditions (plane waves,  PAW). Tests free boundary conditions Poisson solver for PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t23.in" target="_blank">t23.in</a>, <a class="wikilink abifile-wikilink" data-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t31.in" target="_blank">t31.in</a>, <a class="wikilink abifile-wikilink" data-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t32.in" target="_blank">t32.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="Fe in HCP structure. Low cut-offs and few k-points. This test is done within GGA and no magnetism in PAW formalism. The same job is done twice with two differents values of mkmem." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW: test of some variables reserved to experienced users Silicon with few k-points and low cut-off" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t17.in" target="_blank">t17.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the pspcod=8 input format (contributed by D.R. Hamann) This format is primarily intended to offer a flexible platform for those who wish to experiment with their own features in norm-conserving pseudopotentials.  A full description and discussion is given in Infos/Psp_infos/psp8.info.  This test case,  CaO,  is an example of self-interaction-corrected pseudopotentials in the style of D. Vogel,  P. Krueger,  and J. Pollmann,  Phys. Rev. B 52, 14 316 (1995).  The bandgap (direct) in the test example,  11.2eV, is in excellent agreement with experiment,  but is rather strongly dependent on the radius at which the self-interaction-correction of Ca is (smoothly) cut off.  The sic pseudopotentials used in this test should not be considered anything but early-stage experiments and should not be used for any other purpose." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t20.in" target="_blank">t20.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="GaAs with PAW and spin-orbit coupling. 2x2x2 K grid;  low cut-off for test Test paral_kgb==1 with MPI-FFT/spinor parallelization,  the IO of the WFK file, the output of potential files and the calculation of PJDOS in parallel (PW term + on-site contributions)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t28.in" target="_blank">t28.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Test the parallelization over spinorial components of WF Bi A7 structure (2 atoms,  treated as semi-conductor), using PAW,  within LDA and spin-orbit coupling. - with zero magnetization      (nspden=1,  nspinor=2) - with non-collinear magnetism (nspden=4,  nspinor=2)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t28.in" target="_blank">t28.in</a>, <a class="wikilink abifile-wikilink" data-content="FCC Al metallic;  10 special points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="FCC Al metallic;  10 phonon at 1/4 1/8 1/8" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t53.in" target="_blank">t53.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="Lead crystal. Parallelism over k-points" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbasepar_1.in" target="_blank">tbasepar_1.in</a>, <a class="wikilink abifile-wikilink" data-content="FCC Fe (ferromagnetic for fun) with four atoms per cell Distorted with a A1 phonon,  so as to keep the symmetry ... Only one k point in the IBZ Test the parallelism over the spins" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbasepar_2.in" target="_blank">tbasepar_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon Preparatory run for BS calculations There are four datasets specified in this input: 1) Ground-state calculation to get the density. 2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4,  gamma-centered) 3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling 4) SCR calculation with the WFK file generated in the second dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_1.in" target="_blank">tbs_1.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="O2 molecule,  treated like a metal (there is a degeneracy at the Fermi level), occopt=4 and tsmear=0.04,  with nsppol=2 . Use spinat to polarize the molecule at start. Gives total energy of -32.09317 Hartree This test can be used to check the accuracy of stresses in the spin-polarized case. Setting acell(1:2) to 7.005 and 6.995 gives ETOT -32.090846193972 and -32.095501753750, ucvol  441.63023 and 440.37023 so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03, to be compared with sigma(1)=3.6949713786E-03 and sigma(2)=3.6949681083E-03 from the present test (the degeneracy is slightly lifted because of incomplete convergence, using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both sigma values)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="3H2 molecule with distant atoms : probe the use of the spinat variable Use spin-polarized mode,  spinor mode,  as well as antiferromagnetic mode. Even consider an initialization with reather crazy,  nearly ferromagnetic spinat. Use 01h.pspgth,  in a 8 8 16 box,  with 15 Ha cut-off. Separation is 4 bohr. Consider anti-parallel spin configuration,   which is the favoured one for this distance. Get total energy of -0.981 839  Ha . Note that the spin-polarization is not complete. Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t39.in" target="_blank">t39.in</a>, <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  spin-polarized. ixc=0. 7 states for each spin. First,  converge using mixing factor,  then evaluate RPA dielectric matrix,  and use it for convergence." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t53.in" target="_blank">t53.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Orthorhombic Al system,  q(1/2 0 0),  partial occupation numbers. Compares with frozen-phonon calculations. Examine two cases: varying occupation numbers,  and fixed occupation numbers. A. Varying occupation numbers (occopt=4): RF calculation in dataset 5 gives 2DE equal to -3.812577 Ha,  while finite difference of &amp;quot;TOTAL&amp;quot; energy (datasets 6 and 7,  including entropy term) gives -3.812230 Ha (the agreement could be better with better finite difference) B. Fixed occupation numbers (occopt=2): RF calculation in dataset 8 gives 2DE equal to +5.431807 Ha,  while finite difference of total energy (no entropy term is present with occopt=2) gives +5.431857 Ha (the agreement could be better with better finite difference)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="BCC Helium q close to Gamma,  along Gamma-H There is a problem with kptopt=1 or 3 for the NSC step." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t12.in" target="_blank">t12.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 28. The chosen grid (too coarse,  though) is (0 0 0),  (1/4 1/4 0),  (1/2 1/2 0),  (1/2 0 0), (1/2 1/4 1/4),  (1/2 -1/4 1/4)  (in reduced coordinates). The ecut and nkpt parameters are really too low (see test 28), but parameters suitable for physical results (see test 29) are also provided in the input files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t26.in" target="_blank">t26.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2. Use the x-only PBE functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.10691 Ha while finite differences gives : with delta(xred)=0.0002,  189.10790 Ha with delta(xred)=0.0001,  189.10703 Ha . Combining the results gives 189.10675 Ha. The agreement is quite good,  and might likely be improved by increasing tolvrs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2,  and preceeding test, but use the full XC PBE functional. Also,  tolvrs is better. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 188.81162533 Ha while finite differences gives : with delta(xred)=0.0002,  188.81213804 Ha with delta(xred)=0.0001,  188.81175352 Ha . Combining the results gives 188.81162525 Ha." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t08.in" target="_blank">t08.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_1.in" target="_blank">tmbt_1.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="MgB2,  space group P6/m m m (#191);  Bravais hP (primitive hexag.) GS calculation followed by a band structure calculation in which the k-path is automatically defined via the ndivsm input variable. The third dataset tests the calculation and the output of the Fermi surface (prtfsurf=1) in the Xcrysden format." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t14.in" target="_blank">t14.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone. Use the definition through qptrlatt. Otherwise,  similar to Tv2#26 and Tv6#78." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t35.in" target="_blank">t35.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure - anitferro - PAW Test the use of MPI+GPU" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="PAW response function calculation of derivative of wavefunction (DDK) Si with PAW dataset generated from uspp code. Computes derivative with DFPT formalism,  and also computes energies with displaced k+q so that energies can be checked by finite differences." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW: test of some variables reserved to experienced users or developers BCC iron,  ferromagnetic,  GGA,  PAW. Also tests maxnsym keyword." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the computation of the positron lifetime (using the two-component DFT) within PAW. A cubic box with 4 Al atoms at experimental volume. Low cut-offs,  few k-points. Datasets 2 to 3 use ixcpositron=2 i.e. LDA electron-positron correlation provided by Puska, Seitsonen,  and Nieminen (PRB 52,  10947). Datasets 4 to 5 use ixcpositron=11 i.e. LDA zero positron density limit parametrized by Arponen and Pajanne and fitted by Sterne and Kaiser (PRB 43,  13892). Dataset 1 performs a simple electronic GS calculation and store the density. Dataset 2 performs a positronic GS calculation in presence of the electronic density computed by dataset 1 (positron=1). Dataset 3 performs an electronic GS calculation in presence of the positronic density computed by dataset 2 (positron=2). Dataset 4 performs an automatic electronic/positronic GS calculation without storage of the wave-functions (positron=-1). Dataset 5 performs an automatic electronic/positronic GS calculation with storage of the wave-functions (positron=-10). Each dataset computes the positron lifetime and annihilation rate after the SCF iterations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t07.in" target="_blank">t07.in</a> &hellip;</li></ul></details><p>Sets a tolerance for potential residual that, when reached, will cause one SCF
cycle to stop (and ions to be moved).<br />
If set to zero, this stopping condition is ignored.<br />
Effective only when SCF cycles are done (<a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>&gt;0).<br />
To get accurate stresses may be quite demanding. For simple materials with
internal positions determined by symmetries, a value of <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a>=10^-12
empirically leads to a very approximate 10^-6 atomic unit accuracy for the
optimized lattice parameter.</p>
<p>Additional explanation : the residual of the potential is the difference
between the input potential and the output potential, when the latter is
obtained from the density determined from the eigenfunctions of the input
potential. When the self-consistency loop is achieved, both input and output
potentials must be equal, and the residual of the potential must be zero. The
tolerance on the potential residual is imposed by first subtracting the mean
of the residual of the potential (or the trace of the potential matrix, if the
system is spin-polarized), then summing the square of this function over all
FFT grid points. The result should be lower than <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a>.<br />
Since ** toldfe ** , <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> and <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a> are
aimed at the same goal (causing the SCF cycle to stop), they are seen as a
unique input variable at reading. Hence, it is forbidden that two of these
input variables have non-zero values for the same dataset, or generically (for
all datasets). However, a non-zero value for one such variable for one dataset
will have precedence on the non-zero value for another input variable defined
generically.</p>
<h2 id="tolwfr"><strong>tolwfr</strong><a class="headerlink" href="#tolwfr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on WaveFunction squared Residual<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to control the SCF cycle" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Comment:</em> The default value implies that this stopping condition is ignored. For the SCF case, one and only one of the input tolerance criteria <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a>, <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a> or <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> must differ from zero.<br />
<em>The use of this variable forbids the use of:</em> specified(<a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>) or specified(<a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a>)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [440/920] in all abinit tests, [39/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_libxc.in" target="_blank">testin_libxc.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation for crystalline alpha-quartz. Preparatory GS run." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tmbt_1.in" target="_blank">tmbt_1.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="Crystalline silicon Computation of the band structure. First,  a SCF density computation,  then a non-SCF band structure calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_5.in" target="_blank">tbase3_5.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon Preparatory run for BS calculations There are four datasets specified in this input: 1) Ground-state calculation to get the density. 2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4,  gamma-centered) 3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling 4) SCR calculation with the WFK file generated in the second dataset" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbs_1.in" target="_blank">tbs_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon Calculation of the GW corrections Dataset 1: ground state calculation and calculation of the WFK file for 10 k-points in IBZ Dataset 2: calculation of the screening (epsilon^-1 matrix for W) Dataset 3: calculation of the Self-Energy matrix elements (GW corrections)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tgw1_1.in" target="_blank">tgw1_1.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="Water molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Graphene. Test wavelet run on surface" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with geometry optimisation using BFGS (test the reformating part of the code)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="2 special k point Si in 2-atom diamond unit cell.  Uses symmetry. mkmem=mkpt,  mffmem=1 (&amp;quot;in core&amp;quot; solution), This calculation is also iterated to convergence.  ecut too small. Uses original Teter extended norm conserving psp 14si.psp." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in a box.. Test of prtvol = -2,  so stop after init,  and echo in a NETCDF file." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t22.in" target="_blank">t22.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="FCC Yb (1 atom per unit cell), using a l=3 psp with s local part. Crazy cut-off and number of k points. Shows that the derivative of the eigenenergies with respect to the wavevector can be obtained both by finite differences and analytical means (from a preliminary computation in the treatment of the ddk perturbation). For the (0.25, 0.25, 0.25) k point, the tenth band eigenvalue is -3.01209 eV. Going to the (0.251, 0.251, 0.251) k point it becomes -3.00562 eV,  with finite-difference estimation of the derivative with respect to ONE wavevector change (all three components changed) being 0.00647 eV/0.001/3=2.157 eV This value is unchanged when using the data at the (0.253, 0.253, 0.253) k point. The analytical value is 2.15566 eV." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor First dataset : compute the density Second dataset : compute the spinor wfs at one k point, non-self consistently Third dataset : use the spinor wfs of the previous dataset to restart computations at symmetric k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t13.in" target="_blank">t13.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test of the extension of the pspcod=8 input format to include spin-orbit coupling with multiple non-local projectors.  The band structure of fcc Pt is computed at Gamma,  X,  and L. The pseudopotential used in the test is generated by the open-source ONCVPSP code,  which is available at www.mat-simresearch.com,  and described in D. R. Hamann,  Phys. Rev. B 88,  085177 (2013). The relativistic extension is documented in the code package. The Pt 5s and 5p semi-cores are treated as valence,  and the band structure is well-converged at the ecut used in the test (20 Ha). A complete description of the input format is avaiable in doc/psp_infos/psp8_info.txt." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Similar to v7[07]. Here we test optdriver 8 (WFK post-processing) with NC and SO. More specifically,  we reconstruct the wavefunctions in the full BZ in dataset 2 and we use this WFK to restart the calculation in dataset 3 with the full k-mesh (kptopt 3). The SCF cycle should exit at the first iteration since the wavefunctions are already converged." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t12.in" target="_blank">t12.in</a>, <a class="wikilink abifile-wikilink" data-content="Fake body-centered tetragonal crystal This test checks the capability of ABINIT to identify and correct inaccurate primitive vectors using the tolsym input variable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t13.in" target="_blank">t13.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Interpolation of electronic bands with two different techniques (star functions and B-spline interpolation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="WARNING: This code is still under development. Use at your own risk! Preparatory run for the calculation of the Fan-Migdal + Debye-Waller self-energy C in diamond structure. Very rough 2x2x2 q-point grid (3 qpoints);  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t41.in" target="_blank">t41.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW response function calculation of derivative of wavefunction (DDK) Si with PAW dataset generated from uspp code. Computes derivative with DFPT formalism,  and also computes energies with displaced k+q so that energies can be checked by finite differences." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="Ni atom in a big box. Test the use of the atvshift variable : change the potential of the d orbitals." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t14.in" target="_blank">t14.in</a> &hellip;</li></ul></details><p>The signification of this tolerance depends on the basis set. In plane waves,
it gives a convergence tolerance for the largest squared &ldquo;residual&rdquo; (defined
below) for any given band. The squared residual is:  </p>
<div class="codehilite"><pre><span></span>  &lt; nk|(H-E)2|nk &gt;,    E = &lt; nk|H|nk &gt;
</pre></div>


<p>which clearly is nonnegative and goes to 0 as the iterations converge to an
eigenstate. With the squared residual expressed in Hartrees  2  (Hartrees
squared), the largest squared residual (called residm) encountered over all
bands and k points must be less than <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a> for iterations to halt due to
successful convergence.<br />
Note that if <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>&gt;0, this criterion should be replaced by those based
on <a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a> (preferred for <a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>==0), <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a> <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a> (preferred
for <a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>/=0), or <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> (preferred for theoretical reasons!).<br />
When <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a> is 0.0, this criterion is ignored, and a finite value of
<a class="wikilink codevar-wikilink" href="../basic#toldfe">toldfe</a>, <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a> or <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> must be specified. This also imposes a
restriction on taking an ion step; ion steps are not permitted unless the
largest squared residual is less than <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a>, ensuring accurate forces.<br />
To get accurate stresses may be quite demanding.<br />
Note that the preparatory GS calculations before a RF calculations must be
highly converged.<br />
Typical values for these preparatory runs are <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a> between 1.0d-16 and
1.0d-22.</p>
<p>Note that <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a> is often used in the test cases, but this is _ tolwfr _
purely for historical reasons : except when <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>&lt;0, other critera
should be used.</p>
<p>In the wavelet case (see <a class="wikilink codevar-wikilink" href="../basic#usewvl">usewvl</a> = 1), this criterion is the favoured one.
It is based on the norm 2 of the gradient of the wavefunctions. Typical values
range from 5*10  -4  to 5*10  -5  .</p>
<p>Since ** toldfe ** , <a class="wikilink codevar-wikilink" href="../basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolrff">tolrff</a>, <a class="wikilink codevar-wikilink" href="../basic#tolvrs">tolvrs</a> and <a class="wikilink codevar-wikilink" href="../basic#tolwfr">tolwfr</a> are
aimed at the same goal (causing the SCF cycle to stop), they are seen as a
unique input variable at reading. Hence, it is forbidden that two of these
input variables have non-zero values for the same dataset, or generically (for
all datasets). However, a non-zero value for one such variable for one dataset
will have precedence on the non-zero value for another input variable defined
generically.</p>
<h2 id="typat"><strong>typat</strong><a class="headerlink" href="#typat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TYPe of AToms<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify a crystal, with atomic positions and symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/crystal">topic_crystal</a>, <a class="wikilink topic-wikilink" data-content="How to specify the types of atoms that form the system" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/AtomTypes">topic_AtomTypes</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> [3, &lsquo;<a class="wikilink codevar-wikilink" href="../geo#natrd">natrd</a>&rsquo;] if <a class="wikilink codevar-wikilink" href="../geo#natrd">natrd</a>&lt;<a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>,
[3, &lsquo;<a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>&rsquo;] otherwise.</p>
<p><em>Default value:</em> 1 if <a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>==1,
None otherwise.</p>
<details class="note"><summary>Test list (click to open). Very frequently used, [920/920] in all abinit tests, [116/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Array giving an integer label to every atom in the unit cell to denote its
type.<br />
The different types of atoms are constructed from the pseudopotential files.
There are at most <a class="wikilink codevar-wikilink" href="../basic#ntypat">ntypat</a> types of atoms.<br />
As an example, for BaTiO3, where the pseudopotential for Ba is number 1, the
one of Ti is number 2, and the one of O is number 3, the actual value of the
<a class="wikilink codevar-wikilink" href="../basic#typat">typat</a> array might be :</p>
<div class="codehilite"><pre><span></span>  typat 1 2 3 3 3
</pre></div>


<p>The array <a class="wikilink codevar-wikilink" href="../basic#typat">typat</a> has to agree with the actual locations of atoms given in
<a class="wikilink codevar-wikilink" href="../basic#xred">xred</a> , <a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> or <a class="wikilink codevar-wikilink" href="../basic#xangst">xangst</a>, and the input of pseudopotentials has to
be ordered to agree with the atoms identified in <a class="wikilink codevar-wikilink" href="../basic#typat">typat</a>.<br />
The nuclear charge of the elements, given by the array <a class="wikilink codevar-wikilink" href="../basic#znucl">znucl</a>, also must
agree with the type of atoms designated in &ldquo;<a class="wikilink codevar-wikilink" href="../basic#typat">typat</a>&rdquo;.<br />
The array <a class="wikilink codevar-wikilink" href="../basic#typat">typat</a> is not constrained to be increasing. An internal
representation of the list of atoms, deep in the code (array atindx), groups
the atoms of same type together. This should be transparent to the user, while
keeping efficiency.</p>
<h2 id="udtset"><strong>udtset</strong><a class="headerlink" href="#udtset" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Upper limit on DaTa SETs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters for a multi dataset calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/multidtset">topic_multidtset</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> None<br />
<em>Comment:</em> It is not used when it is not defined  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [42/920] in all abinit tests, [11/116] in abinit tutorials</summary><ul><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="Argon FCC Test the approach of Ambrosetti and Silvestrelli to assess van der Waals interactions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t12.in" target="_blank">t12.in</a>, <a class="wikilink abifile-wikilink" data-content="Argon FCC Test the approach of Silvestrelli to assess van der Waals interactions,  combining the QHO model with Wannier functions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t13.in" target="_blank">t13.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of various XC functionals for the response functions (thus,  the XC kernel is also tested). The test includes 3 different functionals: 1) Perdew-Zunger: ixc=2 and ixc=-001009 2) PBE: ixc=11 and ixc=-101130 3) Perdew-Wang92: ixc=7,  ixc=-001012,  and ixc=-001013 The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting some lines indicated by GMR. Note that the underlying FFT grid does not have the symmetry of the lattice." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t81.in" target="_blank">t81.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of the Perdew-Zunger XC functionals for the response functions (thus,  the XC kernel is also tested) in PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t82.in" target="_blank">t82.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a>, <a class="wikilink abifile-wikilink" data-content="Al fcc metal - elastic constant calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_6.in" target="_blank">telast_6.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.out" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t60.in" target="_blank">t60.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.out" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t60.in" target="_blank">t60.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.out" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t60.in" target="_blank">t60.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="2 special k point Si in 2-atom diamond unit cell. Double-loop over acell and ecut using series" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t83.in" target="_blank">t83.in</a>, <a class="wikilink abifile-wikilink" data-content="2 special k point Si in 2-atom diamond unit cell. Double-loop over acell and ecut using metacharacters only." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t84.in" target="_blank">t84.in</a>, <a class="wikilink abifile-wikilink" data-content="Mg atom,  in a big box,  displaced from the center, test different k points with time-reversal symmetry,  and different fftalg values." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t89.in" target="_blank">t89.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Aluminum in FCC structure. For occopt=4, 5, 6, 7,  determination of the total energy at slightly different tsmear values,  and check of the dE/d(tsmear)=-kT.entropy relationship. For example,  for occopt=4,  the difference between tsmear=0.101 and tsmear=0.099 is -11.149450d-6 Ha,  while the value of -kT.entropy is -5.574709d-4Ha,  that is about 500 larger,  as expected." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t45.in" target="_blank">t45.in</a>, <a class="wikilink abifile-wikilink" data-content="Aluminum in FCC structure. At fixed tsmear (=0.04),  check the convergence with respect to the number of k points,  for different occopt. The grids that are tested have respectively 10,  28,  and 60 k points in the IZB (ngkpt values are 4 4 4 4,  6 6 6 4 and 8 8 8 4 For occopt=4,  the total energy (or the enthalpy) is -2.079770 Ha,  -2.080534 Ha,  -2.080672 Ha; for occopt=5,  it is -2.079787 Ha,  -2.080563 Ha,  -2.080693 Ha; for occopt=7,  it is -2.084211 Ha,  -2.084861 Ha,  -2.084916 Ha. The latter values can be corrected by computing the mean of the total energy and the internal energy,  as described in Marzari's thesis,  for example. Thanks to this procedure,  one gets : -2.079732 Ha,  -2.080470 Ha,  and -2.080626 Ha. For information,  with a 12 12 12 4 grid (182 k points) and occopt=4,  one gets -2.080648 Ha." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t46.in" target="_blank">t46.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box. Comparison of the modified Broyden algorithm (ionmov=3) with the original one (ionmov=2). Start with different values of xcart,  from 0.6 to 1.1,  by step of 0.1 . The number of Broyden steps needed to reach acceptable residual forces with the ionmov=3 algorithm are : 3,  2,  2,  3,  3,  4,  while with the ionmov=2 algorithms,  one get : 4,  3,  2,  5,  and then, either the algorithm does not converge within 8 steps,  or it converges to a saddle point of the energy ! This test was hard to make portable. This is why the tolerance for fldiff is very large." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t48.in" target="_blank">t48.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Mg atom,  in a big box,  displaced from the center, test different k points with time-reversal symmetry,  and different fftalg values (4xx) corresponding to the 2002 FFT of SGoedecker." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t50.in" target="_blank">t50.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="GeTe in rhombohedral structure Test the computation of phonons,  dielectric tensor and Born effective charges,  with and without spin-orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t24.in" target="_blank">t24.in</a>, <a class="wikilink abifile-wikilink" data-content="NH3 and NH2-CH3 molecules,  supercell geometry Show the computations needed to obtain the differential pseudopotentials 7n.pspnc (just usual atomic configuration) and 7n.1s_psp.mod (with a hole in state 1s). The differential core-level shift is obtained by comparing difference in the total energies of the NH3 molecule with both pseudopotentials with the one of the NH2CH3 molecule : 0.41522 Ha for the NH3 molecule 0.41768 Ha for the NH2-CH3 molecule,  making for a shift of 2.46 mHa=0.0669 eV due to the replacement of one H atom of the NH3 molecule by a CH3 group. Note that these are completely non converged values. Parameters like ecut and acell should be the subject of a convergence study. For applications of this technique,  see Rignanese GM et al,  Phys. Rev. Lett. 79,  5174 (1997), or Travaly Y et al,  Phys. Rev. B 61,  7716 (2000)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t42.in" target="_blank">t42.in</a>, <a class="wikilink abifile-wikilink" data-content="Bismuth atom,  isolated,  in a supercell. Compares different spin treatments : - spin-polarized collinear (nspinor=1,  nspden=2,  nsppol=2,  no spin-orbit) - spinor (nspinor=2,  nspden=4,  nsppol=1,  no spin-orbit) Both with fixed occupation numbers and metallic occupations. This test has been contributed by L.E. Diaz. Additional test added for kinetic energy density by A. Lherbier" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t51.in" target="_blank">t51.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Bi atom in a big supercell. Test the application of a Zeeman field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t17.in" target="_blank">t17.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon. Diamond structure. Quick test of the use of datasets with a numbering beyond 1000 (the last one is 1022). (Tests 35-40 are for response-function)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t34.in" target="_blank">t34.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone. Use the definition through qptrlatt. Otherwise,  similar to Tv2#26 and Tv6#78." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t35.in" target="_blank">t35.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Fake body-centered tetragonal crystal This test checks the capability of ABINIT to identify and correct inaccurate primitive vectors using the tolsym input variable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t13.in" target="_blank">t13.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t55.in" target="_blank">t55.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="LiH molecule test the use of spatial chemical potential. The molecule starts aligned along the x direction, while the Li chemical potential pulls the Li nucleus. The z coordinate of the molecule is changed from 0 to 5 Bohr. There is a linear part to the chemical potential. The energy and force should be the same in datasets 11 to 15 (without chemical potentiel). One sees that this is not completely the case. The force along z vanishes in these cases,  because the translational invariance is imposed by ABINIT. In datasets 21 to 23,  the energy should increase linearly,  and the force along z should be non-zero and constant. Small fluctuations are observed. Dataset 24 and 25 corresponds to the cubic part of the chemical potential. Dataset 26 places the molecule at a symmetric value of z. The total energy should be the same as with dataset 11,  16,  or 21." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t30.in" target="_blank">t30.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom. Here,  a double loop has been used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_2.in" target="_blank">tbase2_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom. Here,  a double loop has been used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_3.in" target="_blank">tbase2_3.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to optimize the H2 bond length,  compute the associated total energy,  then to compute the total energy of the isolated H atom. Here,  the ecut and acell are fixed : the double loop reduces effectively to a single loop." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase2_4.in" target="_blank">tbase2_4.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Crystalline alpha-quartz Calculation of the GW corrections with non-symmorphic operations,  PAW case. but with a set of translated atoms. PAW case. Ordered set of atoms; non-ordered set of atoms; translated atoms. Similar to v5#64,  for PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t06.in" target="_blank">t06.in</a> &hellip;</li></ul></details><p>Used to define the set of indices in the multi-data set mode, when a double
loop is needed (see later).<br />
The values of <a class="wikilink codevar-wikilink" href="../basic#udtset">udtset</a>(1) must be between 1 and 999, the values of
<a class="wikilink codevar-wikilink" href="../basic#udtset">udtset</a>(2) must be between 1 and 9, and their product must be equal to
<a class="wikilink codevar-wikilink" href="../basic#ndtset">ndtset</a>.<br />
The values of <a class="wikilink codevar-wikilink" href="../basic#jdtset">jdtset</a> are obtained by looping on the two indices defined by
<a class="wikilink codevar-wikilink" href="../basic#udtset">udtset</a>(1) and <a class="wikilink codevar-wikilink" href="../basic#udtset">udtset</a>(2) as follows :</p>
<div class="codehilite"><pre><span></span>  do i1=1,intarr(1)
   do i2=1,intarr(2)
    idtset=idtset+1
    dtsets(idtset)%jdtset=i1*10+i2
   end do
  end do
</pre></div>


<p>So, <a class="wikilink codevar-wikilink" href="../basic#udtset">udtset</a>(2) sets the largest value for the unity digit, that varies
between 1 and <a class="wikilink codevar-wikilink" href="../basic#udtset">udtset</a>(2).<br />
If <a class="wikilink codevar-wikilink" href="../basic#udtset">udtset</a> is used, the input variable <a class="wikilink codevar-wikilink" href="../basic#jdtset">jdtset</a> cannot be used.</p>
<h2 id="usewvl"><strong>usewvl</strong><a class="headerlink" href="#usewvl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Use WaVeLet basis set<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform calculations on a wavelet basis" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Comment:</em> use plane-wave basis set  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [23/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. Forces are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li></ul></details><p>Used to define if the calculation is done on a wavelet basis set or not.<br />
The values of <a class="wikilink codevar-wikilink" href="../basic#usewvl">usewvl</a> must be 0 or 1. Putting <a class="wikilink codevar-wikilink" href="../basic#usewvl">usewvl</a> to 1, makes
<a class="wikilink codevar-wikilink" href="../gstate#icoulomb">icoulomb</a> mandatory to 1. The number of band (<a class="wikilink codevar-wikilink" href="../basic#nband">nband</a>) must be set
manually to the strict number need for an isolator system ( _ i.e. _ number of
electron over two). The cut-off is not relevant in the wavelet case, use
<a class="wikilink codevar-wikilink" href="../basic#wvl_hgrid">wvl_hgrid</a> instead.<br />
In wavelet case, the system must be isolated systems (molecules or clusters).
All geometry optimization are available (see <a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>, especially the
geometry optimisation and the molecular dynamics).<br />
The spin computation is not currently possible with wavelets and metalic
systems may be slow to converge.</p>
<h2 id="wtk"><strong>wtk</strong><a class="headerlink" href="#wtk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WeighTs for K points<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the electronic wavevectors (k-points)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/k-points">topic_k-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>)<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a><em>1.0<br />
*Comment:</em> Except when <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>/=0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [237/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Oxygen atom Test a few functionals for which HGH pseudopotentials are available (from M. Krack), that are present also in the lib XC,  but not in the native ABINIT set of functionals." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Carbon atom Test the Becke-Johnson mGGA functional,  generating directly XC potentials. Convergence parameters are quite high,  and the test is reasonably portable." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t08.in" target="_blank">t08.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca in orthorhombic structure. 1 k point,  low ecut. Perform a test of GS total energy computation,  using an experimental PAW pseudopotential (pspcod=7)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO. Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  static,  spin-polarized. Same system as test 49 of v2,  except that nctime is non-zero. Test ionmov=6 (Verlet) as well as ionmov=7." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t21.in" target="_blank">t21.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Test to prepare a conductivity calculation (test v5#t10) Ground state calculation for 4 Al atoms The number of bands is unrealistic. This test produces files that are inputs for test 10. It tests the following parts of the code: optic_paw,  optic_paw_core Note that,  in addition to the psp file,  the core wave functions file is needed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and Wu-Cohen GGA. Similar to test v3#08 Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.49410411 Ha while finite differences gives : with delta(xred)=0.0002,  189.4945677  Ha with delta(xred)=0.0001,  189.49422003  Ha . Combining the results gives 189.4941041 Ha. Perfect !" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t29.in" target="_blank">t29.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with and without PAW XML data (FJollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t60.in" target="_blank">t60.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with PAW XML data designed for PWPAW (F Jollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t61.in" target="_blank">t61.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk aluminum,  with PAW XML data designed for GPAW (F Jollet)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t62.in" target="_blank">t62.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a> &hellip;</li></ul></details><p>Gives the k point weights.<br />
The k point weights will have their sum (re)normalized to 1 (unless
<a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>=2 and <a class="wikilink codevar-wikilink" href="../basic#kptopt">kptopt</a>=0; see description of <a class="wikilink codevar-wikilink" href="../basic#occopt">occopt</a>) within the
program and therefore may be input with any arbitrary normalization. This
feature helps avoid the need for many digits in representing fractional
weights such as &#8531;.<br />
<a class="wikilink codevar-wikilink" href="../basic#wtk">wtk</a> is ignored if <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a> is not positive, except if <a class="wikilink codevar-wikilink" href="../basic#iscf">iscf</a>=-3.</p>
<h2 id="wvl_hgrid"><strong>wvl_hgrid</strong><a class="headerlink" href="#wvl_hgrid" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WaVeLet H step GRID<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform calculations on a wavelet basis" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Wavelets">topic_Wavelets</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.5  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [23/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. Forces are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li></ul></details><p>It gives the step size in real space for the grid resolution in the wavelet
basis set. This value is highly responsible for the memory occupation in the
wavelet computation. The value is a length in atomic units.</p>
<h2 id="xangst"><strong>xangst</strong><a class="headerlink" href="#xangst" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> vectors (X) of atom positions in cartesian coordinates -length in ANGSTrom-<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">INPUT_ONLY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify a crystal, with atomic positions and symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,min(<a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>,<a class="wikilink codevar-wikilink" href="../geo#natrd">natrd</a>))<br />
<em>Default value:</em> None  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [27/920] in all abinit tests, [1/116] in abinit tutorials</summary><ul><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="Water molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="H2O in isolated boundary conditions (plane waves,  NC),  try tu use Damiens Poisson cutoff. Water molecule with HGH pseudo-potentials. This checks that a negative value in rhor will not make the Poisson solver crashes on XC computation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t22.in" target="_blank">t22.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="move with natfix. Output also GEO files" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t29.in" target="_blank">t29.in</a>, <a class="wikilink abifile-wikilink" data-content="This test is due to Z. Levine. It is a run on Si with the bond center at the origin. Also write density and potential with prtden=9 and prtpot=2 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t30.in" target="_blank">t30.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="O2 molecule,  treated like a metal (there is a degeneracy at the Fermi level), occopt=4 and tsmear=0.04,  with nsppol=2 . Use spinat to polarize the molecule at start. Gives total energy of -32.09317 Hartree This test can be used to check the accuracy of stresses in the spin-polarized case. Setting acell(1:2) to 7.005 and 6.995 gives ETOT -32.090846193972 and -32.095501753750, ucvol  441.63023 and 440.37023 so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03, to be compared with sigma(1)=3.6949713786E-03 and sigma(2)=3.6949681083E-03 from the present test (the degeneracy is slightly lifted because of incomplete convergence, using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both sigma values)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t08.in" target="_blank">t08.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 molecule,  treated as a spin-polarized molecule,  with fixed occupation numbers (occopt=2),  with nsppol=2 . Gives total energy of -32.09792 Hartree" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Test multi-dataset mode. H2 molecule in a box (psp 1h.pspnc). acell constant,  small (7 5 5). 10 different values of ecut (convergence study). Use getxred=-1." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t60.in" target="_blank">t60.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="O2 molecule,  treated like a metal (there is a degeneracy at the Fermi level),  occopt=4 and tsmear=0.04,  with nsppol=2 . Use spinat to polarize the molecule at start. Same as test v1 #8,  except use different energy and length units. Test the use of dimensional and logical input variables." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t53.in" target="_blank">t53.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="Hydronium ion + NH3 molecule Ground state calculation keeping O and H atoms fixed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tstring_01.in" target="_blank">tstring_01.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="NaCl molecule in a big box. Test of the computation of the polarisation with the routine berryphase_new, for different k-point grids : only 1 k-point,  a line of k-points,  and a full mesh of k-points. Results with acell 20 10 10 are : -9.727 C/m^2,  -9.975 C/m^2,  -9.503 C/m^2 multiplied by the volume (in a.u.),  gives -19454,  -19950,  -19006 Test provided by S. Leroux Going to bigger cells make these results converge to the same value : Results with acell 30 20 20 are : -1.771 C/m^2,  -1.746 C/m^2,  -1.747 C/m^2 multiplied by the volume (in a.u.),  gives -21252,  -20952,  -20964 Results with acell 40 20 20 are : -1.3167C/m^2,  -1.3057C/m^2,  -1.3062C/m^2 multiplied by the volume (in a.u.),  gives -21067,  -20891,  -20899 Results with acell 50 20 20 are : -1.0502C/m^2,  -1.0444C/m^2,  -1.0450C/m^2 multiplied by the volume (in a.u.),  gives -21004,  -20888,  -20900" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl Molecule in a big box 3DTE calculation with only one k-point" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t65.in" target="_blank">t65.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation in (N, V, T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested together with the three coordinate systems (primitive,  normal mode,  staging). NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with --- Pseudopotential description --" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t08.in" target="_blank">t08.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="NH3 and NH2-CH3 molecules,  supercell geometry Show the computations needed to obtain the differential pseudopotentials 7n.pspnc (just usual atomic configuration) and 7n.1s_psp.mod (with a hole in state 1s). The differential core-level shift is obtained by comparing difference in the total energies of the NH3 molecule with both pseudopotentials with the one of the NH2CH3 molecule : 0.41522 Ha for the NH3 molecule 0.41768 Ha for the NH2-CH3 molecule,  making for a shift of 2.46 mHa=0.0669 eV due to the replacement of one H atom of the NH3 molecule by a CH3 group. Note that these are completely non converged values. Parameters like ecut and acell should be the subject of a convergence study. For applications of this technique,  see Rignanese GM et al,  Phys. Rev. Lett. 79,  5174 (1997), or Travaly Y et al,  Phys. Rev. B 61,  7716 (2000)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t42.in" target="_blank">t42.in</a> &hellip;</li></ul></details><p>Gives the cartesian coordinates of atoms within unit cell, in angstrom. This
information is redundant with that supplied by array <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a> or <a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a>.<br />
If <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a> and <a class="wikilink codevar-wikilink" href="../basic#xangst">xangst</a> are ABSENT from the input file and <a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> is
provided, then the values of <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a> will be computed from the provided
<a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> (i.e. the user may use xangst instead of <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a> or <a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> to
provide starting coordinates).<br />
One and only one of <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a>, <a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> and <a class="wikilink codevar-wikilink" href="../basic#xangst">xangst</a> must be provided.<br />
The conversion factor between Bohr and Angstrom is 1 Bohr=0.5291772108
Angstrom, see the <a href="http://physics.nist.gov/cuu/Constants/index.html"> NIST site
</a> .<br />
Atomic positions evolve if <a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>/=0 . In constrast with <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a> and
<a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a>, <a class="wikilink codevar-wikilink" href="../basic#xangst">xangst</a> is not internal.</p>
<h2 id="xcart"><strong>xcart</strong><a class="headerlink" href="#xcart" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> vectors (X) of atom positions in CARTesian coordinates<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">EVOLVING</a>, <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify a crystal, with atomic positions and symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,min(<a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>,<a class="wikilink codevar-wikilink" href="../geo#natrd">natrd</a>))<br />
<em>Default value:</em> None  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [151/920] in all abinit tests, [19/116] in abinit tutorials</summary><ul><li>v4:  <a class="wikilink abifile-wikilink" data-content="MgO molecule,  with low cut-off,  in a big box,  and one k point. Pseudopotentials WITHOUT a non-linear core correction. Prepare the Bader density analysis" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t32.in" target="_blank">t32.in</a>, <a class="wikilink abifile-wikilink" data-content="5-atom Al slab,  with three vacuum layers. First,  converge the wavefunctions,  then compute the STM charge density below and above the Fermi energy,  within a 2eV range." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t46.in" target="_blank">t46.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of Mg2 molecule chains,  in a slab supercell geometry. Symmetries are broken. k point (1/4 1/4 1/4) Use of default values of fftalg and exchn2n3 Reference for test #92." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t91.in" target="_blank">t91.in</a> &hellip;</li><li>seq:  <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using old,  rather inaccurate psps. Computation of the Berry phase. Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_04.in" target="_blank">tsv3_04.in</a>, <a class="wikilink abifile-wikilink" data-content="NaF Sodium Fluoride FCC (rocksalt structure) with 2 atoms per cell. Test computation of the Berry phase in PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv5_112.in" target="_blank">tsv5_112.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated hydrogen atom Calculation of the HF levels with different ways to integrate the Coulomb divergence" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Molecular SiH4 in GWLS (G0W0 with Lanczos basis and Sternheimer equations)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t15.in" target="_blank">t15.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. Forces are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="O2 Oxygen spin-temperature-dependent of the band energies" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t83.in" target="_blank">t83.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  static,  spin-polarized.  Write t17o_DEN (prtden=1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t17.in" target="_blank">t17.in</a>, <a class="wikilink abifile-wikilink" data-content="Re-run 17 but in slightly larger box,  same ecut,  larger ng. (Box is still too small for proper model of Si2.)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t19.in" target="_blank">t19.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Finite difference calculation of the Born effective charges of AlAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tffield_1.in" target="_blank">tffield_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Finite difference calculation of d chi / d tau of AlAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_6.in" target="_blank">tnlo_6.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Isolated carbon atom,  with 6c.pspnc pseudopotential Test a non-spherical,  spin-polarized atom,  with nsym=2. In order to have a fast computation,  the cut-off,  19Ha, is not large enough for good convergence,  as well as the box size 9x9x9. With better convergence parameters,  it can be used to find the atomization energy of carbon-containing molecules." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t33.in" target="_blank">t33.in</a>, <a class="wikilink abifile-wikilink" data-content="3H2 molecule with distant atoms : probe the use of the spinat variable Use spin-polarized mode,  spinor mode,  as well as antiferromagnetic mode. Even consider an initialization with reather crazy,  nearly ferromagnetic spinat. Use 01h.pspgth,  in a 8 8 16 box,  with 15 Ha cut-off. Separation is 4 bohr. Consider anti-parallel spin configuration,   which is the favoured one for this distance. Get total energy of -0.981 839  Ha . Note that the spin-polarization is not complete. Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t39.in" target="_blank">t39.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the geometry builder : - H2O molecule repeated four times,  with rotations and translations - Si (100) unreconstructed surface : 2*2*2 objects of eight atoms - 16 H atoms at the bottom This test is not realistic (it would take too much time)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t42.in" target="_blank">t42.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="O2 (non-spin-polarized,  non-linear XC core correction,  GGA) Computation of forces in the GGA,  and comparison with a finite difference of energy. The direct computation of force (dataset 2) gives 0.627251486 Ha/Bohr A simple finite-difference estimation (dataset 1 and 3) gives 0.627251265 Ha/Bohr. The agreement can be improved if a better finite-difference estimation is used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t40.in" target="_blank">t40.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 (non-spin-polarized,  non-linear XC core correction,  GGA) Computation of uniaxial stresses in the GGA, and comparison with a finite difference of energy. The direct computation of sigma(zz) stress (dataset 2) gives 0.964267876d-3 Ha/Bohr**3 A simple finite-difference estimation (dataset 1 and 3) gives a difference in total energy of 0.085048409d-3 Ha, for a difference of volume of 0.0882 Bohr**3 leading to a stress estimation of 0.96426768d-3 Ha/Bohr**3 The agreement can be improved if a better finite-difference estimation is used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t41.in" target="_blank">t41.in</a>, <a class="wikilink abifile-wikilink" data-content="(HeH)+ in a big box. Computation of excitation energies in TDDFT, in the following approximations : TDxOEP/xOEP,  TDLDA/xOEP, BPG hybrid/xOEP." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t42.in" target="_blank">t42.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Si2 diatomic molecule. Spin-polarized (ferromagnetic). Test phonon RF for spin-polarized case. ixc=1 (Teter LSDA) From dataset 2 and 3,  one gets the derivatives with respect to the atomic displacement along x. The simple finite-difference formula gives the 2DTE 10.88934274 Ha,  while the direct computation, in dataset 4 gives 10.88933963 Ha . Cannot be executed in parallel chkinp: Checking input parameters for consistency,  jdtset= 3. --- !ERROR message: | the number of bands in the spin up case must be equal to the number of bands in the spin down case. This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3 Action : change nband,  or use the sequential version of ABINIT. src_file: chkinp.F90 src_line: 1181 ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t10.in" target="_blank">t10.in</a>, <a class="wikilink abifile-wikilink" data-content="Si2 diatomic molecule. Spin-polarized (ferromagnetic). Test phonon RF for spin-polarized case. ixc=7 (Perdew-Wang 92 LSDA) From dataset 2 and 3,  one gets the derivatives with respect to the atomic displacement along x. The simple finite-difference formula gives the 2DTE 10.88283478 Ha,  while the direct computation, in dataset 4 gives 10.882832 Ha . Cannot be executed in parallel --- !ERROR message: | the number of bands in the spin up case must be equal to the number of bands in the spin down case. This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3 Action : change nband,  or use the sequential version of ABINIT. src_file: chkinp.F90 src_line: 1181 ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t11.in" target="_blank">t11.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule. Spin-polarized (anti-ferromagnetic). Test phonon RF for spin-polarized case. ixc=1 (Teter LSDA) From datasets 3 and 4,  one gets the derivatives with respect to the atomic displacement along x. The simple finite-difference formula gives the 2DTE 6.283100652 Ha,  while the direct computation, without using Shubnikov symmetries,  gives 6.282967527 Ha." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t12.in" target="_blank">t12.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Si2 molecule,  static,  spin-polarized. Same system as test 49 of v2,  except that nctime is non-zero. Test ionmov=6 (Verlet) as well as ionmov=7." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t21.in" target="_blank">t21.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Hydrogen dimer in a big cell. Produce different files (_DEN,  _POT,  _VHXC,  _VHA),  for subsequent analysis by CUT3D (see next run). Note the following values,  that will allow to check the correctness of the subsequent analysis : Kinetic energy  =  1.02998395409183E+00 Hartree energy  =  8.05073794254872E-01 Loc. psp. energy= -2.53949740885919E+00 Band energy (Ha)=  -7.2732761066E-01 Also,  the mean of the Vxc potential is announced to be Average Vxc (hartree)=  -0.05293" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t04.in" target="_blank">t04.in</a>, <a class="wikilink abifile-wikilink" data-content="HI 8 molecule per cell,  the cell is triclinic. Prepare the density for the next Bader analysis." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t18.in" target="_blank">t18.in</a>, <a class="wikilink abifile-wikilink" data-content="Bismuth,  rhombohedral,  two atoms per unit cell Scalar relativistic. Relax four different images,  using the steepest descent algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t21.in" target="_blank">t21.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="LiH molecule test the use of spatial chemical potential. The molecule starts aligned along the x direction, while the Li chemical potential pulls the Li nucleus. The z coordinate of the molecule is changed from 0 to 5 Bohr. There is a linear part to the chemical potential. The energy and force should be the same in datasets 11 to 15 (without chemical potentiel). One sees that this is not completely the case. The force along z vanishes in these cases,  because the translational invariance is imposed by ABINIT. In datasets 21 to 23,  the energy should increase linearly,  and the force along z should be non-zero and constant. Small fluctuations are observed. Dataset 24 and 25 corresponds to the cubic part of the chemical potential. Dataset 26 places the molecule at a symmetric value of z. The total energy should be the same as with dataset 11,  16,  or 21." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t30.in" target="_blank">t30.in</a>, <a class="wikilink abifile-wikilink" data-content="LiH molecule test the use of spatial chemical potential. The molecule starts aligned along the x direction, while the Li chemical potential pulls the Li nucleus toward -z,  and the H chemical potential pushes the H nucleus toward +z. See whether the optimization runs properly." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t31.in" target="_blank">t31.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Ni molecule in a big box. Test the use of the atvshift variable First dataset : no shift,  the ten states number 9 to 18 come from the 3d atomic states,  the state number 19 is a bonding 4s state. States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1). State number 18 is a 3d sigma antibonding state (m=0). Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the levels change by less than 0.0002 (and their energy decrease),  except state number 9 (a 3d sigma bonding state (m=0)),  that goes from -0.24020 to -0.23982 (+0.0004) and state number 18,  that goes from -0.15439 to 0.15399 (+0.0004). Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials. All the levels are affected (likely the m=1 and -1 orbitals adjust,  and cause modification of the potential),  but the states 10,  11,  16,  and 17 increase their energy,  while the other state see their energy decrease. Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking of the degeneracy. This test was not easy to make portable. The problem lies in the fact that when the density becomes negative,  due to Bragg oscillations,  the xc kernel can be extremely large,  and when use for the prediction of the residual of the forces,  the differences between machines can be extremely large. IN order to see this effect,  put ecut 7 and npulayit 7 (its default value)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t15.in" target="_blank">t15.in</a> &hellip;</li></ul></details><p>Gives the cartesian coordinates of atoms within unit cell. This information is
redundant with that supplied by array <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a> or <a class="wikilink codevar-wikilink" href="../basic#xangst">xangst</a>. By default,
<a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> is given in Bohr atomic units (1 Bohr=0.5291772108 Angstroms),
although Angstrom can be specified, if preferred, since <a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> has the
&lsquo;<a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">LENGTH</a>&lsquo; characteristics.<br />
If <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a> and <a class="wikilink codevar-wikilink" href="../basic#xangst">xangst</a> are ABSENT from the input file and <a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> is
provided, then the values of <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a> will be computed from the provided
<a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> (i.e. the user may use <a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> instead of <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a> or <a class="wikilink codevar-wikilink" href="../basic#xangst">xangst</a>
to provide starting coordinates).<br />
One and only one of <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a>, <a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> and ** xangst ** must be provided.<br />
Atomic positions evolve if <a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>/=0 .</p>
<h2 id="xred"><strong>xred</strong><a class="headerlink" href="#xred" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> vectors (X) of atom positions in REDuced coordinates<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">EVOLVING</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify a crystal, with atomic positions and symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,min(<a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>,<a class="wikilink codevar-wikilink" href="../geo#natrd">natrd</a>))<br />
<em>Commentdims:</em> represented internally as xred(3,<a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>,<a class="wikilink codevar-wikilink" href="../rlx#nimage">nimage</a>)<br />
<em>Default value:</em> *0.0  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [761/920] in all abinit tests, [96/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  2 special points;  low ecut. With a 4x4x4 k point grid (!only one shift,  but OK because symmetry is imposed),  compute the dielectric constant by two different techniques" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_05.in" target="_blank">tsv3_05.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_bigdft.in" target="_blank">testin_bigdft.in</a>, <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_etsf_io.in" target="_blank">testin_etsf_io.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Test Wannier90 interface with NC pseudos" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_4.in" target="_blank">tw90_4.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a>, <a class="wikilink abifile-wikilink" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_02.in" target="_blank">tgspw_02.in</a>, <a class="wikilink abifile-wikilink" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_03.in" target="_blank">tgspw_03.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="Crystalline silicon: computation of the total energy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_1.in" target="_blank">tbase3_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : computation of the total energy This input file will NOT work : nkpt does not agree with ngkpt and shiftk. The error message will be given in the &amp;quot;log&amp;quot; file." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_2.in" target="_blank">tbase3_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : computation of the total energy Convergence with respect to the number of k points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase3_3.in" target="_blank">tbase3_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Graphene. Test wavelet run on surface" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Si single atom with fractional occupation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t11.in" target="_blank">t11.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2 special k point Si in 2-atom diamond unit cell.  Uses symmetry. mkmem=mkpt,  mffmem=1 (&amp;quot;in core&amp;quot; solution), This calculation is also iterated to convergence.  ecut too small. Uses original Teter extended norm conserving psp 14si.psp." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Same as 03 but run with newer Troullier-Martins psp with core density 14si.pspnc.  Start from wf.03 and run irdwfk=1. Also iterated to convergence." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="KSS file generation for silicon with a different number of bands in the KSS computation compared to ground-state." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW response function calculation of derivative of wavefunction (DDK) Si with PAW dataset generated from uspp code. Computes derivative with DFPT formalism,  and also computes energies with displaced k+q so that energies can be checked by finite differences." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t05.in" target="_blank">t05.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Carbon in diamond structure. Chained GW calculation: The first run produces the WFK,  the SCR,  the SUSC and the QPS file. These file are subsequently read and used in t537 using irdwfk,  irdscr,  irdsuscep and irdqps In the second dataset of t85,  the screened interaction W is approximated using the test-electron expression with the TDDFT ALDA kernel (gwgamma==1)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t04.in" target="_blank">t04.in</a> &hellip;</li></ul></details><p>Gives the atomic locations within unit cell in coordinates relative to real
space primitive translations (NOT in cartesian coordinates). Thus these are
fractional numbers typically between 0 and 1 and are dimensionless. The
cartesian coordinates of atoms (in Bohr) are given by:<br />
R_cartesian = xred1*rprimd1+xred2*rprimd2+xred3*rprimd3<br />
where (xred1,xred2,xred3) are the &ldquo;reduced coordinates&rdquo; given in columns of
&ldquo;<a class="wikilink codevar-wikilink" href="../basic#xred">xred</a>&rdquo;, (rprimd1,rprimd2,rprimd3) are the columns of primitive vectors
array &ldquo;<a class="wikilink codevar-wikilink" href="../basic#rprimd">%rprimd</a>&rdquo; in Bohr.<br />
If you prefer to work only with cartesian coordinates, you may work entirely
with &ldquo;<a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a>&rdquo; or &ldquo;<a class="wikilink codevar-wikilink" href="../basic#xangst">xangst</a>&rdquo; and ignore <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a>, in which case <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a>
must be absent from the input file.<br />
One and only one of <a class="wikilink codevar-wikilink" href="../basic#xred">xred</a>, <a class="wikilink codevar-wikilink" href="../basic#xcart">xcart</a> and <a class="wikilink codevar-wikilink" href="../basic#xangst">xangst</a> must be provided.<br />
Atomic positions evolve if <a class="wikilink codevar-wikilink" href="../rlx#ionmov">ionmov</a>/=0 .</p>
<h2 id="znucl"><strong>znucl</strong><a class="headerlink" href="#znucl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> charge -Z- of the NUCLeus<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to specify the types of atoms that form the system" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/AtomTypes">topic_AtomTypes</a>, <a class="wikilink topic-wikilink" data-content="How to master the use of norm-conserving pseudopotentials and PAW atomic data, and
their consequences" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/PseudosPAW">topic_PseudosPAW</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="../gstate#npsp">npsp</a>)<br />
<em>Default value:</em> None  </p>
<details class="note"><summary>Test list (click to open). Very frequently used, [920/920] in all abinit tests, [116/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test prtposcar input variable. For simple SiO2 with 1 displaced atom,   output POSCAR and FORCES files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the possibility to include a file into an input file Diamond silicon with few k-points and low cut-off The set of k-points is included in input file from another file" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>built-in:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_fast.in" target="_blank">testin_fast.in</a>, <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v1.in" target="_blank">testin_v1.in</a>, <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/built-in/Input/testin_v5.in" target="_blank">testin_v5.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut. Test localrdwf=1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>tutoplugs:  <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (NC pseudos)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_1.in" target="_blank">tw90_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Test interface with Wannier90 (PAW calculation)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_2.in" target="_blank">tw90_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoplugs/Input/tw90_3.in" target="_blank">tw90_3.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_03.in" target="_blank">tdfpt_03.in</a>, <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Gold with one vacancy (107 atoms of gold)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tgspw_01.in" target="_blank">tgspw_01.in</a> &hellip;</li><li>tutorial:  <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_1.in" target="_blank">tbase1_1.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file to compute the total energy and forces as a function of the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_2.in" target="_blank">tbase1_2.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a big box This file will optimize automatically the interatomic distance" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorial/Input/tbase1_3.in" target="_blank">tbase1_3.in</a> &hellip;</li><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Bi atom with PAW,  GGA PBE from LibXC Very quick built-in test,  to check that LibXC is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Helium atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the non-spin-polarized case : 5 LDAs (Teter93,  Perdew-Zunger,  Wigner,  Hedin-Ludqvist,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated Bismuth atom Compare the results using the native XC library and the corresponding ones of LibXC,  in the spin-polarized case : 2 LDAs (Teter93,  PW92) 7 GGAs (PBE,  RPBE,  HCTH93,  HCTH120,  HCTH147,  HCTH407,  WuCohen) Results are excellent (better than 10 microHa),  except for Wu Cohen (must be a bug somewhere)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>psml:  <a class="wikilink abifile-wikilink" data-content="Bulk silicon,  in the diamond structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk iron,  with and without spin-polarization" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/psml/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>bigdft:  <a class="wikilink abifile-wikilink" data-content="H atom within BigDFT. Very quick built-in test,  to check that BigDFT is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with steepest decent for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule with default parameters. No forces are computed,  with DIIS for the direct minimisation of the wavefunctions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>fast:  <a class="wikilink abifile-wikilink" data-content="H2 molecule,  determination of the H-H distance by the Broyden algorithm. Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Single H atom in box.  Uses local psp,  which makes initialization time much shorter.  This calculation is iterated to convergence. This test case is a good choice for running alone just to get something working fast." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule,  static,  to check accurate forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/fast/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  60 special points in core;  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>etsf_io:  <a class="wikilink abifile-wikilink" data-content="Ca atom with PAW,  writing a ETSF_IO wavefunction file. Very quick built-in test,  to check that ETSF_IO is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk water ice 1h,  made-up with 8 water molecules. Density is exported using the ETSF I/O file format. Should be a nice system to look at with visualisation tools." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Simple Li-F structure with KSS output. This is a two data set run, the first dataset being a ground state calculation and the second put nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file is generated by ETSF-IO. The density of the first dataset also use ETSF-IO and dataset two is a good test for density restart." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/etsf_io/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>atompaw:  <a class="wikilink abifile-wikilink" data-content="Bulk diamond,  using the atomic data file generated in test 01" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Nickel,  using the atomic data file generated in test 03" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/atompaw/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="hcp iron - non magnetic - 2 atoms (metal) Test the use of GPU within Norm-Conserving PseupoPotential formalism. Test multidataset mode with different use_gpu_cuda values. paral_kgb is activated." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="NiO - LDA+U - fcc structure Test the use of GPU within Projector Augmented-Wave formalism. Test ferromagnetic and non-collinear magnetism. ABINIT v7.0: GPU is not used when nspinor=2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>v1:  <a class="wikilink abifile-wikilink" data-content="Yb cristal,  self-consistent Very quick built-in test,  to check that ABINIT works." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=4 and tsmear=0.05 . Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.5634 (minimization of the bump)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bulk Aluminium,  FCC,  with 2 special points,  occopt=5 and tsmear=0.05. Designed to test the treatment of metals,  using the &amp;quot;cold smearing&amp;quot; of N. Marzari,  with a=-.8165 (monotonic function in the tail)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="BCC Tantalum (1 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions: 2 slightly different cell sizes. Use only one k point. Test whether the stress is correctly given,  even with spin-orbit coupling. Difference of total energies : 0.0000588977 Ha Difference of unit cell volume : 0.05861 Bohr^3 Stress from finite difference : 1.0049 Ha/Bohr^3 Average stress : 1.0062 Ha/Bohr^3" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="1. Si diamond. Usual geometry,  k points,  psps. One of the two atoms is displaced in order to have non-zeroforces. Test whether energy and forces (and soon stresses) are correctly given,  even with use of spherical harmonics. Perform first computation with the use of Legendre polynomials; Then perform a computation with the use of spherical harmonics. Both must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure. 2 k points,  low ecut. Perform a test of &amp;quot;Phoney pseudopotential with Hamann grid&amp;quot;, using spherical harmonics in the computation of the nonlocal operator. Perform two datasets: First dataset with the use of Legendre Polynomials, Second dataset with the use of spherical harmonics (useylm=1). Both datasets must give the same results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="HBe molecule,  spin-polarized,  determination of forces Very quick built-in test,  to check that ABINIT is working." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="This is a test,  in the norm conserving case,  of the Molecular Dynamics flag ionmov==13. With the values of optcell=0,  1,  2 (isothermal (0),  isothermal/isenthalpic with homogeneous cell deformations (1) or full cell deformations (2).) This is the reversible integrator of Martyna,  Tuckerman,  Tobias and Klein. (Mol. Phys.,  1996,  p 1117). XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent,  while the bmass varies by a factor of 2 ?" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of geometry optimization using using ionmov=1, 4, 5 and 7 Hydrogen molecule inside a box of 12 Bohr This test was created to test ionmov=5" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (1 Si2 molecule in the cell) Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96). The default fftcache=16 seems OK : With fftcache=1,  the tcpu/ncalls/ndata is 0.028 on testf (the reference machine,  20090912) With fftcache=16 (the default),  the tcpu/ncalls/ndata is 0.021 With fftcache=128,  the tcpu/ncalls/ndata is 0.021" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  potential/density mixing and parallelism" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0) Test: DIIS,  density mixing" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/bigdft_paral/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Geometry optimization with LBFGS" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Test generation of k-point mesh with kptrlatt and shiftk. version 8.0.8b was stopping at the level of the parser." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t03.in" target="_blank">t03.in</a> &hellip;</li><li>wannier90:  <a class="wikilink abifile-wikilink" data-content="GaAs crystal with few bands. Very quick built-in test,  to check that Wannier90 is installed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t00.in" target="_blank">t00.in</a>, <a class="wikilink abifile-wikilink" data-content="Gallium Arsenide,  zinc-blende. 8 bands. prtwant=2 Should still be completed by the call to wannier90,  and subsequent fldiff use..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="The same as in 01 but using PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/wannier90/Input/t02.in" target="_blank">t02.in</a> &hellip;</li><li>vdwxc:  <a class="wikilink abifile-wikilink" data-content="Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/vdwxc/Input/t10.in" target="_blank">t10.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="SiC in zinc-blende structure Calculation of the GW corrections with 4 different plasmon-pole models. The following variables are tested: inclvkb=2,  nomegasrd and omegasrd." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant) and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also obtained via Pade extrapolation. The following variables are tested spmeth=2,  spbroad, nomegasi,  and omegasimax" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to speed up the convergence wrt the size of the super cell. The following variables are tested icutcoul=1,  rcut,  vcutgeo,  gw_nqlwl and gw_qlwl." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t03.in" target="_blank">t03.in</a> &hellip;</li></ul></details><p>Gives nuclear charge for each type of pseudopotential, in order.<br />
If <a class="wikilink codevar-wikilink" href="../basic#znucl">znucl</a> does not agree with nuclear charge, as given in pseudopotential
files, the program writes an error message and stops.</p>
<p>N.B. : In the pseudopotential files, <a class="wikilink codevar-wikilink" href="../basic#znucl">znucl</a> is called &ldquo;zatom&rdquo;.</p>
<p>For a &ldquo;dummy&rdquo; atom, with <a class="wikilink codevar-wikilink" href="../basic#znucl">znucl</a>=0 , as used in the case of calculations
with only a jellium surface, ABINIT sets arbitrarily the covalent radius to
one.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/wavefunctions/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../../tutorials/welcome/" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../user-guide/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user-guide/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Variables" class="md-tabs__link md-tabs__link--active">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorials/welcome/" title="Lessons" class="md-tabs__link">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/wavefunctions/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../" title="All Variables" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                All Variables
              </span>
            </div>
          </a>
        
        
          <a href="../bse/" title="Bethe-Salpeter" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Bethe-Salpeter
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.5.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 The Abinit Group
          </div>
        

        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application-f3ab9e5ff8.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
    
  </body>
</html>