
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="'dfpt input variables'">
      
      
        <link rel="canonical" href="http://www.abinit.org/variables/dfpt/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="shortcut icon" href="../../images/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.10.1">
    
    
      
        <title>DFPT - abinit</title>
      
    
    
    
      <script src="../../assets/javascripts/modernizr-e826f8942a.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap 
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>

    <!--
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/pepper-grinder/jquery-ui.css">
    -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Bootstrap theme -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/themes/bootstrap.min.css"/>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}",
                  kq: "{\\kk + \\qq}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Introjs for Guided Tour -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.7.0/introjs.min.css" />

    <!-- Load fonts used for input variables -->
    <!--
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      <link rel="stylesheet" href="../../assets/stylesheets/application-a20f419c8e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-23f75ab9c7.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">

      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="http://www.abinit.org" title="abinit" class="md-logo md-header-nav__button">
            <img src="../../images/logo-abinit-2015.svg" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Variables
                </span>
              
                <span class="md-header-nav__parent">
                  Abinit
                </span>
              
            
            DFPT
          
        </span>
      </div>
        
      <!-- Guide Tour with introjs -->
      <div class="md-flex__cell md-flex__cell--shrink">
          <a href="#" class="btn btn-xs btn-default" title="Guided Tour" onclick="abidocs_guidedtour()">
           <span class="fa fa-info-circle"></span></a>
      </div>

      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      

      <div class="md-flex__cell md-flex__cell--shrink" id="previous_published_versions">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.5.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
            <li><a href="#">8.2.0</a></li>
            
            <li><a href="#">8.1.0</a></li>
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user-guide/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Variables" class="md-tabs__link md-tabs__link--active">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorials/welcome/" title="Lessons" class="md-tabs__link">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/wavefunctions/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <div class="md-nav__button md-logo">
      
        
          <img src="../../images/logo-abinit-2015.svg">
        
      
    </div>
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/help_what_ABINIT_does/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/new_user/" title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ffield/" title="Varff" class="md-nav__link">
      Varff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        DFPT
      </label>
    
    <a href="./" title="DFPT" class="md-nav__link md-nav__link--active">
      DFPT
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bdeigrf" title="bdeigrf" class="md-nav__link">
    bdeigrf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_atpol" title="d3e_pert1_atpol" class="md-nav__link">
    d3e_pert1_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_dir" title="d3e_pert1_dir" class="md-nav__link">
    d3e_pert1_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_elfd" title="d3e_pert1_elfd" class="md-nav__link">
    d3e_pert1_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_phon" title="d3e_pert1_phon" class="md-nav__link">
    d3e_pert1_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_atpol" title="d3e_pert2_atpol" class="md-nav__link">
    d3e_pert2_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_dir" title="d3e_pert2_dir" class="md-nav__link">
    d3e_pert2_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_elfd" title="d3e_pert2_elfd" class="md-nav__link">
    d3e_pert2_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_phon" title="d3e_pert2_phon" class="md-nav__link">
    d3e_pert2_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_atpol" title="d3e_pert3_atpol" class="md-nav__link">
    d3e_pert3_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_dir" title="d3e_pert3_dir" class="md-nav__link">
    d3e_pert3_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_elfd" title="d3e_pert3_elfd" class="md-nav__link">
    d3e_pert3_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_phon" title="d3e_pert3_phon" class="md-nav__link">
    d3e_pert3_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfpt_sciss" title="dfpt_sciss" class="md-nav__link">
    dfpt_sciss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas" title="efmas" class="md-nav__link">
    efmas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_bands" title="efmas_bands" class="md-nav__link">
    efmas_bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_calc_dirs" title="efmas_calc_dirs" class="md-nav__link">
    efmas_calc_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_deg" title="efmas_deg" class="md-nav__link">
    efmas_deg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_deg_tol" title="efmas_deg_tol" class="md-nav__link">
    efmas_deg_tol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_dim" title="efmas_dim" class="md-nav__link">
    efmas_dim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_dirs" title="efmas_dirs" class="md-nav__link">
    efmas_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_n_dirs" title="efmas_n_dirs" class="md-nav__link">
    efmas_n_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_ntheta" title="efmas_ntheta" class="md-nav__link">
    efmas_ntheta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elph2_imagden" title="elph2_imagden" class="md-nav__link">
    elph2_imagden
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eph_task" title="eph_task" class="md-nav__link">
    eph_task
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esmear" title="esmear" class="md-nav__link">
    esmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frzfermi" title="frzfermi" class="md-nav__link">
    frzfermi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ieig2rf" title="ieig2rf" class="md-nav__link">
    ieig2rf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ph_ngqpt" title="ph_ngqpt" class="md-nav__link">
    ph_ngqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ph_qpath" title="ph_qpath" class="md-nav__link">
    ph_qpath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepanl" title="prepanl" class="md-nav__link">
    prepanl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepgkk" title="prepgkk" class="md-nav__link">
    prepgkk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtbbb" title="prtbbb" class="md-nav__link">
    prtbbb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rf2_dkdk" title="rf2_dkdk" class="md-nav__link">
    rf2_dkdk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfasr" title="rfasr" class="md-nav__link">
    rfasr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfatpol" title="rfatpol" class="md-nav__link">
    rfatpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfddk" title="rfddk" class="md-nav__link">
    rfddk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfdir" title="rfdir" class="md-nav__link">
    rfdir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfelfd" title="rfelfd" class="md-nav__link">
    rfelfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfmagn" title="rfmagn" class="md-nav__link">
    rfmagn
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfmeth" title="rfmeth" class="md-nav__link">
    rfmeth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfphon" title="rfphon" class="md-nav__link">
    rfphon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfstrs" title="rfstrs" class="md-nav__link">
    rfstrs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfuser" title="rfuser" class="md-nav__link">
    rfuser
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smdelta" title="smdelta" class="md-nav__link">
    smdelta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#td_maxene" title="td_maxene" class="md-nav__link">
    td_maxene
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#td_mexcit" title="td_mexcit" class="md-nav__link">
    td_mexcit
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connections/" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/welcome/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bdeigrf" title="bdeigrf" class="md-nav__link">
    bdeigrf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_atpol" title="d3e_pert1_atpol" class="md-nav__link">
    d3e_pert1_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_dir" title="d3e_pert1_dir" class="md-nav__link">
    d3e_pert1_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_elfd" title="d3e_pert1_elfd" class="md-nav__link">
    d3e_pert1_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert1_phon" title="d3e_pert1_phon" class="md-nav__link">
    d3e_pert1_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_atpol" title="d3e_pert2_atpol" class="md-nav__link">
    d3e_pert2_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_dir" title="d3e_pert2_dir" class="md-nav__link">
    d3e_pert2_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_elfd" title="d3e_pert2_elfd" class="md-nav__link">
    d3e_pert2_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert2_phon" title="d3e_pert2_phon" class="md-nav__link">
    d3e_pert2_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_atpol" title="d3e_pert3_atpol" class="md-nav__link">
    d3e_pert3_atpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_dir" title="d3e_pert3_dir" class="md-nav__link">
    d3e_pert3_dir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_elfd" title="d3e_pert3_elfd" class="md-nav__link">
    d3e_pert3_elfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d3e_pert3_phon" title="d3e_pert3_phon" class="md-nav__link">
    d3e_pert3_phon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfpt_sciss" title="dfpt_sciss" class="md-nav__link">
    dfpt_sciss
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas" title="efmas" class="md-nav__link">
    efmas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_bands" title="efmas_bands" class="md-nav__link">
    efmas_bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_calc_dirs" title="efmas_calc_dirs" class="md-nav__link">
    efmas_calc_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_deg" title="efmas_deg" class="md-nav__link">
    efmas_deg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_deg_tol" title="efmas_deg_tol" class="md-nav__link">
    efmas_deg_tol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_dim" title="efmas_dim" class="md-nav__link">
    efmas_dim
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_dirs" title="efmas_dirs" class="md-nav__link">
    efmas_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_n_dirs" title="efmas_n_dirs" class="md-nav__link">
    efmas_n_dirs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efmas_ntheta" title="efmas_ntheta" class="md-nav__link">
    efmas_ntheta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elph2_imagden" title="elph2_imagden" class="md-nav__link">
    elph2_imagden
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eph_task" title="eph_task" class="md-nav__link">
    eph_task
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esmear" title="esmear" class="md-nav__link">
    esmear
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frzfermi" title="frzfermi" class="md-nav__link">
    frzfermi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ieig2rf" title="ieig2rf" class="md-nav__link">
    ieig2rf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ph_ngqpt" title="ph_ngqpt" class="md-nav__link">
    ph_ngqpt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ph_qpath" title="ph_qpath" class="md-nav__link">
    ph_qpath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepanl" title="prepanl" class="md-nav__link">
    prepanl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepgkk" title="prepgkk" class="md-nav__link">
    prepgkk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtbbb" title="prtbbb" class="md-nav__link">
    prtbbb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rf2_dkdk" title="rf2_dkdk" class="md-nav__link">
    rf2_dkdk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfasr" title="rfasr" class="md-nav__link">
    rfasr
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfatpol" title="rfatpol" class="md-nav__link">
    rfatpol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfddk" title="rfddk" class="md-nav__link">
    rfddk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfdir" title="rfdir" class="md-nav__link">
    rfdir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfelfd" title="rfelfd" class="md-nav__link">
    rfelfd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfmagn" title="rfmagn" class="md-nav__link">
    rfmagn
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfmeth" title="rfmeth" class="md-nav__link">
    rfmeth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfphon" title="rfphon" class="md-nav__link">
    rfphon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfstrs" title="rfstrs" class="md-nav__link">
    rfstrs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rfuser" title="rfuser" class="md-nav__link">
    rfuser
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smdelta" title="smdelta" class="md-nav__link">
    smdelta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#td_maxene" title="td_maxene" class="md-nav__link">
    td_maxene
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#td_mexcit" title="td_mexcit" class="md-nav__link">
    td_mexcit
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                
                <!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->

<h1 id="dfpt-input-variables">dfpt input variables<a class="headerlink" href="#dfpt-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
dfpt input variables to be used in the input file for the abinit executable.</p>
<h2 id="bdeigrf"><strong>bdeigrf</strong><a class="headerlink" href="#bdeigrf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BanD for second-order EIGenvalues from Response-Function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to calculate the temperature dependence of the electronic structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a> in [1,2,3,4,5]  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [15/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t55.in" target="_blank">t55.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 Oxygen spin-temperature-dependent of the band energies" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t83.in" target="_blank">t83.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . Warning : only valid for Gamma,  AND the temperature-dependent shifts must be averaged over degenerate states." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t37.in" target="_blank">t37.in</a>, <a class="wikilink abifile-wikilink" data-content="He BCC primitive cell. Fake smooth pseudopotential. For testing the electron-phonon modification of the electronic structure. To be compared with the results of tests 51 to 59. Use a 2x2x2 grid of k (shifted) and q (non-shifted) points. No imaginary frequences for the phonons with this choice. Computation of the electronic eigenvalues as well as phonon eigenfrequencies, and corresponding ingredients for the computation of the electron-phonon effect,  in the next tests 51-53." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t50.in" target="_blank">t50.in</a>, <a class="wikilink abifile-wikilink" data-content="He BCC conventional cell. Fake smooth pseudopotential. For testing the electron-phonon modification of the electronic structure. To be compared with the results of tests 50 to 59. Use a FCC grid of k (shifted) and q (non-shifted) points. No imaginary frequences for the phonons with this choice. Computation of the electronic eigenvalues as well as phonon eigenfrequencies, and corresponding ingredients for the computation of the electron-phonon effect,  in the next tests 55-57." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="He BCC 8-atom supercell. Fake smooth pseudopotential. For testing the electron-phonon modification of the electronic structure. To be compared with the results of tests 50 to 59. Use 1/2 1/2 1/2 for electronice wavevector and Gamma point for phonon wavevector Computation of the electronic eigenvalues as well as phonon eigenfrequencies, and corresponding ingredients for the computation of the electron-phonon effect,  in the next test 59 (no need of mrgddb with only one q point." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t58.in" target="_blank">t58.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 Molecule in a small box Second-order eigenvalue calculation using a small number of bands,  testing bdeigrf." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t61.in" target="_blank">t61.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule in a reasonably large box Compute the Fan and Diagonal Debye-Waller corrections to the eigenenergies." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t68.in" target="_blank">t68.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.out" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t60.in" target="_blank">t60.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.out" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t60.in" target="_blank">t60.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.out" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t60.in" target="_blank">t60.in</a></li></ul></details><p>that is, if the user is performing second-order eigenvalue calculations using
response-functions.  </p>
<p>The variable <a class="wikilink codevar-wikilink" href="../dfpt#bdeigrf">bdeigrf</a> is the maximum number of bands for which the second-
order eigenvalues must be calculated: the full number of bands is still used
during the computation of these corrections.  </p>
<p>If <a class="wikilink codevar-wikilink" href="../dfpt#bdeigrf">bdeigrf</a> is set to -1, the code will automatically set <a class="wikilink codevar-wikilink" href="../dfpt#bdeigrf">bdeigrf</a> equal
to nband.</p>
<h2 id="d3e_pert1_atpol"><strong>d3e_pert1_atpol</strong><a class="headerlink" href="#d3e_pert1_atpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 1: limits of ATomic POLarisations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, 1]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/920] in all abinit tests, [6/116] in abinit tutorials</summary><ul><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_2.in" target="_blank">tnlo_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_7.in" target="_blank">tnlo_7.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_8.in" target="_blank">tnlo_8.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_9.in" target="_blank">tnlo_9.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_10.in" target="_blank">tnlo_10.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_11.in" target="_blank">tnlo_11.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t64.in" target="_blank">t64.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl Molecule in a big box 3DTE calculation with only one k-point" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="He dimer,  with bare pseudopotential ixc=0 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  giving DFPT: 0.039868 Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077 to be divided by 0.02 (the difference in xcart) and 4pi =&amp;gt; 0.040439 Going to ngkpt 80 1 1,  gives: DFPT: 0.040052 Finite-differences: 0.040054 The DFPT with ngkpt 320 1 1 gives 0.040055." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t66.in" target="_blank">t66.in</a>, <a class="wikilink abifile-wikilink" data-content="Charged (He dimer)+,  with bare pseudopotential. ixc=7 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  like the previous one. Going to ngkpt 80 1 1 gives Finite-differences: 0.022275 The DFPT with ngkpt 320 1 1 gives 0.022279 . (To obtain the finite-difference results,  one has to reactivate the dtset 15 case) Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t67.in" target="_blank">t67.in</a></li><li>v8:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a></li></ul></details><p>Controls the range of atoms for which displacements will be considered in non-
linear computations (using the 2n+1 theorem), for the 1<sup>st</sup> perturbation.<br />
May take values from 1 to <a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>, with
<strong>d3e_pert1_atpol</strong>(1)&lt;=<strong>d3e_pert1_atpol</strong>(2).<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a> for additional details.</p>
<h2 id="d3e_pert1_dir"><strong>d3e_pert1_dir</strong><a class="headerlink" href="#d3e_pert1_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 1: DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/920] in all abinit tests, [6/116] in abinit tutorials</summary><ul><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_2.in" target="_blank">tnlo_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_7.in" target="_blank">tnlo_7.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_8.in" target="_blank">tnlo_8.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_9.in" target="_blank">tnlo_9.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_10.in" target="_blank">tnlo_10.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_11.in" target="_blank">tnlo_11.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t64.in" target="_blank">t64.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl Molecule in a big box 3DTE calculation with only one k-point" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="He dimer,  with bare pseudopotential ixc=0 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  giving DFPT: 0.039868 Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077 to be divided by 0.02 (the difference in xcart) and 4pi =&amp;gt; 0.040439 Going to ngkpt 80 1 1,  gives: DFPT: 0.040052 Finite-differences: 0.040054 The DFPT with ngkpt 320 1 1 gives 0.040055." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t66.in" target="_blank">t66.in</a>, <a class="wikilink abifile-wikilink" data-content="Charged (He dimer)+,  with bare pseudopotential. ixc=7 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  like the previous one. Going to ngkpt 80 1 1 gives Finite-differences: 0.022275 The DFPT with ngkpt 320 1 1 gives 0.022279 . (To obtain the finite-difference results,  one has to reactivate the dtset 15 case) Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t67.in" target="_blank">t67.in</a></li><li>v8:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a></li></ul></details><p>Gives the directions to be considered in non-linear computations (using the
2n+1 theorem), for the 1<sup>st</sup> perturbation.<br />
The three elements corresponds to the three primitive vectors, either in real
space (atomic displacement), or in reciprocal space (electric field
perturbation).<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a> for additional details.</p>
<h2 id="d3e_pert1_elfd"><strong>d3e_pert1_elfd</strong><a class="headerlink" href="#d3e_pert1_elfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 1: ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/920] in all abinit tests, [6/116] in abinit tutorials</summary><ul><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_2.in" target="_blank">tnlo_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_7.in" target="_blank">tnlo_7.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_8.in" target="_blank">tnlo_8.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_9.in" target="_blank">tnlo_9.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_10.in" target="_blank">tnlo_10.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_11.in" target="_blank">tnlo_11.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t64.in" target="_blank">t64.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl Molecule in a big box 3DTE calculation with only one k-point" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="He dimer,  with bare pseudopotential ixc=0 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  giving DFPT: 0.039868 Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077 to be divided by 0.02 (the difference in xcart) and 4pi =&amp;gt; 0.040439 Going to ngkpt 80 1 1,  gives: DFPT: 0.040052 Finite-differences: 0.040054 The DFPT with ngkpt 320 1 1 gives 0.040055." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t66.in" target="_blank">t66.in</a>, <a class="wikilink abifile-wikilink" data-content="Charged (He dimer)+,  with bare pseudopotential. ixc=7 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  like the previous one. Going to ngkpt 80 1 1 gives Finite-differences: 0.022275 The DFPT with ngkpt 320 1 1 gives 0.022279 . (To obtain the finite-difference results,  one has to reactivate the dtset 15 case) Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t67.in" target="_blank">t67.in</a></li><li>v8:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a></li></ul></details><p>Turns on electric field perturbation in non-linear computation, as 1<sup>st</sup>
perturbation. Actually, such calculations requires first the non-self-
consistent calculation of derivatives with respect to k, independently of the
electric field perturbation itself.<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfelfd">rfelfd</a> for additional details.</p>
<h2 id="d3e_pert1_phon"><strong>d3e_pert1_phon</strong><a class="headerlink" href="#d3e_pert1_phon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 1: PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/920] in all abinit tests, [6/116] in abinit tutorials</summary><ul><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_2.in" target="_blank">tnlo_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_7.in" target="_blank">tnlo_7.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_8.in" target="_blank">tnlo_8.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_9.in" target="_blank">tnlo_9.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_10.in" target="_blank">tnlo_10.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_11.in" target="_blank">tnlo_11.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t64.in" target="_blank">t64.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl Molecule in a big box 3DTE calculation with only one k-point" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="He dimer,  with bare pseudopotential ixc=0 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  giving DFPT: 0.039868 Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077 to be divided by 0.02 (the difference in xcart) and 4pi =&amp;gt; 0.040439 Going to ngkpt 80 1 1,  gives: DFPT: 0.040052 Finite-differences: 0.040054 The DFPT with ngkpt 320 1 1 gives 0.040055." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t66.in" target="_blank">t66.in</a>, <a class="wikilink abifile-wikilink" data-content="Charged (He dimer)+,  with bare pseudopotential. ixc=7 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  like the previous one. Going to ngkpt 80 1 1 gives Finite-differences: 0.022275 The DFPT with ngkpt 320 1 1 gives 0.022279 . (To obtain the finite-difference results,  one has to reactivate the dtset 15 case) Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t67.in" target="_blank">t67.in</a></li><li>v8:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a></li></ul></details><p>Turns on atomic displacement perturbation in non-linear computation, as 1<sup>st</sup>
perturbation.<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfphon">rfphon</a> for additional details.</p>
<h2 id="d3e_pert2_atpol"><strong>d3e_pert2_atpol</strong><a class="headerlink" href="#d3e_pert2_atpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 2: limits of ATomic POLarisations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, 1]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li></ul></details><p>Controls the range of atoms for which displacements will be considered in non-
linear computations (using the 2n+1 theorem), for the 2<sup>nd</sup> perturbation.<br />
May take values from 1 to <a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>, with
<strong>d3e_pert2_atpol</strong>(1)&lt;=<strong>d3e_pert2_atpol</strong>(2).<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a> for additional details.</p>
<h2 id="d3e_pert2_dir"><strong>d3e_pert2_dir</strong><a class="headerlink" href="#d3e_pert2_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 2: DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/920] in all abinit tests, [6/116] in abinit tutorials</summary><ul><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_2.in" target="_blank">tnlo_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_7.in" target="_blank">tnlo_7.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_8.in" target="_blank">tnlo_8.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_9.in" target="_blank">tnlo_9.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_10.in" target="_blank">tnlo_10.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_11.in" target="_blank">tnlo_11.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t64.in" target="_blank">t64.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl Molecule in a big box 3DTE calculation with only one k-point" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="He dimer,  with bare pseudopotential ixc=0 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  giving DFPT: 0.039868 Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077 to be divided by 0.02 (the difference in xcart) and 4pi =&amp;gt; 0.040439 Going to ngkpt 80 1 1,  gives: DFPT: 0.040052 Finite-differences: 0.040054 The DFPT with ngkpt 320 1 1 gives 0.040055." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t66.in" target="_blank">t66.in</a>, <a class="wikilink abifile-wikilink" data-content="Charged (He dimer)+,  with bare pseudopotential. ixc=7 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  like the previous one. Going to ngkpt 80 1 1 gives Finite-differences: 0.022275 The DFPT with ngkpt 320 1 1 gives 0.022279 . (To obtain the finite-difference results,  one has to reactivate the dtset 15 case) Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t67.in" target="_blank">t67.in</a></li><li>v8:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a></li></ul></details><p>Gives the directions to be considered in non-linear computations (using the
2n+1 theorem), for the 2<sup>nd</sup> perturbation.<br />
The three elements corresponds to the three primitive vectors, either in real
space (atomic displacement), or in reciprocal space (electric field
perturbation).<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a> for additional details.</p>
<h2 id="d3e_pert2_elfd"><strong>d3e_pert2_elfd</strong><a class="headerlink" href="#d3e_pert2_elfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 2: ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/920] in all abinit tests, [6/116] in abinit tutorials</summary><ul><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_2.in" target="_blank">tnlo_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_7.in" target="_blank">tnlo_7.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_8.in" target="_blank">tnlo_8.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_9.in" target="_blank">tnlo_9.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_10.in" target="_blank">tnlo_10.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_11.in" target="_blank">tnlo_11.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t64.in" target="_blank">t64.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl Molecule in a big box 3DTE calculation with only one k-point" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="He dimer,  with bare pseudopotential ixc=0 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  giving DFPT: 0.039868 Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077 to be divided by 0.02 (the difference in xcart) and 4pi =&amp;gt; 0.040439 Going to ngkpt 80 1 1,  gives: DFPT: 0.040052 Finite-differences: 0.040054 The DFPT with ngkpt 320 1 1 gives 0.040055." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t66.in" target="_blank">t66.in</a>, <a class="wikilink abifile-wikilink" data-content="Charged (He dimer)+,  with bare pseudopotential. ixc=7 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  like the previous one. Going to ngkpt 80 1 1 gives Finite-differences: 0.022275 The DFPT with ngkpt 320 1 1 gives 0.022279 . (To obtain the finite-difference results,  one has to reactivate the dtset 15 case) Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t67.in" target="_blank">t67.in</a></li><li>v8:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a></li></ul></details><p>Turns on electric field perturbation in non-linear computation, as 2<sup>nd</sup>
perturbation. Actually, such calculations requires first the non-self-
consistent calculation of derivatives with respect to k, independently of the
electric field perturbation itself.<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfelfd">rfelfd</a> for additional details.</p>
<h2 id="d3e_pert2_phon"><strong>d3e_pert2_phon</strong><a class="headerlink" href="#d3e_pert2_phon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 2: PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li></ul></details><p>Turns on atomic displacement perturbation in non-linear computation, as 2<sup>nd</sup>
perturbation.<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfphon">rfphon</a> for additional details.</p>
<h2 id="d3e_pert3_atpol"><strong>d3e_pert3_atpol</strong><a class="headerlink" href="#d3e_pert3_atpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 3: limits of ATomic POLarisations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, 1]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li></ul></details><p>Controls the range of atoms for which displacements will be considered in non-
linear computations (using the 2n+1 theorem), for the 3<sup>rd</sup> perturbation.<br />
May take values from 1 to <a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>, with
<strong>d3e_pert3_atpol</strong>(1)&lt;=<strong>d3e_pert3_atpol</strong>(2).<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a> for additional details.</p>
<h2 id="d3e_pert3_dir"><strong>d3e_pert3_dir</strong><a class="headerlink" href="#d3e_pert3_dir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 3: DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/920] in all abinit tests, [6/116] in abinit tutorials</summary><ul><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_2.in" target="_blank">tnlo_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_7.in" target="_blank">tnlo_7.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_8.in" target="_blank">tnlo_8.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_9.in" target="_blank">tnlo_9.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_10.in" target="_blank">tnlo_10.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_11.in" target="_blank">tnlo_11.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t64.in" target="_blank">t64.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl Molecule in a big box 3DTE calculation with only one k-point" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="He dimer,  with bare pseudopotential ixc=0 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  giving DFPT: 0.039868 Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077 to be divided by 0.02 (the difference in xcart) and 4pi =&amp;gt; 0.040439 Going to ngkpt 80 1 1,  gives: DFPT: 0.040052 Finite-differences: 0.040054 The DFPT with ngkpt 320 1 1 gives 0.040055." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t66.in" target="_blank">t66.in</a>, <a class="wikilink abifile-wikilink" data-content="Charged (He dimer)+,  with bare pseudopotential. ixc=7 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  like the previous one. Going to ngkpt 80 1 1 gives Finite-differences: 0.022275 The DFPT with ngkpt 320 1 1 gives 0.022279 . (To obtain the finite-difference results,  one has to reactivate the dtset 15 case) Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t67.in" target="_blank">t67.in</a></li><li>v8:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a></li></ul></details><p>Gives the directions to be considered in non-linear computations (using the
2n+1 theorem), for the 3<sup>rd</sup> perturbation.<br />
The three elements corresponds to the three primitive vectors, either in real
space (atomic displacement), or in reciprocal space (electric field
perturbation).<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a> for additional details.</p>
<h2 id="d3e_pert3_elfd"><strong>d3e_pert3_elfd</strong><a class="headerlink" href="#d3e_pert3_elfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 3: ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/920] in all abinit tests, [6/116] in abinit tutorials</summary><ul><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_2.in" target="_blank">tnlo_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_7.in" target="_blank">tnlo_7.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_8.in" target="_blank">tnlo_8.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_9.in" target="_blank">tnlo_9.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_10.in" target="_blank">tnlo_10.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_11.in" target="_blank">tnlo_11.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t64.in" target="_blank">t64.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl Molecule in a big box 3DTE calculation with only one k-point" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="He dimer,  with bare pseudopotential ixc=0 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  giving DFPT: 0.039868 Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077 to be divided by 0.02 (the difference in xcart) and 4pi =&amp;gt; 0.040439 Going to ngkpt 80 1 1,  gives: DFPT: 0.040052 Finite-differences: 0.040054 The DFPT with ngkpt 320 1 1 gives 0.040055." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t66.in" target="_blank">t66.in</a>, <a class="wikilink abifile-wikilink" data-content="Charged (He dimer)+,  with bare pseudopotential. ixc=7 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  like the previous one. Going to ngkpt 80 1 1 gives Finite-differences: 0.022275 The DFPT with ngkpt 320 1 1 gives 0.022279 . (To obtain the finite-difference results,  one has to reactivate the dtset 15 case) Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t67.in" target="_blank">t67.in</a></li><li>v8:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a></li></ul></details><p>Turns on electric field perturbation in non-linear computation, as 3<sup>rd</sup>
perturbation. Actually, such calculations requires first the non-self-
consistent calculation of derivatives with respect to k, independently of the
electric field perturbation itself.<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfelfd">rfelfd</a> for additional details.</p>
<h2 id="d3e_pert3_phon"><strong>d3e_pert3_phon</strong><a class="headerlink" href="#d3e_pert3_phon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> 3<sup>rd</sup> Derivative of Energy, mixed PERTurbation 3: PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==5 (non-linear response computations)  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v3:  <a class="wikilink abifile-wikilink" data-content="AlAs (zinc-blende structure). Compute different response functions,  then perform a computation of 3rd derivative of total energy. (to be described in more detail)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t83.in" target="_blank">t83.in</a></li></ul></details><p>Turns on atomic displacement perturbation in non-linear computation, as 3<sup>rd</sup>
perturbation.<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#rfphon">rfphon</a> for additional details.</p>
<h2 id="dfpt_sciss"><strong>dfpt_sciss</strong><a class="headerlink" href="#dfpt_sciss" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DFPT SCISSor operator<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  2 special points;  low ecut. With a 4x4x4 k point grid (!only one shift,  but OK because symmetry is imposed),  compute the dielectric constant with a scissor . Note that the fulfilment of the charge neutrality sum rule,  already broken without a scissor operator,  is strongly affected by a scissor" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t46.in" target="_blank">t46.in</a></li></ul></details><p>It is the value of the &ldquo;scissors operator&rdquo;, the shift of conduction band
eigenvalues, used in response function calculations.<br />
Can be specified in Ha (the default), Ry, eV or Kelvin, since ** ecut ** has
the &lsquo;<a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a>&lsquo; characteristics. (1 Ha=27.2113845 eV)<br />
Typical use is for response to electric field (<a class="wikilink codevar-wikilink" href="../dfpt#rfelfd">rfelfd</a>=3), but NOT for d/dk
(<a class="wikilink codevar-wikilink" href="../dfpt#rfelfd">rfelfd</a>=2) and phonon responses.</p>
<h2 id="efmas"><strong>efmas</strong><a class="headerlink" href="#efmas" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform an effective mass calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/EffMass">topic_EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t80.in" target="_blank">t80.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW for multiple bands and k-points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t81.in" target="_blank">t81.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t82.in" target="_blank">t82.in</a></li></ul></details><p>Turns on effective mass tensor calculations. Such calculations requires the
non-self-consistent calculation of derivatives with respect to k, in the same
dataset. It must therefore be used with <a class="wikilink codevar-wikilink" href="../dfpt#rfelfd">rfelfd</a>=2.  </p>
<ul>
<li>0=&gt;no effective mass tensor calculation </li>
<li>1=&gt;effective mass tensor calculation </li>
</ul>
<p>At the present time, both norm-conserving (NC) and PAW calculations are
supported. Also, for PAW calculations only, <a class="wikilink codevar-wikilink" href="../gstate#nspinor">nspinor</a>==2 and
<a class="wikilink codevar-wikilink" href="../paw#pawspnorb">pawspnorb</a>==1 (i.e. spin-orbit (SO) calculations) is supported. NC SO
calculations are NOT currently supported. Also, for both NC and PAW,
<a class="wikilink codevar-wikilink" href="../gstate#nspden">nspden</a>/=1 and <a class="wikilink codevar-wikilink" href="../basic#nsppol">nsppol</a>/=1 are NOT supported.</p>
<h2 id="efmas_bands"><strong>efmas_bands</strong><a class="headerlink" href="#efmas_bands" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, BANDS to be treated.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform an effective mass calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/EffMass">topic_EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2,<a class="wikilink codevar-wikilink" href="../basic#nkpt">nkpt</a>)<br />
<em>Default value:</em> The full range of band available in the calculation for each k-point.<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#efmas">efmas</a>==1  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t80.in" target="_blank">t80.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW for multiple bands and k-points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t81.in" target="_blank">t81.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t82.in" target="_blank">t82.in</a></li></ul></details><p>This variable controls the range of bands for which the effective mass is to
be calculated. If a band is degenerate, all other bands of the degenerate
group will automatically be treated, even if they were not part of the user
specified range.</p>
<h2 id="efmas_calc_dirs"><strong>efmas_calc_dirs</strong><a class="headerlink" href="#efmas_calc_dirs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, CALCulate along DIRectionS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform an effective mass calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/EffMass">topic_EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#efmas">efmas</a>==1  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t80.in" target="_blank">t80.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t82.in" target="_blank">t82.in</a></li></ul></details><p>Allows the user to calculate the scalar effective mass of all bands specified
by <a class="wikilink codevar-wikilink" href="../dfpt#efmas_bands">efmas_bands</a> along specific directions in reciprocal space. This is
particularly useful when considering degenerate bands, which are usually
warped, and thus cannot have their dispersion (hessian) and effective mass
expressed as a tensor. This allows the user to see the more complex angular
behavior of effective masses in these cases, for instance.</p>
<p>When <a class="wikilink codevar-wikilink" href="../dfpt#efmas_calc_dirs">efmas_calc_dirs</a>==0, no directions are read from the input file (using
<a class="wikilink codevar-wikilink" href="../dfpt#efmas_dirs">efmas_dirs</a>) and the effective masses along the 3 cartesian directions are
output by default.</p>
<p>When <a class="wikilink codevar-wikilink" href="../dfpt#efmas_calc_dirs">efmas_calc_dirs</a>==1, 2 or 3, <a class="wikilink codevar-wikilink" href="../dfpt#efmas_n_dirs">efmas_n_dirs</a> directions are read from
<a class="wikilink codevar-wikilink" href="../dfpt#efmas_dirs">efmas_dirs</a>, assuming cartesian, reduced or angular (theta,phi)
coordinates, respectively. In the case <a class="wikilink codevar-wikilink" href="../dfpt#efmas_calc_dirs">efmas_calc_dirs</a>==3, 2 real values
per directions are read, whereas 3 real values are read in the two other
cases.</p>
<h2 id="efmas_deg"><strong>efmas_deg</strong><a class="headerlink" href="#efmas_deg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, activate DEGenerate formalism<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform an effective mass calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/EffMass">topic_EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#efmas">efmas</a>&gt;0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t82.in" target="_blank">t82.in</a></li></ul></details><p>Activate (==1) or not (==0) the treatment of degenerate bands (within a
criterion <a class="wikilink codevar-wikilink" href="../dfpt#efmas_deg_tol">efmas_deg_tol</a>) using the transport equivalent effective mass
idea (see <a href="https://doi.org/10.1103/PhysRevB.89.155131">PRB 89 155131 (2014)</a>).</p>
<h2 id="efmas_deg_tol"><strong>efmas_deg_tol</strong><a class="headerlink" href="#efmas_deg_tol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, DEGeneracy TOLerance<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform an effective mass calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/EffMass">topic_EffMass</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1e-05<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#efmas_deg">efmas_deg</a>==1  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t82.in" target="_blank">t82.in</a></li></ul></details><p>Energy difference below which 2 bands are considered degenerate (and treated
using the formalism activated with <a class="wikilink codevar-wikilink" href="../dfpt#efmas_deg">efmas_deg</a>==1). <a class="wikilink codevar-wikilink" href="../dfpt#efmas_deg_tol">efmas_deg_tol</a> has
the &lsquo;<a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a>&lsquo; characteristics.</p>
<h2 id="efmas_dim"><strong>efmas_dim</strong><a class="headerlink" href="#efmas_dim" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, DIMension of the effective mass tensor<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform an effective mass calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/EffMass">topic_EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#efmas">efmas</a>==1  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t80.in" target="_blank">t80.in</a></li></ul></details><p>For 2D or 1D systems, the band dispersion goes to 0 perpendicular to the
system, which causes the inverse effective mass to be singular, i.e. the
effective mass to be NaN. This keyword circumvents the problem by eliminating
the troublesome dimensions from the inverse effective mass.</p>
<p>In 2D, the Z axis is ignored and, in 1D, the Z and Y axis are ignored.</p>
<p>Also, note that in the 2D degenerate case, a subtlety arises: the &lsquo;transport
equivalent&rsquo; effective mass does not determine the scale of the transport
tensors (conductivity and others). Therefore, for this specific case, the
factor by which these transport tensors should be scaled once determined from
the &lsquo;transport equivatlent&rsquo; effective mass tensor is output separately on the
line immediately after the effective mass.</p>
<h2 id="efmas_dirs"><strong>efmas_dirs</strong><a class="headerlink" href="#efmas_dirs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, DIRectionS to be calculated<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform an effective mass calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/EffMass">topic_EffMass</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3 or 2,<a class="wikilink codevar-wikilink" href="../dfpt#efmas_n_dirs">efmas_n_dirs</a>)<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#efmas_calc_dirs">efmas_calc_dirs</a>&gt;0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t80.in" target="_blank">t80.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t82.in" target="_blank">t82.in</a></li></ul></details><p>List of <a class="wikilink codevar-wikilink" href="../dfpt#efmas_n_dirs">efmas_n_dirs</a> directions to be considered according to the value of
<a class="wikilink codevar-wikilink" href="../dfpt#efmas_calc_dirs">efmas_calc_dirs</a>. The directions are specified by 3 real values if
<a class="wikilink codevar-wikilink" href="../dfpt#efmas_calc_dirs">efmas_calc_dirs</a>==1 or 2 and by 2 real values if <a class="wikilink codevar-wikilink" href="../dfpt#efmas_calc_dirs">efmas_calc_dirs</a>==3.</p>
<h2 id="efmas_n_dirs"><strong>efmas_n_dirs</strong><a class="headerlink" href="#efmas_n_dirs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, Number of DIRectionS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform an effective mass calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/EffMass">topic_EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#efmas_calc_dirs">efmas_calc_dirs</a>&gt;0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t80.in" target="_blank">t80.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t82.in" target="_blank">t82.in</a></li></ul></details><p>Number of directions in <a class="wikilink codevar-wikilink" href="../dfpt#efmas_dirs">efmas_dirs</a>, to be considered according to
<a class="wikilink codevar-wikilink" href="../dfpt#efmas_calc_dirs">efmas_calc_dirs</a>.</p>
<h2 id="efmas_ntheta"><strong>efmas_ntheta</strong><a class="headerlink" href="#efmas_ntheta" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFfective MASs, Number of points for integration w/r to THETA<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform an effective mass calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/EffMass">topic_EffMass</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1000<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#efmas">efmas</a><mark>1 and <a class="wikilink codevar-wikilink" href="../dfpt#efmas_bands">efmas_bands</a></mark>(degenerate band index)  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Germanium. Germanium effective mass tensor at \Gamma and 0.25 0.00 0.00." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t80.in" target="_blank">t80.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW for multiple bands and k-points." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t81.in" target="_blank">t81.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon. Silicon effective mass tensor in PAW with Spin-Orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t82.in" target="_blank">t82.in</a></li></ul></details><p>When a band is degenerate, the usual definition of effective mass becomes
invalid. However, it is still possible to define a &lsquo;transport equivalent mass
tensor&rsquo; that reproduces the contribution of the band to the conductivity
tensor. To obtain this tensor, an integration over the solid sphere is
required. The default value gives a tensor accurate to the 4<sup>th</sup> decimal in Ge.</p>
<h2 id="elph2_imagden"><strong>elph2_imagden</strong><a class="headerlink" href="#elph2_imagden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ELectron-PHonon interaction at 2<sup>nd</sup> order : IMAGinary shift of the DENominator<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to calculate the temperature dependence of the electronic structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a> != 0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [18/920] in all abinit tests, [3/116] in abinit tutorials</summary><ul><li>v7:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . The temperature-dependent shifts must be averaged over degenerate states. This temperature-dependent calculation make use of a k-point interpolation to speed up the convergence study with respect to the q-points integration. Two q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t50.in" target="_blank">t50.in</a>, <a class="wikilink abifile-wikilink" data-content="This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the previous test. The third q-point is computed here." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t55.in" target="_blank">t55.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. The wtq variable is introduced to be able to reproduce the q-point weight obtained with ngqpt and qptopt. The main reason being that the initialization of large q-point (same for k-point) grid is extremely slow. Inputing manually the qpt and wtq in the input file avoid such inefficient initialization." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t57.in" target="_blank">t57.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Test the getddb variable that cancels the divergence in el-ph for small q-points Such divergence is induced by a residual electric field. Note: The Fan terms in DATASET 6 should be different (renormalized) from the one of DATASET 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t58.in" target="_blank">t58.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Test the getddb variable that cancels the divergence in el-ph for small q-points Such divergence is induced by a residual electric field. Note: DATASET 7 test the irdddb that should behave exactly as getddb." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="O2 Oxygen spin-temperature-dependent of the band energies" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t83.in" target="_blank">t83.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . Warning : only valid for Gamma,  AND the temperature-dependent shifts must be averaged over degenerate states." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t37.in" target="_blank">t37.in</a></li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.out" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t60.in" target="_blank">t60.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.out" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t60.in" target="_blank">t60.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed. Test of the parallelization. Must be compared with v7/Refs/t55.out" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t60.in" target="_blank">t60.in</a></li></ul></details><p>that is, if the user is performing performing second-order eigenvalue
calculations using response-functions.  </p>
<p>The variable <a class="wikilink codevar-wikilink" href="../dfpt#elph2_imagden">elph2_imagden</a> determines the imaginary shift of the
denominator of the sum-over-states in the perturbation denominator,
(e_{nk}-e_{n&rsquo;k&rsquo;}+i <a class="wikilink codevar-wikilink" href="../dfpt#elph2_imagden">elph2_imagden</a>). One should use a width comparable with
the Debye frequency or the maximum phonon frequency.<br />
Can be specified in Ha (the default), Ry, eV or Kelvin, since ** ecut ** has
the &lsquo;<a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a>&lsquo; characteristics. (1 Ha=27.2113845 eV)</p>
<h2 id="eph_task"><strong>eph_task</strong><a class="headerlink" href="#eph_task" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electron-PHonon: Task<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the matrix elements of the electron-phonon interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/ElPhonInt">topic_ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v8:  <a class="wikilink abifile-wikilink" data-content="WARNING: This code is still under development. Use at your own risk. Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.in" target="_blank">t44.in</a>, <a class="wikilink abifile-wikilink" data-content="Testing of the phonon potential interpolation routines." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t65.in" target="_blank">t65.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Calculation of e-ph coupling matrix elements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t89.in" target="_blank">t89.in</a></li></ul></details><p>When <a class="wikilink codevar-wikilink" href="../gstate#optdriver">optdriver</a>==7, select the task to be performed. The choice is among :<br />
<a class="wikilink codevar-wikilink" href="../dfpt#eph_task">eph_task</a>=1 : phonon linewidth<br />
<a class="wikilink codevar-wikilink" href="../dfpt#eph_task">eph_task</a>=2 : electron-phonon coupling elements</p>
<h2 id="esmear"><strong>esmear</strong><a class="headerlink" href="#esmear" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Eigenvalue SMEARing<br />
<em>Characteristics:</em> <a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to calculate the temperature dependence of the electronic structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.01<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../dfpt#smdelta">smdelta</a> != 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v6:  <a class="wikilink abifile-wikilink" data-content="Crystalline Silicon Test the smearing parameter ESMEAR of the imaginary second order eigenvalues for Q-point (0 0 0),  contained in the EIGI2D files. Parameters are far from convergence,  nband=5 and nkpt=16." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t60.in" target="_blank">t60.in</a></li></ul></details><p>that is, if the user is performing simulations of the electronic lifetimes
induced by the electron-phonon coupling.  </p>
<p>The variable <a class="wikilink codevar-wikilink" href="../dfpt#esmear">esmear</a> determines the width of the functions approximating
the delta function, \delta(e_{nk}-e_{n&rsquo;k&rsquo;}), present in the expression of the
lifetimes. One should use a width comparable with the Debye frequency or the
maximum phonon frequency.<br />
Can be specified in Ha (the default), Ry, eV or Kelvin, since ** ecut ** has
the &lsquo;<a class="wikilink" href="../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a>&lsquo; characteristics. (1 Ha=27.2113845 eV)</p>
<h2 id="frzfermi"><strong>frzfermi</strong><a class="headerlink" href="#frzfermi" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FReeZe FERMI energy<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v2:  <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 28. The chosen grid (too coarse,  though) is (0 0 0),  (1/4 1/4 0),  (1/2 1/2 0),  (1/2 0 0), (1/2 1/4 1/4),  (1/2 -1/4 1/4)  (in reduced coordinates). The ecut and nkpt parameters are really too low (see test 28), but parameters suitable for physical results (see test 29) are also provided in the input files." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t26.in" target="_blank">t26.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="O2 (non-spin-polarized,  non-linear XC core correction,  LDA) Metallic occupation numbers. For metallic occupation numbers, RF computation of 2DTE at Gamma,  when taking Fermi energy changes (frzfermi=0),  will give the same answer than finite-difference of GS computations. However,  prior to v4.4,  the change of Fermi energy due to the perturbation was not computed. This corresponds to calculations performed with frzfermi=1 (should be used only for testing purposes). In dataset 1-3,  one computes the total energy and forces, without symmetries,  as it should be for accurate finite-difference tests. The reduced gradients with respect to displacements of the first atom along z in datasets 1 and 3 are -5.705344113253 Ha and -5.692553418498 Ha,  giving the 2DTE of 127.90 Ha. In dataset 4,  RF is computed with the Fermi energy correction, and the agreement with finite-differences of datasets 1 and 3 is good : one gets 127.9068 Ha . In dataset 5,  RF is computed with frozen Fermi energy and the disagreement with finite-differences of datasets 1 and 3 is large: one gets 100.9991668 Ha ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t75.in" target="_blank">t75.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Computation of phonons frequencies for metallic occupations at q=0 0 0 within PAW O2 (nsppol=1);  this test is directly inspired by test v3#75. In datasets 1-3,  one computes the total energy and forces,  without symmetries, as it should be for accurate finite-difference tests. From the reduced gradients with respect to displacements,  one can deduce a 2DTE of 149.9614 Ha. In dataset 4,  RF is computed with the Fermi energy correction, and the agreement with finite-differences of datasets 1 and 3 is good : one gets 149.9612 Ha. In dataset 5,  RF is computed with frozen Fermi energy and the disagreement with finite-differences of datasets 1 and 3 is large: one gets 124.9787 Ha." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t89.in" target="_blank">t89.in</a></li></ul></details><p>Can be used to suppress artificially the first-order change of Fermi energy,
in case of Response Function calculation for metals at Q=0. The input variable
<a class="wikilink codevar-wikilink" href="../dfpt#frzfermi">frzfermi</a>, if set to 1, allows to suppress this contribution, but this is
incorrect.</p>
<h2 id="ieig2rf"><strong>ieig2rf</strong><a class="headerlink" href="#ieig2rf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for second-order EIGenvalues from Response-Function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to calculate the temperature dependence of the electronic structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [25/920] in all abinit tests, [3/116] in abinit tutorials</summary><ul><li>v6:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . Warning : only valid for Gamma,  AND the temperature-dependent shifts must be averaged over degenerate states." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t37.in" target="_blank">t37.in</a>, <a class="wikilink abifile-wikilink" data-content="He BCC primitive cell. Fake smooth pseudopotential. For testing the electron-phonon modification of the electronic structure. To be compared with the results of tests 51 to 59. Use a 2x2x2 grid of k (shifted) and q (non-shifted) points. No imaginary frequences for the phonons with this choice. Computation of the electronic eigenvalues as well as phonon eigenfrequencies, and corresponding ingredients for the computation of the electron-phonon effect,  in the next tests 51-53." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t50.in" target="_blank">t50.in</a>, <a class="wikilink abifile-wikilink" data-content="He BCC conventional cell. Fake smooth pseudopotential. For testing the electron-phonon modification of the electronic structure. To be compared with the results of tests 50 to 59. Use a FCC grid of k (shifted) and q (non-shifted) points. No imaginary frequences for the phonons with this choice. Computation of the electronic eigenvalues as well as phonon eigenfrequencies, and corresponding ingredients for the computation of the electron-phonon effect,  in the next tests 55-57." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t54.in" target="_blank">t54.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . The temperature-dependent shifts must be averaged over degenerate states. This temperature-dependent calculation make use of a k-point interpolation to speed up the convergence study with respect to the q-points integration. Two q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t50.in" target="_blank">t50.in</a>, <a class="wikilink abifile-wikilink" data-content="This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the previous test. The third q-point is computed here." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t55.in" target="_blank">t55.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="Crystalline Silicon Test the computation of second order eigenvalues for two qpoints,  (0 0 0) and (1/2 0 0),  contained in the EIGR2D files. Parameters are far from convergence,  nband=5 and nkpt=16." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t26.in" target="_blank">t26.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a> &hellip;</li></ul></details><p>If <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a> is greater then 0, the code will produce a file, named with the
trailing suffix _EIGR2D, containing the second-order electronic eigenvalues
for the perturbation. These files are used in the calculation of the thermal
correction to the electronic eigenvalues.  </p>
<p>If <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a> is set to 1, the second-order electronic eigenvalues will be
calculated from the DFPT method (Sternheimer).<br />
If <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a> is set to 2, the second-order electronic eigenvalues will be
calculated from the Allen-Cardona method. (sum over states)<br />
If <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a> is set to 3, the second-order electronic eigenvalues will be
calculated from the DFPT method (sum over states) but using a different part
of the code. This is equivalent to <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a> = 1 [debuging]<br />
If <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a> is set to 4, the second-order electronic eigenvalues will be
calculated from the dynamical DFPT method (Sternheimer). The code will
generate _EIGR2D.nc files that contain the electron-phonon matrix element
squared on the space orthogonal to the active space. The code will also
produce _FAN.nc files that contain the electron-phonon matrix elements
squared. Note that <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a>=4 can only be used if Abinit is compiled with
NETCDF support.<br />
If <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a> is set to 5, the second-order electronic eigenvalues will be
calculated from the dynamical DFPT method (Sternheimer). The code will
generate _EIGR2D.nc files that contain the electron-phonon matrix element
square on the space orthogonal to the active space. The code will also produce
_GKK.nc files that contain electron-phonon matrix elements. This option is
preferable for large system to <a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a>=4 as the GKK files take less much
less disk space and memory (but run a little bit slower). Note that
<a class="wikilink codevar-wikilink" href="../dfpt#ieig2rf">ieig2rf</a>=5 can only be used if Abinit is compiled with NETCDF support.<br />
Related variables :
<a class="wikilink codevar-wikilink" href="../dfpt#bdeigrf">bdeigrf</a>,<a class="wikilink codevar-wikilink" href="../dfpt#elph2_imagden">elph2_imagden</a>,<a class="wikilink codevar-wikilink" href="../dev#getgam_eig2nkq">getgam_eig2nkq</a>,<a class="wikilink codevar-wikilink" href="../dfpt#smdelta">smdelta</a></p>
<h2 id="ph_ngqpt"><strong>ph_ngqpt</strong><a class="headerlink" href="#ph_ngqpt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PHonons: Number of Grid points for Q-PoinT mesh.<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT
calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [20, 20, 20]  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v8:  <a class="wikilink abifile-wikilink" data-content="WARNING: This code is still under development. Use at your own risk. Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.in" target="_blank">t44.in</a>, <a class="wikilink abifile-wikilink" data-content="Testing of the phonon potential interpolation routines." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t65.in" target="_blank">t65.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Calculation of phonon linewidths and e-ph coupling parameter lambda." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t88.in" target="_blank">t88.in</a></li></ul></details><p>This variable defines the q-mesh used to compute the phonon DOS and the
Eliashberg function via Fourier interpolation. Related input variables:
<a class="wikilink codevar-wikilink" href="../eph#ph_qshift">ph_qshift</a> and <a class="wikilink codevar-wikilink" href="../eph#ph_nqshift">ph_nqshift</a>.</p>
<h2 id="ph_qpath"><strong>ph_qpath</strong><a class="headerlink" href="#ph_qpath" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Phonons: Q-PATH<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters related to the phonon wavevectors (q-points) in DFPT
calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/q-points">topic_q-points</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3,ph_nqpath)<br />
<em>Default value:</em> None<br />
<em>Only relevant if:</em> specified(<a class="wikilink codevar-wikilink" href="../eph#ph_nqpath">ph_nqpath</a>)  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v8:  <a class="wikilink abifile-wikilink" data-content="WARNING: This code is still under development. Use at your own risk. Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t44.in" target="_blank">t44.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Calculation of phonon linewidths and e-ph coupling parameter lambda." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t88.in" target="_blank">t88.in</a></li></ul></details><p>This array contains the list of special q-points used to construct the q-path
for phonon band structures and phonon linewidths. See also <a class="wikilink codevar-wikilink" href="../eph#ph_nqpath">ph_nqpath</a> and
[<a class="wikilink codevar-wikilink" href="../eph#ph_ndivsm">ph_ndivsm</a>.</p>
<h2 id="prepanl"><strong>prepanl</strong><a class="headerlink" href="#prepanl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PREPAre Non-Linear response calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute Raman intensity, and the related electro-optic coefficients" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/nonlinear">topic_nonlinear</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [17/920] in all abinit tests, [6/116] in abinit tutorials</summary><ul><li>v8:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t64.in" target="_blank">t64.in</a>, <a class="wikilink abifile-wikilink" data-content="NaCl Molecule in a big box 3DTE calculation with only one k-point" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t65.in" target="_blank">t65.in</a>, <a class="wikilink abifile-wikilink" data-content="He dimer,  with bare pseudopotential ixc=0 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  giving DFPT: 0.039868 Finite-differences: 1.6318415296 - 1.6216781815 = 0.0101633077 to be divided by 0.02 (the difference in xcart) and 4pi =&amp;gt; 0.040439 Going to ngkpt 80 1 1,  gives: DFPT: 0.040052 Finite-differences: 0.040054 The DFPT with ngkpt 320 1 1 gives 0.040055." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t66.in" target="_blank">t66.in</a>, <a class="wikilink abifile-wikilink" data-content="Charged (He dimer)+,  with bare pseudopotential. ixc=7 Compute Raman intensity,  showing essentially perfect agreement between DFPT and finite-differences,  when the number of k points is extended to infinity. The present test use ngkpt 10 1 1,  like the previous one. Going to ngkpt 80 1 1 gives Finite-differences: 0.022275 The DFPT with ngkpt 320 1 1 gives 0.022279 . (To obtain the finite-difference results,  one has to reactivate the dtset 15 case) Cannot be executed on more that 1 MPI proc due to different values of nband_k" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t67.in" target="_blank">t67.in</a></li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_2.in" target="_blank">tnlo_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_7.in" target="_blank">tnlo_7.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_8.in" target="_blank">tnlo_8.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_9.in" target="_blank">tnlo_9.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_10.in" target="_blank">tnlo_10.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements adapted for single data set mode by JWZ,  05.05.2011" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_11.in" target="_blank">tnlo_11.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a></li></ul></details><p>The computation of third-order derivatives from the 2n+1 theorem requires the
first-order wavefunctions and densities obtained from a linear response
calculation. The standard approach in a linear response calculation is (i) to
compute only the irreducible perturbations, and (ii) to use symmetries to
reduce the number of k-points for the k-point integration.<br />
This approach cannot be applied, presently (v4.1), if the first-order
wavefunctions are to be used to compute third-order derivatives. First, for
electric fields, the code needs the derivatives along the three directions.
Still, in case of phonons, only the irreducible perturbations are required.
Second, for both electric fields and phonons, the wavefunctions must be
available in half the BZ (kptopt=2), or the full BZ (kptopt=3).<br />
During the linear response calculation, in order to prepare a non-linear
calculation, one should put <a class="wikilink codevar-wikilink" href="../dfpt#prepanl">prepanl</a> to 1 in order to force ABINIT (i) to
compute the electric field perturbation along the three directions explicitly,
and (ii) to keep the full number of k-points.</p>
<h2 id="prepgkk"><strong>prepgkk</strong><a class="headerlink" href="#prepgkk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PREPAre GKK calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the matrix elements of the electron-phonon interaction" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/ElPhonInt">topic_ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/920] in all abinit tests, [1/116] in abinit tutorials</summary><ul><li>v6:  <a class="wikilink abifile-wikilink" data-content="Ground state and phonons of hcp TiNb alloy" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t72.in" target="_blank">t72.in</a>, <a class="wikilink abifile-wikilink" data-content="Ground state and phonons of hcp Ti (similar to test 72,  but grid 2 2 4)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t90.in" target="_blank">t90.in</a></li><li>v5:  <a class="wikilink abifile-wikilink" data-content="FCC Aluminium - get phonons and ddk in preparation for an electron-phonon coupling run. a few extra features are used compared to the tutorial." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t85.in" target="_blank">t85.in</a></li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="the sequence of datasets makes the ground states and all of the explicit perturbations of the single Al atom in all directions,  for the irreducible qpoints in a 2x2x2 grid. Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph_1.in" target="_blank">teph_1.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Ground state and phonons of bcc Li" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t90.in" target="_blank">t90.in</a></li></ul></details><p>The calculation of electron-phonon coupling quantities requires the presence
of all the perturbations (all atoms in all directions) for the chosen set of
(irreducible) q-points. To impose this and prevent ABINIT from using symmetry
to reduce the number of perturbations, set <a class="wikilink codevar-wikilink" href="../dfpt#prepgkk">prepgkk</a> to 1. Use in
conjunction with <a class="wikilink codevar-wikilink" href="../files#prtgkk">prtgkk</a>.</p>
<h2 id="prtbbb"><strong>prtbbb</strong><a class="headerlink" href="#prtbbb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT Band-By-Band decomposition<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to print some useful quantities" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/printing">topic_printing</a>, <a class="wikilink topic-wikilink" data-content="How to tune the output of computed quantities" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Output">topic_Output</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v3:  <a class="wikilink abifile-wikilink" data-content="BaO crystal. Computation of band-by-band decomposition of Born effective charges. Also,  computation of the electronic localization tensor, and its band-by-band decomposition." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t77.in" target="_blank">t77.in</a></li></ul></details><p>If <a class="wikilink codevar-wikilink" href="../dfpt#prtbbb">prtbbb</a> is 1, print the band-by-band decomposition of Born effective
charges and localization tensor, in case they are computed. See Ph. Ghosez and
X. Gonze, J. Phys.: Condens. Matter 12, 9179 (2000).</p>
<h2 id="rf2_dkdk"><strong>rf2_dkdk</strong><a class="headerlink" href="#rf2_dkdk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function : 2<sup>nd</sup> Derivative of wavefunctions with respect to K<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/920] in all abinit tests, [0/116] in abinit tutorials</summary></details><p>UNUSABLE (in development)</p>
<p>Activates computation of second derivatives of wavefunctions with respect to
wavevectors. This is not strictly a response function but is a needed
auxiliary quantity in the calculations of 3<sup>rd</sup>-order derivatives of the energy
(non-linear response). The directions for the derivatives are determined by
<a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a> (TO BE CORRECTED!).</p>
<ul>
<li>0=&gt;no derivative calculation </li>
<li>1=&gt;calculation along diagonal directions (d2/(dk_i dk_i), natom+10 is activated) </li>
<li>2=&gt;calculation along off-diagonal directions (d2/(dk_i dk_j), natom+11 is activated) </li>
<li>3=&gt;calculation along all directions (both natom+10 and natom+11 are activated) </li>
</ul>
<h2 id="rfasr"><strong>rfasr</strong><a class="headerlink" href="#rfasr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function : Acoustic Sum Rule<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective
charges, IR reflectivity ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v5:  <a class="wikilink abifile-wikilink" data-content="GeTe in rhombohedral structure Test the computation of phonons,  dielectric tensor and Born effective charges,  with and without spin-orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t24.in" target="_blank">t24.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . Warning : only valid for Gamma,  AND the temperature-dependent shifts must be averaged over degenerate states." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t37.in" target="_blank">t37.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . The temperature-dependent shifts must be averaged over degenerate states. This temperature-dependent calculation make use of a k-point interpolation to speed up the convergence study with respect to the q-points integration. Two q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t50.in" target="_blank">t50.in</a>, <a class="wikilink abifile-wikilink" data-content="This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the previous test. The third q-point is computed here." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t51.in" target="_blank">t51.in</a></li></ul></details><p>Control the evaluation of the acoustic sum rule in effective charges and
dynamical matrix at Gamma within a response function calculation (not active
at the level of producing the DDB, but at the level of the phonon
eigenfrequencies output).</p>
<ul>
<li>0 =&gt; no acoustic sum rule imposed </li>
<li>1 =&gt; acoustic sum rule imposed for dynamical matrix at Gamma, and charge neutrality imposed with extra charge evenly distributed among atoms </li>
<li>2 =&gt; acoustic sum rule imposed for dynamical matrix at Gamma, and charge neutrality imposed with extra charge given proportionally to those atoms with the largest effective charge. </li>
</ul>
<p>The treatment of the acoustic sum rule and charge neutrality sum rule is finer
at the level of the ANADDB utility, with the two independent input variables
<a class="wikilink codevar-wikilink" href="../anaddb#asr">asr</a> and <a class="wikilink codevar-wikilink" href="../anaddb#chneut">chneut</a>.</p>
<h2 id="rfatpol"><strong>rfatpol</strong><a class="headerlink" href="#rfatpol" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function : ATomic POLarisation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a>, <a class="wikilink topic-wikilink" data-content="How to compute elastic, piezoelectric and internal strain tensors from DFPT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Elastic">topic_Elastic</a>, <a class="wikilink topic-wikilink" data-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective
charges, IR reflectivity ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [1, 1]  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [163/920] in all abinit tests, [18/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of various XC functionals for the response functions (thus,  the XC kernel is also tested). The test includes 3 different functionals: 1) Perdew-Zunger: ixc=2 and ixc=-001009 2) PBE: ixc=11 and ixc=-101130 3) Perdew-Wang92: ixc=7,  ixc=-001012,  and ixc=-001013 The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting some lines indicated by GMR. Note that the underlying FFT grid does not have the symmetry of the lattice." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t81.in" target="_blank">t81.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of the Perdew-Zunger XC functionals for the response functions (thus,  the XC kernel is also tested) in PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t82.in" target="_blank">t82.in</a> &hellip;</li><li>seq:  <a class="wikilink abifile-wikilink" data-content="CrystallIne AlAs first three runs are for calculation of ground state at finite electric field the fourth run gets the gs wavefunction and then do response calculation the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_80.in" target="_blank">tsv4_80.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  NC pseudos. Test the IO routines for a typical DFPT calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="FCC Al metallic;  10 phonon at 1/4 1/8 1/8" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t53.in" target="_blank">t53.in</a>, <a class="wikilink abifile-wikilink" data-content="FCC Al metallic;  10 phonon at 1/4 1/8 1/8" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t53.in" target="_blank">t53.in</a>, <a class="wikilink abifile-wikilink" data-content="FCC Al metallic;  10 phonon at 1/4 1/8 1/8" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t53.in" target="_blank">t53.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Si2 molecules (2 atoms per unit cell), using a separable pseudopotential,  with ixc=3. Computation of the second derivative of the total energy with respect to a atomic displacement perpendicular to the chain,  with q(0 0 1/2) wavevector. (see test.si.chain of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2. Use the x-only PBE functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.10691 Ha while finite differences gives : with delta(xred)=0.0002,  189.10790 Ha with delta(xred)=0.0001,  189.10703 Ha . Combining the results gives 189.10675 Ha. The agreement is quite good,  and might likely be improved by increasing tolvrs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the the effect of the first-order Fermi energy on a Q=0 phonon calculation in metals. The example is for a hypothetical intermetallic compound MgAl2, in a structure which can be thought of as fcc Al with every third (111) layer replaced by Mg.  Technically,  this is the hexagonal CdI2 structure,  space group #164,  P-3 m 1.  For this case,  neglect of this contribution yields approximately a 2% error in the largest interatomic force constants.  Its effect on many force constants for this system cancels because of symmetry.  This calculation is not particularly well converged,  especially with respect to k sample.  A well-converged version is in excellent agreement with interatomic force constants calculated by numerical differentiation of ground-state forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t60.in" target="_blank">t60.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone. Use the definition through qptrlatt. Otherwise,  similar to Tv2#26 and Tv6#78." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t35.in" target="_blank">t35.in</a>, <a class="wikilink abifile-wikilink" data-content="ZrO2 FCC (fluorite structure). Compute the phonon frequencies at the X point. This worked correctly before 5.2.4,  but then,  an erroneous bug fix (correcting v5#21) was introduced. Final (correct) fixing in v6.0.4. (Contributed by I. Lukacevic,  trying to reproduce results by Detraux et al 1997)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t36.in" target="_blank">t36.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . Warning : only valid for Gamma,  AND the temperature-dependent shifts must be averaged over degenerate states." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t37.in" target="_blank">t37.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="EuO rock salt structure. 20-electron PAW pseudo (4f in the core,  but 4d10 as semi-core : 4d10 5s2 5p6 (5d0) 6s2 ) Test of computation of dielectric tensor,  Born effective charges,  dynamical matrix. To keep the CPU time to a reasonable level,  the responses are computed with minimal parameters (nstep and the kpoint grid are too small, ecut might be increased,  and also pawecutdg). Note: Charge neutrality is not achieved with the present dataset for Born Effective Charges, but can be easily reached by increasing some parameters;  for instance: (ngkpt 6 6 6,   ecut 40. pawecutdg 40.) gives Z(Eu)=2.5085,  Z(O)=-2.4982" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t43.in" target="_blank">t43.in</a>, <a class="wikilink abifile-wikilink" data-content="This tests uses psps8 files with model core charges and valence charge densities. We test the initialization of rhor1,  rhog1 from atomic quantities and the treatment of the non-linear core correction in G-space (nc_xccc_gspace)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t45.in" target="_blank">t45.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . The temperature-dependent shifts must be averaged over degenerate states. This temperature-dependent calculation make use of a k-point interpolation to speed up the convergence study with respect to the q-points integration. Two q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t50.in" target="_blank">t50.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="WARNING: This code is still under development. Use at your own risk! Preparatory run for the calculation of the Fan-Migdal + Debye-Waller self-energy C in diamond structure. Very rough 2x2x2 q-point grid (3 qpoints);  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t41.in" target="_blank">t41.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="PbFCl in the matlockite structure P4/nmm. 6 atoms per cell. Compute a set of matrix elements of the dynamical matrix, for q wavevector 0.5 0.5 0.5 . In this test case,  the symmetry operations have an important non-symmorphic character. There was a bug in the treatment of this material,  prior to v5.2.4 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in Zincblende structure. Test calculation of the Born effective charge and dielectric constant tensor at finite electric fields. The first dataset is for normal ground-state calculation at zero electric field. The second dataset is for ground-state calculation at finite electric field. The final datasetis the linear-response calculation at finite electric field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t23.in" target="_blank">t23.in</a>, <a class="wikilink abifile-wikilink" data-content="GeTe in rhombohedral structure Test the computation of phonons,  dielectric tensor and Born effective charges,  with and without spin-orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t24.in" target="_blank">t24.in</a> &hellip;</li></ul></details><p>Control the range of atoms for which displacements will be considered in
phonon calculations (atomic polarizations), using the 2n+1 theorem.<br />
These values are only relevant to phonon response function calculations.<br />
May take values from 1 to <a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>, with <a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a>(1)&lt;=<a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a>(2).<br />
The atoms to be moved will be defined by the<br />
do-loop variable iatpol :<br />
do iatpol=<a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a>(1),<a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a>(2)<br />
For the calculation of a full dynamical matrix, use <a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a>(1)=1 and
<a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a>(2)=<a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>, together with <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a> 1 1 1 . For selected
elements of the dynamical matrix, use different values of <a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a> and/or
<a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a>. The name &lsquo;iatpol&rsquo; is used for the part of the internal variable
ipert when it runs from 1 to <a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>. The internal variable ipert can also
assume values larger than <a class="wikilink codevar-wikilink" href="../basic#natom">natom</a>, denoting perturbations of electric field
or stress type (see <a href="../../../users/generated_files/help_respfn.html"> the response function help file
</a> ).</p>
<h2 id="rfddk"><strong>rfddk</strong><a class="headerlink" href="#rfddk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to Derivative with respect to K<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v5:  <a class="wikilink abifile-wikilink" data-content="Compute DDK response in PAW formalism for two different but equivalent input variables: rfddk 1,  rfelfd 2" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t30.in" target="_blank">t30.in</a></li></ul></details><p>Activates computation of derivatives of ground state wavefunctions with
respect to wavevectors. This is not strictly a response function but is a
needed auxiliary quantity in the electric field calculations (see <a class="wikilink codevar-wikilink" href="../dfpt#rfelfd">rfelfd</a>)
The directions for the derivatives are determined by <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a>.</p>
<ul>
<li>0=&gt;no derivative calculation </li>
<li>1=&gt;calculation of first derivatives of wavefunctions with respect to k points (d/dk calculation). The exact same functionality is provided by <a class="wikilink codevar-wikilink" href="../dfpt#rfelfd">rfelfd</a> = 2. </li>
</ul>
<h2 id="rfdir"><strong>rfdir</strong><a class="headerlink" href="#rfdir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function : DIRections<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a>, <a class="wikilink topic-wikilink" data-content="How to compute elastic, piezoelectric and internal strain tensors from DFPT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Elastic">topic_Elastic</a>, <a class="wikilink topic-wikilink" data-content="How to compute phonon frequencies and modes, IR and Raman spectra, Born effective
charges, IR reflectivity ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Phonons">topic_Phonons</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [216/920] in all abinit tests, [29/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of various XC functionals for the response functions (thus,  the XC kernel is also tested). The test includes 3 different functionals: 1) Perdew-Zunger: ixc=2 and ixc=-001009 2) PBE: ixc=11 and ixc=-101130 3) Perdew-Wang92: ixc=7,  ixc=-001012,  and ixc=-001013 The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting some lines indicated by GMR. Note that the underlying FFT grid does not have the symmetry of the lattice." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t81.in" target="_blank">t81.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of the Perdew-Zunger XC functionals for the response functions (thus,  the XC kernel is also tested) in PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t82.in" target="_blank">t82.in</a> &hellip;</li><li>seq:  <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  2 special points;  low ecut. With a 4x4x4 k point grid (!only one shift,  but OK because symmetry is imposed),  compute the dielectric constant by two different techniques" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_05.in" target="_blank">tsv3_05.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  rhombohedral. Test finite electric field Check the corectness of the symmetry operations with non-zero tnons." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_55.in" target="_blank">tsv4_55.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  NC pseudos. Test the IO routines for a typical DFPT calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t06.in" target="_blank">t06.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Si2 molecules (2 atoms per unit cell), using a separable pseudopotential,  with ixc=3. Computation of the second derivative of the total energy with respect to a atomic displacement perpendicular to the chain,  with q(0 0 1/2) wavevector. (see test.si.chain of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2. Use the x-only PBE functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.10691 Ha while finite differences gives : with delta(xred)=0.0002,  189.10790 Ha with delta(xred)=0.0001,  189.10703 Ha . Combining the results gives 189.10675 Ha. The agreement is quite good,  and might likely be improved by increasing tolvrs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Generate the data for optic (linear and non-linear coefficients). to be analysed in the test 57." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t56.in" target="_blank">t56.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="NaCl molecule in a big box. Test of the computation of the polarisation with the routine berryphase_new, for different k-point grids : only 1 k-point,  a line of k-points,  and a full mesh of k-points. Results with acell 20 10 10 are : -9.727 C/m^2,  -9.975 C/m^2,  -9.503 C/m^2 multiplied by the volume (in a.u.),  gives -19454,  -19950,  -19006 Test provided by S. Leroux Going to bigger cells make these results converge to the same value : Results with acell 30 20 20 are : -1.771 C/m^2,  -1.746 C/m^2,  -1.747 C/m^2 multiplied by the volume (in a.u.),  gives -21252,  -20952,  -20964 Results with acell 40 20 20 are : -1.3167C/m^2,  -1.3057C/m^2,  -1.3062C/m^2 multiplied by the volume (in a.u.),  gives -21067,  -20891,  -20899 Results with acell 50 20 20 are : -1.0502C/m^2,  -1.0444C/m^2,  -1.0450C/m^2 multiplied by the volume (in a.u.),  gives -21004,  -20888,  -20900" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of berrystep Al-As cristal,  zinc-blende structure Compute the polarization along strings of k-points parallel to the primitive vectors of the reciprocal lattice,  and using multiple step berry phase calculation. (Tests 21-30 are related to geometry optimization,  molecular dynamics,  etc) Cannot be executed in parallel: chkint_prt: ERROR - Context : the value of the variable nproc is 2. The value of the input variable berrystep is 5,  while it must be equal to 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t20.in" target="_blank">t20.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone. Use the definition through qptrlatt. Otherwise,  similar to Tv2#26 and Tv6#78." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t35.in" target="_blank">t35.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon,  DDK computation to prepare 'optic'" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t41.in" target="_blank">t41.in</a>, <a class="wikilink abifile-wikilink" data-content="EuO rock salt structure. 20-electron PAW pseudo (4f in the core,  but 4d10 as semi-core : 4d10 5s2 5p6 (5d0) 6s2 ) Test of computation of dielectric tensor,  Born effective charges,  dynamical matrix. To keep the CPU time to a reasonable level,  the responses are computed with minimal parameters (nstep and the kpoint grid are too small, ecut might be increased,  and also pawecutdg). Note: Charge neutrality is not achieved with the present dataset for Born Effective Charges, but can be easily reached by increasing some parameters;  for instance: (ngkpt 6 6 6,   ecut 40. pawecutdg 40.) gives Z(Eu)=2.5085,  Z(O)=-2.4982" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t43.in" target="_blank">t43.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="Response of magnetic metal to external magnetic field. First,  ground state wf is computed,  then dfpt calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t20.in" target="_blank">t20.in</a>, <a class="wikilink abifile-wikilink" data-content="WARNING: This code is still under development. Use at your own risk! Preparatory run for the calculation of the Fan-Migdal + Debye-Waller self-energy C in diamond structure. Very rough 2x2x2 q-point grid (3 qpoints);  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t41.in" target="_blank">t41.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Silicon: Solution of optic with temperature-dependent renormalization WARNING: This feature is still under testing,  files and variables could change in the next versions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t52.in" target="_blank">t52.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="PAW response function calculation of derivative of wavefunction (DDK) Si with PAW dataset generated from uspp code. Computes derivative with DFPT formalism,  and also computes energies with displaced k+q so that energies can be checked by finite differences." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="PbFCl in the matlockite structure P4/nmm. 6 atoms per cell. Compute a set of matrix elements of the dynamical matrix, for q wavevector 0.5 0.5 0.5 . In this test case,  the symmetry operations have an important non-symmorphic character. There was a bug in the treatment of this material,  prior to v5.2.4 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in Zincblende structure. Test calculation of the Born effective charge and dielectric constant tensor at finite electric fields. The first dataset is for normal ground-state calculation at zero electric field. The second dataset is for ground-state calculation at finite electric field. The final datasetis the linear-response calculation at finite electric field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t23.in" target="_blank">t23.in</a> &hellip;</li></ul></details><p>Gives the directions to be considered for response function calculations (also
for the Berry phase computation of the polarization, see the <a class="wikilink codevar-wikilink" href="../ffield#berryopt">berryopt</a>
input variable).<br />
The three elements corresponds to the three primitive vectors, either in real
space (phonon calculations), or in reciprocal space (d/dk, homogeneous
electric field, homogeneous magnetic field calculations). So, they generate a
basis for the generation of the dynamical matrix or the macroscopic dielectric
tensor or magnetic susceptibility and magnetic shielding, or the effective
charge tensors.<br />
If equal to 1, response functions, as defined by <a class="wikilink codevar-wikilink" href="../dfpt#rfddk">rfddk</a>, <a class="wikilink codevar-wikilink" href="../dfpt#rfelfd">rfelfd</a>,
<a class="wikilink codevar-wikilink" href="../dfpt#rfphon">rfphon</a>, <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a> and <a class="wikilink codevar-wikilink" href="../dfpt#rfatpol">rfatpol</a>, are to be computed for the
corresponding direction. If 0, this direction should not be considered.</p>
<h2 id="rfelfd"><strong>rfelfd</strong><a class="headerlink" href="#rfelfd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to the ELectric FielD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform an effective mass calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/EffMass">topic_EffMass</a>, <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [85/920] in all abinit tests, [14/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of various XC functionals for the response functions (thus,  the XC kernel is also tested). The test includes 3 different functionals: 1) Perdew-Zunger: ixc=2 and ixc=-001009 2) PBE: ixc=11 and ixc=-101130 3) Perdew-Wang92: ixc=7,  ixc=-001012,  and ixc=-001013 The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting some lines indicated by GMR. Note that the underlying FFT grid does not have the symmetry of the lattice." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t81.in" target="_blank">t81.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of the Perdew-Zunger XC functionals for the response functions (thus,  the XC kernel is also tested) in PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t82.in" target="_blank">t82.in</a> &hellip;</li><li>seq:  <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  2 special points;  low ecut. With a 4x4x4 k point grid (!only one shift,  but OK because symmetry is imposed),  compute the dielectric constant by two different techniques" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv3_05.in" target="_blank">tsv3_05.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs linear response with NC. Test the parallelisation on perturbations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t69.in" target="_blank">t69.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Response function calculation for: * rigid-atom elastic tensor * rigid-atom piezoelectric tensor * interatomic force constants at gamma * Born effective charges" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_2.in" target="_blank">telast_2.in</a>, <a class="wikilink abifile-wikilink" data-content="the sequence of datasets makes the ground states and all of the explicit perturbations of the single Al atom in all directions,  for the irreducible qpoints in a 2x2x2 grid. Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/teph_1.in" target="_blank">teph_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear and nonlinear response calculation for AlAs Perturbations: electric fields &amp;amp; atomic displacements" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tnlo_2.in" target="_blank">tnlo_2.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs in zinc-blende structure;  GS and RF calculation (similar to test v2 #30,  except that only two q points are considered) the 5-th dataset compute 3DTE. localrdwf=1 Also check parallelism for Raman calculations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t54.in" target="_blank">t54.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Si2 molecules (2 atoms per unit cell), using a separable pseudopotential,  with ixc=3. Computation of the second derivatives of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector,  as well as to an homogeneous electric field. The computed derivatives include the mixed derivative wrt the two perturbations. (see test.si.elfd of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="Si crystal (diamond structure),  2 atoms per unit cell. Computation of responses to atomic displacements and homogeneous electric field at Gamma, giving access to the dynamical matrix at q(0 0 0),  including its non-analytical behaviour (effective charges do not vanish completely due to lack of convergence), the associated phonon frequencies,  and the macroscopic dielectric constant. (see test.si.gamma of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for GaAs (zinc-blende). Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone, in test 32. The chosen grid (too coarse,  though) has only two special q points : 1/4 1/4 1/4 and 1/4 1/2 1/2 (in reduced coordinates). The Gamma point is also needed,  especially for the computation of dielectric matric and effective charges,  needed to get the asymptotic behaviour of the interatomic force constants. To generate the different responses,  the following steps are followed, with each of them corresponding to a different dataset (the multi-dataset mode allows to have only one input file) : 1) ground state calculation,  with a k-point sampling in the irreducible Brillouin zone only; 2) using the density of 1),  computation of the wavefunctions for the grid of k-points in the full Brillouin zone;  (not really needed in v3.0) 3) computation of the ddk response,  in preparation to the electric field response; 4) computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; 5) using the density of 1),  computation of the GS wavefunctions at k+q where q is 1/4 1/4 1/4; 6) computation of the dynamical matrix at 1/4 1/4 1/4; 7) using the density of 1),  computation of the GS wavefunctions at k+q where q is 1/4 1/2 1/2; 8) computation of the dynamical matrix at 1/4 1/2 1/2 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t30.in" target="_blank">t30.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="FCC Yb (1 atom per unit cell), using a l=3 psp with s local part. Crazy cut-off and number of k points. Shows that the derivative of the eigenenergies with respect to the wavevector can be obtained both by finite differences and analytical means (from a preliminary computation in the treatment of the ddk perturbation). For the (0.25, 0.25, 0.25) k point, the tenth band eigenvalue is -3.01209 eV. Going to the (0.251, 0.251, 0.251) k point it becomes -3.00562 eV,  with finite-difference estimation of the derivative with respect to ONE wavevector change (all three components changed) being 0.00647 eV/0.001/3=2.157 eV This value is unchanged when using the data at the (0.253, 0.253, 0.253) k point. The analytical value is 2.15566 eV." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t09.in" target="_blank">t09.in</a>, <a class="wikilink abifile-wikilink" data-content="Si crystal. GGA + non-linear XC core correction. Compute the interatomic force constant for the displacement of the second atom along (111). RF calculation of the 2DTE gives 7.51663417 Ha while finite differences gives: with delta(xred)=0.0001,  7.15663267 Ha. The agreement is quite good,  and might likely be improved by combining finite differences. Also compute the ddk and electric field responses. The number of k points is much too small to obtain physical values,  but are quite comparable to the result of test v2 #6" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t16.in" target="_blank">t16.in</a>, <a class="wikilink abifile-wikilink" data-content="BaO crystal. Computation of band-by-band decomposition of Born effective charges. Also,  computation of the electronic localization tensor, and its band-by-band decomposition." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t77.in" target="_blank">t77.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Generate the data for optic (linear and non-linear coefficients). to be analysed in the test 57." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t56.in" target="_blank">t56.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="PAW response function calculation of derivative of wavefunction (DDK) Si with PAW dataset generated from uspp code. Computes derivative with DFPT formalism,  and also computes energies with displaced k+q so that energies can be checked by finite differences." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in Zincblende structure. Test calculation of the Born effective charge and dielectric constant tensor at finite electric fields. The first dataset is for normal ground-state calculation at zero electric field. The second dataset is for ground-state calculation at finite electric field. The final datasetis the linear-response calculation at finite electric field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t23.in" target="_blank">t23.in</a>, <a class="wikilink abifile-wikilink" data-content="GeTe in rhombohedral structure Test the computation of phonons,  dielectric tensor and Born effective charges,  with and without spin-orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t24.in" target="_blank">t24.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by tutorespfn/trf2 tutorial. Ground state is computed. DDK is computed. Dielectric tensor is computed. Phonon modes at q=0 are computed. Phonons modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t63.in" target="_blank">t63.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized Over 1200 WARNINGS. This test must give the same results of the test 63" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t64.in" target="_blank">t64.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Silicon,  DDK computation to prepare 'optic'" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t41.in" target="_blank">t41.in</a>, <a class="wikilink abifile-wikilink" data-content="EuO rock salt structure. 20-electron PAW pseudo (4f in the core,  but 4d10 as semi-core : 4d10 5s2 5p6 (5d0) 6s2 ) Test of computation of dielectric tensor,  Born effective charges,  dynamical matrix. To keep the CPU time to a reasonable level,  the responses are computed with minimal parameters (nstep and the kpoint grid are too small, ecut might be increased,  and also pawecutdg). Note: Charge neutrality is not achieved with the present dataset for Born Effective Charges, but can be easily reached by increasing some parameters;  for instance: (ngkpt 6 6 6,   ecut 40. pawecutdg 40.) gives Z(Eu)=2.5085,  Z(O)=-2.4982" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t43.in" target="_blank">t43.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  2 special points;  low ecut. With a 4x4x4 k point grid (!only one shift,  but OK because symmetry is imposed),  compute the dielectric constant with a scissor . Note that the fulfilment of the charge neutrality sum rule,  already broken without a scissor operator,  is strongly affected by a scissor" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t46.in" target="_blank">t46.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a> &hellip;</li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Silicon: Solution of optic with temperature-dependent renormalization WARNING: This feature is still under testing,  files and variables could change in the next versions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v67mbpt/Input/t52.in" target="_blank">t52.in</a> &hellip;</li></ul></details><p>Turns on electric field response function calculations. Actually, such
calculations requires first the non-self-consistent calculation of derivatives
with respect to k, independently of the electric field perturbation itself.</p>
<ul>
<li>0=&gt;no electric field perturbation </li>
<li>1=&gt;full calculation, with first the derivative of ground-state wavefunction with respect to k (d/dk calculation), by a non-self-consistent calculation, then the generation of the first-order response to an homogeneous electric field </li>
<li>2=&gt;only the derivative of ground-state wavefunctions with respect to k </li>
<li>3=&gt;only the generation of the first-order response to the electric field, assuming that the data on derivative of ground-state wavefunction with respect to k is available on disk. </li>
</ul>
<p>(Note : because the tolerances to be used for derivatives or homogeneous
electric field are different, one often does the calculation of derivatives in
a separate dataset, followed by calculation of electric field response as well
as phonon.<br />
The options 2 and 3 proves useful in that context ; also, in case a scissor
shift is to be used, it is usually not applied for the d/dk response).</p>
<h2 id="rfmagn"><strong>rfmagn</strong><a class="headerlink" href="#rfmagn" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to MAGNetic B-field perturbation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v8:  <a class="wikilink abifile-wikilink" data-content="Response of magnetic metal to external magnetic field. First,  ground state wf is computed,  then dfpt calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t20.in" target="_blank">t20.in</a></li></ul></details><p>It must be equal to 1 to run response function calculations with respect to
external magnetic field. Currently, orbital magnetism is not taken into
account and the perturbing potential has Zeeman form.</p>
<h2 id="rfmeth"><strong>rfmeth</strong><a class="headerlink" href="#rfmeth" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function METHod<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/920] in all abinit tests, [0/116] in abinit tutorials</summary></details><p>Selects method used in response function calculations. Presently, only 1 is
allowed.</p>
<h2 id="rfphon"><strong>rfphon</strong><a class="headerlink" href="#rfphon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to PHONons<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [164/920] in all abinit tests, [18/116] in abinit tutorials</summary><ul><li>libxc:  <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of various XC functionals for the response functions (thus,  the XC kernel is also tested). The test includes 3 different functionals: 1) Perdew-Zunger: ixc=2 and ixc=-001009 2) PBE: ixc=11 and ixc=-101130 3) Perdew-Wang92: ixc=7,  ixc=-001012,  and ixc=-001013 The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting some lines indicated by GMR. Note that the underlying FFT grid does not have the symmetry of the lattice." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t81.in" target="_blank">t81.in</a>, <a class="wikilink abifile-wikilink" data-content="Silicon Test the equivalence between the internal and LibXC implementations of the Perdew-Zunger XC functionals for the response functions (thus,  the XC kernel is also tested) in PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/libxc/Input/t82.in" target="_blank">t82.in</a> &hellip;</li><li>seq:  <a class="wikilink abifile-wikilink" data-content="CrystallIne AlAs first three runs are for calculation of ground state at finite electric field the fourth run gets the gs wavefunction and then do response calculation the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/seq/Input/tsv4_80.in" target="_blank">tsv4_80.in</a> &hellip;</li><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  NC pseudos. Test the IO routines for a typical DFPT calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="This test check the parallelization over atomic sites both for the ground state and response function features (within PAW formalism),  together with parallelization over perturbations. Computation of phonons and response to electric field within PAW (both q=0 and q/=0) Test on AlAs structure inspired by v6/t62. Ground state,  DDK,  effective charges and dielectric tensor are computed. Phonon modes at q=0 are computed. Phonon modes at q=(1/4, 0, 0) and q=(-1/4, 1/2/1/4) are computed. Note: Charge neutrality is not achieved with the present dataset, but can be easily reached by increasing some parameters;  for instance: (ngkpt 8 8 8,  ecut 15.,  pawecutdg 30.) gives Z(Al)=2.1184310,  Z(As)=-2.1184804" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/mpiio/Input/t62.in" target="_blank">t62.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="FCC Al metallic;  10 phonon at 1/4 1/8 1/8" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t53.in" target="_blank">t53.in</a>, <a class="wikilink abifile-wikilink" data-content="FCC Al metallic;  10 phonon at 1/4 1/8 1/8" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t53.in" target="_blank">t53.in</a>, <a class="wikilink abifile-wikilink" data-content="FCC Al metallic;  10 phonon at 1/4 1/8 1/8" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t53.in" target="_blank">t53.in</a> &hellip;</li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. (see test.ge.xc0 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, with exchange-correlation (ixc=3). Uses 2 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Same as test 1,  except ixc and the k-points,  and except that it doesn't uses multi-data mode,  so GS and RF calculations are separated. (see test.ge.xc5 of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t03.in" target="_blank">t03.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Si2 molecules (2 atoms per unit cell), using a separable pseudopotential,  with ixc=3. Computation of the second derivative of the total energy with respect to a atomic displacement perpendicular to the chain,  with q(0 0 1/2) wavevector. (see test.si.chain of RESPFN)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v2/Input/t04.in" target="_blank">t04.in</a> &hellip;</li><li>v3:  <a class="wikilink abifile-wikilink" data-content="Bi A7 structure (2 atoms per unit cell), using the HGH pseudopotential,  within LDA. Fixed cell dimensions. Treated as a semi-conductor Test the response to atomic displacements, with and without spin-orbit. Perform first computation without spin-orbit. Datasets 1-3 : frozen-phonon,  without SO Datasets 4 : RF,  without SO the comparison between frozen-phonon from dataset 1 and 3 (2DTE=2.35465660) and RF from dataset 4(2DTE=2.35465792) is excellent. Dataset 5 : GS,  with nspinor=2,  but no spin-orbit yet. Dataset 6 : RF,  with nspinor=2,  but no spin-orbit yet. The agreement with nspinor=1 RF is excellent. Dataset 7-9 : frozen-phonon with spin-orbit Dataset 10 : RF with spin-orbit. The agreement is as good as without spin-orbit ! Frozen-phonon 2DTE=2.48156, RF 2DTE=2.48156 . NOTE : the old t02.in file,  which was giving troubles in v3.1.2 is now called t02a.in" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear chain of Ge2 molecules (2 atoms per unit cell), using a local (Starkloff-Joannopoulos) pseudopotential, and no exchange-correlation (ixc=0). Uses 4 k-points. Computation of the second derivative of the total energy with respect to a atomic displacement along the chain, with q(0 0 0) wavevector. Similar to test v2 #1,  except that it uses dilatmx=1.1 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="H2 molecule,  using a local pseudopotential,  and GGA. Similar to test 33 of v2. Use the x-only PBE functional. Compute the interatomic force constant for the displacement of the second atom along x. RF calculation of the 2DTE gives 189.10691 Ha while finite differences gives : with delta(xred)=0.0002,  189.10790 Ha with delta(xred)=0.0001,  189.10703 Ha . Combining the results gives 189.10675 Ha. The agreement is quite good,  and might likely be improved by increasing tolvrs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v3/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98). Compute responses at Gamma: 1) Ground state calculation,  with a k-point sampling in the IBZ only; 2) Computation of the ddk response; 3) Computation of the dynamical matrix at Gamma,  as well as the Born effective charges,  and the dielectric tensor; Perform five datasets: * First dataset is the ground state calculation, * Second dataset compute ddk perturbation with the use of Legendre Polynomials for the nl operator, * Third dataset compute phonon and elec. field perturbation with the use of Legendre Polynomials for the nl operator, * Fourth dataset compute ddk perturbation with the use of spherical harmonics for the nl operator, * Fifth dataset compute phonon and elec. field perturbation with the use of spherical harmonics for the nl operator. Datasets 2 and 3 must give the same results as 4 and 5." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t02.in" target="_blank">t02.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 53 and 54." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t52.in" target="_blank">t52.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the the effect of the first-order Fermi energy on a Q=0 phonon calculation in metals. The example is for a hypothetical intermetallic compound MgAl2, in a structure which can be thought of as fcc Al with every third (111) layer replaced by Mg.  Technically,  this is the hexagonal CdI2 structure,  space group #164,  P-3 m 1.  For this case,  neglect of this contribution yields approximately a 2% error in the largest interatomic force constants.  Its effect on many force constants for this system cancels because of symmetry.  This calculation is not particularly well converged,  especially with respect to k sample.  A well-converged version is in excellent agreement with interatomic force constants calculated by numerical differentiation of ground-state forces." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t60.in" target="_blank">t60.in</a> &hellip;</li><li>tutoparal:  <a class="wikilink abifile-wikilink" data-content="BaTiO3 linear response calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutoparal/Input/tdfpt_04.in" target="_blank">tdfpt_04.in</a> &hellip;</li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Generate first-order responses for FCC Aluminum. Very low cut-off,  to keep CPU the lowest possible Aim at a regular sampling of phonon wavevectors,  needed to interpolate the dynamical matrix over the whole Brillouin Zone. Use the definition through qptrlatt. Otherwise,  similar to Tv2#26 and Tv6#78." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t35.in" target="_blank">t35.in</a>, <a class="wikilink abifile-wikilink" data-content="ZrO2 FCC (fluorite structure). Compute the phonon frequencies at the X point. This worked correctly before 5.2.4,  but then,  an erroneous bug fix (correcting v5#21) was introduced. Final (correct) fixing in v6.0.4. (Contributed by I. Lukacevic,  trying to reproduce results by Detraux et al 1997)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t36.in" target="_blank">t36.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . Warning : only valid for Gamma,  AND the temperature-dependent shifts must be averaged over degenerate states." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t37.in" target="_blank">t37.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="EuO rock salt structure. 20-electron PAW pseudo (4f in the core,  but 4d10 as semi-core : 4d10 5s2 5p6 (5d0) 6s2 ) Test of computation of dielectric tensor,  Born effective charges,  dynamical matrix. To keep the CPU time to a reasonable level,  the responses are computed with minimal parameters (nstep and the kpoint grid are too small, ecut might be increased,  and also pawecutdg). Note: Charge neutrality is not achieved with the present dataset for Born Effective Charges, but can be easily reached by increasing some parameters;  for instance: (ngkpt 6 6 6,   ecut 40. pawecutdg 40.) gives Z(Eu)=2.5085,  Z(O)=-2.4982" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t43.in" target="_blank">t43.in</a>, <a class="wikilink abifile-wikilink" data-content="This tests uses psps8 files with model core charges and valence charge densities. We test the initialization of rhor1,  rhog1 from atomic quantities and the treatment of the non-linear core correction in G-space (nc_xccc_gspace)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t45.in" target="_blank">t45.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . The temperature-dependent shifts must be averaged over degenerate states. This temperature-dependent calculation make use of a k-point interpolation to speed up the convergence study with respect to the q-points integration. Two q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t50.in" target="_blank">t50.in</a> &hellip;</li><li>v8:  <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="WARNING: This code is still under development. Use at your own risk! Preparatory run for the calculation of the Fan-Migdal + Debye-Waller self-energy C in diamond structure. Very rough 2x2x2 q-point grid (3 qpoints);  low ecut." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t41.in" target="_blank">t41.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Code abinit (gstate+respfn+nonlinear) Generate the linear and non-linear coefficients,  in two DDBs, to be merged and analysed in the tests 48,  49 and 50." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t47.in" target="_blank">t47.in</a> &hellip;</li><li>gpu:  <a class="wikilink abifile-wikilink" data-content="GaAs phonons calculation - norm-conserving psp Test the automatic detection of the GPU and the automatic setting of use_gpu_cuda keyword according to the requested calculation. Ground-states calculations should be run with use_gpu_cuda activated (except if set to 0 in input file) while response fonction calculations should be run with use_gpu_cuda deactivated (at present : ABINIT v7.0)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/gpu/Input/t01.in" target="_blank">t01.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="PbFCl in the matlockite structure P4/nmm. 6 atoms per cell. Compute a set of matrix elements of the dynamical matrix, for q wavevector 0.5 0.5 0.5 . In this test case,  the symmetry operations have an important non-symmorphic character. There was a bug in the treatment of this material,  prior to v5.2.4 ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t21.in" target="_blank">t21.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in Zincblende structure. Test calculation of the Born effective charge and dielectric constant tensor at finite electric fields. The first dataset is for normal ground-state calculation at zero electric field. The second dataset is for ground-state calculation at finite electric field. The final datasetis the linear-response calculation at finite electric field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t23.in" target="_blank">t23.in</a>, <a class="wikilink abifile-wikilink" data-content="GeTe in rhombohedral structure Test the computation of phonons,  dielectric tensor and Born effective charges,  with and without spin-orbit coupling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t24.in" target="_blank">t24.in</a> &hellip;</li></ul></details><p>It must be equal to 1 to run phonon response function calculations.</p>
<h2 id="rfstrs"><strong>rfstrs</strong><a class="headerlink" href="#rfstrs" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function with respect to STRainS<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a>, <a class="wikilink topic-wikilink" data-content="How to compute elastic, piezoelectric and internal strain tensors from DFPT" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/Elastic">topic_Elastic</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [26/920] in all abinit tests, [5/116] in abinit tutorials</summary><ul><li>v8:  <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v8/Input/t07.in" target="_blank">t07.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. Finite-difference runs with strain component 1 (1def) is computed DFPT is computed Comparaison with Finite Diferrences give excellent agreement ~1e-5% DFPT is computed with usexcnhat==0 (Just for test)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t95.in" target="_blank">t95.in</a>, <a class="wikilink abifile-wikilink" data-content="MG Note that this test fails with np=4,  wrong results or SIGSEV (np=2 is ok). Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. Finite-difference runs with strain direction 1   is computed Finite-difference runs with atom displacement 1  is computed DFPT is computed Comparaison with Finite Diferrences give excellent agreement DFPT is computed with usexcnhat==0 (Just for test)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t96.in" target="_blank">t96.in</a>, <a class="wikilink abifile-wikilink" data-content="Computation of the elastic constants and internal strains for distorded h-BN (to get non-zero internal strains) vdW-DFT-D3 corrections with Becke-Jonhson damping (DFT-D3(BJ)) Only the pair-wise is computed (3-body term not implemented) In this test the following properties are thus tested: contribution to the energy and to the stress of DFT-D3(BJ) as well as the contribution to the elastic constants and internal strains" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t99.in" target="_blank">t99.in</a> &hellip;</li><li>v4:  <a class="wikilink abifile-wikilink" data-content="Test of the strain perturbation with the GGA Note that this test and the following one,  59, address more advanced features of strain perturbation than the ones going with number 60 to 79,  and were developed later,  but were placed here for convenience). AlAs in the zincblende structure,  with a choice of pseudopotenials that include model core charges.  In the LDA,  the strain perturbation simply introduces perturbing charge densities leading to perturbing first-order potentials in a straightforward manner.  (This perturbation does act differently on the valence and model core charges.)   The GGA is a non-trivial extension, since strain perturbs the gradient operator itself.  This test is a symmetrized and stripped-down version of a test case used in development which yielded agreement between such RF calculations and numerical derivatives of GS stresses and forces to 1.e-8 to 1.e-9 atomic units for the elastic tensor and intenal strain coupling parameters.  Acheiving this agreement does require forcing a considerably more dense fft grid than the default which is accepted here. (ngfft= 50 50 50 was used.)  While only the PBE GGA is tested here,  all forms present in Abinit should give comparably accurate results." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t58.in" target="_blank">t58.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the strain perturbation with GGA  and spin polarization This is the same as t79,  bcc Fe, but with the PBE GGA.  This calculation is restricted to one unaxial strain,  which adequately tests the polarization-dependent parts of the strain GGA code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of the strain perturbation. Si in the usual diamond structrure using a Troullier-Martins potential including a model core charge.  The datasets include an initial ground state run,  2 pairs of 5 ground state runs with incrementally strained lattice vectors rprim (xx and yz strains -0.00004,  -0.00002,  0,  0.00002,  0.00004), and one response function run for the strain 2nd derivatives. This set is illustrative of the kind of testing used extensively in developing the strain perturbation portions of the code. The numerical 2nd derivatives of the energy wrt strains were computed by applying a 5-point derivative formula to ucvol*sigma(i, j), where the sigmas are the stresses calculated in the series of ground state calculations.  These agree with the analytic 2nd derivatives calculated in the response function run to ~1.E-7 for the data given here.  The cartesian internal strain (mixed second derivative wrt strain and atomic coordinate) agrees to ~1E-8. Note that such numerical tests of the internal strain are only valid if the forces are zero (relaxed or by symmetry).  Otherwise,  the reduced-coordinate 2nd derivatives must be used for such tests because the conversion to cartesian coordinates is itself strain- dependent and will introduce changes in the computed derivatives. In the actual development tests,  stricter converence criteria were used (tolvrs=1.E-24) as well as larger cutoffs,  and agreement was obtained at the 1.E-9 level.  The model core charge contributes the largest component of the error. ADDITIONAL NOTE : It should be noted that numerical derivative tests of the internal strain should be done by comparing the &amp;quot;2nd-order matrix&amp;quot; with numerical strain derivatives of the gradients wrt reduced atomic coordinates. These are not normally part of the GS output,  but can be obtained by uncommenting the DEBUG section at the end of prtxf.F90. Comparisons between numerical strain derivatives of the cartesian forces and the cartesian internal strain tensor will be incorrect unless the coordinates have been relaxed and the forces are zero within a tight tolerance." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v4/Input/t61.in" target="_blank">t61.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Response function calculation for: * rigid-atom elastic tensor * rigid-atom piezoelectric tensor * interatomic force constants at gamma * Born effective charges" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_2.in" target="_blank">telast_2.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Alternative response function calculation for some rigid-atom piezoelectric tensor elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_5.in" target="_blank">telast_5.in</a>, <a class="wikilink abifile-wikilink" data-content="Al fcc metal - elastic constant calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/telast_6.in" target="_blank">telast_6.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t95.in" target="_blank">t95.in</a>, <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t95.in" target="_blank">t95.in</a>, <a class="wikilink abifile-wikilink" data-content="Computation of elastic tensor and internal strain in DFPT+PAW Ground state is computed. DFPT is computed" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t95.in" target="_blank">t95.in</a> &hellip;</li></ul></details><p>Used to run strain response-function calculations (e.g. needed to get elastic
constants). Define, with <a class="wikilink codevar-wikilink" href="../dfpt#rfdir">rfdir</a>, the set of perturbations.</p>
<ul>
<li>0=&gt;no strain perturbation </li>
<li>1=&gt;only uniaxial strain(s) (ipert=natom+3 is activated) </li>
<li>2=&gt;only shear strain(s) (ipert=natom+4 is activated) </li>
<li>3=&gt;both uniaxial and shear strain(s) (both ipert=natom+3 and ipert=natom+4 are activated) </li>
</ul>
<p>See the possible restrictions on the use of strain perturbations, in the <a href="../../../users/generated_files/help_respfn.html#1">
respfn help file </a> .</p>
<h2 id="rfuser"><strong>rfuser</strong><a class="headerlink" href="#rfuser" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Response Function, USER-defined<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to generically perform DFPT calculations" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/DFPT">topic_DFPT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [0/920] in all abinit tests, [0/116] in abinit tutorials</summary></details><p>Available to the developpers, to activate the use of ipert=natom+6 and
ipert=natom+7, two sets of perturbations that the developpers can define.  </p>
<ul>
<li>0=&gt;no computations for ipert=natom+6 or ipert=natom+7 </li>
<li>1=&gt;response with respect to perturbation natom+6 will be computed </li>
<li>2=&gt;response with respect to perturbation natom+7 will be computed </li>
<li>3=&gt;responses with respect to perturbations natom+6 and natom+7 will be computed </li>
</ul>
<p>In order to define and use correctly the new perturbations, the developper
might have to include code lines or additional routines at the level of the
following routines : dfpt_cgwf.F90, dfpt_dyout.F90, dfpt_symph.F90,
dfpt_dyout.F90, dfpt_etot.F90, littlegroup_pert.F90, dfpt_looppert.F90,
dfpt_mkcor.F90, dfpt_nstdy.F90, dfpt_nstwf.F90, respfn.F90, dfpt_scfcv.F90,
irreducible_set_pert.F90, dfpt_vloca.F90, dfpt_vtorho.F90, dfpt_vtowfk.F90. In
these routines, the developper should pay a particular attention to the rfpert
array, defined in the routine respfn.F90 , as well as to the ipert local
variable.</p>
<h2 id="smdelta"><strong>smdelta</strong><a class="headerlink" href="#smdelta" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SMeared DELTA function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to calculate the temperature dependence of the electronic structure" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [25/920] in all abinit tests, [3/116] in abinit tutorials</summary><ul><li>v6:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . Warning : only valid for Gamma,  AND the temperature-dependent shifts must be averaged over degenerate states." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t37.in" target="_blank">t37.in</a>, <a class="wikilink abifile-wikilink" data-content="He BCC primitive cell. Fake smooth pseudopotential. For testing the electron-phonon modification of the electronic structure. To be compared with the results of tests 51 to 59. Use a 2x2x2 grid of k (shifted) and q (non-shifted) points. No imaginary frequences for the phonons with this choice. Computation of the electronic eigenvalues as well as phonon eigenfrequencies, and corresponding ingredients for the computation of the electron-phonon effect,  in the next tests 51-53." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t50.in" target="_blank">t50.in</a>, <a class="wikilink abifile-wikilink" data-content="He BCC conventional cell. Fake smooth pseudopotential. For testing the electron-phonon modification of the electronic structure. To be compared with the results of tests 50 to 59. Use a FCC grid of k (shifted) and q (non-shifted) points. No imaginary frequences for the phonons with this choice. Computation of the electronic eigenvalues as well as phonon eigenfrequencies, and corresponding ingredients for the computation of the electron-phonon effect,  in the next tests 55-57." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v6/Input/t54.in" target="_blank">t54.in</a> &hellip;</li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Diamond. Test temperature-dependent of the electronic structure,  with reduction of the number of q points to be computed,  thanks to thmflag=7 . The temperature-dependent shifts must be averaged over degenerate states. This temperature-dependent calculation make use of a k-point interpolation to speed up the convergence study with respect to the q-points integration. Two q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t50.in" target="_blank">t50.in</a>, <a class="wikilink abifile-wikilink" data-content="This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the previous test. The third q-point is computed here." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond. Diamond dynamical temperature-dependent of the electronic structure. Three q-points are computed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v7/Input/t55.in" target="_blank">t55.in</a> &hellip;</li><li>v5:  <a class="wikilink abifile-wikilink" data-content="Crystalline Silicon Test the computation of second order eigenvalues for two qpoints,  (0 0 0) and (1/2 0 0),  contained in the EIGR2D files. Parameters are far from convergence,  nband=5 and nkpt=16." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v5/Input/t26.in" target="_blank">t26.in</a> &hellip;</li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_1.in" target="_blank">tdepes_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_3.in" target="_blank">tdepes_3.in</a>, <a class="wikilink abifile-wikilink" data-content="Temperature dependence calculation of diamond." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/tutorespfn/Input/tdepes_4.in" target="_blank">tdepes_4.in</a> &hellip;</li><li>paral:  <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a>, <a class="wikilink abifile-wikilink" data-content="Calculation of the electron-phonon band structure renormalisation for Diamond, due to the phonon at the Gamma point. The computation with ecut=20 Ha and elph2_imagden 0.0 gives 24.482 meV for the HOMO shift at Gamma,  while the finite-difference of phonon frequencies gives 28.975 meV,  in excellent agreement with frozen-phonon changes of HOMO eigenenergy. The difference is due to the Non-Site-Diagonal Debye-Waller contribution,  that was explicitly obtained by a finite-difference approach." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/paral/Input/t59.in" target="_blank">t59.in</a> &hellip;</li></ul></details><p>When <a class="wikilink codevar-wikilink" href="../dfpt#smdelta">smdelta</a> in non-zero, it will trigger the calculation of the imaginary
part of the second-order electronic eigenvalues, which can be related to the
electronic lifetimes. The delta function is evaluated using:  </p>
<ul>
<li>when <a class="wikilink codevar-wikilink" href="../dfpt#smdelta">smdelta</a> == 1, Fermi-Dirac smearing : 0.25_dp/(cosh(xx/2.0_dp)**2 </li>
<li>when <a class="wikilink codevar-wikilink" href="../dfpt#smdelta">smdelta</a> == 2, Cold smearing by Marzari using the parameter a=-.5634 (minimization of the bump): exp(-xx2)/sqrt(pi) * (1.5d0+xx*(-a*1.5d0+xx*(-1.0d0+a*xx))) </li>
<li>when <a class="wikilink codevar-wikilink" href="../dfpt#smdelta">smdelta</a> == 3, Cold smearing by Marzari using the parameter a=-.8165 (monotonic function in the tail): as 2 but different a </li>
<li>when <a class="wikilink codevar-wikilink" href="../dfpt#smdelta">smdelta</a> == 4, Smearing of Methfessel and Paxton (PRB40,3616(1989)) with Hermite polynomial of degree 2, corresponding to &ldquo;Cold smearing&rdquo; of N. Marzari with a=0 (so, same smeared delta function as smdelta=2, with different a). </li>
<li>when <a class="wikilink codevar-wikilink" href="../dfpt#smdelta">smdelta</a> == 5, Gaussian smearing : 1.0d0*exp(-xx**2)/sqrt(pi) </li>
</ul>
<h2 id="td_maxene"><strong>td_maxene</strong><a class="headerlink" href="#td_maxene" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Time-Dependent dft : MAXimal kohn-sham ENErgy difference<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform time-dependent density-functional theory calculations of neutral
excitation energies" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/TDDFT">topic_TDDFT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v1:  <a class="wikilink abifile-wikilink" data-content="Excited states of the Mg atom,  with (ixc=1,  spin-polarized Teter functional). Use the multi-dataset mode. Can be compared with the results in Vasiliev et al,  PRL 82,  1919 (1999). With the values acell 18,  ecut 3.5,  nband2 10,  the present test generates KS diff=3.46eV,  TDLDA(1S1P)=4.48eV,  TDLDA(1S3P)=2.81eV With the values acell 22,  ecut 3.5,  nband2 22,  ABINIT generates KS diff=3.40eV,  TDLDA(1S1P)=4.35eV,  TDLDA(1S3P)=2.77eV Vasiliev gets KS diff=3.39eV,  TDLDA(1S1P)=4.34eV,  TDLDA(1S3P)=2.79eV" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t69.in" target="_blank">t69.in</a></li></ul></details><p>The Matrix to be diagonalized in the Casida framework (see &ldquo;Time-Dependent
Density Functional Response Theory of Molecular systems: Theory, Computational
Methods, and Functionals&rdquo;, by M.E. Casida, in Recent Developments and
Applications of Modern Density Functional Theory, edited by J.M. Seminario
(Elsevier, Amsterdam, 1996).) is a NxN matrix, where, by default, N is the
product of the number of occupied states by the number of unoccupied states.<br />
The input variable <a class="wikilink codevar-wikilink" href="../dfpt#td_maxene">td_maxene</a> allows to diminish N : it selects only the
pairs of occupied and unoccupied states for which the Kohn-Sham energy
difference is less than <a class="wikilink codevar-wikilink" href="../dfpt#td_maxene">td_maxene</a>. The default value 0.0 means that all
pairs are taken into account.<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#td_mexcit">td_mexcit</a> for an alternative way to decrease N.</p>
<h2 id="td_mexcit"><strong>td_mexcit</strong><a class="headerlink" href="#td_mexcit" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Time-Dependent dft : Maximal number of EXCITations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform time-dependent density-functional theory calculations of neutral
excitation energies" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../topics/TDDFT">topic_TDDFT</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v1:  <a class="wikilink abifile-wikilink" data-content="Excited states of the Mg atom,  with (ixc=1,  spin-polarized Teter functional). Use the multi-dataset mode. Can be compared with the results in Vasiliev et al,  PRL 82,  1919 (1999). With the values acell 18,  ecut 3.5,  nband2 10,  the present test generates KS diff=3.46eV,  TDLDA(1S1P)=4.48eV,  TDLDA(1S3P)=2.81eV With the values acell 22,  ecut 3.5,  nband2 22,  ABINIT generates KS diff=3.40eV,  TDLDA(1S1P)=4.35eV,  TDLDA(1S3P)=2.77eV Vasiliev gets KS diff=3.39eV,  TDLDA(1S1P)=4.34eV,  TDLDA(1S3P)=2.79eV" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../tests/v1/Input/t69.in" target="_blank">t69.in</a></li></ul></details><p>The Matrix to be diagonalized in the Casida framework (see &ldquo;Time-Dependent
Density Functional Response Theory of Molecular systems: Theory, Computational
Methods, and Functionals&rdquo;, by M.E. Casida, in Recent Developments and
Applications of Modern Density Functional Theory, edited by J.M. Seminario
(Elsevier, Amsterdam, 1996).) is a NxN matrix, where, by default, N is the
product of the number of occupied states by the number of unoccupied states.<br />
The input variable <a class="wikilink codevar-wikilink" href="../dfpt#td_mexcit">td_mexcit</a> allows to diminish N : it selects the first
<a class="wikilink codevar-wikilink" href="../dfpt#td_mexcit">td_mexcit</a> pairs of occupied and unoccupied states, ordered with respect to
increasing Kohn-Sham energy difference. However, when <a class="wikilink codevar-wikilink" href="../dfpt#td_mexcit">td_mexcit</a> is zero,
all pairs are allowed.<br />
See <a class="wikilink codevar-wikilink" href="../dfpt#td_maxene">td_maxene</a> for an alternative way to decrease N.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title="About"><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title="Developers"><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/wavefunctions/" data-toggle="tooltip" data-placement="left" 
                  title="Theory"><i class="fa fa-book"></i></a></li>
        
          <li><a href="../../tutorials/welcome/" data-toggle="tooltip" data-placement="left" 
                  title="Lessons"><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title="Variables"><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../user-guide/features/" data-toggle="tooltip" data-placement="left" 
                  title="Topics"><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title="User Guide"><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user-guide/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Variables" class="md-tabs__link md-tabs__link--active">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorials/welcome/" title="Lessons" class="md-tabs__link">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/wavefunctions/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../paw/" title="PAW" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                PAW
              </span>
            </div>
          </a>
        
        
          <a href="../rlx/" title="Relaxation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Relaxation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.5.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 The Abinit Group
          </div>
        

        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application-f3ab9e5ff8.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      
        <script src="../../extra_javascript/jquery.dialogextend.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
    
  </body>
</html>