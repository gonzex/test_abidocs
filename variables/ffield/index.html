
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="'ffield input variables'">
      
      
        <link rel="canonical" href="http://www.abinit.org/variables/ffield/">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="shortcut icon" href="../../images/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.8.1">
    
    
      
        <title>Varff - abinit</title>
      
    
    

    
      <script src="../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    

    <!-- Jquery from Google CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Bootstrap http://getbootstrap.com/getting-started/ -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" 
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" 
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
    </script>

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-bounce.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-corner-indicator.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flat-top.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-loading-bar.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-center-atom.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-flash.min.css" />
    -->

    <!-- MathJax support
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script> 
    -->
    <!--
    This is compatible with plotly.
    -->
    <script type="text/javascript" async 
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script> 

    <!--
    Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html
    -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          TeX: {
              equationNumbers: { autoNumber: "all" },
              extensions: ["AMSmath.js"],
              Macros: {
                  rr: "{\\bf r}",
                  GG: "{\\bf G}",
                  kk: "{\\bf k}",
                  qq: "{\\bf q}",
                  kq: "{\\kk + \\qq}"
              }
          }
      });
    </script>

    <!-- See http://docs.mathjax.org/en/latest/start.html 
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js", "MathMenu.js", "MathZoom.js"],
        jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    -->

    
    
    

    <!-- Load Ubuntu fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    <!-- 
    https://github.com/daneden/animate.css
    <link rel="stylesheet"
     href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    -->

    <!-- 
    https://github.com/IanLunn/Hover
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hover.css/2.1.1/css/hover-min.css" />
    -->



    
      <link rel="stylesheet" href="../../assets/stylesheets/application-bfecc7305d.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-02c2a4388f.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">

      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="http://www.abinit.org" title="abinit" class="md-logo md-header-nav__button">
            <img src="../../images/anna-logo-abinit-2015.svg" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Variables
                </span>
              
                <span class="md-header-nav__parent">
                  Abinit
                </span>
              
            
            Varff
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

          </div>
        </div>
      

      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="dropdown">
          <button class="btn btn-basic btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
            8.5.4
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            
            <li><a href="#">8.2.0</a></li>
            
            <li><a href="#">8.1.0</a></li>
            
          </ul>
        </div>
      </div>

    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user-guide/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Variables" class="md-tabs__link md-tabs__link--active">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorials/welcome/" title="Lessons" class="md-tabs__link">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/wavefunctions/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../images/anna-logo-abinit-2015.svg">
      </i>
    
    abinit
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      github-abinit
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/help_what_ABINIT_does/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/abinit/" title="Abinit" class="md-nav__link">
      Abinit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/cut3d/" title="Cut3d" class="md-nav__link">
      Cut3d
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/fold2bloch/" title="Fold2Bloch" class="md-nav__link">
      Fold2Bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgddb/" title="Mrgddb" class="md-nav__link">
      Mrgddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/mrgscr/" title="Mrgscr" class="md-nav__link">
      Mrgscr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/new_user/" title="NewUser" class="md-nav__link">
      NewUser
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/respfn/" title="Respfn" class="md-nav__link">
      Respfn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Abipy/" title="Abipy" class="md-nav__link">
      Abipy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/APPA/" title="APPA" class="md-nav__link">
      APPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Artificial/" title="Artificial" class="md-nav__link">
      Artificial
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomManipulator/" title="AtomManipulator" class="md-nav__link">
      AtomManipulator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/AtomTypes/" title="AtomTypes" class="md-nav__link">
      AtomTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Bader/" title="Bader" class="md-nav__link">
      Bader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Band2eps/" title="Band2eps" class="md-nav__link">
      Band2eps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Berry/" title="Berry" class="md-nav__link">
      Berry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BandOcc/" title="BandOcc" class="md-nav__link">
      BandOcc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/BSE/" title="BSE" class="md-nav__link">
      BSE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ConstrainedPol/" title="ConstrainedPol" class="md-nav__link">
      ConstrainedPol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Control/" title="Control" class="md-nav__link">
      Control
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Coulomb/" title="Coulomb" class="md-nav__link">
      Coulomb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/CRPA/" title="CRPA" class="md-nav__link">
      CRPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFT+U/" title="DFT+U" class="md-nav__link">
      DFT+U
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DeltaSCF/" title="DeltaSCF" class="md-nav__link">
      DeltaSCF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DensityPotential/" title="DensityPotential" class="md-nav__link">
      DensityPotential
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Dev/" title="Dev" class="md-nav__link">
      Dev
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DFPT/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/DMFT/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EffMass/" title="EffMass" class="md-nav__link">
      EffMass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/EFG/" title="EFG" class="md-nav__link">
      EFG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonInt/" title="ElPhonInt" class="md-nav__link">
      ElPhonInt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElPhonTransport/" title="ElPhonTransport" class="md-nav__link">
      ElPhonTransport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecDOS/" title="ElecDOS" class="md-nav__link">
      ElecDOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ElecBandStructure/" title="ElecBandStructure" class="md-nav__link">
      ElecBandStructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/ForcesStresses/" title="ForcesStresses" class="md-nav__link">
      ForcesStresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/FrequencyMeshMBPT/" title="FrequencyMeshMBPT" class="md-nav__link">
      FrequencyMeshMBPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoConstraints/" title="GeoConstraints" class="md-nav__link">
      GeoConstraints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GeoOpt/" title="GeoOpt" class="md-nav__link">
      GeoOpt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GSintroduction/" title="GSintroduction" class="md-nav__link">
      GSintroduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GW/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/GWls/" title="GWls" class="md-nav__link">
      GWls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Hybrids/" title="Hybrids" class="md-nav__link">
      Hybrids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/k-points/" title="K points" class="md-nav__link">
      K points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/LOTF/" title="LOTF" class="md-nav__link">
      LOTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagField/" title="MagField" class="md-nav__link">
      MagField
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MagMom/" title="MagMom" class="md-nav__link">
      MagMom
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/MolecularDynamics/" title="MolecularDynamics" class="md-nav__link">
      MolecularDynamics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/multidtset/" title="Multidtset" class="md-nav__link">
      Multidtset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/nonlinear/" title="Nonlinear" class="md-nav__link">
      Nonlinear
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Output/" title="Output" class="md-nav__link">
      Output
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/parallelism/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PAW/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PIMD/" title="PIMD" class="md-nav__link">
      PIMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Planewaves/" title="Planewaves" class="md-nav__link">
      Planewaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Phonons/" title="Phonons" class="md-nav__link">
      Phonons
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononBands/" title="PhononBands" class="md-nav__link">
      PhononBands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PhononWidth/" title="PhononWidth" class="md-nav__link">
      PhononWidth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PortabilityNonRegression/" title="PortabilityNonRegression" class="md-nav__link">
      PortabilityNonRegression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/printing/" title="Printing" class="md-nav__link">
      Printing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/PseudosPAW/" title="PseudosPAW" class="md-nav__link">
      PseudosPAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/q-points/" title="Q points" class="md-nav__link">
      Q points
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RandStopPow/" title="RandStopPow" class="md-nav__link">
      RandStopPow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/RPACorrEn/" title="RPACorrEn" class="md-nav__link">
      RPACorrEn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFControl/" title="SCFControl" class="md-nav__link">
      SCFControl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SCFAlgorithms/" title="SCFAlgorithms" class="md-nav__link">
      SCFAlgorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SelfEnergy/" title="SelfEnergy" class="md-nav__link">
      SelfEnergy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/SmartSymm/" title="SmartSymm" class="md-nav__link">
      SmartSymm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/spinpolarisation/" title="Spinpolarisation" class="md-nav__link">
      Spinpolarisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/STM/" title="STM" class="md-nav__link">
      STM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Susceptibility/" title="Susceptibility" class="md-nav__link">
      Susceptibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDDFT/" title="TDDFT" class="md-nav__link">
      TDDFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TDepES/" title="TDepES" class="md-nav__link">
      TDepES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Temperature/" title="Temperature" class="md-nav__link">
      Temperature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TransPath/" title="TransPath" class="md-nav__link">
      TransPath
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/TuningSpeed/" title="TuningSpeed" class="md-nav__link">
      TuningSpeed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Unfolding/" title="Unfolding" class="md-nav__link">
      Unfolding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/UnitCell/" title="UnitCell" class="md-nav__link">
      UnitCell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/vdw/" title="Vdw" class="md-nav__link">
      Vdw
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Verification/" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wannier/" title="Wannier" class="md-nav__link">
      Wannier
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/Wavelets/" title="Wavelets" class="md-nav__link">
      Wavelets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../topics/xc/" title="Xc" class="md-nav__link">
      Xc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Variables
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Variables
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="All Variables" class="md-nav__link">
      All Variables
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      Abinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Abinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../basic/" title="Basic" class="md-nav__link">
      Basic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dev/" title="Developers" class="md-nav__link">
      Developers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eph/" title="Electron-Phonon" class="md-nav__link">
      Electron-Phonon
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Varff
      </label>
    
    <a href="./" title="Varff" class="md-nav__link md-nav__link--active">
      Varff
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#atvshift" title="atvshift" class="md-nav__link">
    atvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bdberry" title="bdberry" class="md-nav__link">
    bdberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berryopt" title="berryopt" class="md-nav__link">
    berryopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrysav" title="berrysav" class="md-nav__link">
    berrysav
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrystep" title="berrystep" class="md-nav__link">
    berrystep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bfield" title="bfield" class="md-nav__link">
    bfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddamp" title="ddamp" class="md-nav__link">
    ddamp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfield" title="dfield" class="md-nav__link">
    dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efield" title="efield" class="md-nav__link">
    efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jfielddir" title="jfielddir" class="md-nav__link">
    jfielddir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kberry" title="kberry" class="md-nav__link">
    kberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maxestep" title="maxestep" class="md-nav__link">
    maxestep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natvshift" title="natvshift" class="md-nav__link">
    natvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nberry" title="nberry" class="md-nav__link">
    nberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polcen" title="polcen" class="md-nav__link">
    polcen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qprtrb" title="qprtrb" class="md-nav__link">
    qprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_dfield" title="red_dfield" class="md-nav__link">
    red_dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efield" title="red_efield" class="md-nav__link">
    red_efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efieldbar" title="red_efieldbar" class="md-nav__link">
    red_efieldbar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spinmagntarget" title="spinmagntarget" class="md-nav__link">
    spinmagntarget
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vprtrb" title="vprtrb" class="md-nav__link">
    vprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeemanfield" title="zeemanfield" class="md-nav__link">
    zeemanfield
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../files/" title="File-handling" class="md-nav__link">
      File-handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../geo/" title="Geometry" class="md-nav__link">
      Geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gstate/" title="Ground-State" class="md-nav__link">
      Ground-State
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gw/" title="GW" class="md-nav__link">
      GW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internal/" title="Internal" class="md-nav__link">
      Internal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paral/" title="Parallelism" class="md-nav__link">
      Parallelism
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../paw/" title="PAW" class="md-nav__link">
      PAW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rlx/" title="Relaxation" class="md-nav__link">
      Relaxation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vdw/" title="VdW" class="md-nav__link">
      VdW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../w90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../anaddb/" title="Anaddb" class="md-nav__link">
      Anaddb
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aim/" title="Aim" class="md-nav__link">
      Aim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../external_parameters/" title="External Parameters" class="md-nav__link">
      External Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varset_stats/" title="Statistics" class="md-nav__link">
      Statistics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connections/" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Lessons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Lessons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/welcome/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Base Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Base Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base1/" title="Base1" class="md-nav__link">
      Base1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base2/" title="Base2" class="md-nav__link">
      Base2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base3/" title="Base3" class="md-nav__link">
      Base3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/base4/" title="Base4" class="md-nav__link">
      Base4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/spin/" title="Spin" class="md-nav__link">
      Spin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      PAW
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        PAW
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paw1/" title="PAW1" class="md-nav__link">
      PAW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paw2/" title="PAW2" class="md-nav__link">
      PAW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paw3/" title="PAW3" class="md-nav__link">
      PAW3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      DFT_PLUS_U
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        DFT_PLUS_U
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/dftu/" title="Dftu" class="md-nav__link">
      Dftu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/udet/" title="Udet" class="md-nav__link">
      Udet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ucalc_crpa/" title="Ucalc crpa" class="md-nav__link">
      Ucalc crpa
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      DFPT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        DFPT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/rf1/" title="RF1" class="md-nav__link">
      RF1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/rf2/" title="RF2" class="md-nav__link">
      RF2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/elastic/" title="Elastic" class="md-nav__link">
      Elastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/ffield/" title="Ffield" class="md-nav__link">
      Ffield
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/nlo/" title="Nlo" class="md-nav__link">
      Nlo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/dmft/" title="DMFT" class="md-nav__link">
      DMFT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      EPH
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        EPH
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/eph/" title="Eph" class="md-nav__link">
      Eph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/tdepes/" title="Tdepes" class="md-nav__link">
      Tdepes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Many-Body
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Many-Body
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/gw1/" title="GW1" class="md-nav__link">
      GW1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/gw2/" title="GW2" class="md-nav__link">
      GW2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-9" type="checkbox" id="nav-4-9">
    
    <label class="md-nav__link" for="nav-4-9">
      Parallelism
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-9">
        Parallelism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/basepar/" title="Base" class="md-nav__link">
      Base
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_dfpt/" title="DFPT" class="md-nav__link">
      DFPT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_gspw/" title="GSPW" class="md-nav__link">
      GSPW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_gswvl/" title="GSWVL" class="md-nav__link">
      GSWVL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_images/" title="Images" class="md-nav__link">
      Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_mbt/" title="Many-Body" class="md-nav__link">
      Many-Body
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/paral_moldyn/" title="Moldyn" class="md-nav__link">
      Moldyn
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/analysis_tools/" title="Analysis tools" class="md-nav__link">
      Analysis tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/fold2bloch/" title="Fold2bloch" class="md-nav__link">
      Fold2bloch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/nuc/" title="Nuc" class="md-nav__link">
      Nuc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/optic/" title="Optic" class="md-nav__link">
      Optic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/positron/" title="Positron" class="md-nav__link">
      Positron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/source_code/" title="Source code" class="md-nav__link">
      Source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/tddft/" title="Tddft" class="md-nav__link">
      Tddft
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/wannier90/" title="Wannier90" class="md-nav__link">
      Wannier90
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Theory
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Theory
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/wavefunctions/" title="Wavefunctions" class="md-nav__link">
      Wavefunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/mbt/" title="Many-Body Perturbation Theory" class="md-nav__link">
      Many-Body Perturbation Theory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bse/" title="Bethe-Salpeter" class="md-nav__link">
      Bethe-Salpeter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/documents/" title="Documents" class="md-nav__link">
      Documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../theory/bibliography/" title="Bibliography" class="md-nav__link">
      Bibliography
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/abimkdocs/" title="Abimkdocs" class="md-nav__link">
      Abimkdocs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/markdown/" title="Markdown" class="md-nav__link">
      Markdown
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/testsuite/" title="Test Suite" class="md-nav__link">
      Test Suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/codestats/" title="Code stats" class="md-nav__link">
      Code stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers/external_resources/" title="External Resources" class="md-nav__link">
      External Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#atvshift" title="atvshift" class="md-nav__link">
    atvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bdberry" title="bdberry" class="md-nav__link">
    bdberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berryopt" title="berryopt" class="md-nav__link">
    berryopt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrysav" title="berrysav" class="md-nav__link">
    berrysav
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#berrystep" title="berrystep" class="md-nav__link">
    berrystep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bfield" title="bfield" class="md-nav__link">
    bfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddamp" title="ddamp" class="md-nav__link">
    ddamp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dfield" title="dfield" class="md-nav__link">
    dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efield" title="efield" class="md-nav__link">
    efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jfielddir" title="jfielddir" class="md-nav__link">
    jfielddir
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kberry" title="kberry" class="md-nav__link">
    kberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maxestep" title="maxestep" class="md-nav__link">
    maxestep
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natvshift" title="natvshift" class="md-nav__link">
    natvshift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nberry" title="nberry" class="md-nav__link">
    nberry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polcen" title="polcen" class="md-nav__link">
    polcen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qprtrb" title="qprtrb" class="md-nav__link">
    qprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_dfield" title="red_dfield" class="md-nav__link">
    red_dfield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efield" title="red_efield" class="md-nav__link">
    red_efield
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#red_efieldbar" title="red_efieldbar" class="md-nav__link">
    red_efieldbar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spinmagntarget" title="spinmagntarget" class="md-nav__link">
    spinmagntarget
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vprtrb" title="vprtrb" class="md-nav__link">
    vprtrb
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zeemanfield" title="zeemanfield" class="md-nav__link">
    zeemanfield
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              

                
                
                <!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->

<h1 id="ffield-input-variables">ffield input variables<a class="headerlink" href="#ffield-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
ffield input variables to be used in the input file for the abinit executable.</p>
<h2 id="atvshift"><strong>atvshift</strong><a class="headerlink" href="#atvshift" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ATomic potential (V) energy SHIFTs<br />
<em>Characteristics:</em> <a class="wikilink" href="../../../user-guide/abinit#32-more-about-abinit-input-variables">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a DFT+U calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="../../../variables/ffield#natvshift">natvshift</a>,<a class="wikilink codevar-wikilink" href="../../../variables/basic#nsppol">nsppol</a>,<a class="wikilink codevar-wikilink" href="../../../variables/basic#natom">natom</a>)<br />
<em>Default value:</em> <em>0.0d0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/paw#usepawu">usepawu</a> /= 0 and <a class="wikilink codevar-wikilink" href="../../../variables/ffield#natvshift">natvshift</a> in [5,7]  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v5:  <a class="wikilink abifile-wikilink" data-content="Ni atom in a big box. Test the use of the atvshift variable : change the potential of the d orbitals." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v5/Input/t14.in" target="_blank">t14.in</a>, <a class="wikilink abifile-wikilink" data-content="Ni molecule in a big box. Test the use of the atvshift variable First dataset : no shift,  the ten states number 9 to 18 come from the 3d atomic states,  the state number 19 is a bonding 4s state. States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1). State number 18 is a 3d sigma antibonding state (m=0). Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the levels change by less than 0.0002 (and their energy decrease),  except state number 9 (a 3d sigma bonding state (m=0)),  that goes from -0.24020 to -0.23982 (+0.0004) and state number 18,  that goes from -0.15439 to 0.15399 (+0.0004). Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials. All the levels are affected (likely the m=1 and -1 orbitals adjust,  and cause modification of the potential),  but the states 10,  11,  16,  and 17 increase their energy,  while the other state see their energy decrease. Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking of the degeneracy. This test was not easy to make portable. The problem lies in the fact that when the density becomes negative,  due to Bragg oscillations,  the xc kernel can be extremely large,  and when use for the prediction of the residual of the forces,  the differences between machines can be extremely large. IN order to see this effect,  put ecut 7 and npulayit 7 (its default value)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v5/Input/t15.in" target="_blank">t15.in</a></li></ul></details><p>Defines for each atom and each spin channel (at present, can only be used with
<a class="wikilink codevar-wikilink" href="../../../variables/basic#nsppol">nsppol</a>=1 or 2, like the +U scheme), a possible potential shift, for the d
(with <a class="wikilink codevar-wikilink" href="../../../variables/paw#lpawu">lpawu</a>=2, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#natvshift">natvshift</a>=5), or f states (with <a class="wikilink codevar-wikilink" href="../../../variables/paw#lpawu">lpawu</a>=3,
<a class="wikilink codevar-wikilink" href="../../../variables/ffield#natvshift">natvshift</a>=7). In the case of d states, and 2 spin channels, a set of 10
numbers for each atom must be defined. The first set of 5 numbers corresponds
to real spherical harmonics m=-2 to m=+2 for the spin-up channel, the second
set of 5 numbers corresponds to real spherical harmonics m=-2 to m=+2 for the
spin-down channel. In the case of f states, the same ordering applies, for
sets of 7 numbers, corresponding to m=-3 to m=+3.<br />
<a class="wikilink codevar-wikilink" href="../../../variables/paw#usepawu">usepawu</a> should be non-zero, <a class="wikilink codevar-wikilink" href="../../../variables/paw#lpawu">lpawu</a> should be 2 or 3.</p>
<h2 id="bdberry"><strong>bdberry</strong><a class="headerlink" href="#bdberry" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BanD limits for BERRY phase<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (4)<br />
<em>Default value:</em> 4*0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> in [1, 2, 3] and <a class="wikilink codevar-wikilink" href="../../../variables/ffield#nberry">nberry</a> &gt; 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [7/920] in all abinit tests, [1/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using old,  rather inaccurate psps. Computation of the Berry phase. Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_04.in" target="_blank">tsv3_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  2 special points;  low ecut. With a 4x4x4 k point grid (!only one shift,  but OK because symmetry is imposed),  compute the dielectric constant by two different techniques" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_05.in" target="_blank">tsv3_05.in</a></li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Alternative response function calculation for some rigid-atom piezoelectric tensor elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/tutorespfn/Input/telast_5.in" target="_blank">telast_5.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="Test of the strain perturbation for the rigid-ion piezoelectric tensor.  Rhombohedrally distorted AlP as in the previous test,  but using a ground-state finite- difference calculation of the d/dk wave functions.  Such calculations were used extensively to test the response function piezoelectric tensor by comparison to numerical derivatives of the ground-state polarization.  Using the same k sample in the ground state and response function calculations,  excellent agreement has been obtained in a variety of cases (including a better-converged version of this one).  Results using the finite- diffrence d/dk and the analytic d/dk as in the preceeding test agree in the limit of large k sample. The analytic form converges much more rapidly,  and is consistent with the slowly converging polarization numerical derivatives. The present version of this calculation uses berryopt = -2 to utilize the routine berryphase_new.f The ground-state polarization calculations used to compute the numerical derivatives in such tests should also be computed using berryphase_new.f setting berryopt = -1 and rfdir = 1 1 1 so that the cartesian polarization is automatically generated. This eliminates several issues that needed special attention using berryopt = 1 and the original berryphase.f routine. The resulting cartesian polarization derivatives represent the &amp;quot;improper&amp;quot; piezoelectric tensor,  and have to be corrected to yield the &amp;quot;proper&amp;quot; tensor as described in D. Vanderbilt,  J. Phys. Chem. Solids 61,  147 (2000),  using Eq.(15).  The response-function calculation gives the proper piezoelectric tensor.  Only the electron response,  and not the strain-induced movement of the rigid ions contributes to the proper tensor." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v4/Input/t66.in" target="_blank">t66.in</a></li></ul></details><p>Give the lower band and the upper band of the set of bands for which the Berry
phase must be computed. Irrelevant if <a class="wikilink codevar-wikilink" href="../../../variables/ffield#nberry">nberry</a> is not positive. When
<a class="wikilink codevar-wikilink" href="../../../variables/basic#nsppol">nsppol</a> is 1 (no spin-polarisation), only the two first numbers, giving the
lower and highest bands, are significant. Their occupation number is assumed
to be 2. When <a class="wikilink codevar-wikilink" href="../../../variables/basic#nsppol">nsppol</a> is 2 (spin-polarized calculation), the two first
numbers give the lowest and highest bands for spin up, and the third and
fourth numbers give the lowest and highest bands for spin down. Their
occupation number is assumed to be 1 .</p>
<p>Presently, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#bdberry">bdberry</a> MUST be initialized by the user in case of a Berry
phase calculation with <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 1, 2, or 3: the above-mentioned default
will cause an early exit.</p>
<h2 id="berryopt"><strong>berryopt</strong><a class="headerlink" href="#berryopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BERRY phase OPTions<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [40/920] in all abinit tests, [7/116] in abinit tutorials</summary><ul><li>paral:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t07.in" target="_blank">t07.in</a></li><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using old,  rather inaccurate psps. Computation of the Berry phase. Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_04.in" target="_blank">tsv3_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  2 special points;  low ecut. With a 4x4x4 k point grid (!only one shift,  but OK because symmetry is imposed),  compute the dielectric constant by two different techniques" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_05.in" target="_blank">tsv3_05.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  rhombohedral. Test finite electric field Check the corectness of the symmetry operations with non-zero tnons." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv4_55.in" target="_blank">tsv4_55.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Finite electric field calculation In order to perform a first-principles calculation in an electric field,  the wavefunctions must be initialized properly. Therefore, I do first a GS calculation to obtain the WF in the whole BZ under zero electric field. Then,  I increase the electric field slowly in successive datasets. The calculation for each dataset is initialized using the WF of a previous one. I consider both positive and negative electric fields. WARNING : HAS BEEN TRANSFERRED TO tests/seq" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv4_78.in" target="_blank">tsv4_78.in</a>, <a class="wikilink abifile-wikilink" data-content="CrystallIne AlAs first three runs are for calculation of ground state at finite electric field the fourth run gets the gs wavefunction and then do response calculation the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv4_80.in" target="_blank">tsv4_80.in</a>, <a class="wikilink abifile-wikilink" data-content="NaF Sodium Fluoride FCC (rocksalt structure) with 2 atoms per cell. Test computation of the Berry phase in PAW." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv5_112.in" target="_blank">tsv5_112.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs with 2 atoms per cell. Test computation of the Berry phase in PAW,  with GGA functional. WARNING : HAS BEEN TRANSFERRED TO tests/seq" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv5_113.in" target="_blank">tsv5_113.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=14 (finite reduced electric field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_121.in" target="_blank">tsv6_121.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=16 (finite reduced electric displacement field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_122.in" target="_blank">tsv6_122.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=4 (finite electric field calculation,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_123.in" target="_blank">tsv6_123.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=6 (finite electric displacement field calculation, relaxing cell perameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_124.in" target="_blank">tsv6_124.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt=17 (mixed finite electric field and electric displacement field boundary condition,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_125.in" target="_blank">tsv6_125.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs case,  to test the &amp;quot;polcen&amp;quot; in finite reduced electric field calculation. (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_126.in" target="_blank">tsv6_126.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of forces in finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial.) Cannot be executed with more than 1 MPI node." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv7_70.in" target="_blank">tsv7_70.in</a></li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Finite-difference calculation for c-axis strain increment +/- 0.0001" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/tutorespfn/Input/telast_4.in" target="_blank">telast_4.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs in hypothetical wurzite (hexagonal) structure Alternative response function calculation for some rigid-atom piezoelectric tensor elements." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/tutorespfn/Input/telast_5.in" target="_blank">telast_5.in</a>, <a class="wikilink abifile-wikilink" data-content="Finite difference calculation of the Born effective charges of AlAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/tutorespfn/Input/tffield_1.in" target="_blank">tffield_1.in</a>, <a class="wikilink abifile-wikilink" data-content="Linear response calculation for AlAs Perturbation: atomic displacements &amp;amp; strains Finite difference calculation of the ddk" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/tutorespfn/Input/tffield_2.in" target="_blank">tffield_2.in</a>, <a class="wikilink abifile-wikilink" data-content="Finite difference calculation of the clamped-ion piezoelectric constants of AlAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/tutorespfn/Input/tffield_4.in" target="_blank">tffield_4.in</a>, <a class="wikilink abifile-wikilink" data-content="Finite difference calculation of the clamped-ion piezoelectric constants of AlAs" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/tutorespfn/Input/tffield_5.in" target="_blank">tffield_5.in</a>, <a class="wikilink abifile-wikilink" data-content="Finite electric field calculation of alas at clamped atomic positions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/tutorespfn/Input/tffield_6.in" target="_blank">tffield_6.in</a></li><li>v4:  <a class="wikilink abifile-wikilink" data-content="Test of the strain perturbation for the rigid-ion piezoelectric tensor.  Rhombohedrally distorted AlP as in the previous test,  but using a ground-state finite- difference calculation of the d/dk wave functions.  Such calculations were used extensively to test the response function piezoelectric tensor by comparison to numerical derivatives of the ground-state polarization.  Using the same k sample in the ground state and response function calculations,  excellent agreement has been obtained in a variety of cases (including a better-converged version of this one).  Results using the finite- diffrence d/dk and the analytic d/dk as in the preceeding test agree in the limit of large k sample. The analytic form converges much more rapidly,  and is consistent with the slowly converging polarization numerical derivatives. The present version of this calculation uses berryopt = -2 to utilize the routine berryphase_new.f The ground-state polarization calculations used to compute the numerical derivatives in such tests should also be computed using berryphase_new.f setting berryopt = -1 and rfdir = 1 1 1 so that the cartesian polarization is automatically generated. This eliminates several issues that needed special attention using berryopt = 1 and the original berryphase.f routine. The resulting cartesian polarization derivatives represent the &amp;quot;improper&amp;quot; piezoelectric tensor,  and have to be corrected to yield the &amp;quot;proper&amp;quot; tensor as described in D. Vanderbilt,  J. Phys. Chem. Solids 61,  147 (2000),  using Eq.(15).  The response-function calculation gives the proper piezoelectric tensor.  Only the electron response,  and not the strain-induced movement of the rigid ions contributes to the proper tensor." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v4/Input/t66.in" target="_blank">t66.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure Compute the polarization along strings of k-points parallel to the primitive vectors of the reciprocal lattice. The Berry phase calculations are performed in three different datasets. For each datatset,  ABINIT writes the polarization in reduced coordinates to a DDB." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v4/Input/t72.in" target="_blank">t72.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure (Test of Na Sai's technique) To compute the polarization,  the finite difference expression of the ddk and the second-order energy derivatives." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v4/Input/t75.in" target="_blank">t75.in</a></li><li>v5:  <a class="wikilink abifile-wikilink" data-content="AlAs in Zincblende structure. Test calculation of the Born effective charge and dielectric constant tensor at finite electric fields. The first dataset is for normal ground-state calculation at zero electric field. The second dataset is for ground-state calculation at finite electric field. The final datasetis the linear-response calculation at finite electric field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v5/Input/t23.in" target="_blank">t23.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="NaCl molecule in a big box. Test of the computation of the polarisation with the routine berryphase_new, for different k-point grids : only 1 k-point,  a line of k-points,  and a full mesh of k-points. Results with acell 20 10 10 are : -9.727 C/m^2,  -9.975 C/m^2,  -9.503 C/m^2 multiplied by the volume (in a.u.),  gives -19454,  -19950,  -19006 Test provided by S. Leroux Going to bigger cells make these results converge to the same value : Results with acell 30 20 20 are : -1.771 C/m^2,  -1.746 C/m^2,  -1.747 C/m^2 multiplied by the volume (in a.u.),  gives -21252,  -20952,  -20964 Results with acell 40 20 20 are : -1.3167C/m^2,  -1.3057C/m^2,  -1.3062C/m^2 multiplied by the volume (in a.u.),  gives -21067,  -20891,  -20899 Results with acell 50 20 20 are : -1.0502C/m^2,  -1.0444C/m^2,  -1.0450C/m^2 multiplied by the volume (in a.u.),  gives -21004,  -20888,  -20900" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of berrystep Al-As cristal,  zinc-blende structure Compute the polarization along strings of k-points parallel to the primitive vectors of the reciprocal lattice,  and using multiple step berry phase calculation. (Tests 21-30 are related to geometry optimization,  molecular dynamics,  etc) Cannot be executed in parallel: chkint_prt: ERROR - Context : the value of the variable nproc is 2. The value of the input variable berrystep is 5,  while it must be equal to 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t20.in" target="_blank">t20.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite differences (contributed by J. Zwanziger,  adapted from efield tutorial). MG: Very problematic in parallel (run get stuck!)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t42.in" target="_blank">t42.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial.) Cannot be executed with more than 1 MPI node." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t43.in" target="_blank">t43.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v7/Input/t03.in" target="_blank">t03.in</a></li></ul></details><p>Specifies the use of Berry phase for the computation of either the
polarization, the derivatives with respect to the wavevector, or finite
electric field calculations.</p>
<ul>
<li>0 =&gt; no computation of expressions relying on a Berry phase (default) </li>
<li>1 =&gt; the computation of Berry phases is activated (berryphase routine) </li>
<li>2 =&gt; the computation of derivatives with respect to the wavevector, thanks to the Berry phase finite-difference formula, is activated (uderiv routine) </li>
<li>3 =&gt; same as option 1 and 2 together 
<strong>Note that options 1 to 3 require the use of a serial build of Abinit.</strong></li>
<li>-1 =&gt; alternative computation of Berry phases (berryphase_new routine) </li>
<li>-2 =&gt; alternative computation of derivatives with respect to the wavevector, thanks to the Berry phase finite-difference formula (berryphase_new routine) </li>
<li>-3 =&gt; same as option -1 and -2 together 
<strong>Options -1 to -3 permit use of a parallel build and will be preferred by most users.</strong></li>
<li>4 =&gt; finite electric field calculation (unreduced E-field) </li>
<li>6 =&gt; finite electric displacement field calculation (unreduced D-field) </li>
<li>14 =&gt; finite reduced electric field calculation </li>
<li>16 =&gt; finite electric displacement field calculation </li>
<li>17 =&gt; mixed electric boundary condition: finite reduced electric field in some directions, finite reduced electric displacement field along other directions. See variable <a class="wikilink codevar-wikilink" href="../../../variables/ffield#jfielddir">jfielddir</a> for more details. </li>
</ul>
<p>Other related input variables are :</p>
<ul>
<li>in case of <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=1,2, or 3 : <a class="wikilink codevar-wikilink" href="../../../variables/ffield#bdberry">bdberry</a> and <a class="wikilink codevar-wikilink" href="../../../variables/ffield#kberry">kberry</a>; also, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#nberry">nberry</a> must be larger than 0; </li>
<li>in case of <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=-1,-2, or -3 : the variable <a class="wikilink codevar-wikilink" href="../../../variables/dfpt#rfdir">rfdir</a> must be used to specify the primitive vector along which the projection of the polarization or the ddk will be computed. For example if <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=-1 and <a class="wikilink codevar-wikilink" href="../../../variables/dfpt#rfdir">rfdir</a>=1 0 0, the projection of the polarization along the reciprocal lattice vector G_1 is computed. In case <a class="wikilink codevar-wikilink" href="../../../variables/dfpt#rfdir">rfdir</a>=1 1 1, ABINIT computes the projection of P along G_1, G_2 and G_3 and transforms the results to cartesian coordinates; </li>
<li>in cases where <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> is negative, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berrystep">berrystep</a> allow a computation of multiple-step Berry phase in order to accelerate the convergence. </li>
<li><a class="wikilink codevar-wikilink" href="../../../variables/ffield#efield">efield</a> and <a class="wikilink codevar-wikilink" href="../../../variables/dfpt#rfdir">rfdir</a> in case of <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=4 ; </li>
</ul>
<p>The cases <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=-1,-2,-3, 4, 6, 7, 14, 16, and 17 have to be used with
<a class="wikilink codevar-wikilink" href="../../../variables/basic#occopt">occopt</a>=1.</p>
<p>The cases <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=-1 and 4, 6, 7, 14, 16, 17 are compatible with PAW,
howevever, if in these cases one uses <a class="wikilink codevar-wikilink" href="../../../variables/basic#kptopt">kptopt</a>/=3, one must also use only
symmorphic symmetries (either because the space group is symmorphic or the
variable <a class="wikilink codevar-wikilink" href="../../../variables/dev#symmorphi">symmorphi</a> is set to zero).</p>
<p>For a phonon calculation under a finite electric field, respect the following
procedure.</p>
<ul>
<li>1. Run a scf ground-state calculation at zero electric field to get wavefunctions to initialize the ground-state calculation in finite electric fields. </li>
<li>2. Run a scf ground-state calculation in finite electric field. The electric field is controlled by the input variable <a class="wikilink codevar-wikilink" href="../../../variables/ffield#efield">efield</a>. <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> should be 4. The input variable <a class="wikilink codevar-wikilink" href="../../../variables/basic#kptopt">kptopt</a> should be set to be 2. </li>
<li>3. Based on the wave functions obtained in step (2), perform phonon calculation by setting <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=4, <a class="wikilink codevar-wikilink" href="../../../variables/basic#kptopt">kptopt</a>=3 and The same value of <a class="wikilink codevar-wikilink" href="../../../variables/ffield#efield">efield</a> than in step 2. <a class="wikilink codevar-wikilink" href="../../../variables/basic#nsym">nsym</a> should be set to 1 currently but this restriction may be removed later . The other parameters are the same as phonon calculation at zero electric field. </li>
<li>Note : the choice of k-point sampling N x N x N should be the same in the three runs and N should be an even number. </li>
</ul>
<p>In case of finite electric and displacement field calculations
(<a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=4,6,7,14,16,17), see also the input variables <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berrysav">berrysav</a>,
<a class="wikilink codevar-wikilink" href="../../../variables/ffield#dfield">dfield</a>, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_dfield">red_dfield</a>, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_efield">red_efield</a>, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#ddamp">ddamp</a></p>
<h2 id="berrysav"><strong>berrysav</strong><a class="headerlink" href="#berrysav" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BERRY SAVe<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=6 (finite electric displacement field calculation, relaxing cell perameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_124.in" target="_blank">tsv6_124.in</a></li></ul></details><ul>
<li>0 =&gt; for finite electric field calculation (<a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=4/14), the polarization branch will be chosen on each iteration from (-pi, pi); for finite electric displacement field calculation(<a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=6/7/16/17), the polarization will be chosen to minimize the internal energy. </li>
<li>1 =&gt; the polarization will be kept in the same branch on each iteration. At the end of the run, a file &ldquo;POLSAVE&rdquo; will be saved containing the reduced polarization in atomic units. Note: Make sure that &ldquo;POLSAVE&rdquo; is empty or it does not exist before the calculation, or else that it specifies the desired polarization branch. </li>
</ul>
<h2 id="berrystep"><strong>berrystep</strong><a class="headerlink" href="#berrystep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BERRY phase : multiple STEP<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> 0 &gt; <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v6:  <a class="wikilink abifile-wikilink" data-content="Test of berrystep Al-As cristal,  zinc-blende structure Compute the polarization along strings of k-points parallel to the primitive vectors of the reciprocal lattice,  and using multiple step berry phase calculation. (Tests 21-30 are related to geometry optimization,  molecular dynamics,  etc) Cannot be executed in parallel: chkint_prt: ERROR - Context : the value of the variable nproc is 2. The value of the input variable berrystep is 5,  while it must be equal to 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t20.in" target="_blank">t20.in</a></li></ul></details><p>If <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> is negative, this variable is used to compute berry phases
using multiple discrete steps, in order to accelerate convergence. The single-
step berry phase is the standard calculation using strings of k-points based
on overlap of Bloch function separated by dk, while the two-step berry phase
use strings use overlaps based on dk and 2*dk, the three-step use overlaps
based on dk, 2*dk and 3*dk&hellip;</p>
<p>The default value of this variable is 1, meaning that only the single-step
berry phase calculation is done. If a larger value is set, ABINIT will compute
all the multiple-step berry phase from the single-step to the
<a class="wikilink codevar-wikilink" href="../../../variables/ffield#berrystep">berrystep</a>-step, and use the large-step values of berry phase to correct
the single-step berry phase. Use with care: while experience is still to be
gained with this procedure, the outlook is promising.</p>
<h2 id="bfield"><strong>bfield</strong><a class="headerlink" href="#bfield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> finite B FIELD calculation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to take into account an external magnetic field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/MagField">topic_MagField</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0.0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>paral:  <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t07.in" target="_blank">t07.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial.) Cannot be executed with more than 1 MPI node." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t43.in" target="_blank">t43.in</a></li></ul></details><p>Perform finite magnetic field calculation.<br />
<strong>THIS CODE IS UNDER DEVELOPMENT AND IS NOT READY FOR USE.</strong></p>
<h2 id="ddamp"><strong>ddamp</strong><a class="headerlink" href="#ddamp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> electric Displacement field DAMPing parameter<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 6 or 16  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=14 (finite reduced electric field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_121.in" target="_blank">tsv6_121.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=16 (finite reduced electric displacement field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_122.in" target="_blank">tsv6_122.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=6 (finite electric displacement field calculation, relaxing cell perameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_124.in" target="_blank">tsv6_124.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt=17 (mixed finite electric field and electric displacement field boundary condition,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_125.in" target="_blank">tsv6_125.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs case,  to test the &amp;quot;polcen&amp;quot; in finite reduced electric field calculation. (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_126.in" target="_blank">tsv6_126.in</a></li></ul></details><p>In case <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=6, the electric field is updated after each SCF iteration
according to E_{n+1}= <a class="wikilink codevar-wikilink" href="../../../variables/ffield#ddamp">ddamp</a><em>(D - 4*pi*P_{n}) + (1-<a class="wikilink codevar-wikilink" href="../../../variables/ffield#ddamp">ddamp</a>)*E_{n} where
P_{n} and E_{n} are the polarization and electric field after nth SCF
iteration. <a class="wikilink codevar-wikilink" href="../../../variables/ffield#ddamp">ddamp</a> is a damping parameter used to control the convergence
speed.<br />
In case <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=16, the electric field is updated after each SCF
iteration according to e_{n+1}= <a class="wikilink codevar-wikilink" href="../../../variables/ffield#ddamp">ddamp</a></em>(d - p_{n}) + (1-<a class="wikilink codevar-wikilink" href="../../../variables/ffield#ddamp">ddamp</a>)*e_{n}<br />
If you have difficulty getting convergence, try to reduce this value or reduce
maxestep. This parameter is used in finite electric displacement field
calculations (berryopt=6,16,17).</p>
<h2 id="dfield"><strong>dfield</strong><a class="headerlink" href="#dfield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Displacement FIELD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 6, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#efield">efield</a>  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=16 (finite reduced electric displacement field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_122.in" target="_blank">tsv6_122.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=6 (finite electric displacement field calculation, relaxing cell perameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_124.in" target="_blank">tsv6_124.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt=17 (mixed finite electric field and electric displacement field boundary condition,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_125.in" target="_blank">tsv6_125.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs case,  to test the &amp;quot;polcen&amp;quot; in finite reduced electric field calculation. (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_126.in" target="_blank">tsv6_126.in</a></li></ul></details><p>In case <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=6, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#dfield">dfield</a> specifies the (unreduced) finite electric
displacement field vector, in atomic units, that is to be imposed as a
constraint during the calculation.</p>
<h2 id="efield"><strong>efield</strong><a class="headerlink" href="#efield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Electric FIELD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 4 or 6  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [22/920] in all abinit tests, [1/116] in abinit tutorials</summary><ul><li>paral:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="LiNbO3,  parallelism over k points (coming from test v4#55 written by MVeithen,  then modified by DHamann) Test parallelism of the Berry phase calculation,  and finite electric field calculation." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t06.in" target="_blank">t06.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t07.in" target="_blank">t07.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t07.in" target="_blank">t07.in</a></li><li>seq:  <a class="wikilink abifile-wikilink" data-content="LiNbO3,  rhombohedral. Test finite electric field Check the corectness of the symmetry operations with non-zero tnons." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv4_55.in" target="_blank">tsv4_55.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs,  zinc-blende structure. Finite electric field calculation In order to perform a first-principles calculation in an electric field,  the wavefunctions must be initialized properly. Therefore, I do first a GS calculation to obtain the WF in the whole BZ under zero electric field. Then,  I increase the electric field slowly in successive datasets. The calculation for each dataset is initialized using the WF of a previous one. I consider both positive and negative electric fields. WARNING : HAS BEEN TRANSFERRED TO tests/seq" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv4_78.in" target="_blank">tsv4_78.in</a>, <a class="wikilink abifile-wikilink" data-content="CrystallIne AlAs first three runs are for calculation of ground state at finite electric field the fourth run gets the gs wavefunction and then do response calculation the wavevector q is commensurate with lattice so gs wfs at q+k are not needed." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv4_80.in" target="_blank">tsv4_80.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=14 (finite reduced electric field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_121.in" target="_blank">tsv6_121.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=16 (finite reduced electric displacement field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_122.in" target="_blank">tsv6_122.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=4 (finite electric field calculation,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_123.in" target="_blank">tsv6_123.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=6 (finite electric displacement field calculation, relaxing cell perameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_124.in" target="_blank">tsv6_124.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt=17 (mixed finite electric field and electric displacement field boundary condition,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_125.in" target="_blank">tsv6_125.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs case,  to test the &amp;quot;polcen&amp;quot; in finite reduced electric field calculation. (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_126.in" target="_blank">tsv6_126.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of forces in finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial.) Cannot be executed with more than 1 MPI node." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv7_70.in" target="_blank">tsv7_70.in</a></li><li>tutorespfn:  <a class="wikilink abifile-wikilink" data-content="Finite electric field calculation of alas at clamped atomic positions" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/tutorespfn/Input/tffield_6.in" target="_blank">tffield_6.in</a></li><li>v5:  <a class="wikilink abifile-wikilink" data-content="AlAs in Zincblende structure. Test calculation of the Born effective charge and dielectric constant tensor at finite electric fields. The first dataset is for normal ground-state calculation at zero electric field. The second dataset is for ground-state calculation at finite electric field. The final datasetis the linear-response calculation at finite electric field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v5/Input/t23.in" target="_blank">t23.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite differences (contributed by J. Zwanziger,  adapted from efield tutorial). MG: Very problematic in parallel (run get stuck!)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t42.in" target="_blank">t42.in</a>, <a class="wikilink abifile-wikilink" data-content="PAW Berrys Phase calculation of Born effective charge in AlAs by finite electric fields (contributed by J. Zwanziger,  adapted from efield tutorial.) Cannot be executed with more than 1 MPI node." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t43.in" target="_blank">t43.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="Test berryopt -1 and berryopt 4,  with NCPP,  with spinors and spin-orbit coupling. This test computes the polarization of GaAs in zero and finite electric field,  in three cases: nspinor 1,  nspinor 2,  and nspinor 2 with spin-orbit coupling (so_psp). HGH norm-conserving pseudopotentials are used." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v7/Input/t03.in" target="_blank">t03.in</a></li></ul></details><p>In case <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=4, a finite electric field calculation is performed. The
value of this electric field, and its direction is determined by <a class="wikilink codevar-wikilink" href="../../../variables/ffield#efield">efield</a>.
It must be given in atomic units (1 a.u. of electric field= 514220624373.482
V/m, see note below), in cartesian coordinates.</p>
<p>References for the calculation under electric field (based on multi k point
Berry phase) :</p>
<ul>
<li>Nunes and Vanderbilt, PRL 73, 712 (1994) : real-space version of the finite-field Hamiltonian </li>
<li>Nunes and Gonze, PRB 63, 155107 (2001) : reciprocal-space version of the finite-field Hamiltonian (the one presently implemented), and extensive theoretical analysis </li>
<li>Souza, Iniguez and Vanderbilt, PRL 89, 117602 (2003) : implementation of the finite-field Hamiltonian (reciprocal-space version) </li>
<li>Zwanziger, Galbraith, Kipouros, Torrent, Giantomassi and Gonze, Comp. Mater. Sci. 58, 113 (2012) : extension to PAW formalism </li>
</ul>
<p>See also Umari, Gonze, Pasquarello, PRL 90, 027401 (2003).</p>
<p>The atomic unit of electric field strength is : e_Cb/(4 pi eps0 a0**2), where
e_Cb is the electronic charge in Coulomb (1.60217653e-19), eps0 is the
electric constant (8.854187817d-12 F/m), and a0 is the Bohr radius in meter
(0.5291772108e-10).</p>
<h2 id="jfielddir"><strong>jfielddir</strong><a class="headerlink" href="#jfielddir" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> electric/displacement FIELD DIRection<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 17  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="Test berryopt=17 (mixed finite electric field and electric displacement field boundary condition,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_125.in" target="_blank">tsv6_125.in</a></li></ul></details><p>When specifying mixed electric field boundary conditions ( <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=17),
jfielddir controls whether reduced electric field (<a class="wikilink codevar-wikilink" href="../../../variables/ffield#jfielddir">jfielddir</a>=1) or reduced
electric displacement field (<a class="wikilink codevar-wikilink" href="../../../variables/ffield#jfielddir">jfielddir</a>=2) is chosen to be fixed, in each
of the three lattice directions (i.e., in the reduced, not the Cartesian,
frame). For example, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#jfielddir">jfielddir</a>=(1 1 2) tells the code to use fixed ebar_1
and ebar_2 along the first two lattice directions and fixed d_3 along the
third.<br />
For the case of mixed electric field boundary conditions, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_efieldbar">red_efieldbar</a>
and <a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_dfield">red_dfield</a> are used to control ebar and d, respectively. For example,
for electric boundary conditions corresponding to a material in a parallel-
plate capacitor, if you want to control d_3=d0, while fixing ebar_1=ebar_2=0,
then the input files should have <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=17, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#jfielddir">jfielddir</a>=(1 1 2),
<a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_efieldbar">red_efieldbar</a>=(0.0 0.0 a), and <a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_dfield">red_dfield</a>=(b c d0). Here a, b, and c
are the starting values. They can be chosen in this way: do a single run for
fixed d calculation (<a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_dfield">red_dfield</a>=0,0,d0), from the final results you will
have ebar_3, which is a good guess for a. Then do another single run for fixed
ebar calculation (<a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_efieldbar">red_efieldbar</a>=(0 0 0)), from the final results you will
have d_1,d_2, these are good guesses for b, c.</p>
<h2 id="kberry"><strong>kberry</strong><a class="headerlink" href="#kberry" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> K wavevectors for BERRY phase computation<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="../../../variables/ffield#nberry">nberry</a>)<br />
<em>Default value:</em> <em>0<br />
*Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 1, 2, or 3  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [5/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using old,  rather inaccurate psps. Computation of the Berry phase. Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_04.in" target="_blank">tsv3_04.in</a>, <a class="wikilink abifile-wikilink" data-content="Si in diamond structure;  2 special points;  low ecut. With a 4x4x4 k point grid (!only one shift,  but OK because symmetry is imposed),  compute the dielectric constant by two different techniques" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_05.in" target="_blank">tsv3_05.in</a></li></ul></details><p>Used for values of <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 1, 2, or 3.</p>
<p>This array defines, for each Berry phase calculation (the number of such
calculations is defined by <a class="wikilink codevar-wikilink" href="../../../variables/ffield#nberry">nberry</a>), the difference of wavevector between k
points for which the overlap matrix must be computed. The polarisation vector
will be projected on the direction of that wavevector, and the result of the
computation will be the magnitude of this projection. Doing more than one
wavevector, with different independent direction, allows to find the full
polarisation vector. However, note that converged results need oriented grids,
denser along the difference wavevector than usual Monkhorst-Pack grids.</p>
<p>The difference of wavevector is computed in the coordinate system defined by
the k-points grid (see <a class="wikilink codevar-wikilink" href="../../../variables/basic#ngkpt">ngkpt</a> and <a class="wikilink codevar-wikilink" href="../../../variables/gstate#kptrlatt">kptrlatt</a>), so that the values of
<a class="wikilink codevar-wikilink" href="../../../variables/ffield#kberry">kberry</a> are integers. Of course, such a k point grid must exist, and all
the corresponding wavefunctions must be available, so that the computation is
allowed only when <a class="wikilink codevar-wikilink" href="../../../variables/basic#kptopt">kptopt</a> is equal to 3. In order to save computing time,
it is suggested to make a preliminary calculation of the wavefunctions on the
irreducible part of the grid, with <a class="wikilink codevar-wikilink" href="../../../variables/basic#kptopt">kptopt</a> equal to 1, and then use these
converged wavefunctions in the entire Brillouin zone, by reading them to
initialize the <a class="wikilink codevar-wikilink" href="../../../variables/basic#kptopt">kptopt</a>=3 computation.</p>
<h2 id="maxestep"><strong>maxestep</strong><a class="headerlink" href="#maxestep" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MAXimum Electric field STEP<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.005<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 6, 16, or 17  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=16 (finite reduced electric displacement field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_122.in" target="_blank">tsv6_122.in</a>, <a class="wikilink abifile-wikilink" data-content="AlAs case,  to test the &amp;quot;polcen&amp;quot; in finite reduced electric field calculation. (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_126.in" target="_blank">tsv6_126.in</a></li></ul></details><p>This variable controls the maximum change of electric field when updating the
electric field after each SCF iteration. When the calculation is difficult to
converge, try reducing this value or reducing <a class="wikilink codevar-wikilink" href="../../../variables/ffield#ddamp">ddamp</a>. This variable is used
in finite electric displacement field calculations (<a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=6,16,17).</p>
<h2 id="natvshift"><strong>natvshift</strong><a class="headerlink" href="#natvshift" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of ATomic potential (V) energy SHIFTs (per atom)<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform a DFT+U calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/paw#usepawu">usepawu</a> /= 0, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#atvshift">atvshift</a>  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v5:  <a class="wikilink abifile-wikilink" data-content="Ni atom in a big box. Test the use of the atvshift variable : change the potential of the d orbitals." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v5/Input/t14.in" target="_blank">t14.in</a>, <a class="wikilink abifile-wikilink" data-content="Ni molecule in a big box. Test the use of the atvshift variable First dataset : no shift,  the ten states number 9 to 18 come from the 3d atomic states,  the state number 19 is a bonding 4s state. States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1). State number 18 is a 3d sigma antibonding state (m=0). Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the levels change by less than 0.0002 (and their energy decrease),  except state number 9 (a 3d sigma bonding state (m=0)),  that goes from -0.24020 to -0.23982 (+0.0004) and state number 18,  that goes from -0.15439 to 0.15399 (+0.0004). Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials. All the levels are affected (likely the m=1 and -1 orbitals adjust,  and cause modification of the potential),  but the states 10,  11,  16,  and 17 increase their energy,  while the other state see their energy decrease. Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking of the degeneracy. This test was not easy to make portable. The problem lies in the fact that when the density becomes negative,  due to Bragg oscillations,  the xc kernel can be extremely large,  and when use for the prediction of the residual of the forces,  the differences between machines can be extremely large. IN order to see this effect,  put ecut 7 and npulayit 7 (its default value)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v5/Input/t15.in" target="_blank">t15.in</a></li></ul></details><p>Number of atomic potential energy shifts (per atom), to be used to define the
array <a class="wikilink codevar-wikilink" href="../../../variables/ffield#atvshift">atvshift</a>. If non-zero, only two possibilities exist : 5 for d states
(with <a class="wikilink codevar-wikilink" href="../../../variables/paw#lpawu">lpawu</a>=2), and 7 for f states (with <a class="wikilink codevar-wikilink" href="../../../variables/paw#lpawu">lpawu</a>=3). If non-zero, one
should define <a class="wikilink codevar-wikilink" href="../../../variables/paw#usepawu">usepawu</a>, <a class="wikilink codevar-wikilink" href="../../../variables/paw#lpawu">lpawu</a> and <a class="wikilink codevar-wikilink" href="../../../variables/ffield#atvshift">atvshift</a>.</p>
<h2 id="nberry"><strong>nberry</strong><a class="headerlink" href="#nberry" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of BERRY phase computations<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 1, 2, or 3  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [4/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="GaAs,  zinc-blende structure. Compute Berry phase along 0 0 1,  using a 4x4x10 sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv2_82.in" target="_blank">tsv2_82.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using old,  rather inaccurate psps. Computation of the Berry phase. Test the doubling of the step of the sampling." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_04.in" target="_blank">tsv3_04.in</a></li></ul></details><p>Gives the number of Berry phase computations of polarisation, or finite-
difference estimations of the derivative of wavefunctions with respect to the
wavevector, each of which might be characterized by a different change of
wavevector <a class="wikilink codevar-wikilink" href="../../../variables/ffield#kberry">kberry</a>.</p>
<p>When equal to 0, no Berry phase calculation of polarisation is performed. The
maximal value of <a class="wikilink codevar-wikilink" href="../../../variables/ffield#nberry">nberry</a> is 20.</p>
<p>Note that the computation of the polarisation for a set of bands having
different occupation numbers is meaningless (although in the case of spin-
polarized calculations, the spin up bands might have an identical occupation
number, that might differ from the identical occupation number of spin down
bands). Although meaningless, ABINIT will perform such computation, if
required by the user. The input variable <a class="wikilink codevar-wikilink" href="../../../variables/ffield#bdberry">bdberry</a> governs the set of bands
for which a Berry phase is computed.</p>
<p>For the <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 1, 2, and 3 cases, spinor wavefunctions are not
allowed, nor are parallel computations.</p>
<h2 id="polcen"><strong>polcen</strong><a class="headerlink" href="#polcen" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> POLarization for CENtrosymmetric geometry<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="AlAs case,  to test the &amp;quot;polcen&amp;quot; in finite reduced electric field calculation. (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_126.in" target="_blank">tsv6_126.in</a></li></ul></details><p>When doing a finite electric displacement field calculation, if the structure
is centrosymmetric but the polarization is non-zero (such as for AlAs), this
non-zero polarization should be specified as <a class="wikilink codevar-wikilink" href="../../../variables/ffield#polcen">polcen</a> (in REDUCED
coordinates, in atomic units) in the input file. See Eq.(24) in the Suppl. of
Nat. Phys. (M. Stengel, N.A. Spaldin and D. Vanderbilt, Nat. Phys. 5,304
(2009))</p>
<h2 id="qprtrb"><strong>qprtrb</strong><a class="headerlink" href="#qprtrb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Q-wavevector of the PERTurbation<br />
<em>Characteristics:</em> <a class="wikilink" href="../../../user-guide/abinit#32-more-about-abinit-input-variables">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform some artificial modifications of the physics" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Artificial">topic_Artificial</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> [0, 0, 0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#vprtrb">vprtrb</a>  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t02.in" target="_blank">t02.in</a></li></ul></details><p>Gives the wavevector, in units of reciprocal lattice primitive translations,
of a perturbing potential of strength <a class="wikilink codevar-wikilink" href="../../../variables/ffield#vprtrb">vprtrb</a>. See <a class="wikilink codevar-wikilink" href="../../../variables/ffield#vprtrb">vprtrb</a> for more
explanation.</p>
<h2 id="red_dfield"><strong>red_dfield</strong><a class="headerlink" href="#red_dfield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> REDuced Displacement FIELD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 16, <a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_efield">red_efield</a>  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=16 (finite reduced electric displacement field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_122.in" target="_blank">tsv6_122.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt=17 (mixed finite electric field and electric displacement field boundary condition,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_125.in" target="_blank">tsv6_125.in</a></li></ul></details><p>In case <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=16, a reduced finite electric displacement field
calculation is performed. The value of this displacement field, and its
direction is determined by <a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_dfield">red_dfield</a>. It must be given in atomic units.</p>
<p><a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_dfield">red_dfield</a> is defined via Eq.(26) in the Supplement of M. Stengel, N.A.
Spaldin and D. Vanderbilt, Nat. Phys. 5,304 (2009).</p>
<h2 id="red_efield"><strong>red_efield</strong><a class="headerlink" href="#red_efield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> REDuced Electric FIELD<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 16  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [3/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=14 (finite reduced electric field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_121.in" target="_blank">tsv6_121.in</a>, <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=16 (finite reduced electric displacement field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_122.in" target="_blank">tsv6_122.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt=17 (mixed finite electric field and electric displacement field boundary condition,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_125.in" target="_blank">tsv6_125.in</a></li></ul></details><p>In case <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=16, a reduced finite electric displacement field
calculation is performed. In this case, the parameter red_efield specifies the
initial electric field used on the first iteration, in atomic units.</p>
<p><a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_efield">red_efield</a> is defined via Eq.(25) in the Supplement of M. Stengel, N.A.
Spaldin and D. Vanderbilt, Nat. Phys. 5,304 (2009).</p>
<h2 id="red_efieldbar"><strong>red_efieldbar</strong><a class="headerlink" href="#red_efieldbar" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> REDuced Electric FIELD BAR<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to compute the polarisation and take into account a finite homogeneous electric
field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Berry">topic_Berry</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 3*0.0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a> = 14  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>seq:  <a class="wikilink abifile-wikilink" data-content="PbTiO3 in the tetragonal geometry. Test berryopt=14 (finite reduced electric field calculation, relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_121.in" target="_blank">tsv6_121.in</a>, <a class="wikilink abifile-wikilink" data-content="Test berryopt=17 (mixed finite electric field and electric displacement field boundary condition,  relaxing cell parameters,  e.g. optcell=2) (XG120616 : tranferred to tests/seq)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv6_125.in" target="_blank">tsv6_125.in</a></li></ul></details><p>In case <a class="wikilink codevar-wikilink" href="../../../variables/ffield#berryopt">berryopt</a>=14, a reduced finite electric field calculation is
performed. The magnitude and direction of this electric field are determined
by red_efieldbar. It must be given in atomic units.</p>
<p><a class="wikilink codevar-wikilink" href="../../../variables/ffield#red_efieldbar">red_efieldbar</a> is defined via Eq.(28) in the Supplement of M. Stengel, N.A.
Spaldin and D. Vanderbilt, Nat. Phys. 5,304 (2009).</p>
<h2 id="spinmagntarget"><strong>spinmagntarget</strong><a class="headerlink" href="#spinmagntarget" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SPIN-MAGNetization TARGET<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to set parameters for a spin-polarized calculation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/spinpolarisation">topic_spinpolarisation</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -99.99  </p>
<details class="note"><summary>Test list (click to open). Moderately used, [33/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>mpiio:  <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/mpiio/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test the triple parallelisation. We cannot check the distribution npband*npfft*npkpt=2*2*2=8 processors, this number being not allowed in the test procedure. Here,  we only test the parallelisation over bands and spins: npband*npfft*npkpt=2*1*2=4 processors. In addition,  we also test here various features of bandfft-kpt parallelisation In particular,  the bandpp,  istwfk=2 and wfoptalg=14 variables." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/mpiio/Input/t25.in" target="_blank">t25.in</a></li><li>paral:  <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule Test TDDFT in parallel,  with nsppol=2 even if the molecule is non spin-polarized" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t05.in" target="_blank">t05.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 0 and 4 procs." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test the triple parallelisation. We cannot check the distribution npband*npfft*npkpt=2*2*2=8 processors, this number being not allowed in the test procedure. Here,  we only test the parallelisation over bands and spins: npband*npfft*npkpt=2*1*2=4 processors. In addition,  we also test here various features of bandfft-kpt parallelisation In particular,  the bandpp,  istwfk=2 and wfoptalg=14 variables." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t25.in" target="_blank">t25.in</a>, <a class="wikilink abifile-wikilink" data-content="C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Test of ground state with different occs(7 and 0), and also ionmov 2. Only with 4 procs. Same of test R:test the automatic parallelisation" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t26.in" target="_blank">t26.in</a>, <a class="wikilink abifile-wikilink" data-content="Chebyshev,  C-diamond,  Bulk,  2 atoms,  paral_kgb,  with PAW. Also test gemm_nonlop" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t30.in" target="_blank">t30.in</a>, <a class="wikilink abifile-wikilink" data-content="Test paral_kgb 0 eigensolver and IO routines with idle processors." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="Test paral_kgb 0 eigensolver and IO routines with idle processors." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of PBE0-1/3 in parallel NB: HF does not support MPI-IO. gmatteo will add support for HDF5 when this test will succeed with MPI-IO. For the time being,  this test is disabled when we are in netcdf mode." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/paral/Input/t94.in" target="_blank">t94.in</a></li><li>seq:  <a class="wikilink abifile-wikilink" data-content="81. Nitrogen atom in a big box,  spin-polarized. Compute Berry phase for atom at different positions." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv2_81.in" target="_blank">tsv2_81.in</a>, <a class="wikilink abifile-wikilink" data-content="Zinc-blende GaAs (2 atoms per unit cell), using HGH psps. Test the computation of the Berry phase. Grid sampling is very rough,  for speed. 8 dataset,  testing all combinations of location of wfs (memory or disk),  spin polarisation, use (or non-use) of time-reversal symmetry." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv3_03.in" target="_blank">tsv3_03.in</a>, <a class="wikilink abifile-wikilink" data-content="Crystalline silicon : print the pwfn.data file, for use in a subsequent run of the CASINO code." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/seq/Input/tsv4_90.in" target="_blank">tsv4_90.in</a></li><li>v1:  <a class="wikilink abifile-wikilink" data-content="3H2 molecule with distant atoms : probe the use of the spinat variable Use spin-polarized mode,  spinor mode,  as well as antiferromagnetic mode. Even consider an initialization with reather crazy,  nearly ferromagnetic spinat. Use 01h.pspgth,  in a 8 8 16 box,  with 15 Ha cut-off. Separation is 4 bohr. Consider anti-parallel spin configuration,   which is the favoured one for this distance. Get total energy of -0.981 839  Ha . Note that the spin-polarization is not complete. Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha ." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v1/Input/t39.in" target="_blank">t39.in</a></li><li>v2:  <a class="wikilink abifile-wikilink" data-content="Silicon,  diamond structure. Test the ability to read an input wavefunction and to generate from it any other wavefunction,  changing different parameters. One of the _DEN file is also used as starting point of the cut3D tests." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v2/Input/t76.in" target="_blank">t76.in</a></li><li>v3:  <a class="wikilink abifile-wikilink" data-content="H2 diatomic molecule. Spin-polarized (anti-ferromagnetic). Test phonon RF for spin-polarized case. ixc=1 (Teter LSDA) From datasets 3 and 4,  one gets the derivatives with respect to the atomic displacement along x. The simple finite-difference formula gives the 2DTE 6.283100652 Ha,  while the direct computation, without using Shubnikov symmetries,  gives 6.282967527 Ha." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v3/Input/t12.in" target="_blank">t12.in</a>, <a class="wikilink abifile-wikilink" data-content="H diatomic molecule in the antiferromagnetic regime. Different data sets. Test Shubnikov symmetries." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v3/Input/t20.in" target="_blank">t20.in</a>, <a class="wikilink abifile-wikilink" data-content="Fe BCC crystal. Constraint the magnetic moment,  using the input variable spinmagntarget." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v3/Input/t51.in" target="_blank">t51.in</a>, <a class="wikilink abifile-wikilink" data-content="Diamond Si in an orthorhombic cell,  in preparation of cut3d analysis,  see test 59." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v3/Input/t58.in" target="_blank">t58.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diamond Spin-polarized calculation (nspden=2) RF phonon with q=0.5 0 0" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v3/Input/t86.in" target="_blank">t86.in</a></li><li>v5:  <a class="wikilink abifile-wikilink" data-content="Crystalline Cu2O Computation of the total energy and EFG tensors in LDA+U formalism Note: Cu2O is a nonmagnetic insulator. However,  LDA+U as implemented requires nspden=2 in all cases." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v5/Input/t33.in" target="_blank">t33.in</a>, <a class="wikilink abifile-wikilink" data-content="N2 molecule non-spin-polarized,  but treated with nsppol=2,  in a big box. Similar to test 55 of tests/v3. There should be only small numerical differences with respect to datasets 1 and 2 of this test, due to the fact that the tetragonal symmetry was here slightly broken for sake of portability of the automatic test. Note however that the singlet and triplet states cannot be disentagled, so one gets a big list of excitations,  the merge of singlet and triplet excitations." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v5/Input/t61.in" target="_blank">t61.in</a>, <a class="wikilink abifile-wikilink" data-content="BeH spin-polarized,  in a supercell Test the spin-polarized TDDFT implementation. nband 20,  ecut 8,  acell 14 14 14 . For the first two excitations,  one finds : 2.40967E+00 eV,  doubly degenerate  (Pi excitation) 3.94165E+00 eV  (Sigma+ excitation) They come mainly from the 2nd occupied Kohn-Sham state,  spin up. The third excitation,  at 5.11592E+00 eV (Sigma+ excitation) comes mainly from the 1st occupied Kohn-Sham state,  spin down. Then,  come excitations that are in the continuum,  or close to it (depending on the parameters of the calculation),  so,  harder to converge, In order to have a calculation converged at the level of 0.1 eV,  one needs parameters like nband 40,  ecut 10,  acell 30. In that case,  the three above-mentioned excitations become 2.388 eV (Pi),  4.432 eV (Sigma+),  5.357 eV (Sigma+). In this case,  the latter is no more the third excitation,  as other ones, coupled to the vacuum have a lower energy. These numbers can be compared to the values given by J. Guan,  ME Casida,  DR Salahub,  J. of Mol. Structure - Theochem 527, 229,  Sp. Iss. SI (2000) : 2.391 eV (1Pi),  4.593 eV (2Sigma+),  5.418 eV (5Sigma+), and to the experimental values (see the above paper) 2.56 eV/2.484 eV,  5.51 eV,  6.71 eV." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v5/Input/t62.in" target="_blank">t62.in</a>, <a class="wikilink abifile-wikilink" data-content="Bcc Hydrogen,  r_s=2.6 a.u AF Check the GW+spin calculation with and without symmetries" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v5/Input/t63.in" target="_blank">t63.in</a></li><li>v6:  <a class="wikilink abifile-wikilink" data-content="Tests series for the mGGA implementation (from 31 to 33) Silicon bulk. Two datasets are run. One (classic) LDA calculation with ixc 7. One with a fake native mGGA (fake1,  i.e. ixc 31) and using effmass_free=1.01. Both calculation should give the same total energy (change in kinetic energy due to effmass_free is compensated by the fake mGGA using kinetic energy density: taur). (Two other datasets are also run for spin polarized case)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t31.in" target="_blank">t31.in</a>, <a class="wikilink abifile-wikilink" data-content="Test the mGGA implementation. Silicon bulk. Two datasets are run. One with a fake native mGGA (fake2,  i.e. ixc 32) involving laplacian of the density. One with a fake native mGGA (fake3,  i.e. ixc 33) involving gradient of the density. Both calculation should give the same total and exchange-correlation energies. (Two other datasets are also run for spin polarized case)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t32.in" target="_blank">t32.in</a>, <a class="wikilink abifile-wikilink" data-content="Si diatomic molecule Test of linear and non-linear response in the non-spin-polarized case. Only four bands are allowed,  both spin-up and spin-down,  so that the molecule is non spin polarized. However nsppol=2 for testing purposes. Over 1200 WARNINGS. This test must give the same results of the test 64 non-linear response with nsppol=1 does not support MPI with nprocs &amp;gt; 1" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t63.in" target="_blank">t63.in</a></li><li>v67mbpt:  <a class="wikilink abifile-wikilink" data-content="Silicon: Solution of the Bethe-Salpeter equation (BSE) with PAW and nsppol = 2. Use model dielectric function computed from AE PAW density (denfgr.F90)." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v67mbpt/Input/t29.in" target="_blank">t29.in</a></li><li>v7:  <a class="wikilink abifile-wikilink" data-content="EuO rock salt structure. 27-electron PAW pseudo (4f and 5d are explicitly treated : 4d10 4f7 5s2 5p6 (5d0) 6s2 ) Test of initialisation using occopt=1 (the default) with non-zero spinmagntarget, and also metallic occopt. Also test pawxcdev=0" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v7/Input/t22.in" target="_blank">t22.in</a>, <a class="wikilink abifile-wikilink" data-content="Test of PBE0 in sequential case" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v7/Input/t66.in" target="_blank">t66.in</a></li></ul></details><p>This input variable is active only in the <a class="wikilink codevar-wikilink" href="../../../variables/basic#nsppol">nsppol</a>=2 case. If
<a class="wikilink codevar-wikilink" href="../../../variables/ffield#spinmagntarget">spinmagntarget</a> is not the &ldquo;magic&rdquo; value of -99.99d0, the spin-
magnetization of the primitive cell will be fixed (or optimized, if it is not
possible to impose it) to the value of <a class="wikilink codevar-wikilink" href="../../../variables/ffield#spinmagntarget">spinmagntarget</a>, in Bohr magneton
units, e.g. for an Hydrogen atom, it is 1.<br />
If <a class="wikilink codevar-wikilink" href="../../../variables/basic#occopt">occopt</a> is a metallic one, the Fermi energies for spin up and spin down
are adjusted to give the target spin-polarisation (this is equivalent to an
exchange splitting). If <a class="wikilink codevar-wikilink" href="../../../variables/basic#occopt">occopt</a>=1 and <a class="wikilink codevar-wikilink" href="../../../variables/basic#nsppol">nsppol</a>=2, the occupation numbers
for spin up and spin down will be adjusted to give the required spin-
magnetization (occupation numbers are identical for all k-points, with
<a class="wikilink codevar-wikilink" href="../../../variables/basic#occopt">occopt</a>=1). The definition of <a class="wikilink codevar-wikilink" href="../../../variables/ffield#spinmagntarget">spinmagntarget</a> is actually requested in
this case, except for the single isolated Hydrogen atom.<br />
If <a class="wikilink codevar-wikilink" href="../../../variables/ffield#spinmagntarget">spinmagntarget</a> is the default one, the spin-magnetization will not be
constrained, and will be determined self-consistently, by having the same spin
up and spin down Fermi energy in the metallic case, while for the other cases,
there will be no spin-magnetization, except for an odd number of electrons if
<a class="wikilink codevar-wikilink" href="../../../variables/basic#occopt">occopt</a>=1 and <a class="wikilink codevar-wikilink" href="../../../variables/basic#nsppol">nsppol</a>=2.</p>
<p>Note : for the time being, only the spin down Fermi energy is written out in
the main output file. In the fixed magnetic moment case, it differs from the
spin up Fermi energy.</p>
<h2 id="vprtrb"><strong>vprtrb</strong><a class="headerlink" href="#vprtrb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> potential -V- for the PeRTuRBation<br />
<em>Characteristics:</em> <a class="wikilink" href="../../../user-guide/abinit#32-more-about-abinit-input-variables">DEVELOP</a>, <a class="wikilink" href="../../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to perform some artificial modifications of the physics" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/Artificial">topic_Artificial</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (2)<br />
<em>Default value:</em> [0.0, 0.0]<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="../../../variables/ffield#qprtrb">qprtrb</a>  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [2/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v6:  <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. This should be linked with the computation of the dielectric constant, test v2#05,  that uses directly the RF capabilities of ABINIT, for one diatomic molecule. For dataset 1,  one reproduces the results obtained in Tv2#05,  multiplied by 4. The total energy is consistent up to more than 10 digits : -6.6499924738006 Ha for Tv2#05,  -26.599969895203 Ha for the present calculation. For dataset 2,  the perturbation qprtrb 0 0 1 is frozen in,  with vprtrb 100. The total energy is -26.600317638775 Ha. The difference wrt the unperturbed situation is 0.000348743572 Ha. For dataset 3,  a much smaller perturbation (10 times smaller) is taken, giving total energy -26.599973367786 Ha. The difference wrt the unperturbed situation is 0.3472583 microHa. For dataset 4,  an even smaller perturbation (100 times smaller) is taken, giving total energy -26.599969929928 Ha. The difference wrt the unperturbed situation is 0.000034725 microHa. With datasets 3 and 4,  we are in the linear regime. The previous amplitude is better for such studies. Dataset 5 is the same as 3,  with reversed amplitude. Results are similar to dataset 3. I had no sufficient time to analyze these data correctly and make the connection with the results of Tv2#05,  unfortunately. The following (also test 02 below) gives some more data,  and raise questions. There might be some problem with the use of qprtrb and vprtrb. For dataset 2,  the group of the four lowest eigenenergies (each corresponding to a different molecule) is : -0.47198  -0.46381  -0.46091  -0.45266,  whose spread is 0.01932 Ha. One might think that the maximum and minimum of the potential are separated roughly by 0.02 Ha. The value vprtrb 100 corresponds to a cosine wave whose amplitude is 100,  divided by the volume of the cell,  that is 5000 Bohr^3 : 0.02 Ha. The maximum and minimum of the potential should thus be separated by 0.04 Ha. There seems to be a factor of 2 off." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t01.in" target="_blank">t01.in</a>, <a class="wikilink abifile-wikilink" data-content="Chain of Silicon diatomic molecules (4 Si2 molecules in the cell) Freeze oscillatory perturbations with different wavelengths and intensities, thanks to the qprtrb and vprtrb input variables. Compute the dielectric constant. Similar to test v6#01, but uses a more symmetric geometry,  to examine invariance of the response with respect to shifts of potential,  and also a shorter wavelength. I do not understand why vprtrb 0 10.0 leads to no response. Such a sine wave should cause similar response as for the cosine wave. No time presently to investigate this problem (XG090909)" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t02.in" target="_blank">t02.in</a></li></ul></details><p>Gives the real and imaginary parts of a scalar potential perturbation. Can be
specified in Ha (the default), Ry, eV or Kelvin, since <a class="wikilink codevar-wikilink" href="../../../variables/ffield#vprtrb">vprtrb</a> has the
&lsquo;<a class="wikilink" href="../../../user-guide/abinit#32-more-about-abinit-input-variables">ENERGY</a>&lsquo; characteristics.<br />
This is made available for testing responses to such perturbations. The form
of the perturbation, which is added to the local potential, is:</p>
<ul>
<li>(<a class="wikilink codevar-wikilink" href="../../../variables/ffield#vprtrb">vprtrb</a>(1)+I*<a class="wikilink codevar-wikilink" href="../../../variables/ffield#vprtrb">vprtrb</a>(2))/2 at G=<a class="wikilink codevar-wikilink" href="../../../variables/ffield#qprtrb">qprtrb</a> and </li>
<li>(<a class="wikilink codevar-wikilink" href="../../../variables/ffield#vprtrb">vprtrb</a>(1)-I*<a class="wikilink codevar-wikilink" href="../../../variables/ffield#vprtrb">vprtrb</a>(2))/2 at G=-<a class="wikilink codevar-wikilink" href="../../../variables/ffield#qprtrb">qprtrb</a> (see <a class="wikilink codevar-wikilink" href="../../../variables/ffield#qprtrb">qprtrb</a> also). </li>
</ul>
<h2 id="zeemanfield"><strong>zeemanfield</strong><a class="headerlink" href="#zeemanfield" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ZEEMAN FIELD<br />
<em>Characteristics:</em> <a class="wikilink" href="../../../user-guide/abinit#32-more-about-abinit-input-variables">MAGNETIC_FIELD</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-content="How to take into account an external magnetic field" data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../topics/MagField">topic_MagField</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (3)<br />
<em>Default value:</em> 0  </p>
<details class="note"><summary>Test list (click to open). Rarely used, [1/920] in all abinit tests, [0/116] in abinit tutorials</summary><ul><li>v6:  <a class="wikilink abifile-wikilink" data-content="Bi atom in a big supercell. Test the application of a Zeeman field." data-placement="auto right" data-toggle="popover" data-trigger="hover focus" href="../../../tests/v6/Input/t17.in" target="_blank">t17.in</a></li></ul></details><p>Give the value of the Zeeman field, H, acting on the spinorial wavefunctions.
Note that Tesla are admitted. This sets the magnitude of mu_0*H, in Tesla,
with H in Amperes/metre.</p>
                
                  
                
              

<!-- 
add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
                <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
                <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
                <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li><a href="../../about/release-notes/" data-toggle="tooltip" data-placement="left" 
                  title=About><i class="fa fa-info-circle"></i></a></li>
        
          <li><a href="../../developers/abimkdocs/" data-toggle="tooltip" data-placement="left" 
                  title=Developers><i class="fa fa-terminal"></i></a></li>
        
          <li><a href="../../theory/wavefunctions/" data-toggle="tooltip" data-placement="left" 
                  title=Theory><i class="fa fa-book"></i></a></li>
        
          <li><a href="../../tutorials/welcome/" data-toggle="tooltip" data-placement="left" 
                  title=Lessons><i class="fa fa-graduation-cap"></i></a></li>
        
          <li><a href="../" data-toggle="tooltip" data-placement="left" 
                  title=Variables><i class="fa fa-file-text-o"></i></a></li>
        
          <li><a href="../../user-guide/features/" data-toggle="tooltip" data-placement="left" 
                  title=Topics><i class="fa fa-question"></i></a></li>
        
          <li><a href="../.." data-toggle="tooltip" data-placement="left" 
                  title=User Guide><i class="fa fa-user-circle-o"></i></a></li>
        
        <!--
        Example: 
        <li><a href="/index.html" data-toggle="tooltip" data-placement="left" title="User-Guide">
              <i class="fa fa-user-circle-o"></i></a></li>
        -->
        </ul>
      </div>
    </div>
  </div>
</div>

              
                
              
            </article>
          </div>
        </div>
      </main>
      
    <!-- Add tabs to footer -->
    
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="User Guide" class="md-tabs__link">
          User Guide
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../user-guide/features/" title="Topics" class="md-tabs__link">
          Topics
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Variables" class="md-tabs__link md-tabs__link--active">
          Variables
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tutorials/welcome/" title="Lessons" class="md-tabs__link">
          Lessons
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../theory/wavefunctions/" title="Theory" class="md-tabs__link">
          Theory
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../developers/abimkdocs/" title="Developers" class="md-tabs__link">
          Developers
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../about/release-notes/" title="About" class="md-tabs__link">
          About
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
    
    
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../eph/" title="Electron-Phonon" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Electron-Phonon
              </span>
            </div>
          </a>
        
        
          <a href="../files/" title="File-handling" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                File-handling
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 8.5.4</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 The Abinit Group
          </div>
        

        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/abinit/abinit" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/hashtag/abinit" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://www.facebook.com/abinit.org" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      

    </div>
    
      <script src="../../assets/javascripts/application-6940329b9f.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.8/ace.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
    
      
    
  </body>
</html>